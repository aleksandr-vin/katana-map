(self.webpackChunkkatana_map=self.webpackChunkkatana_map||[]).push([[179],{451:(Hc,Fo,vs)=>{"use strict";function $t(e){return"function"==typeof e}function nc(e){const t=e(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const qc=nc(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function v(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class Jt{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const a of t)a.remove(this);else t.remove(this);const{initialTeardown:i}=this;if($t(i))try{i()}catch(a){n=a instanceof qc?a.errors:[a]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const a of r)try{ut(a)}catch(u){n=n??[],u instanceof qc?n=[...n,...u.errors]:n.push(u)}}if(n)throw new qc(n)}}add(n){var t;if(n&&n!==this)if(this.closed)ut(n);else{if(n instanceof Jt){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&v(t,n)}remove(n){const{_finalizers:t}=this;t&&v(t,n),n instanceof Jt&&n._removeParent(this)}}Jt.EMPTY=(()=>{const e=new Jt;return e.closed=!0,e})();const xe=Jt.EMPTY;function Qi(e){return e instanceof Jt||e&&"closed"in e&&$t(e.remove)&&$t(e.add)&&$t(e.unsubscribe)}function ut(e){$t(e)?e():e.unsubscribe()}const yr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},to={setTimeout(e,n,...t){const{delegate:i}=to;return i?.setTimeout?i.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=to;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function bs(e){to.setTimeout(()=>{const{onUnhandledError:n}=yr;if(!n)throw e;n(e)})}function no(){}const rs=Ri("C",void 0,void 0);function Ri(e,n,t){return{kind:e,value:n,error:t}}let Oo=null;function Lo(e){if(yr.useDeprecatedSynchronousErrorHandling){const n=!Oo;if(n&&(Oo={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:i}=Oo;if(Oo=null,t)throw i}}else e()}class ze extends Jt{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Qi(n)&&n.add(this)):this.destination=No}static create(n,t,i){return new ht(n,t,i)}next(n){this.isStopped?Ji(function yo(e){return Ri("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Ji(function qn(e){return Ri("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Ji(rs,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const We=Function.prototype.bind;function dt(e,n){return We.call(e,n)}class mt{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(i){Bt(i)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(i){Bt(i)}else Bt(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){Bt(t)}}}class ht extends ze{constructor(n,t,i){let r;if(super(),$t(n)||!n)r={next:n??void 0,error:t??void 0,complete:i??void 0};else{let a;this&&yr.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&dt(n.next,a),error:n.error&&dt(n.error,a),complete:n.complete&&dt(n.complete,a)}):r=n}this.destination=new mt(r)}}function Bt(e){yr.useDeprecatedSynchronousErrorHandling?function He(e){yr.useDeprecatedSynchronousErrorHandling&&Oo&&(Oo.errorThrown=!0,Oo.error=e)}(e):bs(e)}function Ji(e,n){const{onStoppedNotification:t}=yr;t&&to.setTimeout(()=>t(e,n))}const No={closed:!0,next:no,error:function Zn(e){throw e},complete:no},Bo="function"==typeof Symbol&&Symbol.observable||"@@observable";function vr(e){return e}function Ks(e){return 0===e.length?vr:1===e.length?e[0]:function(t){return e.reduce((i,r)=>r(i),t)}}let bn=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(t,i,r){const a=function Lr(e){return e&&e instanceof ze||function Xs(e){return e&&$t(e.next)&&$t(e.error)&&$t(e.complete)}(e)&&Qi(e)}(t)?t:new ht(t,i,r);return Lo(()=>{const{operator:u,source:p}=this;a.add(u?u.call(a,p):p?this._subscribe(a):this._trySubscribe(a))}),a}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=pl(i))((r,a)=>{const u=new ht({next:p=>{try{t(p)}catch(y){a(y),u.unsubscribe()}},error:a,complete:r});this.subscribe(u)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Bo](){return this}pipe(...t){return Ks(t)(this)}toPromise(t){return new(t=pl(t))((i,r)=>{let a;this.subscribe(u=>a=u,u=>r(u),()=>i(a))})}}return e.create=n=>new e(n),e})();function pl(e){var n;return null!==(n=e??yr.Promise)&&void 0!==n?n:Promise}const vo=nc(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let St=(()=>{class e extends bn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Na(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new vo}next(t){Lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:a}=this;return i||r?xe:(this.currentObservers=null,a.push(t),new Jt(()=>{this.currentObservers=null,v(a,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:a}=this;i?t.error(r):a&&t.complete()}asObservable(){const t=new bn;return t.source=this,t}}return e.create=(n,t)=>new Na(n,t),e})();class Na extends St{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,n)}error(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==i?i:xe}}function Ba(e){return $t(e?.lift)}function In(e){return n=>{if(Ba(n))return n.lift(function(t){try{return e(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function xn(e,n,t,i,r){return new xs(e,n,t,i,r)}class xs extends ze{constructor(n,t,i,r,a,u){super(n),this.onFinalize=a,this.shouldUnsubscribe=u,this._next=t?function(p){try{t(p)}catch(y){n.error(y)}}:super._next,this._error=r?function(p){try{r(p)}catch(y){n.error(y)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(p){n.error(p)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function wt(e,n){return In((t,i)=>{let r=0;t.subscribe(xn(i,a=>{i.next(e.call(n,a,r++))}))})}function Dt(e){return this instanceof Dt?(this.v=e,this):new Dt(e)}function bi(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function bo(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=e[a]&&function(u){return new Promise(function(p,y){!function r(a,u,p,y){Promise.resolve(y).then(function(E){a({value:E,done:p})},u)}(p,y,(u=e[a](u)).done,u.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const V=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function q(e){return $t(e?.then)}function ee(e){return $t(e[Bo])}function ne(e){return Symbol.asyncIterator&&$t(e?.[Symbol.asyncIterator])}function ce(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ie=function ae(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function de(e){return $t(e?.[ie])}function Ie(e){return function Rt(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),a=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(B){i[B]&&(r[B]=function(H){return new Promise(function(X,re){a.push([B,H,X,re])>1||p(B,H)})})}function p(B,H){try{!function y(B){B.value instanceof Dt?Promise.resolve(B.value.v).then(E,I):R(a[0][2],B)}(i[B](H))}catch(X){R(a[0][3],X)}}function E(B){p("next",B)}function I(B){p("throw",B)}function R(B,H){B(H),a.shift(),a.length&&p(a[0][0],a[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:i,done:r}=yield Dt(t.read());if(r)return yield Dt(void 0);yield yield Dt(i)}}finally{t.releaseLock()}})}function Te(e){return $t(e?.getReader)}function Ee(e){if(e instanceof bn)return e;if(null!=e){if(ee(e))return function gt(e){return new bn(n=>{const t=e[Bo]();if($t(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(V(e))return function It(e){return new bn(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(q(e))return function it(e){return new bn(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,bs)})}(e);if(ne(e))return Ct(e);if(de(e))return function pt(e){return new bn(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(Te(e))return function en(e){return Ct(Ie(e))}(e)}throw ce(e)}function Ct(e){return new bn(n=>{(function zt(e,n){var t,i,r,a;return function Qs(e,n,t,i){return new(t||(t=Promise))(function(a,u){function p(I){try{E(i.next(I))}catch(R){u(R)}}function y(I){try{E(i.throw(I))}catch(R){u(R)}}function E(I){I.done?a(I.value):function r(a){return a instanceof t?a:new t(function(u){u(a)})}(I.value).then(p,y)}E((i=i.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=bi(e);!(i=yield t.next()).done;)if(n.next(i.value),n.closed)return}catch(u){r={error:u}}finally{try{i&&!i.done&&(a=t.return)&&(yield a.call(t))}finally{if(r)throw r.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Vt(e,n,t,i=0,r=!1){const a=n.schedule(function(){t(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(a),!r)return a}function tn(e,n,t=1/0){return $t(n)?tn((i,r)=>wt((a,u)=>n(i,a,r,u))(Ee(e(i,r))),t):("number"==typeof n&&(t=n),In((i,r)=>function On(e,n,t,i,r,a,u,p){const y=[];let E=0,I=0,R=!1;const B=()=>{R&&!y.length&&!E&&n.complete()},H=re=>E<i?X(re):y.push(re),X=re=>{a&&n.next(re),E++;let _e=!1;Ee(t(re,I++)).subscribe(xn(n,Se=>{r?.(Se),a?H(Se):n.next(Se)},()=>{_e=!0},void 0,()=>{if(_e)try{for(E--;y.length&&E<i;){const Se=y.shift();u?Vt(n,u,()=>X(Se)):X(Se)}B()}catch(Se){n.error(Se)}}))};return e.subscribe(xn(n,H,()=>{R=!0,B()})),()=>{p?.()}}(i,r,e,t)))}function xt(e=1/0){return tn(vr,e)}const gn=new bn(e=>e.complete());function Wr(e){return e&&$t(e.schedule)}function Zr(e){return e[e.length-1]}function Va(e){return $t(Zr(e))?e.pop():void 0}function ea(e){return Wr(Zr(e))?e.pop():void 0}function yl(e,n=0){return In((t,i)=>{t.subscribe(xn(i,r=>Vt(i,e,()=>i.next(r),n),()=>Vt(i,e,()=>i.complete(),n),r=>Vt(i,e,()=>i.error(r),n)))})}function Ds(e,n=0){return In((t,i)=>{i.add(e.schedule(()=>t.subscribe(i),n))})}function Hi(e,n){if(!e)throw new Error("Iterable cannot be null");return new bn(t=>{Vt(t,n,()=>{const i=e[Symbol.asyncIterator]();Vt(t,n,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function ei(e,n){return n?function Zc(e,n){if(null!=e){if(ee(e))return function hi(e,n){return Ee(e).pipe(Ds(n),yl(n))}(e,n);if(V(e))return function Vo(e,n){return new bn(t=>{let i=0;return n.schedule(function(){i===e.length?t.complete():(t.next(e[i++]),t.closed||this.schedule())})})}(e,n);if(q(e))return function Wc(e,n){return Ee(e).pipe(Ds(n),yl(n))}(e,n);if(ne(e))return Hi(e,n);if(de(e))return function Mh(e,n){return new bn(t=>{let i;return Vt(t,n,()=>{i=e[ie](),Vt(t,n,()=>{let r,a;try{({value:r,done:a}=i.next())}catch(u){return void t.error(u)}a?t.complete():t.next(r)},0,!0)}),()=>$t(i?.return)&&i.return()})}(e,n);if(Te(e))return function od(e,n){return Hi(Ie(e),n)}(e,n)}throw ce(e)}(e,n):Ee(e)}function Ht(...e){const n=ea(e),t=function xi(e,n){return"number"==typeof Zr(e)?e.pop():n}(e,1/0),i=e;return i.length?1===i.length?Ee(i[0]):xt(t)(ei(i,n)):gn}class wi extends St{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:i}=this;if(n)throw t;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function _t(...e){return ei(e,ea(e))}function vl(e={}){const{connector:n=(()=>new St),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return a=>{let u,p,y,E=0,I=!1,R=!1;const B=()=>{p?.unsubscribe(),p=void 0},H=()=>{B(),u=y=void 0,I=R=!1},X=()=>{const re=u;H(),re?.unsubscribe()};return In((re,_e)=>{E++,!R&&!I&&B();const Se=y=y??n();_e.add(()=>{E--,0===E&&!R&&!I&&(p=Kc(X,r))}),Se.subscribe(_e),!u&&E>0&&(u=new ht({next:ye=>Se.next(ye),error:ye=>{R=!0,B(),p=Kc(H,t,ye),Se.error(ye)},complete:()=>{I=!0,B(),p=Kc(H,i),Se.complete()}}),Ee(re).subscribe(u))})(a)}}function Kc(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new ht({next:()=>{i.unsubscribe(),e()}});return Ee(n(...t)).subscribe(i)}function ir(e,n){return In((t,i)=>{let r=null,a=0,u=!1;const p=()=>u&&!r&&i.complete();t.subscribe(xn(i,y=>{r?.unsubscribe();let E=0;const I=a++;Ee(e(y,I)).subscribe(r=xn(i,R=>i.next(n?n(y,R,I,E++):R),()=>{r=null,p()}))},()=>{u=!0,p()}))})}function Xc(e,n=vr){return e=e??Th,In((t,i)=>{let r,a=!0;t.subscribe(xn(i,u=>{const p=n(u);(a||!e(r,p))&&(a=!1,r=p,i.next(u))}))})}function Th(e,n){return e===n}function wn(e){for(let n in e)if(e[n]===wn)return n;throw Error("Could not find renamed property on target object.")}function Yc(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Ei(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Ei).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function sd(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const ad=wn({__forward_ref__:wn});function Mn(e){return e.__forward_ref__=Mn,e.toString=function(){return Ei(this())},e}function Mt(e){return Qc(e)?e():e}function Qc(e){return"function"==typeof e&&e.hasOwnProperty(ad)&&e.__forward_ref__===Mn}function Jc(e){return e&&!!e.\u0275providers}const oc="https://g.co/ng/security#xss";class be extends Error{constructor(n,t){super(function Ua(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function Tt(e){return"string"==typeof e?e:null==e?"":String(e)}function na(e,n){throw new be(-201,!1)}function ro(e,n){null==e&&function Et(e,n,t,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${t} ${i} ${n} <=Actual]`))}(n,e,null,"!=")}function et(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function pi(e){return{providers:e.providers||[],imports:e.imports||[]}}function wl(e){return ru(e,sc)||ru(e,su)}function ru(e,n){return e.hasOwnProperty(n)?e[n]:null}function Is(e){return e&&(e.hasOwnProperty(ou)||e.hasOwnProperty(ja))?e[ou]:null}const sc=wn({\u0275prov:wn}),ou=wn({\u0275inj:wn}),su=wn({ngInjectableDef:wn}),ja=wn({ngInjectorDef:wn});var rn=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(rn||{});let ia;function Nr(e){const n=ia;return ia=e,n}function au(e,n,t){const i=wl(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&rn.Optional?null:void 0!==n?n:void na(Ei(e))}const Tn=globalThis;class Re{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=et({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const _n={},ra="__NG_DI_FLAG__",lc="ngTempTokenPath",ff=/\n/gm,cc="__source";let Ms;function as(e){const n=Ms;return Ms=e,n}function uc(e,n=rn.Default){if(void 0===Ms)throw new be(-203,!1);return null===Ms?au(e,void 0,n):Ms.get(e,n&rn.Optional?null:void 0,n)}function Me(e,n=rn.Default){return(function $a(){return ia}()||uc)(Mt(e),n)}function Qe(e,n=rn.Default){return Me(e,Kn(n))}function Kn(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Ts(e){const n=[];for(let t=0;t<e.length;t++){const i=Mt(e[t]);if(Array.isArray(i)){if(0===i.length)throw new be(900,!1);let r,a=rn.Default;for(let u=0;u<i.length;u++){const p=i[u],y=Lh(p);"number"==typeof y?-1===y?r=p.token:a|=y:r=p}n.push(Me(r,a))}else n.push(Me(i))}return n}function xr(e,n){return e[ra]=n,e.prototype[ra]=n,e}function Lh(e){return e[ra]}function Br(e){return{toString:e}.toString()}var oa=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(oa||{}),rr=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(rr||{});const Uo={},cn=[],Cl=wn({\u0275cmp:wn}),lu=wn({\u0275dir:wn}),Sl=wn({\u0275pipe:wn}),jo=wn({\u0275mod:wn}),wo=wn({\u0275fac:wn}),sa=wn({__NG_ELEMENT_ID__:wn}),vd=wn({__NG_ENV_ID__:wn});function Dl(e,n,t){let i=e.length;for(;;){const r=e.indexOf(n,t);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const a=n.length;if(r+a===i||e.charCodeAt(r+a)<=32)return r}t=r+1}}function cu(e,n,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const a=t[i++],u=t[i++],p=t[i++];e.setAttribute(n,u,p,a)}else{const a=r,u=t[++i];Il(a)?e.setProperty(n,a,u):e.setAttribute(n,a,u),i++}}return i}function bd(e){return 3===e||4===e||6===e}function Il(e){return 64===e.charCodeAt(0)}function Ml(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?t=r:0===t||$o(e,t,r,null,-1===t||2===t?n[++i]:null)}}return e}function $o(e,n,t,i,r){let a=0,u=e.length;if(-1===n)u=-1;else for(;a<e.length;){const p=e[a++];if("number"==typeof p){if(p===n){u=-1;break}if(p>n){u=a-1;break}}}for(;a<e.length;){const p=e[a];if("number"==typeof p)break;if(p===t){if(null===i)return void(null!==r&&(e[a+1]=r));if(i===e[a+1])return void(e[a+2]=r)}a++,null!==i&&a++,null!==r&&a++}-1!==u&&(e.splice(u,0,n),a=u+1),e.splice(a++,0,t),null!==i&&e.splice(a++,0,i),null!==r&&e.splice(a++,0,r)}const oo="ng-template";function dc(e,n,t){let i=0,r=!0;for(;i<e.length;){let a=e[i++];if("string"==typeof a&&r){const u=e[i++];if(t&&"class"===a&&-1!==Dl(u.toLowerCase(),n,0))return!0}else{if(1===a){for(;i<e.length&&"string"==typeof(a=e[i++]);)if(a.toLowerCase()===n)return!0;return!1}"number"==typeof a&&(r=!1)}}return!1}function fi(e){return 4===e.type&&e.value!==oo}function aa(e,n,t){return n===(4!==e.type||t?e.value:oo)}function mf(e,n,t){let i=4;const r=e.attrs||[],a=function ls(e){for(let n=0;n<e.length;n++)if(bd(e[n]))return n;return e.length}(r);let u=!1;for(let p=0;p<n.length;p++){const y=n[p];if("number"!=typeof y){if(!u)if(4&i){if(i=2|1&i,""!==y&&!aa(e,y,t)||""===y&&1===n.length){if(Ho(i))return!1;u=!0}}else{const E=8&i?y:n[++p];if(8&i&&null!==e.attrs){if(!dc(e.attrs,E,t)){if(Ho(i))return!1;u=!0}continue}const R=gf(8&i?"class":y,r,fi(e),t);if(-1===R){if(Ho(i))return!1;u=!0;continue}if(""!==E){let B;B=R>a?"":r[R+1].toLowerCase();const H=8&i?B:null;if(H&&-1!==Dl(H,E,0)||2&i&&E!==B){if(Ho(i))return!1;u=!0}}}}else{if(!u&&!Ho(i)&&!Ho(y))return!1;if(u&&Ho(y))continue;u=!1,i=y|1&i}}return Ho(i)||u}function Ho(e){return 0==(1&e)}function gf(e,n,t,i){if(null===n)return-1;let r=0;if(i||!t){let a=!1;for(;r<n.length;){const u=n[r];if(u===e)return r;if(3===u||6===u)a=!0;else{if(1===u||2===u){let p=n[++r];for(;"string"==typeof p;)p=n[++r];continue}if(4===u)break;if(0===u){r+=4;continue}}r+=a?1:2}return-1}return function tt(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const i=e[t];if("number"==typeof i)return-1;if(i===n)return t;t++}return-1}(n,e)}function Ha(e,n,t=!1){for(let i=0;i<n.length;i++)if(mf(e,n[i],t))return!0;return!1}function uu(e,n){e:for(let t=0;t<n.length;t++){const i=n[t];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function Tl(e,n){return e?":not("+n.trim()+")":n}function As(e){let n=e[0],t=1,i=2,r="",a=!1;for(;t<e.length;){let u=e[t];if("string"==typeof u)if(2&i){const p=e[++t];r+="["+u+(p.length>0?'="'+p+'"':"")+"]"}else 8&i?r+="."+u:4&i&&(r+=" "+u);else""!==r&&!Ho(u)&&(n+=Tl(a,r),r=""),i=u,a=a||!Ho(i);t++}return""!==r&&(n+=Tl(a,r)),n}function Ci(e){return Br(()=>{const n=wd(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===oa.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||rr.Emulated,styles:e.styles||cn,_:null,schemas:e.schemas||null,tView:null,id:""};pu(t);const i=e.dependencies;return t.directiveDefs=qa(i,!1),t.pipeDefs=qa(i,!0),t.id=function Vh(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of t)n=Math.imul(31,n)+r.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function zh(e){return nn(e)||Pi(e)}function du(e){return null!==e}function mi(e){return Br(()=>({type:e.type,bootstrap:e.bootstrap||cn,declarations:e.declarations||cn,imports:e.imports||cn,exports:e.exports||cn,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function pc(e,n){if(null==e)return Uo;const t={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],a=r;Array.isArray(r)&&(a=r[1],r=r[0]),t[r]=i,n&&(n[r]=a)}return t}function ct(e){return Br(()=>{const n=wd(e);return pu(n),n})}function nn(e){return e[Cl]||null}function Pi(e){return e[lu]||null}function Fi(e){return e[Sl]||null}function Si(e,n){const t=e[jo]||null;if(!t&&!0===n)throw new Error(`Type ${Ei(e)} does not have '\u0275mod' property.`);return t}function wd(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Uo,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||cn,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:pc(e.inputs,n),outputs:pc(e.outputs)}}function pu(e){e.features?.forEach(n=>n(e))}function qa(e,n){if(!e)return null;const t=n?Fi:zh;return()=>("function"==typeof e?e():e).map(i=>t(i)).filter(du)}const fn=0,Le=1,Ot=2,$n=3,Eo=4,ks=5,or=6,la=7,Sn=8,qo=9,nt=10,Oe=11,Rs=12,fu=13,ca=14,un=15,Al=16,zr=17,cs=18,so=19,ni=20,Nn=21,us=22,ds=23,ua=24,Zt=25,kl=1,da=2,ao=7,pa=9,ii=11;function sr(e){return Array.isArray(e)&&"object"==typeof e[kl]}function gi(e){return Array.isArray(e)&&!0===e[kl]}function Rl(e){return 0!=(4&e.flags)}function Fs(e){return e.componentOffset>-1}function Ga(e){return 1==(1&e.flags)}function Kr(e){return!!e.template}function Pl(e){return 0!=(512&e[Ot])}function De(e,n){return e.hasOwnProperty(wo)?e[wo]:null}let Be=null,at=!1;function yt(e){const n=Be;return Be=e,n}const $e={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Ye(e){if(!Vr(e)||e.dirty){if(!e.producerMustRecompute(e)&&!Er(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function an(e){e.dirty=!0,function sn(e){if(void 0===e.liveConsumerNode)return;const n=at;at=!0;try{for(const t of e.liveConsumerNode)t.dirty||an(t)}finally{at=n}}(e),e.consumerMarkedDirty?.(e)}function At(e){return e&&(e.nextProducerIndex=0),yt(e)}function Xn(e,n){if(yt(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Vr(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)Cr(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function Er(e){Sr(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],i=e.producerLastReadVersion[n];if(i!==t.version||(Ye(t),i!==t.version))return!0}return!1}function ai(e){if(Sr(e),Vr(e))for(let n=0;n<e.producerNode.length;n++)Cr(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function Cr(e,n){if(function Dr(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Sr(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)Cr(e.producerNode[i],e.producerIndexOfThis[i]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[n],r=e.liveConsumerNode[n];Sr(r),r.producerIndexOfThis[i]=n}}function Vr(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Sr(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let Ni=null;const $h=()=>{},jg=(()=>({...$e,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:$h}))();class $g{constructor(n,t,i){this.previousValue=n,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Go(){return Hh}function Hh(e){return e.type.prototype.ngOnChanges&&(e.setInput=yf),db}function db(){const e=bf(this),n=e?.current;if(n){const t=e.previous;if(t===Uo)e.previous=n;else for(let i in n)t[i]=n[i];e.current=null,this.ngOnChanges(n)}}function yf(e,n,t,i){const r=this.declaredInputs[t],a=bf(e)||function gu(e,n){return e[vf]=n}(e,{previous:Uo,current:null}),u=a.current||(a.current={}),p=a.previous,y=p[r];u[r]=new $g(y&&y.currentValue,n,p===Uo),e[i]=n}Go.ngInherit=!0;const vf="__ngSimpleChanges__";function bf(e){return e[vf]||null}const Wo=function(e,n,t){},Md="svg";function Gn(e){for(;Array.isArray(e);)e=e[fn];return e}function ar(e,n){return Gn(n[e])}function lr(e,n){return Gn(n[e.index])}function Sf(e,n){return e.data[n]}function Zo(e,n){const t=n[e];return sr(t)?t:t[fn]}function Wa(e,n){return null==n?null:e[n]}function Gg(e){e[zr]=0}function Df(e){1024&e[Ot]||(e[Ot]|=1024,Gh(e,1))}function If(e){1024&e[Ot]&&(e[Ot]&=-1025,Gh(e,-1))}function Gh(e,n){let t=e[$n];if(null===t)return;t[ks]+=n;let i=t;for(t=t[$n];null!==t&&(1===n&&1===i[ks]||-1===n&&0===i[ks]);)t[ks]+=n,i=t,t=t[$n]}const Ft={lFrame:Bf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Td(){return Ft.bindingsEnabled}function mc(){return null!==Ft.skipHydrationRootTNode}function Pe(){return Ft.lFrame.lView}function yn(){return Ft.lFrame.tView}function kd(e){return Ft.lFrame.contextLView=e,e[Sn]}function Rd(e){return Ft.lFrame.contextLView=null,e}function cr(){let e=Wg();for(;null!==e&&64===e.type;)e=e.parent;return e}function Wg(){return Ft.lFrame.currentTNode}function _a(e,n){const t=Ft.lFrame;t.currentTNode=e,t.isParent=n}function oi(){return Ft.lFrame.isParent}function yu(){Ft.lFrame.isParent=!1}function va(){return Ft.lFrame.bindingIndex++}function _b(e,n){const t=Ft.lFrame;t.bindingIndex=t.bindingRootIndex=e,_c(n)}function _c(e){Ft.lFrame.currentDirectiveIndex=e}function Wh(){return Ft.lFrame.currentQueryIndex}function Of(e){Ft.lFrame.currentQueryIndex=e}function Lf(e){const n=e[Le];return 2===n.type?n.declTNode:1===n.type?e[or]:null}function Zh(e,n,t){if(t&rn.SkipSelf){let r=n,a=e;for(;!(r=r.parent,null!==r||t&rn.Host||(r=Lf(a),null===r||(a=a[ca],10&r.type))););if(null===r)return!1;n=r,e=a}const i=Ft.lFrame=Nf();return i.currentTNode=n,i.lView=e,!0}function Fd(e){const n=Nf(),t=e[Le];Ft.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function Nf(){const e=Ft.lFrame,n=null===e?null:e.child;return null===n?Bf(e):n}function Bf(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function Xg(){const e=Ft.lFrame;return Ft.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Yg=Xg;function zf(){const e=Xg();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function lo(){return Ft.lFrame.selectedIndex}function Ll(e){Ft.lFrame.selectedIndex=e}function Hn(){const e=Ft.lFrame;return Sf(e.tView,e.selectedIndex)}function Vf(){Ft.lFrame.currentNamespace=Md}let Jg=!0;function Kh(){return Jg}function Nl(e){Jg=e}function vu(e,n){for(let t=n.directiveStart,i=n.directiveEnd;t<i;t++){const a=e.data[t].type.prototype,{ngAfterContentInit:u,ngAfterContentChecked:p,ngAfterViewInit:y,ngAfterViewChecked:E,ngOnDestroy:I}=a;u&&(e.contentHooks??=[]).push(-t,u),p&&((e.contentHooks??=[]).push(t,p),(e.contentCheckHooks??=[]).push(t,p)),y&&(e.viewHooks??=[]).push(-t,y),E&&((e.viewHooks??=[]).push(t,E),(e.viewCheckHooks??=[]).push(t,E)),null!=I&&(e.destroyHooks??=[]).push(t,I)}}function Bl(e,n,t){e_(e,n,3,t)}function bu(e,n,t,i){(3&e[Ot])===t&&e_(e,n,t,i)}function jf(e,n){let t=e[Ot];(3&t)===n&&(t&=8191,t+=1,e[Ot]=t)}function e_(e,n,t,i){const a=i??-1,u=n.length-1;let p=0;for(let y=void 0!==i?65535&e[zr]:0;y<u;y++)if("number"==typeof n[y+1]){if(p=n[y],null!=i&&p>=i)break}else n[y]<0&&(e[zr]+=65536),(p<a||-1==a)&&(wb(e,t,n,y),e[zr]=(4294901760&e[zr])+y+2),y++}function $f(e,n){Wo(4,e,n);const t=yt(null);try{n.call(e)}finally{yt(t),Wo(5,e,n)}}function wb(e,n,t,i){const r=t[i]<0,a=t[i+1],p=e[r?-t[i]:t[i]];r?e[Ot]>>13<e[zr]>>16&&(3&e[Ot])===n&&(e[Ot]+=8192,$f(p,a)):$f(p,a)}const ba=-1;class xu{constructor(n,t,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Xh(e){return e!==ba}function wu(e){return 32767&e}function Od(e,n){let t=function n_(e){return e>>16}(e),i=n;for(;t>0;)i=i[ca],t--;return i}let Eu=!0;function Ld(e){const n=Eu;return Eu=e,n}const i_=255,r_=5;let o_=0;const xa={};function zl(e,n){const t=qf(e,n);if(-1!==t)return t;const i=n[Le];i.firstCreatePass&&(e.injectorIndex=n.length,Di(i.data,e),Di(n,null),Di(i.blueprint,null));const r=Nd(e,n),a=e.injectorIndex;if(Xh(r)){const u=wu(r),p=Od(r,n),y=p[Le].data;for(let E=0;E<8;E++)n[a+E]=p[u+E]|y[u+E]}return n[a+8]=r,a}function Di(e,n){e.push(0,0,0,0,0,0,0,0,n)}function qf(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function Nd(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,i=null,r=n;for(;null!==r;){if(i=Zf(r),null===i)return ba;if(t++,r=r[ca],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return ba}function Yh(e,n,t){!function Ib(e,n,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(sa)&&(i=t[sa]),null==i&&(i=t[sa]=o_++);const r=i&i_;n.data[e+(r>>r_)]|=1<<r}(e,n,t)}function Qh(e,n,t){if(t&rn.Optional||void 0!==e)return e;na()}function Gf(e,n,t,i){if(t&rn.Optional&&void 0===i&&(i=null),!(t&(rn.Self|rn.Host))){const r=e[qo],a=Nr(void 0);try{return r?r.get(n,i,t&rn.Optional):au(n,i,t&rn.Optional)}finally{Nr(a)}}return Qh(i,0,t)}function Wf(e,n,t,i=rn.Default,r){if(null!==e){if(2048&n[Ot]&&!(i&rn.Self)){const u=function Du(e,n,t,i,r){let a=e,u=n;for(;null!==a&&null!==u&&2048&u[Ot]&&!(512&u[Ot]);){const p=wa(a,u,t,i|rn.Self,xa);if(p!==xa)return p;let y=a.parent;if(!y){const E=u[ni];if(E){const I=E.get(t,xa,i);if(I!==xa)return I}y=Zf(u),u=u[ca]}a=y}return r}(e,n,t,i,xa);if(u!==xa)return u}const a=wa(e,n,t,i,xa);if(a!==xa)return a}return Gf(n,t,i,r)}function wa(e,n,t,i,r){const a=function Mb(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(sa)?e[sa]:void 0;return"number"==typeof n?n>=0?n&i_:Ab:n}(t);if("function"==typeof a){if(!Zh(n,e,i))return i&rn.Host?Qh(r,0,i):Gf(n,t,i,r);try{let u;if(u=a(i),null!=u||i&rn.Optional)return u;na()}finally{Yg()}}else if("number"==typeof a){let u=null,p=qf(e,n),y=ba,E=i&rn.Host?n[un][or]:null;for((-1===p||i&rn.SkipSelf)&&(y=-1===p?Nd(e,n):n[p+8],y!==ba&&a_(i,!1)?(u=n[Le],p=wu(y),n=Od(y,n)):p=-1);-1!==p;){const I=n[Le];if(s_(a,p,I.data)){const R=Cu(p,n,t,u,i,E);if(R!==xa)return R}y=n[p+8],y!==ba&&a_(i,n[Le].data[p+8]===E)&&s_(a,p,n)?(u=I,p=wu(y),n=Od(y,n)):p=-1}}return r}function Cu(e,n,t,i,r,a){const u=n[Le],p=u.data[e+8],I=Bd(p,u,t,null==i?Fs(p)&&Eu:i!=u&&0!=(3&p.type),r&rn.Host&&a===p);return null!==I?yc(n,u,I,p):xa}function Bd(e,n,t,i,r){const a=e.providerIndexes,u=n.data,p=1048575&a,y=e.directiveStart,I=a>>20,B=r?p+I:e.directiveEnd;for(let H=i?p:p+I;H<B;H++){const X=u[H];if(H<y&&t===X||H>=y&&X.type===t)return H}if(r){const H=u[y];if(H&&Kr(H)&&H.type===t)return y}return null}function yc(e,n,t,i){let r=e[t];const a=n.data;if(function Eb(e){return e instanceof xu}(r)){const u=r;u.resolving&&function eu(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new be(-200,`Circular dependency in DI detected for ${e}${t}`)}(function on(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Tt(e)}(a[t]));const p=Ld(u.canSeeViewProviders);u.resolving=!0;const E=u.injectImpl?Nr(u.injectImpl):null;Zh(e,i,rn.Default);try{r=e[t]=u.factory(void 0,a,e,i),n.firstCreatePass&&t>=i.directiveStart&&function xb(e,n,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:a}=n.type.prototype;if(i){const u=Hh(n);(t.preOrderHooks??=[]).push(e,u),(t.preOrderCheckHooks??=[]).push(e,u)}r&&(t.preOrderHooks??=[]).push(0-e,r),a&&((t.preOrderHooks??=[]).push(e,a),(t.preOrderCheckHooks??=[]).push(e,a))}(t,a[t],n)}finally{null!==E&&Nr(E),Ld(p),u.resolving=!1,Yg()}}return r}function s_(e,n,t){return!!(t[n+(e>>r_)]&1<<e)}function a_(e,n){return!(e&rn.Self||e&rn.Host&&n)}class co{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,i){return Wf(this._tNode,this._lView,n,Kn(i),t)}}function Ab(){return new co(cr(),Pe())}function Ii(e){return Br(()=>{const n=e.prototype.constructor,t=n[wo]||Su(n),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const a=r[wo]||Su(r);if(a&&a!==t)return a;r=Object.getPrototypeOf(r)}return a=>new a})}function Su(e){return Qc(e)?()=>{const n=Su(Mt(e));return n&&n()}:De(e)}function Zf(e){const n=e[Le],t=n.type;return 2===t?n.declTNode:1===t?e[or]:null}function Za(e){return function An(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const a=t[r];if(bd(a))break;if(0===a)r+=2;else if("number"==typeof a)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(a===n)return t[r+1];r+=2}}}return null}(cr(),e)}const Iu="__parameters__";function vc(e,n,t){return Br(()=>{const i=function Jh(e){return function(...t){if(e){const i=e(...t);for(const r in i)this[r]=i[r]}}}(n);function r(...a){if(this instanceof r)return i.apply(this,a),this;const u=new r(...a);return p.annotation=u,p;function p(y,E,I){const R=y.hasOwnProperty(Iu)?y[Iu]:Object.defineProperty(y,Iu,{value:[]})[Iu];for(;R.length<=I;)R.push(null);return(R[I]=R[I]||[]).push(u),y}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function Ul(e,n){e.forEach(t=>Array.isArray(t)?Ul(t,n):n(t))}function d_(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function np(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function Au(e,n){const t=[];for(let i=0;i<e;i++)t.push(n);return t}function uo(e,n,t){let i=ku(e,n);return i>=0?e[1|i]=t:(i=~i,function jl(e,n,t,i){let r=e.length;if(r==n)e.push(t,i);else if(1===r)e.push(i,e[0]),e[0]=t;else{for(r--,e.push(e[r-1],e[r]);r>n;)e[r]=e[r-2],r--;e[n]=t,e[n+1]=i}}(e,i,n,t)),i}function Yf(e,n){const t=ku(e,n);if(t>=0)return e[1|t]}function ku(e,n){return function ip(e,n,t){let i=0,r=e.length>>t;for(;r!==i;){const a=i+(r-i>>1),u=e[a<<t];if(n===u)return a<<t;u>n?r=a:i=a+1}return~(r<<t)}(e,n,1)}const xc=xr(vc("Optional"),8),Hd=xr(vc("SkipSelf"),4);function up(e){return 128==(128&e.flags)}var Ca=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Ca||{});const dp=new Map;let Zb=0;const Ou="__ngContext__";function Zi(e,n){sr(n)?(e[Ou]=n[so],function lm(e){dp.set(e[so],e)}(n)):e[Ou]=n}let C;function D(e,n){return C(e,n)}function P(e){const n=e[$n];return gi(n)?n[$n]:n}function U(e){return Y(e[Rs])}function $(e){return Y(e[Eo])}function Y(e){for(;null!==e&&!gi(e);)e=e[Eo];return e}function W(e,n,t,i,r){if(null!=i){let a,u=!1;gi(i)?a=i:sr(i)&&(u=!0,i=i[fn]);const p=Gn(i);0===e&&null!==t?null==r?Mi(n,t,p):En(n,t,p,r||null,!0):1===e&&null!==t?En(n,t,p,r||null,!0):2===e?function Vi(e,n,t){const i=_i(e,n);i&&function Ir(e,n,t,i){e.removeChild(n,t,i)}(e,i,n,t)}(n,p,u):3===e&&n.destroyNode(p),null!=a&&function Bs(e,n,t,i,r){const a=t[ao];a!==Gn(t)&&W(n,e,i,a,r);for(let p=ii;p<t.length;p++){const y=t[p];Ti(y[Le],y,e,n,i,a)}}(n,e,a,t,r)}}function he(e,n,t){return e.createElement(n,t)}function Ue(e,n){const t=e[pa],i=t.indexOf(n);If(n),t.splice(i,1)}function Ze(e,n){if(e.length<=ii)return;const t=ii+n,i=e[t];if(i){const r=i[Al];null!==r&&r!==e&&Ue(r,i),n>0&&(e[t-1][Eo]=i[Eo]);const a=np(e,ii+n);!function ge(e,n){Ti(e,n,n[Oe],2,null,null),n[fn]=null,n[or]=null}(i[Le],i);const u=a[cs];null!==u&&u.detachView(a[Le]),i[$n]=null,i[Eo]=null,i[Ot]&=-129}return i}function Ge(e,n){if(!(256&n[Ot])){const t=n[Oe];n[ds]&&ai(n[ds]),n[ua]&&ai(n[ua]),t.destroyNode&&Ti(e,n,t,3,null,null),function rt(e){let n=e[Rs];if(!n)return Fe(e[Le],e);for(;n;){let t=null;if(sr(n))t=n[Rs];else{const i=n[ii];i&&(t=i)}if(!t){for(;n&&!n[Eo]&&n!==e;)sr(n)&&Fe(n[Le],n),n=n[$n];null===n&&(n=e),sr(n)&&Fe(n[Le],n),t=n&&n[Eo]}n=t}}(n)}}function Fe(e,n){if(!(256&n[Ot])){n[Ot]&=-129,n[Ot]|=256,function st(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let i=0;i<t.length;i+=2){const r=n[t[i]];if(!(r instanceof xu)){const a=t[i+1];if(Array.isArray(a))for(let u=0;u<a.length;u+=2){const p=r[a[u]],y=a[u+1];Wo(4,p,y);try{y.call(p)}finally{Wo(5,p,y)}}else{Wo(4,r,a);try{a.call(r)}finally{Wo(5,r,a)}}}}}(e,n),function ft(e,n){const t=e.cleanup,i=n[la];if(null!==t)for(let a=0;a<t.length-1;a+=2)if("string"==typeof t[a]){const u=t[a+3];u>=0?i[u]():i[-u].unsubscribe(),a+=2}else t[a].call(i[t[a+1]]);null!==i&&(n[la]=null);const r=n[Nn];if(null!==r){n[Nn]=null;for(let a=0;a<r.length;a++)(0,r[a])()}}(e,n),1===n[Le].type&&n[Oe].destroy();const t=n[Al];if(null!==t&&gi(n[$n])){t!==n[$n]&&Ue(t,n);const i=n[cs];null!==i&&i.detachView(e)}!function S_(e){dp.delete(e[so])}(n)}}function Ut(e,n,t){return function zn(e,n,t){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return t[fn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:a}=e.data[i.directiveStart+r];if(a===rr.None||a===rr.Emulated)return null}return lr(i,t)}}(e,n.parent,t)}function En(e,n,t,i,r){e.insertBefore(n,t,i,r)}function Mi(e,n,t){e.appendChild(n,t)}function Do(e,n,t,i,r){null!==i?En(e,n,t,i,r):Mi(e,n,t)}function _i(e,n){return e.parentNode(n)}function Tr(e,n,t){return yi(e,n,t)}let Ki,kr,_p,yi=function Yr(e,n,t){return 40&e.type?lr(e,t):null};function dr(e,n,t,i){const r=Ut(e,i,n),a=n[Oe],p=Tr(i.parent||n[or],i,n);if(null!=r)if(Array.isArray(t))for(let y=0;y<t.length;y++)Do(a,r,t[y],p,!1);else Do(a,r,t,p,!1);void 0!==Ki&&Ki(a,i,n,t,r)}function hr(e,n){if(null!==n){const t=n.type;if(3&t)return lr(n,e);if(4&t)return Yn(-1,e[n.index]);if(8&t){const i=n.child;if(null!==i)return hr(e,i);{const r=e[n.index];return gi(r)?Yn(-1,r):Gn(r)}}if(32&t)return D(n,e)()||Gn(e[n.index]);{const i=Qr(e,n);return null!==i?Array.isArray(i)?i[0]:hr(P(e[un]),i):hr(e,n.next)}}return null}function Qr(e,n){return null!==n?e[un][or].projection[n.projection]:null}function Yn(e,n){const t=ii+e+1;if(t<n.length){const i=n[t],r=i[Le].firstChild;if(null!==r)return hr(i,r)}return n[ao]}function Jr(e,n,t,i,r,a,u){for(;null!=t;){const p=i[t.index],y=t.type;if(u&&0===n&&(p&&Zi(Gn(p),i),t.flags|=2),32!=(32&t.flags))if(8&y)Jr(e,n,t.child,i,r,a,!1),W(n,e,r,p,a);else if(32&y){const E=D(t,i);let I;for(;I=E();)W(n,e,r,I,a);W(n,e,r,p,a)}else 16&y?Yo(e,n,i,t,r,a):W(n,e,r,p,a);t=u?t.projectionNext:t.next}}function Ti(e,n,t,i,r,a){Jr(t,i,e.firstChild,n,r,a,!1)}function Yo(e,n,t,i,r,a){const u=t[un],y=u[or].projection[i.projection];if(Array.isArray(y))for(let E=0;E<y.length;E++)W(n,e,r,y[E],a);else{let E=y;const I=u[$n];up(i)&&(E.flags|=128),Jr(e,n,E,I,r,a,!0)}}function Qo(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function Io(e,n,t){const{mergedAttrs:i,classes:r,styles:a}=t;null!==i&&cu(e,n,i),null!==r&&Qo(e,n,r),null!==a&&function Qa(e,n,t){e.setAttribute(n,"style",t)}(e,n,a)}function Sa(e){return function Vs(){if(void 0===kr&&(kr=null,Tn.trustedTypes))try{kr=Tn.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return kr}()?.createHTML(e)||e}class Sc{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${oc})`}}class Xb extends Sc{getTypeName(){return"HTML"}}class Yb extends Sc{getTypeName(){return"Style"}}class Qb extends Sc{getTypeName(){return"Script"}}class Us extends Sc{getTypeName(){return"URL"}}class yp extends Sc{getTypeName(){return"ResourceURL"}}function Mo(e){return e instanceof Sc?e.changingThisBreaksApplicationSecurity:e}function li(e,n){const t=function Da(e){return e instanceof Sc&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${oc})`)}return t===n}class U2{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(Sa(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class j2{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=Sa(n),t}}const H2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function R_(e){return(e=String(e)).match(H2)?e:"unsafe:"+e}function Ic(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function hm(...e){const n={};for(const t of e)for(const i in t)t.hasOwnProperty(i)&&(n[i]=!0);return n}const YE=Ic("area,br,col,hr,img,wbr"),QE=Ic("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),JE=Ic("rp,rt"),Jb=hm(YE,hm(QE,Ic("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),hm(JE,Ic("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),hm(JE,QE)),ex=Ic("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),eC=hm(ex,Ic("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ic("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),q2=Ic("script,style,template");class G2{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!Jb.hasOwnProperty(t))return this.sanitizedSomething=!0,!q2.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=n.attributes;for(let r=0;r<i.length;r++){const a=i.item(r),u=a.name,p=u.toLowerCase();if(!eC.hasOwnProperty(p)){this.sanitizedSomething=!0;continue}let y=a.value;ex[p]&&(y=R_(y)),this.buf.push(" ",u,'="',tC(y),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();Jb.hasOwnProperty(t)&&!YE.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(tC(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const W2=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Z2=/([^\#-~ |!])/g;function tC(e){return e.replace(/&/g,"&amp;").replace(W2,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(Z2,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let P_;function nC(e,n){let t=null;try{P_=P_||function XE(e){const n=new j2(e);return function $2(){try{return!!(new window.DOMParser).parseFromString(Sa(""),"text/html")}catch{return!1}}()?new U2(n):n}(e);let i=n?String(n):"";t=P_.getInertBodyElement(i);let r=5,a=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=a,a=t.innerHTML,t=P_.getInertBodyElement(i)}while(i!==a);return Sa((new G2).sanitizeChildren(tx(t)||t))}finally{if(t){const i=tx(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function tx(e){return"content"in e&&function K2(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var ho=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(ho||{});function nx(e){const n=function pm(){const e=Pe();return e&&e[nt].sanitizer}();return n?n.sanitize(ho.URL,e)||"":li(e,"URL")?Mo(e):R_(Tt(e))}const fm=new Re("ENVIRONMENT_INITIALIZER"),oC=new Re("INJECTOR",-1),sC=new Re("INJECTOR_DEF_TYPES");class ix{get(n,t=_n){if(t===_n){const i=new Error(`NullInjectorError: No provider for ${Ei(n)}!`);throw i.name="NullInjectorError",i}return t}}function nF(...e){return{\u0275providers:aC(0,e),\u0275fromNgModule:!0}}function aC(e,...n){const t=[],i=new Set;let r;const a=u=>{t.push(u)};return Ul(n,u=>{const p=u;F_(p,a,[],i)&&(r||=[],r.push(p))}),void 0!==r&&lC(r,a),t}function lC(e,n){for(let t=0;t<e.length;t++){const{ngModule:i,providers:r}=e[t];ox(r,a=>{n(a,i)})}}function F_(e,n,t,i){if(!(e=Mt(e)))return!1;let r=null,a=Is(e);const u=!a&&nn(e);if(a||u){if(u&&!u.standalone)return!1;r=e}else{const y=e.ngModule;if(a=Is(y),!a)return!1;r=y}const p=i.has(r);if(u){if(p)return!1;if(i.add(r),u.dependencies){const y="function"==typeof u.dependencies?u.dependencies():u.dependencies;for(const E of y)F_(E,n,t,i)}}else{if(!a)return!1;{if(null!=a.imports&&!p){let E;i.add(r);try{Ul(a.imports,I=>{F_(I,n,t,i)&&(E||=[],E.push(I))})}finally{}void 0!==E&&lC(E,n)}if(!p){const E=De(r)||(()=>new r);n({provide:r,useFactory:E,deps:cn},r),n({provide:sC,useValue:r,multi:!0},r),n({provide:fm,useValue:()=>Me(r),multi:!0},r)}const y=a.providers;if(null!=y&&!p){const E=e;ox(y,I=>{n(I,E)})}}}return r!==e&&void 0!==e.providers}function ox(e,n){for(let t of e)Jc(t)&&(t=t.\u0275providers),Array.isArray(t)?ox(t,n):n(t)}const iF=wn({provide:String,useValue:wn});function sx(e){return null!==e&&"object"==typeof e&&iF in e}function eh(e){return"function"==typeof e}const ax=new Re("Set Injector scope."),O_={},oF={};let lx;function L_(){return void 0===lx&&(lx=new ix),lx}class el{}class vp extends el{get destroyed(){return this._destroyed}constructor(n,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,ux(n,u=>this.processProvider(u)),this.records.set(oC,bp(void 0,this)),r.has("environment")&&this.records.set(el,bp(void 0,this));const a=this.records.get(ax);null!=a&&"string"==typeof a.value&&this.scopes.add(a.value),this.injectorDefTypes=new Set(this.get(sC.multi,cn,rn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=as(this),i=Nr(void 0);try{return n()}finally{as(t),Nr(i)}}get(n,t=_n,i=rn.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(vd))return n[vd](this);i=Kn(i);const a=as(this),u=Nr(void 0);try{if(!(i&rn.SkipSelf)){let y=this.records.get(n);if(void 0===y){const E=function uF(e){return"function"==typeof e||"object"==typeof e&&e instanceof Re}(n)&&wl(n);y=E&&this.injectableDefInScope(E)?bp(cx(n),O_):null,this.records.set(n,y)}if(null!=y)return this.hydrate(n,y)}return(i&rn.Self?L_():this.parent).get(n,t=i&rn.Optional&&t===_n?null:t)}catch(p){if("NullInjectorError"===p.name){if((p[lc]=p[lc]||[]).unshift(Ei(n)),a)throw p;return function yd(e,n,t,i){const r=e[lc];throw n[cc]&&r.unshift(n[cc]),e.message=function Nh(e,n,t,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=Ei(n);if(Array.isArray(n))r=n.map(Ei).join(" -> ");else if("object"==typeof n){let a=[];for(let u in n)if(n.hasOwnProperty(u)){let p=n[u];a.push(u+":"+("string"==typeof p?JSON.stringify(p):Ei(p)))}r=`{${a.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${e.replace(ff,"\n  ")}`}("\n"+e.message,r,t,i),e.ngTokenPath=r,e[lc]=null,e}(p,n,"R3InjectorError",this.source)}throw p}finally{Nr(u),as(a)}}resolveInjectorInitializers(){const n=as(this),t=Nr(void 0);try{const r=this.get(fm.multi,cn,rn.Self);for(const a of r)a()}finally{as(n),Nr(t)}}toString(){const n=[],t=this.records;for(const i of t.keys())n.push(Ei(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new be(205,!1)}processProvider(n){let t=eh(n=Mt(n))?n:Mt(n&&n.provide);const i=function aF(e){return sx(e)?bp(void 0,e.useValue):bp(dC(e),O_)}(n);if(eh(n)||!0!==n.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=bp(void 0,O_,!0),r.factory=()=>Ts(r.multi),this.records.set(t,r)),t=n,r.multi.push(n)}this.records.set(t,i)}hydrate(n,t){return t.value===O_&&(t.value=oF,t.value=t.factory()),"object"==typeof t.value&&t.value&&function cF(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=Mt(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function cx(e){const n=wl(e),t=null!==n?n.factory:De(e);if(null!==t)return t;if(e instanceof Re)throw new be(204,!1);if(e instanceof Function)return function sF(e){const n=e.length;if(n>0)throw Au(n,"?"),new be(204,!1);const t=function ud(e){return e&&(e[sc]||e[su])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new be(204,!1)}function dC(e,n,t){let i;if(eh(e)){const r=Mt(e);return De(r)||cx(r)}if(sx(e))i=()=>Mt(e.useValue);else if(function uC(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...Ts(e.deps||[]));else if(function cC(e){return!(!e||!e.useExisting)}(e))i=()=>Me(Mt(e.useExisting));else{const r=Mt(e&&(e.useClass||e.provide));if(!function lF(e){return!!e.deps}(e))return De(r)||cx(r);i=()=>new r(...Ts(e.deps))}return i}function bp(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function ux(e,n){for(const t of e)Array.isArray(t)?ux(t,n):t&&Jc(t)?ux(t.\u0275providers,n):n(t)}const N_=new Re("AppId",{providedIn:"root",factory:()=>dF}),dF="ng",hC=new Re("Platform Initializer"),Mc=new Re("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Tc=new Re("AnimationModuleType"),dx=new Re("CSP nonce",{providedIn:"root",factory:()=>function ql(){if(void 0!==_p)return _p;if(typeof document<"u")return document;throw new be(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let pC=(e,n,t)=>null;function vx(e,n,t=!1){return pC(e,n,t)}class xF{}class gC{}class EF{resolveComponentFactory(n){throw function wF(e){const n=Error(`No component factory found for ${Ei(e)}.`);return n.ngComponent=e,n}(n)}}let _m=(()=>{class e{static#e=this.NULL=new EF}return e})();function CF(){return Ep(cr(),Pe())}function Ep(e,n){return new kn(lr(e,n))}let kn=(()=>{class e{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=CF}return e})();function SF(e){return e instanceof kn?e.nativeElement:e}class ym{}let Ac=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function DF(){const e=Pe(),t=Zo(cr().index,e);return(sr(t)?t:e)[Oe]}()}return e})(),IF=(()=>{class e{static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:()=>null})}return e})();class th{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const MF=new th("16.2.11"),wx={};function xC(e,n=null,t=null,i){const r=wC(e,n,t,i);return r.resolveInjectorInitializers(),r}function wC(e,n=null,t=null,i,r=new Set){const a=[t||cn,nF(e)];return i=i||("object"==typeof e?void 0:Ei(e)),new vp(a,n||L_(),i||null,r)}let Jo=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=_n;static#t=this.NULL=new ix;static create(t,i){if(Array.isArray(t))return xC({name:""},i,t,"");{const r=t.name??"";return xC({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=et({token:e,providedIn:"any",factory:()=>Me(oC)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function Cx(e){return e.ngOriginalError}class Ia{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&Cx(n);for(;t&&Cx(t);)t=Cx(t);return t||null}}function Dx(e){return n=>{setTimeout(e,void 0,n)}}const Dn=class OF extends St{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,i){let r=n,a=t||(()=>null),u=i;if(n&&"object"==typeof n){const y=n;r=y.next?.bind(y),a=y.error?.bind(y),u=y.complete?.bind(y)}this.__isAsync&&(a=Dx(a),r&&(r=Dx(r)),u&&(u=Dx(u)));const p=super.subscribe({next:r,error:a,complete:u});return n instanceof Jt&&n.add(p),p}};function CC(...e){}class jt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Dn(!1),this.onMicrotaskEmpty=new Dn(!1),this.onStable=new Dn(!1),this.onError=new Dn(!1),typeof Zone>"u")throw new be(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function LF(){const e="function"==typeof Tn.requestAnimationFrame;let n=Tn[e?"requestAnimationFrame":"setTimeout"],t=Tn[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function zF(e){const n=()=>{!function BF(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Tn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Mx(e),e.isCheckStableRunning=!0,Ix(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Mx(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,a,u,p)=>{if(function UF(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(p))return t.invokeTask(r,a,u,p);try{return SC(e),t.invokeTask(r,a,u,p)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&n(),DC(e)}},onInvoke:(t,i,r,a,u,p,y)=>{try{return SC(e),t.invoke(r,a,u,p,y)}finally{e.shouldCoalesceRunChangeDetection&&n(),DC(e)}},onHasTask:(t,i,r,a)=>{t.hasTask(r,a),i===r&&("microTask"==a.change?(e._hasPendingMicrotasks=a.microTask,Mx(e),Ix(e)):"macroTask"==a.change&&(e.hasPendingMacrotasks=a.macroTask))},onHandleError:(t,i,r,a)=>(t.handleError(r,a),e.runOutsideAngular(()=>e.onError.emit(a)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!jt.isInAngularZone())throw new be(909,!1)}static assertNotInAngularZone(){if(jt.isInAngularZone())throw new be(909,!1)}run(n,t,i){return this._inner.run(n,t,i)}runTask(n,t,i,r){const a=this._inner,u=a.scheduleEventTask("NgZoneEvent: "+r,n,NF,CC,CC);try{return a.runTask(u,t,i)}finally{a.cancelTask(u)}}runGuarded(n,t,i){return this._inner.runGuarded(n,t,i)}runOutsideAngular(n){return this._outer.run(n)}}const NF={};function Ix(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Mx(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function SC(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function DC(e){e._nesting--,Ix(e)}class VF{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Dn,this.onMicrotaskEmpty=new Dn,this.onStable=new Dn,this.onError=new Dn}run(n,t,i){return n.apply(t,i)}runGuarded(n,t,i){return n.apply(t,i)}runOutsideAngular(n){return n()}runTask(n,t,i,r){return n.apply(t,i)}}const IC=new Re("",{providedIn:"root",factory:MC});function MC(){const e=Qe(jt);let n=!0;return Ht(new bn(r=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(n),r.complete()})}),new bn(r=>{let a;e.runOutsideAngular(()=>{a=e.onStable.subscribe(()=>{jt.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,r.next(!0))})})});const u=e.onUnstable.subscribe(()=>{jt.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{a.unsubscribe(),u.unsubscribe()}}).pipe(vl()))}function kc(e){return e instanceof Function?e():e}let Tx=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:()=>new e})}return e})();function vm(e){for(;e;){e[Ot]|=64;const n=P(e);if(Pl(e)&&!n)return e;e=n}return null}const PC=new Re("",{providedIn:"root",factory:()=>!1});let H_=null;function NC(e,n){return e[n]??VC()}function BC(e,n){const t=VC();t.producerNode?.length&&(e[n]=H_,t.lView=e,H_=zC())}const YF={...$e,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{vm(e.lView)},lView:null};function zC(){return Object.create(YF)}function VC(){return H_??=zC(),H_}const Wt={};function Ai(e){UC(yn(),Pe(),lo()+e,!1)}function UC(e,n,t,i){if(!i)if(3==(3&n[Ot])){const a=e.preOrderCheckHooks;null!==a&&Bl(n,a,t)}else{const a=e.preOrderHooks;null!==a&&bu(n,a,0,t)}Ll(t)}function me(e,n=rn.Default){const t=Pe();return null===t?Me(e,n):Wf(cr(),t,Mt(e),n)}function Ax(){throw new Error("invalid")}function q_(e,n,t,i,r,a,u,p,y,E,I){const R=n.blueprint.slice();return R[fn]=r,R[Ot]=140|i,(null!==E||e&&2048&e[Ot])&&(R[Ot]|=2048),Gg(R),R[$n]=R[ca]=e,R[Sn]=t,R[nt]=u||e&&e[nt],R[Oe]=p||e&&e[Oe],R[qo]=y||e&&e[qo]||null,R[or]=a,R[so]=function C_(){return Zb++}(),R[us]=I,R[ni]=E,R[un]=2==n.type?e[un]:R,R}function Dp(e,n,t,i,r){let a=e.data[n];if(null===a)a=function kx(e,n,t,i,r){const a=Wg(),u=oi(),y=e.data[n]=function oO(e,n,t,i,r,a){let u=n?n.injectorIndex:-1,p=0;return mc()&&(p|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:u,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:p,providerIndexes:0,value:r,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,u?a:a&&a.parent,t,n,i,r);return null===e.firstChild&&(e.firstChild=y),null!==a&&(u?null==a.child&&null!==y.parent&&(a.child=y):null===a.next&&(a.next=y,y.prev=a)),y}(e,n,t,i,r),function Rf(){return Ft.lFrame.inI18n}()&&(a.flags|=32);else if(64&a.type){a.type=t,a.value=i,a.attrs=r;const u=function ga(){const e=Ft.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();a.injectorIndex=null===u?-1:u.injectorIndex}return _a(a,!0),a}function bm(e,n,t,i){if(0===t)return-1;const r=n.length;for(let a=0;a<t;a++)n.push(i),e.blueprint.push(i),e.data.push(null);return r}function jC(e,n,t,i,r){const a=NC(n,ds),u=lo(),p=2&i;try{Ll(-1),p&&n.length>Zt&&UC(e,n,Zt,!1),Wo(p?2:0,r);const E=p?a:null,I=At(E);try{null!==E&&(E.dirty=!1),t(i,r)}finally{Xn(E,I)}}finally{p&&null===n[ds]&&BC(n,ds),Ll(u),Wo(p?3:1,r)}}function Rx(e,n,t){if(Rl(n)){const i=yt(null);try{const a=n.directiveEnd;for(let u=n.directiveStart;u<a;u++){const p=e.data[u];p.contentQueries&&p.contentQueries(1,t[u],u)}}finally{yt(i)}}}function Px(e,n,t){Td()&&(function hO(e,n,t,i){const r=t.directiveStart,a=t.directiveEnd;Fs(t)&&function vO(e,n,t){const i=lr(n,e),r=$C(t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const p=G_(e,q_(e,r,null,u,i,n,null,e[nt].rendererFactory.createRenderer(i,t),null,null,null));e[n.index]=p}(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||zl(t,n),Zi(i,n);const u=t.initialInputs;for(let p=r;p<a;p++){const y=e.data[p],E=yc(n,e,p,t);Zi(E,n),null!==u&&bO(0,p-r,E,y,0,u),Kr(y)&&(Zo(t.index,n)[Sn]=yc(n,e,p,t))}}(e,n,t,lr(t,n)),64==(64&t.flags)&&ZC(e,n,t))}function Fx(e,n,t=lr){const i=n.localNames;if(null!==i){let r=n.index+1;for(let a=0;a<i.length;a+=2){const u=i[a+1],p=-1===u?t(n,e):e[u];e[r++]=p}}}function $C(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=Ox(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Ox(e,n,t,i,r,a,u,p,y,E,I){const R=Zt+i,B=R+r,H=function JF(e,n){const t=[];for(let i=0;i<n;i++)t.push(i<e?null:Wt);return t}(R,B),X="function"==typeof E?E():E;return H[Le]={type:e,blueprint:H,template:t,queries:null,viewQuery:p,declTNode:n,data:H.slice().fill(null,R),bindingStartIndex:R,expandoStartIndex:B,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof u?u():u,firstChild:null,schemas:y,consts:X,incompleteFirstPass:!1,ssrId:I}}let HC=e=>null;function qC(e,n,t,i){for(let r in e)if(e.hasOwnProperty(r)){t=null===t?{}:t;const a=e[r];null===i?GC(t,n,r,a):i.hasOwnProperty(r)&&GC(t,n,i[r],a)}return t}function GC(e,n,t,i){e.hasOwnProperty(t)?e[t].push(n,i):e[t]=[n,i]}function js(e,n,t,i,r,a,u,p){const y=lr(n,t);let I,E=n.inputs;!p&&null!=E&&(I=E[i])?(Vx(e,t,I,i,r),Fs(n)&&function lO(e,n){const t=Zo(n,e);16&t[Ot]||(t[Ot]|=64)}(t,n.index)):3&n.type&&(i=function aO(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=u?u(r,n.value||"",i):r,a.setProperty(y,i,r))}function Lx(e,n,t,i){if(Td()){const r=null===i?null:{"":-1},a=function fO(e,n){const t=e.directiveRegistry;let i=null,r=null;if(t)for(let a=0;a<t.length;a++){const u=t[a];if(Ha(n,u.selectors,!1))if(i||(i=[]),Kr(u))if(null!==u.findHostDirectiveDefs){const p=[];r=r||new Map,u.findHostDirectiveDefs(u,p,r),i.unshift(...p,u),Nx(e,n,p.length)}else i.unshift(u),Nx(e,n,0);else r=r||new Map,u.findHostDirectiveDefs?.(u,i,r),i.push(u)}return null===i?null:[i,r]}(e,t);let u,p;null===a?u=p=null:[u,p]=a,null!==u&&WC(e,n,t,u,r,p),r&&function mO(e,n,t){if(n){const i=e.localNames=[];for(let r=0;r<n.length;r+=2){const a=t[n[r+1]];if(null==a)throw new be(-301,!1);i.push(n[r],a)}}}(t,i,r)}t.mergedAttrs=Ml(t.mergedAttrs,t.attrs)}function WC(e,n,t,i,r,a){for(let E=0;E<i.length;E++)Yh(zl(t,n),e,i[E].type);!function _O(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,i.length);for(let E=0;E<i.length;E++){const I=i[E];I.providersResolver&&I.providersResolver(I)}let u=!1,p=!1,y=bm(e,n,i.length,null);for(let E=0;E<i.length;E++){const I=i[E];t.mergedAttrs=Ml(t.mergedAttrs,I.hostAttrs),yO(e,t,n,y,I),gO(y,I,r),null!==I.contentQueries&&(t.flags|=4),(null!==I.hostBindings||null!==I.hostAttrs||0!==I.hostVars)&&(t.flags|=64);const R=I.type.prototype;!u&&(R.ngOnChanges||R.ngOnInit||R.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),u=!0),!p&&(R.ngOnChanges||R.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),p=!0),y++}!function sO(e,n,t){const r=n.directiveEnd,a=e.data,u=n.attrs,p=[];let y=null,E=null;for(let I=n.directiveStart;I<r;I++){const R=a[I],B=t?t.get(R):null,X=B?B.outputs:null;y=qC(R.inputs,I,y,B?B.inputs:null),E=qC(R.outputs,I,E,X);const re=null===y||null===u||fi(n)?null:xO(y,I,u);p.push(re)}null!==y&&(y.hasOwnProperty("class")&&(n.flags|=8),y.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=p,n.inputs=y,n.outputs=E}(e,t,a)}function ZC(e,n,t){const i=t.directiveStart,r=t.directiveEnd,a=t.index,u=function Kg(){return Ft.lFrame.currentDirectiveIndex}();try{Ll(a);for(let p=i;p<r;p++){const y=e.data[p],E=n[p];_c(p),(null!==y.hostBindings||0!==y.hostVars||null!==y.hostAttrs)&&pO(y,E)}}finally{Ll(-1),_c(u)}}function pO(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function Nx(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function gO(e,n,t){if(t){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)t[n.exportAs[i]]=e;Kr(n)&&(t[""]=e)}}function yO(e,n,t,i,r){e.data[i]=r;const a=r.factory||(r.factory=De(r.type)),u=new xu(a,Kr(r),me);e.blueprint[i]=u,t[i]=u,function uO(e,n,t,i,r){const a=r.hostBindings;if(a){let u=e.hostBindingOpCodes;null===u&&(u=e.hostBindingOpCodes=[]);const p=~n.index;(function dO(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(u)!=p&&u.push(p),u.push(t,i,a)}}(e,n,i,bm(e,t,r.hostVars,Wt),r)}function Gl(e,n,t,i,r,a){const u=lr(e,n);!function Bx(e,n,t,i,r,a,u){if(null==a)e.removeAttribute(n,r,t);else{const p=null==u?Tt(a):u(a,i||"",r);e.setAttribute(n,r,p,t)}}(n[Oe],u,a,e.value,t,i,r)}function bO(e,n,t,i,r,a){const u=a[n];if(null!==u)for(let p=0;p<u.length;)KC(i,t,u[p++],u[p++],u[p++])}function KC(e,n,t,i,r){const a=yt(null);try{const u=e.inputTransforms;null!==u&&u.hasOwnProperty(i)&&(r=u[i].call(n,r)),null!==e.setInput?e.setInput(n,r,t,i):n[i]=r}finally{yt(a)}}function xO(e,n,t){let i=null,r=0;for(;r<t.length;){const a=t[r];if(0!==a)if(5!==a){if("number"==typeof a)break;if(e.hasOwnProperty(a)){null===i&&(i=[]);const u=e[a];for(let p=0;p<u.length;p+=2)if(u[p]===n){i.push(a,u[p+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function XC(e,n,t,i){return[e,!0,!1,n,null,0,i,t,null,null,null]}function YC(e,n){const t=e.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const a=t[i+1];if(-1!==a){const u=e.data[a];Of(t[i]),u.contentQueries(2,n[a],a)}}}function G_(e,n){return e[Rs]?e[fu][Eo]=n:e[Rs]=n,e[fu]=n,n}function zx(e,n,t){Of(0);const i=yt(null);try{n(e,t)}finally{yt(i)}}function QC(e){return e[la]||(e[la]=[])}function JC(e){return e.cleanup||(e.cleanup=[])}function tS(e,n){const t=e[qo],i=t?t.get(Ia,null):null;i&&i.handleError(n)}function Vx(e,n,t,i,r){for(let a=0;a<t.length;){const u=t[a++],p=t[a++];KC(e.data[u],n[u],i,p,r)}}function wO(e,n){const t=Zo(n,e),i=t[Le];!function EO(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(i,t);const r=t[fn];null!==r&&null===t[us]&&(t[us]=vx(r,t[qo])),Ux(i,t,t[Sn])}function Ux(e,n,t){Fd(n);try{const i=e.viewQuery;null!==i&&zx(1,i,t);const r=e.template;null!==r&&jC(e,n,r,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&YC(e,n),e.staticViewQueries&&zx(2,e.viewQuery,t);const a=e.components;null!==a&&function CO(e,n){for(let t=0;t<n.length;t++)wO(e,n[t])}(n,a)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{n[Ot]&=-5,zf()}}let nS=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const a=typeof Zone>"u"?null:Zone.current,u=function jh(e,n,t){const i=Object.create(jg);t&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=n;const r=u=>{i.cleanupFn=u};return i.ref={notify:()=>an(i),run:()=>{if(i.dirty=!1,i.hasRun&&!Er(i))return;i.hasRun=!0;const u=At(i);try{i.cleanupFn(),i.cleanupFn=$h,i.fn(r)}finally{Xn(i,u)}},cleanup:()=>i.cleanupFn()},i.ref}(t,E=>{this.all.has(E)&&this.queue.set(E,a)},r);let p;this.all.add(u),u.notify();const y=()=>{u.cleanup(),p?.(),this.all.delete(u),this.queue.delete(u)};return p=i?.onDestroy(y),{destroy:y}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:()=>new e})}return e})();function W_(e,n,t){let i=t?e.styles:null,r=t?e.classes:null,a=0;if(null!==n)for(let u=0;u<n.length;u++){const p=n[u];"number"==typeof p?a=p:1==a?r=sd(r,p):2==a&&(i=sd(i,p+": "+n[++u]+";"))}t?e.styles=i:e.stylesWithoutHost=i,t?e.classes=r:e.classesWithoutHost=r}function xm(e,n,t,i,r=!1){for(;null!==t;){const a=n[t.index];null!==a&&i.push(Gn(a)),gi(a)&&iS(a,i);const u=t.type;if(8&u)xm(e,n,t.child,i);else if(32&u){const p=D(t,n);let y;for(;y=p();)i.push(y)}else if(16&u){const p=Qr(n,t);if(Array.isArray(p))i.push(...p);else{const y=P(n[un]);xm(y[Le],y,p,i,!0)}}t=r?t.projectionNext:t.next}return i}function iS(e,n){for(let t=ii;t<e.length;t++){const i=e[t],r=i[Le].firstChild;null!==r&&xm(i[Le],i,r,n)}e[ao]!==e[fn]&&n.push(e[ao])}function Z_(e,n,t,i=!0){const r=n[nt],a=r.rendererFactory,u=r.afterRenderEventManager;a.begin?.(),u?.begin();try{rS(e,n,e.template,t)}catch(y){throw i&&tS(n,y),y}finally{a.end?.(),r.effectManager?.flush(),u?.end()}}function rS(e,n,t,i){const r=n[Ot];if(256!=(256&r)){n[nt].effectManager?.flush(),Fd(n);try{Gg(n),function kf(e){return Ft.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&jC(e,n,t,2,i);const u=3==(3&r);if(u){const E=e.preOrderCheckHooks;null!==E&&Bl(n,E,null)}else{const E=e.preOrderHooks;null!==E&&bu(n,E,0,null),jf(n,0)}if(function IO(e){for(let n=U(e);null!==n;n=$(n)){if(!n[da])continue;const t=n[pa];for(let i=0;i<t.length;i++){Df(t[i])}}}(n),oS(n,2),null!==e.contentQueries&&YC(e,n),u){const E=e.contentCheckHooks;null!==E&&Bl(n,E)}else{const E=e.contentHooks;null!==E&&bu(n,E,1),jf(n,1)}!function QF(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const i=NC(n,ua);try{for(let r=0;r<t.length;r++){const a=t[r];if(a<0)Ll(~a);else{const u=a,p=t[++r],y=t[++r];_b(p,u),i.dirty=!1;const E=At(i);try{y(2,n[u])}finally{Xn(i,E)}}}}finally{null===n[ua]&&BC(n,ua),Ll(-1)}}(e,n);const p=e.components;null!==p&&aS(n,p,0);const y=e.viewQuery;if(null!==y&&zx(2,y,i),u){const E=e.viewCheckHooks;null!==E&&Bl(n,E)}else{const E=e.viewHooks;null!==E&&bu(n,E,2),jf(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[Ot]&=-73,If(n)}finally{zf()}}}function oS(e,n){for(let t=U(e);null!==t;t=$(t))for(let i=ii;i<t.length;i++)sS(t[i],n)}function MO(e,n,t){sS(Zo(n,e),t)}function sS(e,n){if(!function Hg(e){return 128==(128&e[Ot])}(e))return;const t=e[Le],i=e[Ot];if(80&i&&0===n||1024&i||2===n)rS(t,e,t.template,e[Sn]);else if(e[ks]>0){oS(e,1);const r=t.components;null!==r&&aS(e,r,1)}}function aS(e,n,t){for(let i=0;i<n.length;i++)MO(e,n[i],t)}class wm{get rootNodes(){const n=this._lView,t=n[Le];return xm(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Sn]}set context(n){this._lView[Sn]=n}get destroyed(){return 256==(256&this._lView[Ot])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[$n];if(gi(n)){const t=n[8],i=t?t.indexOf(this):-1;i>-1&&(Ze(n,i),np(t,i))}this._attachedToViewContainer=!1}Ge(this._lView[Le],this._lView)}onDestroy(n){!function _u(e,n){if(256==(256&e[Ot]))throw new be(911,!1);null===e[Nn]&&(e[Nn]=[]),e[Nn].push(n)}(this._lView,n)}markForCheck(){vm(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ot]&=-129}reattach(){this._lView[Ot]|=128}detectChanges(){Z_(this._lView[Le],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new be(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Je(e,n){Ti(e,n,n[Oe],2,null,null)}(this._lView[Le],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new be(902,!1);this._appRef=n}}class TO extends wm{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Z_(n[Le],n,n[Sn],!1)}checkNoChanges(){}get context(){return null}}class lS extends _m{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=nn(n);return new Em(t,this.ngModule)}}function cS(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class kO{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,i){i=Kn(i);const r=this.injector.get(n,wx,i);return r!==wx||t===wx?r:this.parentInjector.get(n,t,i)}}class Em extends gC{get inputs(){const n=this.componentDef,t=n.inputTransforms,i=cS(n.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return cS(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function Bh(e){return e.map(As).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,i,r){let a=(r=r||this.ngModule)instanceof el?r:r?.injector;a&&null!==this.componentDef.getStandaloneInjector&&(a=this.componentDef.getStandaloneInjector(a)||a);const u=a?new kO(n,a):n,p=u.get(ym,null);if(null===p)throw new be(407,!1);const R={rendererFactory:p,sanitizer:u.get(IF,null),effectManager:u.get(nS,null),afterRenderEventManager:u.get(Tx,null)},B=p.createRenderer(null,this.componentDef),H=this.componentDef.selectors[0][0]||"div",X=i?function eO(e,n,t,i){const a=i.get(PC,!1)||t===rr.ShadowDom,u=e.selectRootElement(n,a);return function tO(e){HC(e)}(u),u}(B,i,this.componentDef.encapsulation,u):he(B,H,function AO(e){const n=e.toLowerCase();return"svg"===n?Md:"math"===n?"math":null}(H)),Se=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let ye=null;null!==X&&(ye=vx(X,u,!0));const ot=Ox(0,null,null,1,0,null,null,null,null,null,null),lt=q_(null,ot,null,Se,null,null,R,B,u,null,ye);let Gt,Jn;Fd(lt);try{const di=this.componentDef;let _o,Ws=null;di.findHostDirectiveDefs?(_o=[],Ws=new Map,di.findHostDirectiveDefs(di,_o,Ws),_o.push(di)):_o=[di];const dl=function PO(e,n){const t=e[Le],i=Zt;return e[i]=n,Dp(t,i,2,"#host",null)}(lt,X),cb=function FO(e,n,t,i,r,a,u){const p=r[Le];!function OO(e,n,t,i){for(const r of e)n.mergedAttrs=Ml(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(W_(n,n.mergedAttrs,!0),null!==t&&Io(i,t,n))}(i,e,n,u);let y=null;null!==n&&(y=vx(n,r[qo]));const E=a.rendererFactory.createRenderer(n,t);let I=16;t.signals?I=4096:t.onPush&&(I=64);const R=q_(r,$C(t),null,I,r[e.index],e,a,E,null,null,y);return p.firstCreatePass&&Nx(p,e,i.length-1),G_(r,R),r[e.index]=R}(dl,X,di,_o,lt,R,B);Jn=Sf(ot,Zt),X&&function NO(e,n,t,i){if(i)cu(e,t,["ng-version",MF.full]);else{const{attrs:r,classes:a}=function Ke(e){const n=[],t=[];let i=1,r=2;for(;i<e.length;){let a=e[i];if("string"==typeof a)2===r?""!==a&&n.push(a,e[++i]):8===r&&t.push(a);else{if(!Ho(r))break;r=a}i++}return{attrs:n,classes:t}}(n.selectors[0]);r&&cu(e,t,r),a&&a.length>0&&Qo(e,t,a.join(" "))}}(B,di,X,i),void 0!==t&&function BO(e,n,t){const i=e.projection=[];for(let r=0;r<n.length;r++){const a=t[r];i.push(null!=a?Array.from(a):null)}}(Jn,this.ngContentSelectors,t),Gt=function LO(e,n,t,i,r,a){const u=cr(),p=r[Le],y=lr(u,r);WC(p,r,u,t,null,i);for(let I=0;I<t.length;I++)Zi(yc(r,p,u.directiveStart+I,u),r);ZC(p,r,u),y&&Zi(y,r);const E=yc(r,p,u.directiveStart+u.componentOffset,u);if(e[Sn]=r[Sn]=E,null!==a)for(const I of a)I(E,n);return Rx(p,u,e),E}(cb,di,_o,Ws,lt,[zO]),Ux(ot,lt,null)}finally{zf()}return new RO(this.componentType,Gt,Ep(Jn,lt),lt,Jn)}}class RO extends xF{constructor(n,t,i,r,a){super(),this.location=i,this._rootLView=r,this._tNode=a,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new TO(r),this.componentType=n}setInput(n,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const a=this._rootLView;Vx(a[Le],a,r,n,t),this.previousInputValues.set(n,t),vm(Zo(this._tNode.index,a))}}get injector(){return new co(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function zO(){const e=cr();vu(Pe()[Le],e)}function Nt(e){let n=function uS(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const i=[e];for(;n;){let r;if(Kr(e))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new be(903,!1);r=n.\u0275dir}if(r){if(t){i.push(r);const u=e;u.inputs=K_(e.inputs),u.inputTransforms=K_(e.inputTransforms),u.declaredInputs=K_(e.declaredInputs),u.outputs=K_(e.outputs);const p=r.hostBindings;p&&$O(e,p);const y=r.viewQuery,E=r.contentQueries;if(y&&UO(e,y),E&&jO(e,E),Yc(e.inputs,r.inputs),Yc(e.declaredInputs,r.declaredInputs),Yc(e.outputs,r.outputs),null!==r.inputTransforms&&(null===u.inputTransforms&&(u.inputTransforms={}),Yc(u.inputTransforms,r.inputTransforms)),Kr(r)&&r.data.animation){const I=e.data;I.animation=(I.animation||[]).concat(r.data.animation)}}const a=r.features;if(a)for(let u=0;u<a.length;u++){const p=a[u];p&&p.ngInherit&&p(e),p===Nt&&(t=!1)}}n=Object.getPrototypeOf(n)}!function VO(e){let n=0,t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Ml(r.hostAttrs,t=Ml(t,r.hostAttrs))}}(i)}function K_(e){return e===Uo?{}:e===cn?[]:e}function UO(e,n){const t=e.viewQuery;e.viewQuery=t?(i,r)=>{n(i,r),t(i,r)}:n}function jO(e,n){const t=e.contentQueries;e.contentQueries=t?(i,r,a)=>{n(i,r,a),t(i,r,a)}:n}function $O(e,n){const t=e.hostBindings;e.hostBindings=t?(i,r)=>{n(i,r),t(i,r)}:n}function X_(e){return!!jx(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function jx(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function To(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function Qn(e,n,t,i){const r=Pe();return To(r,va(),n)&&(yn(),Gl(Hn(),r,e,n,t,i)),Qn}function Mp(e,n,t,i){return To(e,va(),t)?n+Tt(t)+i:Wt}function ps(e,n,t,i,r,a,u,p){const y=Pe(),E=yn(),I=e+Zt,R=E.firstCreatePass?function fL(e,n,t,i,r,a,u,p,y){const E=n.consts,I=Dp(n,e,4,u||null,Wa(E,p));Lx(n,t,I,Wa(E,y)),vu(n,I);const R=I.tView=Ox(2,I,i,r,a,n.directiveRegistry,n.pipeRegistry,null,n.schemas,E,null);return null!==n.queries&&(n.queries.template(n,I),R.queries=n.queries.embeddedTView(I)),I}(I,E,y,n,t,i,r,a,u):E.data[I];_a(R,!1);const B=IS(E,y,R,e);Kh()&&dr(E,y,B,R),Zi(B,y),G_(y,y[I]=XC(B,y,B,R)),Ga(R)&&Px(E,y,R),null!=u&&Fx(y,R,p)}let IS=function MS(e,n,t,i){return Nl(!0),n[Oe].createComment("")};function Xi(e,n,t){const i=Pe();return To(i,va(),n)&&js(yn(),Hn(),i,e,n,i[Oe],t,!1),Xi}function Kx(e,n,t,i,r){const u=r?"class":"style";Vx(e,t,n.inputs[u],u,i)}function Kt(e,n,t,i){const r=Pe(),a=yn(),u=Zt+e,p=r[Oe],y=a.firstCreatePass?function yL(e,n,t,i,r,a){const u=n.consts,y=Dp(n,e,2,i,Wa(u,r));return Lx(n,t,y,Wa(u,a)),null!==y.attrs&&W_(y,y.attrs,!1),null!==y.mergedAttrs&&W_(y,y.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,y),y}(u,a,r,n,t,i):a.data[u],E=TS(a,r,y,p,n,e);r[u]=E;const I=Ga(y);return _a(y,!0),Io(p,E,y),32!=(32&y.flags)&&Kh()&&dr(a,r,E,y),0===function hb(){return Ft.lFrame.elementDepthCount}()&&Zi(E,r),function pb(){Ft.lFrame.elementDepthCount++}(),I&&(Px(a,r,y),Rx(a,y,r)),null!==i&&Fx(r,y),Kt}function vn(){let e=cr();oi()?yu():(e=e.parent,_a(e,!1));const n=e;(function gc(e){return Ft.skipHydrationRootTNode===e})(n)&&function gb(){Ft.skipHydrationRootTNode=null}(),function Tf(){Ft.lFrame.elementDepthCount--}();const t=yn();return t.firstCreatePass&&(vu(t,e),Rl(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function Cb(e){return 0!=(8&e.flags)}(n)&&Kx(t,n,Pe(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Sb(e){return 0!=(16&e.flags)}(n)&&Kx(t,n,Pe(),n.stylesWithoutHost,!1),vn}function pr(e,n,t,i){return Kt(e,n,t,i),vn(),pr}let TS=(e,n,t,i,r,a)=>(Nl(!0),he(i,r,function Uf(){return Ft.lFrame.currentNamespace}()));function Mm(e){return!!e&&"function"==typeof e.then}function PS(e){return!!e&&"function"==typeof e.subscribe}function Ui(e,n,t,i){const r=Pe(),a=yn(),u=cr();return function OS(e,n,t,i,r,a,u){const p=Ga(i),E=e.firstCreatePass&&JC(e),I=n[Sn],R=QC(n);let B=!0;if(3&i.type||u){const re=lr(i,n),_e=u?u(re):re,Se=R.length,ye=u?lt=>u(Gn(lt[i.index])):i.index;let ot=null;if(!u&&p&&(ot=function CL(e,n,t,i){const r=e.cleanup;if(null!=r)for(let a=0;a<r.length-1;a+=2){const u=r[a];if(u===t&&r[a+1]===i){const p=n[la],y=r[a+2];return p.length>y?p[y]:null}"string"==typeof u&&(a+=2)}return null}(e,n,r,i.index)),null!==ot)(ot.__ngLastListenerFn__||ot).__ngNextListenerFn__=a,ot.__ngLastListenerFn__=a,B=!1;else{a=NS(i,n,I,a,!1);const lt=t.listen(_e,r,a);R.push(a,lt),E&&E.push(r,ye,Se,Se+1)}}else a=NS(i,n,I,a,!1);const H=i.outputs;let X;if(B&&null!==H&&(X=H[r])){const re=X.length;if(re)for(let _e=0;_e<re;_e+=2){const Gt=n[X[_e]][X[_e+1]].subscribe(a),Jn=R.length;R.push(a,Gt),E&&E.push(r,i.index,Jn,-(Jn+1))}}}(a,r,r[Oe],u,e,n,i),Ui}function LS(e,n,t,i){try{return Wo(6,n,t),!1!==t(i)}catch(r){return tS(e,r),!1}finally{Wo(7,n,t)}}function NS(e,n,t,i,r){return function a(u){if(u===Function)return i;vm(e.componentOffset>-1?Zo(e.index,n):n);let y=LS(n,t,i,u),E=a.__ngNextListenerFn__;for(;E;)y=LS(n,t,E,u)&&y,E=E.__ngNextListenerFn__;return r&&!1===y&&u.preventDefault(),y}}function ih(e=1){return function yb(e){return(Ft.lFrame.contextLView=function Ol(e,n){for(;e>0;)n=n[ca],e--;return n}(e,Ft.lFrame.contextLView))[Sn]}(e)}function SL(e,n){let t=null;const i=function hc(e){const n=e.attrs;if(null!=n){const t=n.indexOf(5);if(!(1&t))return n[t+1]}return null}(e);for(let r=0;r<n.length;r++){const a=n[r];if("*"!==a){if(null===i?Ha(e,a,!0):uu(i,a))return r}else t=r}return t}function $s(e){const n=Pe()[un][or];if(!n.projection){const i=n.projection=Au(e?e.length:1,null),r=i.slice();let a=n.child;for(;null!==a;){const u=e?SL(a,e):0;null!==u&&(r[u]?r[u].projectionNext=a:i[u]=a,r[u]=a),a=a.next}}}function ki(e,n=0,t){const i=Pe(),r=yn(),a=Dp(r,Zt+e,16,null,t||null);null===a.projection&&(a.projection=n),yu(),(!i[us]||mc())&&32!=(32&a.flags)&&function $r(e,n,t){Yo(n[Oe],0,n,t,Ut(e,t,n),Tr(t.parent||n[or],t,n))}(r,i,a)}function ty(e,n,t,i,r){const a=Pe(),u=Mp(a,n,t,i);return u!==Wt&&js(yn(),Hn(),a,e,u,a[Oe],r,!1),ty}function ny(e,n){return e<<17|n<<2}function Lu(e){return e>>17&32767}function Xx(e){return 2|e}function rh(e){return(131068&e)>>2}function Yx(e,n){return-131069&e|n<<2}function Qx(e){return 1|e}function WS(e,n,t,i,r){const a=e[t+1],u=null===n;let p=i?Lu(a):rh(a),y=!1;for(;0!==p&&(!1===y||u);){const I=e[p+1];kL(e[p],n)&&(y=!0,e[p+1]=i?Qx(I):Xx(I)),p=i?Lu(I):rh(I)}y&&(e[t+1]=i?Xx(a):Qx(a))}function kL(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&ku(e,n)>=0}function po(e,n){return function tl(e,n,t,i){const r=Pe(),a=yn(),u=function Ns(e){const n=Ft.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}(2);a.firstUpdatePass&&function nD(e,n,t,i){const r=e.data;if(null===r[t+1]){const a=r[lo()],u=function tD(e,n){return n>=e.expandoStartIndex}(e,t);(function sD(e,n){return 0!=(e.flags&(n?8:16))})(a,i)&&null===n&&!u&&(n=!1),n=function VL(e,n,t,i){const r=function Ff(e){const n=Ft.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}(e);let a=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(t=Tm(t=Jx(null,e,n,t,i),n.attrs,i),a=null);else{const u=n.directiveStylingLast;if(-1===u||e[u]!==r)if(t=Jx(r,e,n,t,i),null===a){let y=function UL(e,n,t){const i=t?n.classBindings:n.styleBindings;if(0!==rh(i))return e[Lu(i)]}(e,n,i);void 0!==y&&Array.isArray(y)&&(y=Jx(null,e,n,y[1],i),y=Tm(y,n.attrs,i),function jL(e,n,t,i){e[Lu(t?n.classBindings:n.styleBindings)]=i}(e,n,i,y))}else a=function $L(e,n,t){let i;const r=n.directiveEnd;for(let a=1+n.directiveStylingLast;a<r;a++)i=Tm(i,e[a].hostAttrs,t);return Tm(i,n.attrs,t)}(e,n,i)}return void 0!==a&&(i?n.residualClasses=a:n.residualStyles=a),t}(r,a,n,i),function TL(e,n,t,i,r,a){let u=a?n.classBindings:n.styleBindings,p=Lu(u),y=rh(u);e[i]=t;let I,E=!1;if(Array.isArray(t)?(I=t[1],(null===I||ku(t,I)>0)&&(E=!0)):I=t,r)if(0!==y){const B=Lu(e[p+1]);e[i+1]=ny(B,p),0!==B&&(e[B+1]=Yx(e[B+1],i)),e[p+1]=function IL(e,n){return 131071&e|n<<17}(e[p+1],i)}else e[i+1]=ny(p,0),0!==p&&(e[p+1]=Yx(e[p+1],i)),p=i;else e[i+1]=ny(y,0),0===p?p=i:e[y+1]=Yx(e[y+1],i),y=i;E&&(e[i+1]=Xx(e[i+1])),WS(e,I,i,!0),WS(e,I,i,!1),function AL(e,n,t,i,r){const a=r?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof n&&ku(a,n)>=0&&(t[i+1]=Qx(t[i+1]))}(n,I,e,i,a),u=ny(p,y),a?n.classBindings=u:n.styleBindings=u}(r,a,n,t,u,i)}}(a,e,u,i),n!==Wt&&To(r,u,n)&&function rD(e,n,t,i,r,a,u,p){if(!(3&n.type))return;const y=e.data,E=y[p+1],I=function ML(e){return 1==(1&e)}(E)?oD(y,n,t,r,rh(E),u):void 0;iy(I)||(iy(a)||function DL(e){return 2==(2&e)}(E)&&(a=oD(y,null,t,r,p,u)),function zs(e,n,t,i,r){if(n)r?e.addClass(t,i):e.removeClass(t,i);else{let a=-1===i.indexOf("-")?void 0:Ca.DashCase;null==r?e.removeStyle(t,i,a):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),a|=Ca.Important),e.setStyle(t,i,r,a))}}(i,u,ar(lo(),t),r,a))}(a,a.data[lo()],r,r[Oe],e,r[u+1]=function WL(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=Ei(Mo(e)))),e}(n,t),i,u)}(e,n,null,!0),po}function Jx(e,n,t,i,r){let a=null;const u=t.directiveEnd;let p=t.directiveStylingLast;for(-1===p?p=t.directiveStart:p++;p<u&&(a=n[p],i=Tm(i,a.hostAttrs,r),a!==e);)p++;return null!==e&&(t.directiveStylingLast=p),i}function Tm(e,n,t){const i=t?1:2;let r=-1;if(null!==n)for(let a=0;a<n.length;a++){const u=n[a];"number"==typeof u?r=u:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),uo(e,u,!!t||n[++a]))}return void 0===e?null:e}function oD(e,n,t,i,r,a){const u=null===n;let p;for(;r>0;){const y=e[r],E=Array.isArray(y),I=E?y[1]:y,R=null===I;let B=t[r+1];B===Wt&&(B=R?cn:void 0);let H=R?Yf(B,i):I===i?B:void 0;if(E&&!iy(H)&&(H=Yf(y,i)),iy(H)&&(p=H,u))return p;const X=e[r+1];r=u?Lu(X):rh(X)}if(null!==n){let y=a?n.residualClasses:n.residualStyles;null!=y&&(p=Yf(y,i))}return p}function iy(e){return void 0!==e}function Ao(e,n=""){const t=Pe(),i=yn(),r=e+Zt,a=i.firstCreatePass?Dp(i,r,1,n,null):i.data[r],u=aD(i,t,a,n,e);t[r]=u,Kh()&&dr(i,t,u,a),_a(a,!1)}let aD=(e,n,t,i,r)=>(Nl(!0),function se(e,n){return e.createText(n)}(n[Oe],i));function Am(e){return ry("",e,""),Am}function ry(e,n,t){const i=Pe(),r=Mp(i,e,n,t);return r!==Wt&&function Rc(e,n,t){const i=ar(n,e);!function ue(e,n,t){e.setValue(n,t)}(e[Oe],i,t)}(i,lo(),r),ry}function Nu(e,n,t){const i=Pe();return To(i,va(),n)&&js(yn(),Hn(),i,e,n,i[Oe],t,!0),Nu}const Vp="en-US";let MD=Vp;function n0(e,n,t,i,r){if(e=Mt(e),Array.isArray(e))for(let a=0;a<e.length;a++)n0(e[a],n,t,i,r);else{const a=yn(),u=Pe(),p=cr();let y=eh(e)?e:Mt(e.provide);const E=dC(e),I=1048575&p.providerIndexes,R=p.directiveStart,B=p.providerIndexes>>20;if(eh(e)||!e.multi){const H=new xu(E,r,me),X=o0(y,n,r?I:I+B,R);-1===X?(Yh(zl(p,u),a,y),r0(a,e,n.length),n.push(y),p.directiveStart++,p.directiveEnd++,r&&(p.providerIndexes+=1048576),t.push(H),u.push(H)):(t[X]=H,u[X]=H)}else{const H=o0(y,n,I+B,R),X=o0(y,n,I,I+B),_e=X>=0&&t[X];if(r&&!_e||!r&&!(H>=0&&t[H])){Yh(zl(p,u),a,y);const Se=function fB(e,n,t,i,r){const a=new xu(e,t,me);return a.multi=[],a.index=n,a.componentProviders=0,JD(a,r,i&&!t),a}(r?pB:hB,t.length,r,i,E);!r&&_e&&(t[X].providerFactory=Se),r0(a,e,n.length,0),n.push(y),p.directiveStart++,p.directiveEnd++,r&&(p.providerIndexes+=1048576),t.push(Se),u.push(Se)}else r0(a,e,H>-1?H:X,JD(t[r?X:H],E,!r&&i));!r&&i&&_e&&t[X].componentProviders++}}}function r0(e,n,t,i){const r=eh(n),a=function rF(e){return!!e.useClass}(n);if(r||a){const y=(a?Mt(n.useClass):n).prototype.ngOnDestroy;if(y){const E=e.destroyHooks||(e.destroyHooks=[]);if(!r&&n.multi){const I=E.indexOf(t);-1===I?E.push(t,[i,y]):E[I+1].push(i,y)}else E.push(t,y)}}}function JD(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function o0(e,n,t,i){for(let r=t;r<i;r++)if(n[r]===e)return r;return-1}function hB(e,n,t,i){return s0(this.multi,[])}function pB(e,n,t,i){const r=this.multi;let a;if(this.providerFactory){const u=this.providerFactory.componentProviders,p=yc(t,t[Le],this.providerFactory.index,i);a=p.slice(0,u),s0(r,a);for(let y=u;y<p.length;y++)a.push(p[y])}else a=[],s0(r,a);return a}function s0(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Rn(e,n=[]){return t=>{t.providersResolver=(i,r)=>function dB(e,n,t){const i=yn();if(i.firstCreatePass){const r=Kr(e);n0(t,i.data,i.blueprint,r,!0),n0(n,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,n)}}class sh{}class eI{}class a0 extends sh{constructor(n,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lS(this);const r=Si(n);this._bootstrapComponents=kc(r.bootstrap),this._r3Injector=wC(n,t,[{provide:sh,useValue:this},{provide:_m,useValue:this.componentFactoryResolver},...i],Ei(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class l0 extends eI{constructor(n){super(),this.moduleType=n}create(n){return new a0(this.moduleType,n,[])}}class tI extends sh{constructor(n){super(),this.componentFactoryResolver=new lS(this),this.instance=null;const t=new vp([...n.providers,{provide:sh,useValue:this},{provide:_m,useValue:this.componentFactoryResolver}],n.parent||L_(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function nI(e,n,t=null){return new tI({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let _B=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=aC(0,t.type),r=i.length>0?nI([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=et({token:e,providedIn:"environment",factory:()=>new e(Me(el))})}return e})();function c0(e){e.getStandaloneInjector=n=>n.get(_B).getOrCreateStandaloneInjector(e)}function $B(){return this._results[Symbol.iterator]()}class ah{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Dn)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=ah.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=$B)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const i=this;i.dirty=!1;const r=function So(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function u_(e,n,t){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],a=n[i];if(t&&(r=t(r),a=t(a)),a!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function qB(e,n,t,i=!0){const r=n[Le];if(function Xe(e,n,t,i){const r=ii+i,a=t.length;i>0&&(t[r-1][Eo]=n),i<a-ii?(n[Eo]=t[r],d_(t,ii+i,n)):(t.push(n),n[Eo]=null),n[$n]=t;const u=n[Al];null!==u&&t!==u&&function qe(e,n){const t=e[pa];n[un]!==n[$n][$n][un]&&(e[da]=!0),null===t?e[pa]=[n]:t.push(n)}(u,n);const p=n[cs];null!==p&&p.insertView(e),n[Ot]|=128}(r,n,e,t),i){const a=Yn(t,e),u=n[Oe],p=_i(u,e[ao]);null!==p&&function Ce(e,n,t,i,r,a){i[fn]=r,i[or]=n,Ti(e,i,t,1,r,a)}(r,e[or],u,n,p,a)}}let Xl=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=ZB}return e})();const GB=Xl,WB=class extends GB{constructor(n,t,i){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,i){const r=function HB(e,n,t,i){const r=n.tView,p=q_(e,r,t,4096&e[Ot]?4096:16,null,n,null,null,null,i?.injector??null,i?.hydrationInfo??null);p[Al]=e[n.index];const E=e[cs];return null!==E&&(p[cs]=E.createEmbeddedView(r)),Ux(r,p,t),p}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:i});return new wm(r)}};function ZB(){return cy(cr(),Pe())}function cy(e,n){return 4&e.type?new WB(n,e,Ep(e,n)):null}let Ta=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=ez}return e})();function ez(){return bI(cr(),Pe())}const tz=Ta,yI=class extends tz{constructor(n,t,i){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=i}get element(){return Ep(this._hostTNode,this._hostLView)}get injector(){return new co(this._hostTNode,this._hostLView)}get parentInjector(){const n=Nd(this._hostTNode,this._hostLView);if(Xh(n)){const t=Od(n,this._hostLView),i=wu(n);return new co(t[Le].data[i+8],t)}return new co(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=vI(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-ii}createEmbeddedView(n,t,i){let r,a;"number"==typeof i?r=i:null!=i&&(r=i.index,a=i.injector);const p=n.createEmbeddedViewImpl(t||{},a,null);return this.insertImpl(p,r,false),p}createComponent(n,t,i,r,a){const u=n&&!function Tu(e){return"function"==typeof e}(n);let p;if(u)p=t;else{const re=t||{};p=re.index,i=re.injector,r=re.projectableNodes,a=re.environmentInjector||re.ngModuleRef}const y=u?n:new Em(nn(n)),E=i||this.parentInjector;if(!a&&null==y.ngModule){const _e=(u?E:this.parentInjector).get(el,null);_e&&(a=_e)}nn(y.componentType??{});const H=y.create(E,r,null,a);return this.insertImpl(H.hostView,p,false),H}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,i){const r=n._lView;if(function qg(e){return gi(e[$n])}(r)){const y=this.indexOf(n);if(-1!==y)this.detach(y);else{const E=r[$n],I=new yI(E,E[or],E[$n]);I.detach(I.indexOf(n))}}const u=this._adjustIndex(t),p=this._lContainer;return qB(p,r,u,!i),n.attachToViewContainerRef(),d_(d0(p),u,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=vI(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),i=Ze(this._lContainer,t);i&&(np(d0(this._lContainer),t),Ge(i[Le],i))}detach(n){const t=this._adjustIndex(n,-1),i=Ze(this._lContainer,t);return i&&null!=np(d0(this._lContainer),t)?new wm(i):null}_adjustIndex(n,t=0){return n??this.length+t}};function vI(e){return e[8]}function d0(e){return e[8]||(e[8]=[])}function bI(e,n){let t;const i=n[e.index];return gi(i)?t=i:(t=XC(i,n,null,e),n[e.index]=t,G_(n,t)),xI(t,n,e,i),new yI(t,e,n)}let xI=function wI(e,n,t,i){if(e[ao])return;let r;r=8&t.type?Gn(i):function nz(e,n){const t=e[Oe],i=t.createComment(""),r=lr(n,e);return En(t,_i(t,r),i,function Mr(e,n){return e.nextSibling(n)}(t,r),!1),i}(n,t),e[ao]=r};class h0{constructor(n){this.queryList=n,this.matches=null}clone(){return new h0(this.queryList)}setDirty(){this.queryList.setDirty()}}class p0{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const i=null!==n.contentQueries?n.contentQueries[0]:t.length,r=[];for(let a=0;a<i;a++){const u=t.getByIndex(a);r.push(this.queries[u.indexInDeclarationView].clone())}return new p0(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==II(n,t).matches&&this.queries[t].setDirty()}}class EI{constructor(n,t,i=null){this.predicate=n,this.flags=t,this.read=i}}class f0{constructor(n=[]){this.queries=n}elementStart(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,a=this.getByIndex(i).embeddedTView(n,r);a&&(a.indexInDeclarationView=i,null!==t?t.push(a):t=[a])}return null!==t?new f0(t):null}template(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class m0{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new m0(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const a=i[r];this.matchTNodeWithReadOption(n,t,oz(t,a)),this.matchTNodeWithReadOption(n,t,Bd(t,n,a,!1,!1))}else i===Xl?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,Bd(t,n,i,!1,!1))}matchTNodeWithReadOption(n,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===kn||r===Ta||r===Xl&&4&t.type)this.addMatch(t.index,-2);else{const a=Bd(t,n,r,!1,!1);null!==a&&this.addMatch(t.index,a)}else this.addMatch(t.index,i)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function oz(e,n){const t=e.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===n)return t[i+1];return null}function az(e,n,t,i){return-1===t?function sz(e,n){return 11&e.type?Ep(e,n):4&e.type?cy(e,n):null}(n,e):-2===t?function lz(e,n,t){return t===kn?Ep(n,e):t===Xl?cy(n,e):t===Ta?bI(n,e):void 0}(e,n,i):yc(e,e[Le],t,n)}function CI(e,n,t,i){const r=n[cs].queries[i];if(null===r.matches){const a=e.data,u=t.matches,p=[];for(let y=0;y<u.length;y+=2){const E=u[y];p.push(E<0?null:az(n,a[E],u[y+1],t.metadata.read))}r.matches=p}return r.matches}function g0(e,n,t,i){const r=e.queries.getByIndex(t),a=r.matches;if(null!==a){const u=CI(e,n,r,t);for(let p=0;p<a.length;p+=2){const y=a[p];if(y>0)i.push(u[p/2]);else{const E=a[p+1],I=n[-y];for(let R=ii;R<I.length;R++){const B=I[R];B[Al]===B[$n]&&g0(B[Le],B,E,i)}if(null!==I[pa]){const R=I[pa];for(let B=0;B<R.length;B++){const H=R[B];g0(H[Le],H,E,i)}}}}}return i}function Rr(e){const n=Pe(),t=yn(),i=Wh();Of(i+1);const r=II(t,i);if(e.dirty&&function qh(e){return 4==(4&e[Ot])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const a=r.crossesNgTemplate?g0(t,n,i,[]):CI(t,n,r,i);e.reset(a,SF),e.notifyOnChanges()}return!0}return!1}function Bm(e,n,t){const i=yn();i.firstCreatePass&&(DI(i,new EI(e,n,t),-1),2==(2&n)&&(i.staticViewQueries=!0)),SI(i,Pe(),n)}function ko(e,n,t,i){const r=yn();if(r.firstCreatePass){const a=cr();DI(r,new EI(n,t,i),a.index),function uz(e,n){const t=e.contentQueries||(e.contentQueries=[]);n!==(t.length?t[t.length-1]:-1)&&t.push(e.queries.length-1,n)}(r,e),2==(2&t)&&(r.staticContentQueries=!0)}SI(r,Pe(),t)}function Pr(){return function cz(e,n){return e[cs].queries[n].queryList}(Pe(),Wh())}function SI(e,n,t){const i=new ah(4==(4&t));(function rO(e,n,t,i){const r=QC(n);r.push(t),e.firstCreatePass&&JC(e).push(i,r.length-1)})(e,n,i,i.destroy),null===n[cs]&&(n[cs]=new p0),n[cs].queries.push(new h0(i))}function DI(e,n,t){null===e.queries&&(e.queries=new f0),e.queries.track(new m0(n,t))}function II(e,n){return e.queries.getByIndex(n)}const qI=new Re("Application Initializer");let w0=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Qe(qI,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const a=r();if(Mm(a))t.push(a);else if(PS(a)){const u=new Promise((p,y)=>{a.subscribe({complete:p,error:y})});t.push(u)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),GI=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const Yl=new Re("LocaleId",{providedIn:"root",factory:()=>Qe(Yl,rn.Optional|rn.SkipSelf)||function kz(){return typeof $localize<"u"&&$localize.locale||Vp}()});let WI=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new wi(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Fz{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let Oz=(()=>{class e{compileModuleSync(t){return new l0(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),a=kc(Si(t).declarations).reduce((u,p)=>{const y=nn(p);return y&&u.push(new Em(y)),u},[]);return new Fz(i,a)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const YI=new Re(""),py=new Re("");let I0,S0=(()=>{class e{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,I0||(function iV(e){I0=e}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{jt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let a=-1;i&&i>0&&(a=setTimeout(()=>{this._callbacks=this._callbacks.filter(u=>u.timeoutId!==a),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:a,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||e)(Me(jt),Me(D0),Me(py))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})(),D0=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return I0?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Bu=null;const QI=new Re("AllowMultipleToken"),M0=new Re("PlatformDestroyListeners"),JI=new Re("appBootstrapListener");function nM(e,n,t=[]){const i=`Platform: ${n}`,r=new Re(i);return(a=[])=>{let u=T0();if(!u||u.injector.get(QI,!1)){const p=[...t,...a,{provide:r,useValue:!0}];e?e(p):function sV(e){if(Bu&&!Bu.get(QI,!1))throw new be(400,!1);(function eM(){!function Bi(e){Ni=e}(()=>{throw new be(600,!1)})})(),Bu=e;const n=e.get(rM);(function tM(e){e.get(hC,null)?.forEach(t=>t())})(e)}(function iM(e=[],n){return Jo.create({name:n,providers:[{provide:ax,useValue:"platform"},{provide:M0,useValue:new Set([()=>Bu=null])},...e]})}(p,i))}return function lV(e){const n=T0();if(!n)throw new be(401,!1);return n}()}}function T0(){return Bu?.get(rM)??null}let rM=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function cV(e="zone.js",n){return"noop"===e?new VF:"zone.js"===e?new jt(n):e}(i?.ngZone,function oM(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const a=function gB(e,n,t){return new a0(e,n,t)}(t.moduleType,this.injector,function uM(e){return[{provide:jt,useFactory:e},{provide:fm,multi:!0,useFactory:()=>{const n=Qe(dV,{optional:!0});return()=>n.initialize()}},{provide:cM,useFactory:uV},{provide:IC,useFactory:MC}]}(()=>r)),u=a.injector.get(Ia,null);return r.runOutsideAngular(()=>{const p=r.onError.subscribe({next:y=>{u.handleError(y)}});a.onDestroy(()=>{fy(this._modules,a),p.unsubscribe()})}),function sM(e,n,t){try{const i=t();return Mm(i)?i.catch(r=>{throw n.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>e.handleError(i)),i}}(u,r,()=>{const p=a.injector.get(w0);return p.runInitializers(),p.donePromise.then(()=>(function TD(e){ro(e,"Expected localeId to be defined"),"string"==typeof e&&(MD=e.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Yl,Vp)||Vp),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=aM({},i);return function rV(e,n,t){const i=new l0(t);return Promise.resolve(i)}(0,0,t).then(a=>this.bootstrapModuleFactory(a,r))}_moduleDoBootstrap(t){const i=t.injector.get(zu);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new be(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new be(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(M0,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Jo))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function aM(e,n){return Array.isArray(n)?n.reduce(aM,e):{...e,...n}}let zu=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Qe(cM),this.zoneIsStable=Qe(IC),this.componentTypes=[],this.components=[],this.isStable=Qe(WI).hasPendingTasks.pipe(ir(t=>t?_t(!1):this.zoneIsStable),Xc(),vl()),this._injector=Qe(el)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof gC;if(!this._injector.get(w0).done)throw!r&&function Oi(e){const n=nn(e)||Pi(e)||Fi(e);return null!==n&&n.standalone}(t),new be(405,!1);let u;u=r?t:this._injector.get(_m).resolveComponentFactory(t),this.componentTypes.push(u.componentType);const p=function oV(e){return e.isBoundToModule}(u)?void 0:this._injector.get(sh),E=u.create(Jo.NULL,[],i||u.selector,p),I=E.location.nativeElement,R=E.injector.get(YI,null);return R?.registerApplication(I),E.onDestroy(()=>{this.detachView(E.hostView),fy(this.components,E),R?.unregisterApplication(I)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new be(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;fy(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(JI,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>fy(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new be(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function fy(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const cM=new Re("",{providedIn:"root",factory:()=>Qe(Ia).handleError.bind(void 0)});function uV(){const e=Qe(jt),n=Qe(Ia);return t=>e.runOutsideAngular(()=>n.handleError(t))}let dV=(()=>{class e{constructor(){this.zone=Qe(jt),this.applicationRef=Qe(zu)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let Aa=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=fV}return e})();function fV(e){return function mV(e,n,t){if(Fs(e)&&!t){const i=Zo(e.index,n);return new wm(i,i)}return 47&e.type?new wm(n[un],n):null}(cr(),Pe(),16==(16&e))}class fM{constructor(){}supports(n){return X_(n)}create(n){return new xV(n)}}const bV=(e,n)=>n;class xV{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||bV}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,i=this._removalsHead,r=0,a=null;for(;t||i;){const u=!i||t&&t.currentIndex<gM(i,r,a)?t:i,p=gM(u,r,a),y=u.currentIndex;if(u===i)r--,i=i._nextRemoved;else if(t=t._next,null==u.previousIndex)r++;else{a||(a=[]);const E=p-r,I=y-r;if(E!=I){for(let B=0;B<E;B++){const H=B<a.length?a[B]:a[B]=0,X=H+B;I<=X&&X<E&&(a[B]=H+1)}a[u.previousIndex]=I-E}}p!==y&&n(u,p,y)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!X_(n))throw new be(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,a,u,t=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let p=0;p<this.length;p++)a=n[p],u=this._trackByFn(p,a),null!==t&&Object.is(t.trackById,u)?(i&&(t=this._verifyReinsertion(t,a,u,p)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,u,p),i=!0),t=t._next}else r=0,function XO(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let i;for(;!(i=t.next()).done;)n(i.value)}}(n,p=>{u=this._trackByFn(r,p),null!==t&&Object.is(t.trackById,u)?(i&&(t=this._verifyReinsertion(t,p,u,r)),Object.is(t.item,p)||this._addIdentityChange(t,p)):(t=this._mismatch(t,p,u,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,i,r){let a;return null===n?a=this._itTail:(a=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,a,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,a,r)):n=this._addAfter(new wV(t,i),a,r),n}_verifyReinsertion(n,t,i,r){let a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==a?n=this._reinsertAfter(a,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,a=n._nextRemoved;return null===r?this._removalsHead=a:r._nextRemoved=a,null===a?this._removalsTail=r:a._prevRemoved=r,this._insertAfter(n,t,i),this._addToMoves(n,i),n}_moveAfter(n,t,i){return this._unlink(n),this._insertAfter(n,t,i),this._addToMoves(n,i),n}_addAfter(n,t,i){return this._insertAfter(n,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,i){const r=null===t?this._itHead:t._next;return n._next=r,n._prev=t,null===r?this._itTail=n:r._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new mM),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,i=n._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new mM),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class wV{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class EV{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const t=n._prevDup,i=n._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class mM{constructor(){this.map=new Map}put(n){const t=n.trackById;let i=this.map.get(t);i||(i=new EV,this.map.set(t,i)),i.add(n)}get(n,t){const r=this.map.get(n);return r?r.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function gM(e,n,t){const i=e.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+n+r}class _M{constructor(){}supports(n){return n instanceof Map||jx(n)}create(){return new CV}}class CV{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||jx(n)))throw new be(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const a=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,a)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const i=n._prev;return t._next=n,t._prev=i,n._prev=t,i&&(i._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,t);const a=r._prev,u=r._next;return a&&(a._next=u),u&&(u._prev=a),r._next=null,r._prev=null,r}const i=new SV(n);return this._records.set(n,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(i=>t(n[i],i))}}class SV{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function yM(){return new _y([new fM])}let _y=(()=>{class e{static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:yM});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||yM()),deps:[[e,new Hd,new xc]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new be(901,!1)}}return e})();function vM(){return new Um([new _M])}let Um=(()=>{class e{static#e=this.\u0275prov=et({token:e,providedIn:"root",factory:vM});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||vM()),deps:[[e,new Hd,new xc]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new be(901,!1)}}return e})();const MV=nM(null,"core",[]);let TV=(()=>{class e{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||e)(Me(zu))};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({})}return e})(),O0=null;function Vu(){return O0}class jV{}const hn=new Re("DocumentToken");let MM=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return Qe($V)},providedIn:"platform"})}return e})(),$V=(()=>{class e extends MM{constructor(){super(),this._doc=Qe(hn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Vu().getBaseHref(this._doc)}onPopState(t){const i=Vu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Vu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function TM(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function AM(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function ch(e){return e&&"?"!==e[0]?"?"+e:e}let vy=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return Qe(qV)},providedIn:"root"})}return e})();const HV=new Re("appBaseHref");let qV=(()=>{class e extends vy{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Qe(hn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return TM(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+ch(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,a){const u=this.prepareExternalUrl(r+ch(a));this._platformLocation.pushState(t,i,u)}replaceState(t,i,r,a){const u=this.prepareExternalUrl(r+ch(a));this._platformLocation.replaceState(t,i,u)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(MM),Me(HV,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),by=(()=>{class e{constructor(t){this._subject=new Dn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function ZV(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(AM(kM(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ch(i))}normalize(t){return e.stripTrailingSlash(function WV(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,kM(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ch(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ch(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=ch;static#t=this.joinWithSlash=TM;static#n=this.stripTrailingSlash=AM;static#i=this.\u0275fac=function(i){return new(i||e)(Me(vy))};static#r=this.\u0275prov=et({token:e,factory:function(){return function GV(){return new by(Me(vy))}()},providedIn:"root"})}return e})();function kM(e){return e.replace(/\/index.html$/,"")}const q0=/\s+/,VM=[];let UM=(()=>{class e{constructor(t,i,r,a){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=a,this.initialClasses=VM,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(q0):VM}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(q0):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(q0).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||e)(me(_y),me(Um),me(kn),me(Ac))};static#t=this.\u0275dir=ct({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return e})(),Hm=(()=>{class e{constructor(t,i){this._viewContainer=t,this._context=new N3,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){HM("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){HM("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(me(Ta),me(Xl))};static#t=this.\u0275dir=ct({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class N3{constructor(){this.$implicit=null,this.ngIf=null}}function HM(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Ei(n)}'.`)}let K0=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({})}return e})();const ZM="browser";function X0(e){return e===ZM}function KM(e){return"server"===e}class FU extends jV{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class J0 extends FU{static makeCurrent(){!function UV(e){O0||(O0=e)}(new J0)}onAndCancel(n,t,i){return n.addEventListener(t,i),()=>{n.removeEventListener(t,i)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function OU(){return Gm=Gm||document.querySelector("base"),Gm?Gm.getAttribute("href"):null}();return null==t?null:function LU(e){Fy=Fy||document.createElement("a"),Fy.setAttribute("href",e);const n=Fy.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){Gm=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function P3(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const i=t.indexOf("="),[r,a]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===n)return decodeURIComponent(a)}return null}(document.cookie,n)}}let Fy,Gm=null,BU=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();const ew=new Re("EventManagerPlugins");let eT=(()=>{class e{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(a=>a.supports(t)),!i)throw new be(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||e)(Me(ew),Me(jt))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();class tT{constructor(n){this._doc=n}}const tw="ng-app-id";let nT=(()=>{class e{constructor(t,i,r,a={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=KM(a),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${tw}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const a=r.get(t);return a.usage+=i,a.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,a=r?.get(i);if(a?.parentNode===t)return r.delete(i),a.removeAttribute(tw),a;{const u=this.doc.createElement("style");return this.nonce&&u.setAttribute("nonce",this.nonce),u.textContent=i,this.platformIsServer&&u.setAttribute(tw,this.appId),u}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const a=this.styleRef,u=a.get(i)?.elements;u?u.push(r):a.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn),Me(N_),Me(dx,8),Me(Mc))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();const nw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},iw=/%COMP%/g,jU=new Re("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function rT(e,n){return n.map(t=>t.replace(iw,e))}let rw=(()=>{class e{constructor(t,i,r,a,u,p,y,E=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=a,this.doc=u,this.platformId=p,this.ngZone=y,this.nonce=E,this.rendererByCompId=new Map,this.platformIsServer=KM(p),this.defaultRenderer=new ow(t,u,y,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===rr.ShadowDom&&(i={...i,encapsulation:rr.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof sT?r.applyToHost(t):r instanceof sw&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let a=r.get(i.id);if(!a){const u=this.doc,p=this.ngZone,y=this.eventManager,E=this.sharedStylesHost,I=this.removeStylesOnCompDestroy,R=this.platformIsServer;switch(i.encapsulation){case rr.Emulated:a=new sT(y,E,i,this.appId,I,u,p,R);break;case rr.ShadowDom:return new GU(y,E,t,i,u,p,this.nonce,R);default:a=new sw(y,E,i,I,u,p,R)}r.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||e)(Me(eT),Me(nT),Me(N_),Me(jU),Me(hn),Me(Mc),Me(jt),Me(dx))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();class ow{constructor(n,t,i,r){this.eventManager=n,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(nw[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(oT(n)?n.content:n).appendChild(t)}insertBefore(n,t,i){n&&(oT(n)?n.content:n).insertBefore(t,i)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new be(-5104,!1);return t||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,i,r){if(r){t=r+":"+t;const a=nw[r];a?n.setAttributeNS(a,t,i):n.setAttribute(t,i)}else n.setAttribute(t,i)}removeAttribute(n,t,i){if(i){const r=nw[i];r?n.removeAttributeNS(r,t):n.removeAttribute(`${i}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,i,r){r&(Ca.DashCase|Ca.Important)?n.style.setProperty(t,i,r&Ca.Important?"important":""):n.style[t]=i}removeStyle(n,t,i){i&Ca.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,i){n[t]=i}setValue(n,t){n.nodeValue=t}listen(n,t,i){if("string"==typeof n&&!(n=Vu().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(i))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function oT(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class GU extends ow{constructor(n,t,i,r,a,u,p,y){super(n,a,u,y),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const E=rT(r.id,r.styles);for(const I of E){const R=document.createElement("style");p&&R.setAttribute("nonce",p),R.textContent=I,this.shadowRoot.appendChild(R)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,i){return super.insertBefore(this.nodeOrShadowRoot(n),t,i)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class sw extends ow{constructor(n,t,i,r,a,u,p,y){super(n,a,u,p),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=y?rT(y,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class sT extends sw{constructor(n,t,i,r,a,u,p,y){const E=r+"-"+i.id;super(n,t,i,a,u,p,y,E),this.contentAttr=function $U(e){return"_ngcontent-%COMP%".replace(iw,e)}(E),this.hostAttr=function HU(e){return"_nghost-%COMP%".replace(iw,e)}(E)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const i=super.createElement(n,t);return super.setAttribute(i,this.contentAttr,""),i}}let WU=(()=>{class e extends tT{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();const aT=["alt","control","meta","shift"],ZU={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},KU={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let XU=(()=>{class e extends tT{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const a=e.parseEventName(i),u=e.eventCallback(a.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Vu().onAndCancel(t,a.domEventName,u))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const a=e._normalizeKey(i.pop());let u="",p=i.indexOf("code");if(p>-1&&(i.splice(p,1),u="code."),aT.forEach(E=>{const I=i.indexOf(E);I>-1&&(i.splice(I,1),u+=E+".")}),u+=a,0!=i.length||0===a.length)return null;const y={};return y.domEventName=r,y.fullKey=u,y}static matchEventFullKeyCode(t,i){let r=ZU[t.key]||t.key,a="";return i.indexOf("code.")>-1&&(r=t.code,a="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),aT.forEach(u=>{u!==r&&(0,KU[u])(t)&&(a+=u+".")}),a+=r,a===i)}static eventCallback(t,i,r){return a=>{e.matchEventFullKeyCode(a,t)&&r.runGuarded(()=>i(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();const e5=nM(MV,"browser",[{provide:Mc,useValue:ZM},{provide:hC,useValue:function YU(){J0.makeCurrent()},multi:!0},{provide:hn,useFactory:function JU(){return function um(e){_p=e}(document),document},deps:[]}]),t5=new Re(""),uT=[{provide:py,useClass:class NU{addToWindow(n){Tn.getAngularTestability=(i,r=!0)=>{const a=n.findTestabilityInTree(i,r);if(null==a)throw new be(5103,!1);return a},Tn.getAllAngularTestabilities=()=>n.getAllTestabilities(),Tn.getAllAngularRootElements=()=>n.getAllRootElements(),Tn.frameworkStabilizers||(Tn.frameworkStabilizers=[]),Tn.frameworkStabilizers.push(i=>{const r=Tn.getAllAngularTestabilities();let a=r.length,u=!1;const p=function(y){u=u||y,a--,0==a&&i(u)};r.forEach(y=>{y.whenStable(p)})})}findTestabilityInTree(n,t,i){return null==t?null:n.getTestability(t)??(i?Vu().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:YI,useClass:S0,deps:[jt,D0,py]},{provide:S0,useClass:S0,deps:[jt,D0,py]}],dT=[{provide:ax,useValue:"root"},{provide:Ia,useFactory:function QU(){return new Ia},deps:[]},{provide:ew,useClass:WU,multi:!0,deps:[hn,jt,Mc]},{provide:ew,useClass:XU,multi:!0,deps:[hn]},rw,nT,eT,{provide:ym,useExisting:rw},{provide:class dU{},useClass:BU,deps:[]},[]];let hT=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:N_,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||e)(Me(t5,12))};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({providers:[...dT,...uT],imports:[K0,TV]})}return e})(),pT=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn))};static#t=this.\u0275prov=et({token:e,factory:function(i){let r=null;return r=i?new i:function r5(){return new pT(Me(hn))}(),r},providedIn:"root"})}return e})();typeof window<"u"&&window;let cw,lw=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(i){let r=null;return r=i?new(i||e):Me(gT),r},providedIn:"root"})}return e})(),gT=(()=>{class e extends lw{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case ho.NONE:return i;case ho.HTML:return li(i,"HTML")?Mo(i):nC(this._doc,String(i)).toString();case ho.STYLE:return li(i,"Style")?Mo(i):i;case ho.SCRIPT:if(li(i,"Script"))return Mo(i);throw new be(5200,!1);case ho.URL:return li(i,"URL")?Mo(i):R_(String(i));case ho.RESOURCE_URL:if(li(i,"ResourceURL"))return Mo(i);throw new be(5201,!1);default:throw new be(5202,!1)}}bypassSecurityTrustHtml(t){return function Qd(e){return new Xb(e)}(t)}bypassSecurityTrustStyle(t){return function Jd(e){return new Yb(e)}(t)}bypassSecurityTrustScript(t){return function k_(e){return new Qb(e)}(t)}bypassSecurityTrustUrl(t){return function Dc(e){return new Us(e)}(t)}bypassSecurityTrustResourceUrl(t){return function V2(e){return new yp(e)}(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn))};static#t=this.\u0275prov=et({token:e,factory:function(i){let r=null;return r=i?new i:function l5(e){return new gT(e.get(hn))}(Me(Jo)),r},providedIn:"root"})}return e})();try{cw=typeof Intl<"u"&&Intl.v8BreakIterator}catch{cw=!1}let Wm,uh,uw,gs=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?X0(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!cw)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Mc))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Zm(e){return function c5(){if(null==Wm&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Wm=!0}))}finally{Wm=Wm||!1}return Wm}()?e:!!e.capture}function u5(){if(null==uh){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return uh=!1,uh;if("scrollBehavior"in document.documentElement.style)uh=!0;else{const e=Element.prototype.scrollTo;uh=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return uh}function ju(e){return e.composedPath?e.composedPath()[0]:e.target}function dw(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Ly(e,...n){return n.length?n.some(t=>e[t]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function mr(e,n,t){const i=$t(e)||n||t?{next:e,error:n,complete:t}:e;return i?In((r,a)=>{var u;null===(u=i.subscribe)||void 0===u||u.call(i);let p=!0;r.subscribe(xn(a,y=>{var E;null===(E=i.next)||void 0===E||E.call(i,y),a.next(y)},()=>{var y;p=!1,null===(y=i.complete)||void 0===y||y.call(i),a.complete()},y=>{var E;p=!1,null===(E=i.error)||void 0===E||E.call(i,y),a.error(y)},()=>{var y,E;p&&(null===(y=i.unsubscribe)||void 0===y||y.call(i)),null===(E=i.finalize)||void 0===E||E.call(i)}))}):vr}class M5 extends Jt{constructor(n,t){super()}schedule(n,t=0){return this}}const Ny={setInterval(e,n,...t){const{delegate:i}=Ny;return i?.setInterval?i.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=Ny;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};class _w extends M5{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const r=this.id,a=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(a,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(a,this.id,t),this}requestAsyncId(n,t,i=0){return Ny.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Ny.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r,i=!1;try{this.work(n)}catch(a){i=!0,r=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,v(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}const xT={now:()=>(xT.delegate||Date).now(),delegate:void 0};class Xm{constructor(n,t=Xm.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}Xm.now=xT.now;class yw extends Xm{constructor(n,t=Xm.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}const By=new yw(_w),T5=By;function wT(e,n=By){return In((t,i)=>{let r=null,a=null,u=null;const p=()=>{if(r){r.unsubscribe(),r=null;const E=a;a=null,i.next(E)}};function y(){const E=u+e,I=n.now();if(I<E)return r=this.schedule(void 0,E-I),void i.add(r);p()}t.subscribe(xn(i,E=>{a=E,u=n.now(),r||(r=n.schedule(y,e),i.add(r))},()=>{p(),i.complete()},void 0,()=>{a=r=null}))})}function ji(e,n){return In((t,i)=>{let r=0;t.subscribe(xn(i,a=>e.call(n,a,r++)&&i.next(a)))})}function ET(e){return ji((n,t)=>e<=t)}function fo(e){return In((n,t)=>{Ee(e).subscribe(xn(t,()=>t.complete(),no)),!t.closed&&n.subscribe(t)})}function gr(e){return null!=e&&"false"!=`${e}`}function zy(e){return Array.isArray(e)?e:[e]}function Or(e){return null==e?"":"string"==typeof e?e:`${e}px`}function Gp(e){return e instanceof kn?e.nativeElement:e}const{isArray:R5}=Array,{getPrototypeOf:P5,prototype:F5,keys:O5}=Object;function CT(e){if(1===e.length){const n=e[0];if(R5(n))return{args:n,keys:null};if(function L5(e){return e&&"object"==typeof e&&P5(e)===F5}(n)){const t=O5(n);return{args:t.map(i=>n[i]),keys:t}}}return{args:e,keys:null}}const{isArray:N5}=Array;function vw(e){return wt(n=>function B5(e,n){return N5(n)?e(...n):e(n)}(e,n))}function ST(e,n){return e.reduce((t,i,r)=>(t[i]=n[r],t),{})}function bw(...e){const n=ea(e),t=Va(e),{args:i,keys:r}=CT(e);if(0===i.length)return ei([],n);const a=new bn(function z5(e,n,t=vr){return i=>{DT(n,()=>{const{length:r}=e,a=new Array(r);let u=r,p=r;for(let y=0;y<r;y++)DT(n,()=>{const E=ei(e[y],n);let I=!1;E.subscribe(xn(i,R=>{a[y]=R,I||(I=!0,p--),p||i.next(t(a.slice()))},()=>{--u||i.complete()}))},i)},i)}}(i,n,r?u=>ST(r,u):vr));return t?a.pipe(vw(t)):a}function DT(e,n,t){e?Vt(t,e,n):n()}function Wp(...e){return function V5(){return xt(1)}()(ei(e,ea(e)))}function _r(e){return e<=0?()=>gn:In((n,t)=>{let i=0;n.subscribe(xn(t,r=>{++i<=e&&(t.next(r),e<=i&&t.complete())}))})}function Oc(...e){const n=ea(e);return In((t,i)=>{(n?Wp(e,t,n):Wp(e,t)).subscribe(i)})}const IT=new Set;let dh,U5=(()=>{class e{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):$5}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function j5(e,n){if(!IT.has(e))try{dh||(dh=document.createElement("style"),n&&(dh.nonce=n),dh.setAttribute("type","text/css"),document.head.appendChild(dh)),dh.sheet&&(dh.sheet.insertRule(`@media ${e} {body{ }}`,0),IT.add(e))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(gs),Me(dx,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function $5(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let H5=(()=>{class e{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new St}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return MT(zy(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let a=bw(MT(zy(t)).map(u=>this._registerQuery(u).observable));return a=Wp(a.pipe(_r(1)),a.pipe(ET(1),wT(0))),a.pipe(wt(u=>{const p={matches:!1,breakpoints:{}};return u.forEach(({matches:y,query:E})=>{p.matches=p.matches||y,p.breakpoints[E]=y}),p}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),a={observable:new bn(u=>{const p=y=>this._zone.run(()=>u.next(y));return i.addListener(p),()=>{i.removeListener(p)}}).pipe(Oc(i),wt(({matches:u})=>({query:t,matches:u})),fo(this._destroySubject)),mql:i};return this._queries.set(t,a),a}static#e=this.\u0275fac=function(i){return new(i||e)(Me(U5),Me(jt))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function MT(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}class W5{constructor(n){this._items=n,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new St,this._typeaheadSubscription=Jt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new St,this.change=new St,n instanceof ah&&(this._itemChangesSubscription=n.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(n){return this._skipPredicateFn=n,this}withWrap(n=!0){return this._wrap=n,this}withVerticalOrientation(n=!0){return this._vertical=n,this}withHorizontalOrientation(n){return this._horizontal=n,this}withAllowedModifierKeys(n){return this._allowedModifierKeys=n,this}withTypeAhead(n=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(mr(t=>this._pressedLetters.push(t)),wT(n),ji(()=>this._pressedLetters.length>0),wt(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const a=(this._activeItemIndex+r)%i.length,u=i[a];if(!this._skipPredicateFn(u)&&0===u.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(a);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(n=!0){return this._homeAndEnd=n,this}withPageUpDown(n=!0,t=10){return this._pageUpAndDown={enabled:n,delta:t},this}setActiveItem(n){const t=this._activeItem;this.updateActiveItem(n),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(n){const t=n.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(a=>!n[a]||this._allowedModifierKeys.indexOf(a)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const a=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(a>0?a:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const a=this._activeItemIndex+this._pageUpAndDown.delta,u=this._getItemsArray().length;this._setActiveItemByIndex(a<u?a:u-1,-1);break}return;default:return void((r||Ly(n,"shiftKey"))&&(n.key&&1===n.key.length?this._letterKeyStream.next(n.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],n.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(n){const t=this._getItemsArray(),i="number"==typeof n?n:t.indexOf(n);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(n){this._wrap?this._setActiveInWrapMode(n):this._setActiveInDefaultMode(n)}_setActiveInWrapMode(n){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+n*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(n){this._setActiveItemByIndex(this._activeItemIndex+n,n)}_setActiveItemByIndex(n,t){const i=this._getItemsArray();if(i[n]){for(;this._skipPredicateFn(i[n]);)if(!i[n+=t])return;this.setActiveItem(n)}}_getItemsArray(){return this._items instanceof ah?this._items.toArray():this._items}}class kT extends W5{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(n){return this._origin=n,this}setActiveItem(n){super.setActiveItem(n),this.activeItem&&this.activeItem.focus(this._origin)}}function xw(e){return 0===e.buttons||0===e.offsetX&&0===e.offsetY}function ww(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const J5=new Re("cdk-input-modality-detector-options"),e4={ignoreKeys:[18,17,224,91,16]},Zp=Zm({passive:!0,capture:!0});let t4=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(t,i,r,a){this._platform=t,this._mostRecentTarget=null,this._modality=new wi(null),this._lastTouchMs=0,this._onKeydown=u=>{this._options?.ignoreKeys?.some(p=>p===u.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=ju(u))},this._onMousedown=u=>{Date.now()-this._lastTouchMs<650||(this._modality.next(xw(u)?"keyboard":"mouse"),this._mostRecentTarget=ju(u))},this._onTouchstart=u=>{ww(u)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=ju(u))},this._options={...e4,...a},this.modalityDetected=this._modality.pipe(ET(1)),this.modalityChanged=this.modalityDetected.pipe(Xc()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Zp),r.addEventListener("mousedown",this._onMousedown,Zp),r.addEventListener("touchstart",this._onTouchstart,Zp)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Zp),document.removeEventListener("mousedown",this._onMousedown,Zp),document.removeEventListener("touchstart",this._onTouchstart,Zp))}static#e=this.\u0275fac=function(i){return new(i||e)(Me(gs),Me(jt),Me(hn),Me(J5,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const i4=new Re("cdk-focus-monitor-default-options"),Vy=Zm({passive:!0,capture:!0});let Ym=(()=>{class e{constructor(t,i,r,a,u){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new St,this._rootNodeFocusAndBlurListener=p=>{for(let E=ju(p);E;E=E.parentElement)"focus"===p.type?this._onFocus(p,E):this._onBlur(p,E)},this._document=a,this._detectionMode=u?.detectionMode||0}monitor(t,i=!1){const r=Gp(t);if(!this._platform.isBrowser||1!==r.nodeType)return _t();const a=function h5(e){if(function d5(){if(null==uw){const e=typeof document<"u"?document.head:null;uw=!(!e||!e.createShadowRoot&&!e.attachShadow)}return uw}()){const n=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(r)||this._getDocument(),u=this._elementInfo.get(r);if(u)return i&&(u.checkChildren=!0),u.subject;const p={checkChildren:i,subject:new St,rootNode:a};return this._elementInfo.set(r,p),this._registerGlobalListeners(p),p.subject}stopMonitoring(t){const i=Gp(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const a=Gp(t);a===this._getDocument().activeElement?this._getClosestElementsInfo(a).forEach(([p,y])=>this._originChanged(p,i,y)):(this._setOrigin(i),"function"==typeof a.focus&&a.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),a=ju(t);!r||!r.checkChildren&&i!==a||this._originChanged(i,this._getFocusOrigin(a),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Vy),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Vy)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(fo(this._stopInputModalityDetector)).subscribe(a=>{this._setOrigin(a,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Vy),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Vy),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,a)=>{(a===t||r.checkChildren&&a.contains(t))&&i.push([a,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const a=t.labels;if(a)for(let u=0;u<a.length;u++)if(a[u].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||e)(Me(jt),Me(gs),Me(t4),Me(hn,8),Me(i4,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const FT="cdk-high-contrast-black-on-white",OT="cdk-high-contrast-white-on-black",Ew="cdk-high-contrast-active";let r4=(()=>{class e{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Qe(H5).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,a=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(Ew,FT,OT),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(Ew,FT):2===i&&t.add(Ew,OT)}}static#e=this.\u0275fac=function(i){return new(i||e)(Me(gs),Me(hn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const o4=new Re("cdk-dir-doc",{providedIn:"root",factory:function s4(){return Qe(hn)}}),a4=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Uy=(()=>{class e{constructor(t){this.value="ltr",this.change=new Dn,t&&(this.value=function l4(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?a4.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||e)(Me(o4,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Qm=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({})}return e})();const u4=new Re("mat-sanity-checks",{providedIn:"root",factory:function c4(){return!0}});let Pa=(()=>{class e{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!dw()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||e)(Me(r4),Me(u4,8),Me(hn))};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({imports:[Qm,Qm]})}return e})();function Cw(e){return class extends e{get disabled(){return this._disabled}set disabled(n){this._disabled=gr(n)}constructor(...n){super(...n),this._disabled=!1}}}function jy(e,n){return class extends e{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=n,this.color=n}}}function Sw(e){return class extends e{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=gr(n)}constructor(...n){super(...n),this._disableRipple=!1}}}function Dw(e,n=0){return class extends e{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?function A5(e,n=0){return function k5(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):n}(t):this.defaultTabIndex}constructor(...t){super(...t),this._tabIndex=n,this.defaultTabIndex=n}}}let BT=(()=>{class e{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class p4{constructor(n,t,i,r=!1){this._renderer=n,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const zT=Zm({passive:!0,capture:!0});class f4{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const t=ju(n);t&&this._events.get(n.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(a=>a.handleEvent(n))})}}addHandler(n,t,i,r){const a=this._events.get(t);if(a){const u=a.get(i);u?u.add(r):a.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,zT)})}removeHandler(n,t,i){const r=this._events.get(n);if(!r)return;const a=r.get(t);a&&(a.delete(i),0===a.size&&r.delete(t),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,zT)))}}const VT={enterDuration:225,exitDuration:150},UT=Zm({passive:!0,capture:!0}),jT=["mousedown","touchstart"],$T=["mouseup","mouseleave","touchend","touchcancel"];class $y{static#e=this._eventManager=new f4;constructor(n,t,i,r){this._target=n,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Gp(i))}fadeInRipple(n,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),a={...VT,...i.animation};i.centered&&(n=r.left+r.width/2,t=r.top+r.height/2);const u=i.radius||function g4(e,n,t){const i=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),r=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(i*i+r*r)}(n,t,r),p=n-r.left,y=t-r.top,E=a.enterDuration,I=document.createElement("div");I.classList.add("mat-ripple-element"),I.style.left=p-u+"px",I.style.top=y-u+"px",I.style.height=2*u+"px",I.style.width=2*u+"px",null!=i.color&&(I.style.backgroundColor=i.color),I.style.transitionDuration=`${E}ms`,this._containerElement.appendChild(I);const R=window.getComputedStyle(I),H=R.transitionDuration,X="none"===R.transitionProperty||"0s"===H||"0s, 0s"===H||0===r.width&&0===r.height,re=new p4(this,I,i,X);I.style.transform="scale3d(1, 1, 1)",re.state=0,i.persistent||(this._mostRecentTransientRipple=re);let _e=null;return!X&&(E||a.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Se=()=>this._finishRippleTransition(re),ye=()=>this._destroyRipple(re);I.addEventListener("transitionend",Se),I.addEventListener("transitioncancel",ye),_e={onTransitionEnd:Se,onTransitionCancel:ye}}),this._activeRipples.set(re,_e),(X||!E)&&this._finishRippleTransition(re),re}fadeOutRipple(n){if(2===n.state||3===n.state)return;const t=n.element,i={...VT,...n.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=Gp(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,jT.forEach(i=>{$y._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{$T.forEach(t=>{this._triggerElement.addEventListener(t,this,UT)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:i}=n.config;n.state=1,!i&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel)),n.element.remove()}_onMousedown(n){const t=xw(n),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!ww(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(jT.forEach(t=>$y._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&$T.forEach(t=>n.removeEventListener(t,this,UT)))}}const Hy=new Re("mat-ripple-global-options");let HT=(()=>{class e{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,a,u){this._elementRef=t,this._animationMode=u,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=a||{},this._rippleRenderer=new $y(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(jt),me(gs),me(Hy,8),me(Tc,8))};static#t=this.\u0275dir=ct({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&po("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return e})(),Iw=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({imports:[Pa,Pa]})}return e})();const qT={capture:!0},GT=["focus","click","mouseenter","touchstart"],Mw="mat-ripple-loader-uninitialized",Tw="mat-ripple-loader-class-name",WT="mat-ripple-loader-centered",qy="mat-ripple-loader-disabled";let ZT=(()=>{class e{constructor(){this._document=Qe(hn,{optional:!0}),this._animationMode=Qe(Tc,{optional:!0}),this._globalRippleOptions=Qe(Hy,{optional:!0}),this._platform=Qe(gs),this._ngZone=Qe(jt),this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;const r=t.target.closest(`[${Mw}]`);r&&this.createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const t of GT)this._document?.addEventListener(t,this._onInteraction,qT)})}ngOnDestroy(){for(const t of GT)this._document?.removeEventListener(t,this._onInteraction,qT)}configureRipple(t,i){t.setAttribute(Mw,""),(i.className||!t.hasAttribute(Tw))&&t.setAttribute(Tw,i.className||""),i.centered&&t.setAttribute(WT,""),i.disabled&&t.setAttribute(qy,"")}getRipple(t){return t.matRipple?t.matRipple:this.createRipple(t)}setDisabled(t,i){const r=t.matRipple;r?r.disabled=i:i?t.setAttribute(qy,""):t.removeAttribute(qy)}createRipple(t){if(!this._document)return;t.querySelector(".mat-ripple")?.remove();const i=this._document.createElement("span");i.classList.add("mat-ripple",t.getAttribute(Tw)),t.append(i);const r=new HT(new kn(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=t,r.centered=t.hasAttribute(WT),r.disabled=t.hasAttribute(qy),this.attachRipple(t,r),r}attachRipple(t,i){t.removeAttribute(Mw),t.matRipple=i}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function hh(e,n){const t=$t(e)?e:()=>e,i=r=>r.error(t());return new bn(n?r=>n.schedule(i,0,r):i)}function $u(e){return In((n,t)=>{let a,i=null,r=!1;i=n.subscribe(xn(t,void 0,void 0,u=>{a=Ee(e(u,$u(e)(n))),i?(i.unsubscribe(),i=null,a.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,a.subscribe(t))})}function Gy(e){return In((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function eg(e,n){return $t(n)?tn(e,n,1):tn(e,1)}class Aw{}class Lc{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),a=r.toLowerCase(),u=t.slice(i+1).trim();this.maybeSetNormalizedName(r,a),this.headers.has(a)?this.headers.get(a).push(u):this.headers.set(a,[u])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof Lc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new Lc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Lc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,t);const r=("a"===n.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const a=n.value;if(a){let u=this.headers.get(t);if(!u)return;u=u.filter(p=>-1===a.indexOf(p)),0===u.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,u)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const i=(Array.isArray(t)?t:[t]).map(a=>a.toString()),r=n.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(n,r)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class _4{encodeKey(n){return XT(n)}encodeValue(n){return XT(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const v4=/%(\d[a-f0-9])/gi,b4={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function XT(e){return encodeURIComponent(e).replace(v4,(n,t)=>b4[t]??n)}function Wy(e){return`${e}`}class Hu{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new _4,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function y4(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const a=r.indexOf("="),[u,p]=-1==a?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,a)),n.decodeValue(r.slice(a+1))],y=t.get(u)||[];y.push(p),t.set(u,y)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const i=n.fromObject[t],r=Array.isArray(i)?i.map(Wy):[Wy(i)];this.map.set(t,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(i=>{const r=n[i];Array.isArray(r)?r.forEach(a=>{t.push({param:i,value:a,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new Hu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(Wy(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const r=i.indexOf(Wy(n.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class x4{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function YT(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function QT(e){return typeof Blob<"u"&&e instanceof Blob}function JT(e){return typeof FormData<"u"&&e instanceof FormData}class tg{constructor(n,t,i,r){let a;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function w4(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,a=r):a=i,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new Lc),this.context||(this.context=new x4),this.params){const u=this.params.toString();if(0===u.length)this.urlWithParams=t;else{const p=t.indexOf("?");this.urlWithParams=t+(-1===p?"?":p<t.length-1?"&":"")+u}}else this.params=new Hu,this.urlWithParams=t}serializeBody(){return null===this.body?null:YT(this.body)||QT(this.body)||JT(this.body)||function E4(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Hu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||JT(this.body)?null:QT(this.body)?this.body.type||null:YT(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Hu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,i=n.url||this.url,r=n.responseType||this.responseType,a=void 0!==n.body?n.body:this.body,u=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,p=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let y=n.headers||this.headers,E=n.params||this.params;const I=n.context??this.context;return void 0!==n.setHeaders&&(y=Object.keys(n.setHeaders).reduce((R,B)=>R.set(B,n.setHeaders[B]),y)),n.setParams&&(E=Object.keys(n.setParams).reduce((R,B)=>R.set(B,n.setParams[B]),E)),new tg(t,i,a,{params:E,headers:y,context:I,reportProgress:p,responseType:r,withCredentials:u})}}var Rw=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(Rw||{});class C4{constructor(n,t=200,i="OK"){this.headers=n.headers||new Lc,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class ng extends C4{constructor(n={}){super(n),this.type=Rw.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new ng({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}function Pw(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let Fw=(()=>{class e{constructor(t){this.handler=t}request(t,i,r={}){let a;if(t instanceof tg)a=t;else{let y,E;y=r.headers instanceof Lc?r.headers:new Lc(r.headers),r.params&&(E=r.params instanceof Hu?r.params:new Hu({fromObject:r.params})),a=new tg(t,i,void 0!==r.body?r.body:null,{headers:y,context:r.context,params:E,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const u=_t(a).pipe(eg(y=>this.handler.handle(y)));if(t instanceof tg||"events"===r.observe)return u;const p=u.pipe(ji(y=>y instanceof ng));switch(r.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return p.pipe(wt(y=>{if(null!==y.body&&!(y.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return y.body}));case"blob":return p.pipe(wt(y=>{if(null!==y.body&&!(y.body instanceof Blob))throw new Error("Response is not a Blob.");return y.body}));case"text":return p.pipe(wt(y=>{if(null!==y.body&&"string"!=typeof y.body)throw new Error("Response is not a string.");return y.body}));default:return p.pipe(wt(y=>y.body))}case"response":return p;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Hu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Pw(r,i))}post(t,i,r={}){return this.request("POST",t,Pw(r,i))}put(t,i,r={}){return this.request("PUT",t,Pw(r,i))}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Aw))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();const H4=["*"];let Xy;function ig(e){return function q4(){if(void 0===Xy&&(Xy=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(Xy=e.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return Xy}()?.createHTML(e)||e}function cA(e){return Error(`Unable to find icon with the name "${e}"`)}function uA(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function dA(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class fh{constructor(n,t,i){this.url=n,this.svgText=t,this.options=i}}let Yy=(()=>{class e{constructor(t,i,r,a){this._httpClient=t,this._sanitizer=i,this._errorHandler=a,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,a){return this._addSvgIconConfig(t,i,new fh(r,null,a))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,a){const u=this._sanitizer.sanitize(ho.HTML,r);if(!u)throw dA(r);const p=ig(u);return this._addSvgIconConfig(t,i,new fh("",p,a))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new fh(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const a=this._sanitizer.sanitize(ho.HTML,i);if(!a)throw dA(i);const u=ig(a);return this._addSvgIconSetConfig(t,new fh("",u,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(ho.RESOURCE_URL,t);if(!i)throw uA(t);const r=this._cachedIconsByUrl.get(i);return r?_t(Qy(r)):this._loadSvgIconFromConfig(new fh(t,null)).pipe(mr(a=>this._cachedIconsByUrl.set(i,a)),wt(a=>Qy(a)))}getNamedSvgIcon(t,i=""){const r=hA(i,t);let a=this._svgIconConfigs.get(r);if(a)return this._getSvgFromConfig(a);if(a=this._getIconConfigFromResolvers(i,t),a)return this._svgIconConfigs.set(r,a),this._getSvgFromConfig(a);const u=this._iconSetConfigs.get(i);return u?this._getSvgFromIconSetConfigs(t,u):hh(cA(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?_t(Qy(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(wt(i=>Qy(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?_t(r):function KT(...e){const n=Va(e),{args:t,keys:i}=CT(e),r=new bn(a=>{const{length:u}=t;if(!u)return void a.complete();const p=new Array(u);let y=u,E=u;for(let I=0;I<u;I++){let R=!1;Ee(t[I]).subscribe(xn(a,B=>{R||(R=!0,E--),p[I]=B},()=>y--,void 0,()=>{(!y||!R)&&(E||a.next(i?ST(i,p):p),a.complete())}))}});return n?r.pipe(vw(n)):r}(i.filter(u=>!u.svgText).map(u=>this._loadSvgIconSetFromConfig(u).pipe($u(p=>{const E=`Loading icon set URL: ${this._sanitizer.sanitize(ho.RESOURCE_URL,u.url)} failed: ${p.message}`;return this._errorHandler.handleError(new Error(E)),_t(null)})))).pipe(wt(()=>{const u=this._extractIconWithNameFromAnySet(t,i);if(!u)throw cA(t);return u}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const a=i[r];if(a.svgText&&a.svgText.toString().indexOf(t)>-1){const u=this._svgElementFromConfig(a),p=this._extractSvgIconFromSet(u,t,a.options);if(p)return p}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(mr(i=>t.svgText=i),wt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?_t(null):this._fetchIcon(t).pipe(mr(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const a=t.querySelector(`[id="${i}"]`);if(!a)return null;const u=a.cloneNode(!0);if(u.removeAttribute("id"),"svg"===u.nodeName.toLowerCase())return this._setSvgAttributes(u,r);if("symbol"===u.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(u),r);const p=this._svgElementFromString(ig("<svg></svg>"));return p.appendChild(u),this._setSvgAttributes(p,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(ig("<svg></svg>")),r=t.attributes;for(let a=0;a<r.length;a++){const{name:u,value:p}=r[a];"id"!==u&&i.setAttribute(u,p)}for(let a=0;a<t.childNodes.length;a++)t.childNodes[a].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[a].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,a=r?.withCredentials??!1;if(!this._httpClient)throw function G4(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const u=this._sanitizer.sanitize(ho.RESOURCE_URL,i);if(!u)throw uA(i);const p=this._inProgressUrlFetches.get(u);if(p)return p;const y=this._httpClient.get(u,{responseType:"text",withCredentials:a}).pipe(wt(E=>ig(E)),Gy(()=>this._inProgressUrlFetches.delete(u)),vl());return this._inProgressUrlFetches.set(u,y),y}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(hA(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const a=this._resolvers[r](i,t);if(a)return Z4(a)?new fh(a.url,null,a.options):new fh(a,null)}}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Fw,8),Me(lw),Me(hn,8),Me(Ia))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Qy(e){return e.cloneNode(!0)}function hA(e,n){return e+":"+n}function Z4(e){return!(!e.url||!e.options)}const K4=jy(class{constructor(e){this._elementRef=e}}),X4=new Re("MAT_ICON_DEFAULT_OPTIONS"),Y4=new Re("mat-icon-location",{providedIn:"root",factory:function Q4(){const e=Qe(hn),n=e?e.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),pA=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],J4=pA.map(e=>`[${e}]`).join(", "),ej=/^url\(['"]?#(.*?)['"]?\)$/;let tj=(()=>{class e extends K4{get inline(){return this._inline}set inline(t){this._inline=gr(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,a,u,p){super(t),this._iconRegistry=i,this._location=a,this._errorHandler=u,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Jt.EMPTY,p&&(p.color&&(this.color=this.defaultColor=p.color),p.fontSet&&(this.fontSet=p.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,a)=>{r.forEach(u=>{a.setAttribute(u.name,`url('${t}#${u.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(J4),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let a=0;a<i.length;a++)pA.forEach(u=>{const p=i[a],y=p.getAttribute(u),E=y?y.match(ej):null;if(E){let I=r.get(p);I||(I=[],r.set(p,I)),I.push({name:u,value:E[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(_r(1)).subscribe(a=>this._setSvgElement(a),a=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${a.message}`))})}}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(Yy),Za("aria-hidden"),me(Y4),me(Ia),me(X4,8))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(i,r){2&i&&(Qn("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),po("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Nt],ngContentSelectors:H4,decls:1,vars:0,template:function(i,r){1&i&&($s(),ki(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return e})(),nj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({imports:[Pa,Pa]})}return e})();const ij=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],rj=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],fA=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}",mA=["mat-icon-button",""],oj=["*"],aj=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],lj=jy(Cw(Sw(class{constructor(e){this._elementRef=e}})));let gA=(()=>{class e extends lj{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=gr(t),this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=gr(t),this._updateRippleDisabled()}constructor(t,i,r,a){super(t),this._platform=i,this._ngZone=r,this._animationMode=a,this._focusMonitor=Qe(Ym),this._rippleLoader=Qe(ZT),this._isFab=!1,this._disableRipple=!1,this._disabled=!1,this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-button-ripple"});const u=t.nativeElement.classList;for(const p of aj)this._hasHostAttributes(p.selector)&&p.mdcClasses.forEach(y=>{u.add(y)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){Ax()};static#t=this.\u0275dir=ct({type:e,features:[Nt]})}return e})(),uj=(()=>{class e extends gA{constructor(t,i,r,a){super(t,i,r,a),this._haltDisabledEvents=u=>{this.disabled&&(u.preventDefault(),u.stopImmediatePropagation())}}ngOnInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)})}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}static#e=this.\u0275fac=function(i){Ax()};static#t=this.\u0275dir=ct({type:e,features:[Nt]})}return e})(),hj=(()=>{class e extends gA{constructor(t,i,r,a){super(t,i,r,a),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(gs),me(jt),me(Tc,8))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(i,r){2&i&&(Qn("disabled",r.disabled||null),po("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Nt],attrs:mA,ngContentSelectors:oj,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&($s(),pr(0,"span",0),ki(1),pr(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',fA],encapsulation:2,changeDetection:0})}return e})(),pj=(()=>{class e extends uj{constructor(t,i,r,a){super(t,i,r,a)}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(gs),me(jt),me(Tc,8))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["a","mat-icon-button",""]],hostVars:9,hostBindings:function(i,r){2&i&&(Qn("disabled",r.disabled||null)("tabindex",r.disabled?-1:r.tabIndex)("aria-disabled",r.disabled.toString()),po("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[Nt],attrs:mA,ngContentSelectors:rj,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&($s(ij),pr(0,"span",0),ki(1),Kt(2,"span",1),ki(3,1),vn(),ki(4,2),pr(5,"span",2)(6,"span",3)),2&i&&po("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',fA],encapsulation:2,changeDetection:0})}return e})(),fj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({imports:[Pa,Iw,Pa]})}return e})();const mj=["*",[["mat-toolbar-row"]]],gj=["*","mat-toolbar-row"],_j=jy(class{constructor(e){this._elementRef=e}});let yj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=ct({type:e,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return e})(),vj=(()=>{class e extends _j{constructor(t,i,r){super(t),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(gs),me(hn))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["mat-toolbar"]],contentQueries:function(i,r,a){if(1&i&&ko(a,yj,5),2&i){let u;Rr(u=Pr())&&(r._toolbarRows=u)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(i,r){2&i&&po("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",0===r._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Nt],ngContentSelectors:gj,decls:2,vars:0,template:function(i,r){1&i&&($s(mj),ki(0),ki(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}return e})(),bj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({imports:[Pa,Pa]})}return e})();class bk{}class b${}const Bc="*";function t1(e,n){return{type:7,name:e,definitions:n,options:{}}}function uv(e,n=null){return{type:4,styles:n,timings:e}}function xk(e,n=null){return{type:2,steps:e,options:n}}function zc(e){return{type:6,styles:e,offset:null}}function n1(e,n,t){return{type:0,name:e,styles:n,options:t}}function dv(e,n,t=null){return{type:1,expr:e,animation:n,options:t}}class cg{constructor(n=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class wk{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let t=0,i=0,r=0;const a=this.players.length;0==a?queueMicrotask(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++t==a&&this._onFinish()}),u.onDestroy(()=>{++i==a&&this._onDestroy()}),u.onStart(()=>{++r==a&&this._onStart()})}),this.totalTime=this.players.reduce((u,p)=>Math.max(u,p.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const t=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function T$(e,n){1&e&&(Kt(0,"span",7),ki(1,1),vn())}function A$(e,n){1&e&&(Kt(0,"span",8),ki(1,2),vn())}const Ek=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],Ck=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"];function k$(e,n){1&e&&(Kt(0,"span",8),ki(1,1),Kt(2,"span",9),Vf(),Kt(3,"svg",10),pr(4,"path",11),vn()()())}function R$(e,n){1&e&&(Kt(0,"span",12),ki(1,2),vn())}const hv=new Re("mat-chips-default-options"),s1=new Re("MatChipAvatar"),a1=new Re("MatChipTrailingIcon"),l1=new Re("MatChipRemove"),pv=new Re("MatChip");class j${}const $$=Dw(j$,-1);let Xp=(()=>{class e extends $${get disabled(){return this._disabled||this._parentChip.disabled}set disabled(t){this._disabled=gr(t)}_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(t,i){super(),this._elementRef=t,this._parentChip=i,this.isInteractive=!0,this._isPrimary=!0,this._disabled=!1,this._allowFocusWhenDisabled=!1,"BUTTON"===t.nativeElement.nodeName&&t.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(t){!this.disabled&&this.isInteractive&&this._isPrimary&&(t.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(t.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(pv))};static#t=this.\u0275dir=ct({type:e,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(i,r){1&i&&Ui("click",function(u){return r._handleClick(u)})("keydown",function(u){return r._handleKeydown(u)}),2&i&&(Qn("tabindex",r._getTabindex())("disabled",r._getDisabledAttribute())("aria-disabled",r.disabled),po("mdc-evolution-chip__action--primary",r._isPrimary)("mdc-evolution-chip__action--presentational",!r.isInteractive)("mdc-evolution-chip__action--trailing",!r._isPrimary))},inputs:{disabled:"disabled",tabIndex:"tabIndex",isInteractive:"isInteractive",_allowFocusWhenDisabled:"_allowFocusWhenDisabled"},features:[Nt]})}return e})(),W$=0;const Z$=Dw(jy(Sw(Cw(class{constructor(e){this._elementRef=e}})),"primary"),-1);let d1,Yp=(()=>{class e extends Z${_hasFocus(){return this._hasFocusInternal}get value(){return void 0!==this._value?this._value:this._textElement.textContent.trim()}set value(t){this._value=t}get removable(){return this._removable}set removable(t){this._removable=gr(t)}get highlighted(){return this._highlighted}set highlighted(t){this._highlighted=gr(t)}get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}constructor(t,i,r,a,u,p,y,E){super(i),this._changeDetectorRef=t,this._ngZone=r,this._focusMonitor=a,this._globalRippleOptions=y,this._onFocus=new St,this._onBlur=new St,this.role=null,this._hasFocusInternal=!1,this.id="mat-mdc-chip-"+W$++,this.ariaLabel=null,this.ariaDescription=null,this._ariaDescriptionId=`${this.id}-aria-description`,this._removable=!0,this._highlighted=!1,this.removed=new Dn,this.destroyed=new Dn,this.basicChipAttrName="mat-basic-chip",this._rippleLoader=Qe(ZT),this._document=u,this._animationsDisabled="NoopAnimations"===p,null!=E&&(this.tabIndex=parseInt(E)??this.defaultTabIndex),this._monitorFocus(),this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-chip-ripple",disabled:this._isRippleDisabled()})}ngOnInit(){const t=this._elementRef.nativeElement;this._isBasicChip=t.hasAttribute(this.basicChipAttrName)||t.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=Ht(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngDoCheck(){this._rippleLoader.setDisabled(this._elementRef.nativeElement,this._isRippleDisabled())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!(!this.trailingIcon&&!this.removeIcon)}_handleKeydown(t){(8===t.keyCode||46===t.keyCode)&&(t.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(t){return this._getActions().find(i=>{const r=i._elementRef.nativeElement;return r===t||r.contains(t)})}_getActions(){const t=[];return this.primaryAction&&t.push(this.primaryAction),this.removeIcon&&t.push(this.removeIcon),this.trailingIcon&&t.push(this.trailingIcon),t}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{const i=null!==t;i!==this._hasFocusInternal&&(this._hasFocusInternal=i,i?this._onFocus.next({chip:this}):this._ngZone.onStable.pipe(_r(1)).subscribe(()=>this._ngZone.run(()=>this._onBlur.next({chip:this}))))})}static#e=this.\u0275fac=function(i){return new(i||e)(me(Aa),me(kn),me(jt),me(Ym),me(hn),me(Tc,8),me(Hy,8),Za("tabindex"))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(i,r,a){if(1&i&&(ko(a,s1,5),ko(a,a1,5),ko(a,l1,5),ko(a,s1,5),ko(a,a1,5),ko(a,l1,5)),2&i){let u;Rr(u=Pr())&&(r.leadingIcon=u.first),Rr(u=Pr())&&(r.trailingIcon=u.first),Rr(u=Pr())&&(r.removeIcon=u.first),Rr(u=Pr())&&(r._allLeadingIcons=u),Rr(u=Pr())&&(r._allTrailingIcons=u),Rr(u=Pr())&&(r._allRemoveIcons=u)}},viewQuery:function(i,r){if(1&i&&Bm(Xp,5),2&i){let a;Rr(a=Pr())&&(r.primaryAction=a.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:30,hostBindings:function(i,r){1&i&&Ui("keydown",function(u){return r._handleKeydown(u)}),2&i&&(Nu("id",r.id),Qn("role",r.role)("tabindex",r.role?r.tabIndex:null)("aria-label",r.ariaLabel),po("mdc-evolution-chip",!r._isBasicChip)("mdc-evolution-chip--disabled",r.disabled)("mdc-evolution-chip--with-trailing-action",r._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",r.leadingIcon)("mdc-evolution-chip--with-primary-icon",r.leadingIcon)("mdc-evolution-chip--with-avatar",r.leadingIcon)("mat-mdc-chip-with-avatar",r.leadingIcon)("mat-mdc-chip-highlighted",r.highlighted)("mat-mdc-chip-disabled",r.disabled)("mat-mdc-basic-chip",r._isBasicChip)("mat-mdc-standard-chip",!r._isBasicChip)("mat-mdc-chip-with-trailing-icon",r._hasTrailingIcon())("_mat-animation-noopable",r._animationsDisabled))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaDescription:["aria-description","ariaDescription"],value:"value",removable:"removable",highlighted:"highlighted"},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[Rn([{provide:pv,useExisting:e}]),Nt],ngContentSelectors:Ck,decls:8,vars:3,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(i,r){1&i&&($s(Ek),pr(0,"span",0),Kt(1,"span",1)(2,"span",2),ps(3,T$,2,0,"span",3),Kt(4,"span",4),ki(5),pr(6,"span",5),vn()()(),ps(7,A$,2,0,"span",6)),2&i&&(Ai(2),Xi("isInteractive",!1),Ai(1),Xi("ngIf",r.leadingIcon),Ai(4),Xi("ngIf",r._hasTrailingIcon()))},dependencies:[Hm,Xp],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius);height:var(--mdc-chip-container-height);--mdc-chip-container-shape-family:rounded;--mdc-chip-container-shape-radius:16px 16px 16px 16px;--mdc-chip-with-avatar-avatar-shape-family:rounded;--mdc-chip-with-avatar-avatar-shape-radius:14px 14px 14px 14px;--mdc-chip-with-avatar-avatar-size:28px;--mdc-chip-with-icon-icon-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size);width:var(--mdc-chip-with-avatar-avatar-size);font-size:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font);line-height:var(--mdc-chip-label-text-line-height);font-size:var(--mdc-chip-label-text-size);font-weight:var(--mdc-chip-label-text-weight);letter-spacing:var(--mdc-chip-label-text-tracking)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size);width:var(--mdc-chip-with-icon-icon-size);font-size:var(--mdc-chip-with-icon-icon-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary.mdc-ripple-upgraded--background-focused .mdc-evolution-chip__ripple::before,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:not(.mdc-ripple-upgraded):focus .mdc-evolution-chip__ripple::before{transition-duration:75ms;opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color);opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{flex-basis:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})(),c1=(()=>{class e extends Yp{constructor(){super(...arguments),this._defaultOptions=Qe(hv,{optional:!0}),this.chipListSelectable=!0,this._chipListMultiple=!1,this._chipListHideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._selectable=!0,this._selected=!1,this.basicChipAttrName="mat-basic-chip-option",this.selectionChange=new Dn}get selectable(){return this._selectable&&this.chipListSelectable}set selectable(t){this._selectable=gr(t),this._changeDetectorRef.markForCheck()}get selected(){return this._selected}set selected(t){this._setSelectedState(gr(t),!1,!0)}get ariaSelected(){return this.selectable?this.selected.toString():null}ngOnInit(){super.ngOnInit(),this.role="presentation"}select(){this._setSelectedState(!0,!1,!0)}deselect(){this._setSelectedState(!1,!1,!0)}selectViaInteraction(){this._setSelectedState(!0,!0,!0)}toggleSelected(t=!1){return this._setSelectedState(!this.selected,t,!0),this.selected}_handlePrimaryActionInteraction(){this.disabled||(this.focus(),this.selectable&&this.toggleSelected(!0))}_hasLeadingGraphic(){return!!this.leadingIcon||!this._chipListHideSingleSelectionIndicator||this._chipListMultiple}_setSelectedState(t,i,r){t!==this.selected&&(this._selected=t,r&&this.selectionChange.emit({source:this,isUserInput:i,selected:this.selected}),this._changeDetectorRef.markForCheck())}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Ii(e)))(r||e)}}();static#t=this.\u0275cmp=Ci({type:e,selectors:[["mat-basic-chip-option"],["","mat-basic-chip-option",""],["mat-chip-option"],["","mat-chip-option",""]],hostAttrs:[1,"mat-mdc-chip","mat-mdc-chip-option"],hostVars:37,hostBindings:function(i,r){2&i&&(Nu("id",r.id),Qn("tabindex",null)("aria-label",null)("aria-description",null)("role",r.role),po("mdc-evolution-chip",!r._isBasicChip)("mdc-evolution-chip--filter",!r._isBasicChip)("mdc-evolution-chip--selectable",!r._isBasicChip)("mat-mdc-chip-selected",r.selected)("mat-mdc-chip-multiple",r._chipListMultiple)("mat-mdc-chip-disabled",r.disabled)("mat-mdc-chip-with-avatar",r.leadingIcon)("mdc-evolution-chip--disabled",r.disabled)("mdc-evolution-chip--selected",r.selected)("mdc-evolution-chip--selecting",!r._animationsDisabled)("mdc-evolution-chip--with-trailing-action",r._hasTrailingIcon())("mdc-evolution-chip--with-primary-icon",r.leadingIcon)("mdc-evolution-chip--with-primary-graphic",r._hasLeadingGraphic())("mdc-evolution-chip--with-avatar",r.leadingIcon)("mat-mdc-chip-highlighted",r.highlighted)("mat-mdc-chip-with-trailing-icon",r._hasTrailingIcon()))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",selectable:"selectable",selected:"selected"},outputs:{selectionChange:"selectionChange"},features:[Rn([{provide:Yp,useExisting:e},{provide:pv,useExisting:e}]),Nt],ngContentSelectors:Ck,decls:10,vars:9,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","","role","option",3,"tabIndex","_allowFocusWhenDisabled"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"cdk-visually-hidden",3,"id"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__checkmark"],["viewBox","-2 -3 30 30","focusable","false","aria-hidden","true",1,"mdc-evolution-chip__checkmark-svg"],["fill","none","stroke","currentColor","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-evolution-chip__checkmark-path"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(i,r){1&i&&($s(Ek),pr(0,"span",0),Kt(1,"span",1)(2,"button",2),ps(3,k$,5,0,"span",3),Kt(4,"span",4),ki(5),pr(6,"span",5),vn()()(),ps(7,R$,2,0,"span",6),Kt(8,"span",7),Ao(9),vn()),2&i&&(Ai(2),Xi("tabIndex",r.tabIndex)("_allowFocusWhenDisabled",!0),Qn("aria-selected",r.ariaSelected)("aria-label",r.ariaLabel)("aria-describedby",r._ariaDescriptionId),Ai(1),Xi("ngIf",r._hasLeadingGraphic()),Ai(4),Xi("ngIf",r._hasTrailingIcon()),Ai(1),Xi("id",r._ariaDescriptionId),Ai(1),Am(r.ariaDescription))},dependencies:[Hm,Xp],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius);height:var(--mdc-chip-container-height);--mdc-chip-container-shape-family:rounded;--mdc-chip-container-shape-radius:16px 16px 16px 16px;--mdc-chip-with-avatar-avatar-shape-family:rounded;--mdc-chip-with-avatar-avatar-shape-radius:14px 14px 14px 14px;--mdc-chip-with-avatar-avatar-size:28px;--mdc-chip-with-icon-icon-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size);width:var(--mdc-chip-with-avatar-avatar-size);font-size:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font);line-height:var(--mdc-chip-label-text-line-height);font-size:var(--mdc-chip-label-text-size);font-weight:var(--mdc-chip-label-text-weight);letter-spacing:var(--mdc-chip-label-text-tracking)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size);width:var(--mdc-chip-with-icon-icon-size);font-size:var(--mdc-chip-with-icon-icon-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary.mdc-ripple-upgraded--background-focused .mdc-evolution-chip__ripple::before,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:not(.mdc-ripple-upgraded):focus .mdc-evolution-chip__ripple::before{transition-duration:75ms;opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color);opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{flex-basis:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})(),r6=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({providers:[BT,{provide:hv,useValue:{separatorKeyCodes:[13]}}],imports:[Pa,K0,Iw,Pa]})}return e})(),o6=1;const mv={};function Tk(e){return e in mv&&(delete mv[e],!0)}const s6={setImmediate(e){const n=o6++;return mv[n]=!0,d1||(d1=Promise.resolve()),d1.then(()=>Tk(n)&&e()),n},clearImmediate(e){Tk(e)}},{setImmediate:a6,clearImmediate:l6}=s6,gv={setImmediate(...e){const{delegate:n}=gv;return(n?.setImmediate||a6)(...e)},clearImmediate(e){const{delegate:n}=gv;return(n?.clearImmediate||l6)(e)},delegate:void 0},h1=new class u6 extends yw{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class c6 extends _w{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=gv.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:a}=n;null!=t&&(null===(r=a[a.length-1])||void 0===r?void 0:r.id)!==t&&(gv.clearImmediate(t),n._scheduled===t&&(n._scheduled=void 0))}});function Ak(e){return wt(()=>e)}function kk(e,n){return n?t=>Wp(n.pipe(_r(1),function d6(){return In((e,n)=>{e.subscribe(xn(n,no))})}()),t.pipe(kk(e))):tn((t,i)=>Ee(e(t,i)).pipe(_r(1),Ak(t)))}function Rk(e=0,n,t=T5){let i=-1;return null!=n&&(Wr(n)?t=n:i=n),new bn(r=>{let a=function h6(e){return e instanceof Date&&!isNaN(e)}(e)?+e-t.now():e;a<0&&(a=0);let u=0;return t.schedule(function(){r.closed||(r.next(u++),0<=i?this.schedule(void 0,i):r.complete())},a)})}function p1(e,n=By){const t=Rk(e,n);return kk(()=>t)}class f1{attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class p6 extends f1{constructor(n,t,i,r,a){super(),this.component=n,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=a}}class Pk extends f1{constructor(n,t,i,r){super(),this.templateRef=n,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(n,t=this.context){return this.context=t,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class f6 extends f1{constructor(n){super(),this.element=n instanceof kn?n.nativeElement:n}}class m6{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof p6?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof Pk?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof f6?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class g6 extends m6{constructor(n,t,i,r,a){super(),this.outletElement=n,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=u=>{const p=u.element,y=this._document.createComment("dom-portal");p.parentNode.insertBefore(y,p),this.outletElement.appendChild(p),this._attachedPortal=u,super.setDisposeFn(()=>{y.parentNode&&y.parentNode.replaceChild(p,y)})},this._document=a}attachComponentPortal(n){const i=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component);let r;return n.viewContainerRef?(r=n.viewContainerRef.createComponent(i,n.viewContainerRef.length,n.injector||n.viewContainerRef.injector,n.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(n.injector||this._defaultInjector||Jo.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=n,r}attachTemplatePortal(n){let t=n.viewContainerRef,i=t.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=n,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let _6=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({})}return e})();const y6=["addListener","removeListener"],v6=["addEventListener","removeEventListener"],b6=["on","off"];function ug(e,n,t,i){if($t(t)&&(i=t,t=void 0),i)return ug(e,n,t).pipe(vw(i));const[r,a]=function E6(e){return $t(e.addEventListener)&&$t(e.removeEventListener)}(e)?v6.map(u=>p=>e[u](n,p,t)):function x6(e){return $t(e.addListener)&&$t(e.removeListener)}(e)?y6.map(Fk(e,n)):function w6(e){return $t(e.on)&&$t(e.off)}(e)?b6.map(Fk(e,n)):[];if(!r&&V(e))return tn(u=>ug(u,n,t))(Ee(e));if(!r)throw new TypeError("Invalid event target");return new bn(u=>{const p=(...y)=>u.next(1<y.length?y:y[0]);return r(p),()=>a(p)})}function Fk(e,n){return t=>i=>e[t](n,i)}const dg={schedule(e){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=dg;i&&(n=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=n(a=>{t=void 0,e(a)});return new Jt(()=>t?.(r))},requestAnimationFrame(...e){const{delegate:n}=dg;return(n?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:n}=dg;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0};new class S6 extends yw{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class C6 extends _w{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=dg.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:a}=n;null!=t&&(null===(r=a[a.length-1])||void 0===r?void 0:r.id)!==t&&(dg.cancelAnimationFrame(t),n._scheduled=void 0)}});function Ok(e,n=By){return function I6(e){return In((n,t)=>{let i=!1,r=null,a=null,u=!1;const p=()=>{if(a?.unsubscribe(),a=null,i){i=!1;const E=r;r=null,t.next(E)}u&&t.complete()},y=()=>{a=null,u&&t.complete()};n.subscribe(xn(t,E=>{i=!0,r=E,a||Ee(e(E)).subscribe(a=xn(t,p,y))},()=>{u=!0,(!i||!a||a.closed)&&t.complete()}))})}(()=>Rk(e,n))}let T6=(()=>{class e{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new St,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new bn(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(Ok(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):_t()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(ji(a=>!a||r.indexOf(a)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,a)=>{this._scrollableContainsElement(a,t)&&i.push(a)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Gp(i),a=t.getElementRef().nativeElement;do{if(r==a)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>ug(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(jt),Me(gs),Me(hn,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Lk=(()=>{class e{constructor(t,i,r){this._platform=t,this._change=new St,this._changeListener=a=>{this._change.next(a)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const a=this._getWindow();a.addEventListener("resize",this._changeListener),a.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,a=r.getBoundingClientRect();return{top:-a.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-a.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Ok(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||e)(Me(gs),Me(jt),Me(hn,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),m1=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({})}return e})(),Nk=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({imports:[Qm,m1,Qm,m1]})}return e})();const Bk=u5();class k6{constructor(n,t){this._viewportRuler=n,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=Or(-this._previousScrollPosition.left),n.style.top=Or(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,i=n.style,r=this._document.body.style,a=i.scrollBehavior||"",u=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),Bk&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Bk&&(i.scrollBehavior=a,r.scrollBehavior=u)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class R6{constructor(n,t,i,r){this._scrollDispatcher=n,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(ji(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class zk{enable(){}disable(){}attach(){}}function g1(e,n){return n.some(t=>e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right)}function Vk(e,n){return n.some(t=>e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}class P6{constructor(n,t,i,r){this._scrollDispatcher=n,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();g1(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let F6=(()=>{class e{constructor(t,i,r,a){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new zk,this.close=u=>new R6(this._scrollDispatcher,this._ngZone,this._viewportRuler,u),this.block=()=>new k6(this._viewportRuler,this._document),this.reposition=u=>new P6(this._scrollDispatcher,this._viewportRuler,this._ngZone,u),this._document=a}static#e=this.\u0275fac=function(i){return new(i||e)(Me(T6),Me(Lk),Me(jt),Me(hn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Uk{constructor(n){if(this.scrollStrategy=new zk,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,n){const t=Object.keys(n);for(const i of t)void 0!==n[i]&&(this[i]=n[i])}}}class O6{constructor(n,t){this.connectionPair=n,this.scrollableViewProperties=t}}let jk=(()=>{class e{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),L6=(()=>{class e extends jk{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const a=this._attachedOverlays;for(let u=a.length-1;u>-1;u--)if(a[u]._keydownEvents.observers.length>0){const p=a[u]._keydownEvents;this._ngZone?this._ngZone.run(()=>p.next(r)):p.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn),Me(jt,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),N6=(()=>{class e extends jk{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=a=>{this._pointerDownEventTarget=ju(a)},this._clickListener=a=>{const u=ju(a),p="click"===a.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:u;this._pointerDownEventTarget=null;const y=this._attachedOverlays.slice();for(let E=y.length-1;E>-1;E--){const I=y[E];if(I._outsidePointerEvents.observers.length<1||!I.hasAttached())continue;if(I.overlayElement.contains(u)||I.overlayElement.contains(p))break;const R=I._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>R.next(a)):R.next(a)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn),Me(gs),Me(jt,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),$k=(()=>{class e{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||dw()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let a=0;a<r.length;a++)r[a].remove()}const i=this._document.createElement("div");i.classList.add(t),dw()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn),Me(gs))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class B6{constructor(n,t,i,r,a,u,p,y,E,I=!1){this._portalOutlet=n,this._host=t,this._pane=i,this._config=r,this._ngZone=a,this._keyboardDispatcher=u,this._document=p,this._location=y,this._outsideClickDispatcher=E,this._animationsDisabled=I,this._backdropElement=null,this._backdropClick=new St,this._attachments=new St,this._detachments=new St,this._locationChanges=Jt.EMPTY,this._backdropClickHandler=R=>this._backdropClick.next(R),this._backdropTransitionendHandler=R=>{this._disposeBackdrop(R.target)},this._keydownEvents=new St,this._outsidePointerEvents=new St,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(n){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(n);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(_r(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,n&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=Or(this._config.width),n.height=Or(this._config.height),n.minWidth=Or(this._config.minWidth),n.minHeight=Or(this._config.minHeight),n.maxWidth=Or(this._config.maxWidth),n.maxHeight=Or(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(n)})}):this._backdropElement.classList.add(n)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const n=this._backdropElement;if(n){if(this._animationsDisabled)return void this._disposeBackdrop(n);n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{n.addEventListener("transitionend",this._backdropTransitionendHandler)}),n.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(n)},500))}}_toggleClasses(n,t,i){const r=zy(t||[]).filter(a=>!!a);r.length&&(i?n.classList.add(...r):n.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const n=this._ngZone.onStable.pipe(fo(Ht(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),n.unsubscribe())})})}_disposeScrollStrategy(){const n=this._scrollStrategy;n&&(n.disable(),n.detach&&n.detach())}_disposeBackdrop(n){n&&(n.removeEventListener("click",this._backdropClickHandler),n.removeEventListener("transitionend",this._backdropTransitionendHandler),n.remove(),this._backdropElement===n&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Hk="cdk-overlay-connected-position-bounding-box",z6=/([A-Za-z%]+)$/;class V6{get positions(){return this._preferredPositions}constructor(n,t,i,r,a){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=a,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new St,this._resizeSubscription=Jt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(Hk),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,a=[];let u;for(let p of this._preferredPositions){let y=this._getOriginPoint(n,r,p),E=this._getOverlayPoint(y,t,p),I=this._getOverlayFit(E,t,i,p);if(I.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(p,y);this._canFitWithFlexibleDimensions(I,E,i)?a.push({position:p,origin:y,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(y,p)}):(!u||u.overlayFit.visibleArea<I.visibleArea)&&(u={overlayFit:I,overlayPoint:E,originPoint:y,position:p,overlayRect:t})}if(a.length){let p=null,y=-1;for(const E of a){const I=E.boundingBoxRect.width*E.boundingBoxRect.height*(E.position.weight||1);I>y&&(y=I,p=E)}return this._isPushed=!1,void this._applyPosition(p.position,p.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(u.position,u.originPoint);this._applyPosition(u.position,u.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&_h(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Hk),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;if(n){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,n);this._applyPosition(n,t)}else this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}_getOriginPoint(n,t,i){let r,a;if("center"==i.originX)r=n.left+n.width/2;else{const u=this._isRtl()?n.right:n.left,p=this._isRtl()?n.left:n.right;r="start"==i.originX?u:p}return t.left<0&&(r-=t.left),a="center"==i.originY?n.top+n.height/2:"top"==i.originY?n.top:n.bottom,t.top<0&&(a-=t.top),{x:r,y:a}}_getOverlayPoint(n,t,i){let r,a;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,a="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:n.x+r,y:n.y+a}}_getOverlayFit(n,t,i,r){const a=Gk(t);let{x:u,y:p}=n,y=this._getOffset(r,"x"),E=this._getOffset(r,"y");y&&(u+=y),E&&(p+=E);let B=0-p,H=p+a.height-i.height,X=this._subtractOverflows(a.width,0-u,u+a.width-i.width),re=this._subtractOverflows(a.height,B,H),_e=X*re;return{visibleArea:_e,isCompletelyWithinViewport:a.width*a.height===_e,fitsInViewportVertically:re===a.height,fitsInViewportHorizontally:X==a.width}}_canFitWithFlexibleDimensions(n,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,a=i.right-t.x,u=qk(this._overlayRef.getConfig().minHeight),p=qk(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=u&&u<=r)&&(n.fitsInViewportHorizontally||null!=p&&p<=a)}return!1}_pushOverlayOnScreen(n,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const r=Gk(t),a=this._viewportRect,u=Math.max(n.x+r.width-a.width,0),p=Math.max(n.y+r.height-a.height,0),y=Math.max(a.top-i.top-n.y,0),E=Math.max(a.left-i.left-n.x,0);let I=0,R=0;return I=r.width<=a.width?E||-u:n.x<this._viewportMargin?a.left-i.left-n.x:0,R=r.height<=a.height?y||-p:n.y<this._viewportMargin?a.top-i.top-n.y:0,this._previousPushAmount={x:I,y:R},{x:n.x+I,y:n.y+R}}_applyPosition(n,t){if(this._setTransformOrigin(n),this._setOverlayElementStyles(t,n),this._setBoundingBoxStyles(t,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._lastPosition=n,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new O6(n,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=n.overlayY;i="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let a=0;a<t.length;a++)t[a].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(n,t){const i=this._viewportRect,r=this._isRtl();let a,u,p,I,R,B;if("top"===t.overlayY)u=n.y,a=i.height-u+this._viewportMargin;else if("bottom"===t.overlayY)p=i.height-n.y+2*this._viewportMargin,a=i.height-p+this._viewportMargin;else{const H=Math.min(i.bottom-n.y+i.top,n.y),X=this._lastBoundingBoxSize.height;a=2*H,u=n.y-H,a>X&&!this._isInitialRender&&!this._growAfterOpen&&(u=n.y-X/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)B=i.width-n.x+this._viewportMargin,I=n.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)R=n.x,I=i.right-n.x;else{const H=Math.min(i.right-n.x+i.left,n.x),X=this._lastBoundingBoxSize.width;I=2*H,R=n.x-H,I>X&&!this._isInitialRender&&!this._growAfterOpen&&(R=n.x-X/2)}return{top:u,left:R,bottom:p,right:B,width:I,height:a}}_setBoundingBoxStyles(n,t){const i=this._calculateBoundingBoxRect(n,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const a=this._overlayRef.getConfig().maxHeight,u=this._overlayRef.getConfig().maxWidth;r.height=Or(i.height),r.top=Or(i.top),r.bottom=Or(i.bottom),r.width=Or(i.width),r.left=Or(i.left),r.right=Or(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",a&&(r.maxHeight=Or(a)),u&&(r.maxWidth=Or(u))}this._lastBoundingBoxSize=i,_h(this._boundingBox.style,r)}_resetBoundingBoxStyles(){_h(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){_h(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,t){const i={},r=this._hasExactPosition(),a=this._hasFlexibleDimensions,u=this._overlayRef.getConfig();if(r){const I=this._viewportRuler.getViewportScrollPosition();_h(i,this._getExactOverlayY(t,n,I)),_h(i,this._getExactOverlayX(t,n,I))}else i.position="static";let p="",y=this._getOffset(t,"x"),E=this._getOffset(t,"y");y&&(p+=`translateX(${y}px) `),E&&(p+=`translateY(${E}px)`),i.transform=p.trim(),u.maxHeight&&(r?i.maxHeight=Or(u.maxHeight):a&&(i.maxHeight="")),u.maxWidth&&(r?i.maxWidth=Or(u.maxWidth):a&&(i.maxWidth="")),_h(this._pane.style,i)}_getExactOverlayY(n,t,i){let r={top:"",bottom:""},a=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,i)),"bottom"===n.overlayY?r.bottom=this._document.documentElement.clientHeight-(a.y+this._overlayRect.height)+"px":r.top=Or(a.y),r}_getExactOverlayX(n,t,i){let u,r={left:"",right:""},a=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,i)),u=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===u?r.right=this._document.documentElement.clientWidth-(a.x+this._overlayRect.width)+"px":r.left=Or(a.x),r}_getScrollVisibility(){const n=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Vk(n,i),isOriginOutsideView:g1(n,i),isOverlayClipped:Vk(t,i),isOverlayOutsideView:g1(t,i)}}_subtractOverflows(n,...t){return t.reduce((i,r)=>i-Math.max(r,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+n-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:n-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,t){return"x"===t?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&zy(n).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getOriginRect(){const n=this._origin;if(n instanceof kn)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const t=n.width||0,i=n.height||0;return{top:n.y,bottom:n.y+i,left:n.x,right:n.x+t,height:i,width:t}}}function _h(e,n){for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function qk(e){if("number"!=typeof e&&null!=e){const[n,t]=e.split(z6);return t&&"px"!==t?null:parseFloat(n)}return e||null}function Gk(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const Wk="cdk-global-overlay-wrapper";class U6{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(n){const t=n.getConfig();this._overlayRef=n,this._width&&!t.width&&n.updateSize({width:this._width}),this._height&&!t.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(Wk),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:a,maxWidth:u,maxHeight:p}=i,y=!("100%"!==r&&"100vw"!==r||u&&"100%"!==u&&"100vw"!==u),E=!("100%"!==a&&"100vh"!==a||p&&"100%"!==p&&"100vh"!==p),I=this._xPosition,R=this._xOffset,B="rtl"===this._overlayRef.getConfig().direction;let H="",X="",re="";y?re="flex-start":"center"===I?(re="center",B?X=R:H=R):B?"left"===I||"end"===I?(re="flex-end",H=R):("right"===I||"start"===I)&&(re="flex-start",X=R):"left"===I||"start"===I?(re="flex-start",H=R):("right"===I||"end"===I)&&(re="flex-end",X=R),n.position=this._cssPosition,n.marginLeft=y?"0":H,n.marginTop=E?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=y?"0":X,t.justifyContent=re,t.alignItems=E?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(Wk),i.justifyContent=i.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let j6=(()=>{class e{constructor(t,i,r,a){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=a}global(){return new U6}flexibleConnectedTo(t){return new V6(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Lk),Me(hn),Me(gs),Me($k))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),$6=0,_v=(()=>{class e{constructor(t,i,r,a,u,p,y,E,I,R,B,H){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=a,this._keyboardDispatcher=u,this._injector=p,this._ngZone=y,this._document=E,this._directionality=I,this._location=R,this._outsideClickDispatcher=B,this._animationsModuleType=H}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),a=this._createPortalOutlet(r),u=new Uk(t);return u.direction=u.direction||this._directionality.value,new B6(a,i,r,u,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+$6++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(zu)),new g6(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(F6),Me($k),Me(_m),Me(j6),Me(L6),Me(Jo),Me(jt),Me(hn),Me(Uy),Me(by),Me(N6),Me(Tc,8))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const G6={provide:new Re("cdk-connected-overlay-scroll-strategy"),deps:[_v],useFactory:function q6(e){return()=>e.scrollStrategies.reposition()}};let W6=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({providers:[_v,G6],imports:[Qm,_6,Nk,Nk]})}return e})();const Z6=["mat-menu-item",""];function K6(e,n){1&e&&(Vf(),Kt(0,"svg",3),pr(1,"polygon",4),vn())}const X6=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Y6=["mat-icon, [matMenuItemIcon]","*"];function Q6(e,n){if(1&e){const t=function RS(){return Pe()}();Kt(0,"div",0),Ui("keydown",function(r){return kd(t),Rd(ih()._handleKeydown(r))})("click",function(){return kd(t),Rd(ih().closed.emit("click"))})("@transformMenu.start",function(r){return kd(t),Rd(ih()._onAnimationStart(r))})("@transformMenu.done",function(r){return kd(t),Rd(ih()._onAnimationDone(r))}),Kt(1,"div",1),ki(2),vn()()}if(2&e){const t=ih();Xi("id",t.panelId)("ngClass",t._classList)("@transformMenu",t._panelAnimationState),Qn("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const J6=["*"],_1=new Re("MAT_MENU_PANEL"),e8=Sw(Cw(class{}));let yv=(()=>{class e extends e8{constructor(t,i,r,a,u){super(),this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=a,this._changeDetectorRef=u,this.role="menuitem",this._hovered=new St,this._focused=new St,this._highlighted=!1,this._triggersSubmenu=!1,a?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(hn),me(Ym),me(_1,8),me(Aa))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(i,r){1&i&&Ui("click",function(u){return r._checkDisabled(u)})("mouseenter",function(){return r._handleMouseEnter()}),2&i&&(Qn("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),po("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[Nt],attrs:Z6,ngContentSelectors:Y6,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-mdc-menu-submenu-icon","viewBox","0 0 5 10","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(i,r){1&i&&($s(X6),ki(0),Kt(1,"span",0),ki(2,1),vn(),pr(3,"div",1),ps(4,K6,2,0,"svg",2)),2&i&&(Ai(3),Xi("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),Ai(1),Xi("ngIf",r._triggersSubmenu))},dependencies:[Hm,HT],encapsulation:2,changeDetection:0})}return e})();const t8=new Re("MatMenuContent"),vv={transformMenu:t1("transformMenu",[n1("void",zc({opacity:0,transform:"scale(0.8)"})),dv("void => enter",uv("120ms cubic-bezier(0, 0, 0.2, 1)",zc({opacity:1,transform:"scale(1)"}))),dv("* => void",uv("100ms 25ms linear",zc({opacity:0})))]),fadeInItems:t1("fadeInItems",[n1("showing",zc({opacity:1})),dv("void => *",[zc({opacity:0}),uv("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let n8=0;const Zk=new Re("mat-menu-default-options",{providedIn:"root",factory:function i8(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let hg=(()=>{class e{get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(t){this._overlapTrigger=gr(t)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=gr(t)}set panelClass(t){const i=this._previousPanelClass;i&&i.length&&i.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(t){this.panelClass=t}constructor(t,i,r,a){this._elementRef=t,this._ngZone=i,this._changeDetectorRef=a,this._directDescendantItems=new ah,this._classList={},this._panelAnimationState="void",this._animationDone=new St,this.closed=new Dn,this.close=this.closed,this.panelId="mat-menu-panel-"+n8++,this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this._overlapTrigger=r.overlapTrigger,this._hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new kT(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Oc(this._directDescendantItems),ir(t=>Ht(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),a=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[a]&&!r[a].disabled?i.setActiveItem(a):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe(Oc(this._directDescendantItems),ir(i=>Ht(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:Ly(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe(_r(1)).subscribe(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,a=Object.keys(this._classList).find(u=>u.startsWith(this._elevationPrefix));(!a||a===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(t=this.xPosition,i=this.yPosition){const r=this._classList;r["mat-menu-before"]="before"===t,r["mat-menu-after"]="after"===t,r["mat-menu-above"]="above"===i,r["mat-menu-below"]="below"===i,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Oc(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(jt),me(Zk),me(Aa))};static#t=this.\u0275dir=ct({type:e,contentQueries:function(i,r,a){if(1&i&&(ko(a,t8,5),ko(a,yv,5),ko(a,yv,4)),2&i){let u;Rr(u=Pr())&&(r.lazyContent=u.first),Rr(u=Pr())&&(r._allItems=u),Rr(u=Pr())&&(r.items=u)}},viewQuery:function(i,r){if(1&i&&Bm(Xl,5),2&i){let a;Rr(a=Pr())&&(r.templateRef=a.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}})}return e})(),r8=(()=>{class e extends hg{constructor(t,i,r,a){super(t,i,r,a),this._elevationPrefix="mat-elevation-z",this._baseElevation=8}static#e=this.\u0275fac=function(i){return new(i||e)(me(kn),me(jt),me(Zk),me(Aa))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["mat-menu"]],hostAttrs:["ngSkipHydration",""],hostVars:3,hostBindings:function(i,r){2&i&&Qn("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Rn([{provide:_1,useExisting:e}]),Nt],ngContentSelectors:J6,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"id","ngClass","keydown","click"],[1,"mat-mdc-menu-content"]],template:function(i,r){1&i&&($s(),ps(0,Q6,3,6,"ng-template"))},dependencies:[UM],styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;white-space:normal;font-family:var(--mat-menu-item-label-text-font);line-height:var(--mat-menu-item-label-text-line-height);font-size:var(--mat-menu-item-label-text-size);letter-spacing:var(--mat-menu-item-label-text-tracking);font-weight:var(--mat-menu-item-label-text-weight)}.mat-mdc-menu-panel{--mat-menu-container-shape:4px;min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape);background-color:var(--mat-menu-container-color);will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;align-items:center;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color)}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color)}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{margin-right:16px}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:16px}.mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-mdc-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[vv.transformMenu,vv.fadeInItems]},changeDetection:0})}return e})();const Kk=new Re("mat-menu-scroll-strategy"),s8={provide:Kk,deps:[_v],useFactory:function o8(e){return()=>e.scrollStrategies.reposition()}},Xk=Zm({passive:!0});let a8=(()=>{class e{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(t,i,r,a,u,p,y,E,I){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=p,this._dir=y,this._focusMonitor=E,this._ngZone=I,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=Jt.EMPTY,this._hoverSubscription=Jt.EMPTY,this._menuCloseSubscription=Jt.EMPTY,this._changeDetectorRef=Qe(Aa),this._handleTouchStart=R=>{ww(R)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new Dn,this.onMenuOpen=this.menuOpened,this.menuClosed=new Dn,this.onMenuClose=this.menuClosed,this._scrollStrategy=a,this._parentMaterialMenu=u instanceof hg?u:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,Xk)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,Xk),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const i=this._createOverlay(t),r=i.getConfig(),a=r.positionStrategy;this._setPosition(t,a),r.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,i.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof hg&&(t._startAnimation(),t._directDescendantItems.changes.pipe(fo(t.close)).subscribe(()=>{a.withLockedPosition(!1).reapplyLastPosition(),a.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof hg?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(ji(r=>"void"===r.toState),_r(1),fo(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let i=0,r=t.parentMenu;for(;r;)i++,r=r.parentMenu;t.setElevation(i)}}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new Uk({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{const a="start"===r.connectionPair.overlayX?"after":"before",u="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(a,u)):t.setPositionClasses(a,u)})}_setPosition(t,i){let[r,a]="before"===t.xPosition?["end","start"]:["start","end"],[u,p]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[y,E]=[u,p],[I,R]=[r,a],B=0;if(this.triggersSubmenu()){if(R=r="before"===t.xPosition?"start":"end",a=I="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const H=this._parentMaterialMenu.items.first;this._parentInnerPadding=H?H._getHostElement().offsetTop:0}B="bottom"===u?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(y="top"===u?"bottom":"top",E="top"===p?"bottom":"top");i.withPositions([{originX:r,originY:y,overlayX:I,overlayY:u,offsetY:B},{originX:a,originY:y,overlayX:R,overlayY:u,offsetY:B},{originX:r,originY:E,overlayX:I,overlayY:p,offsetY:-B},{originX:a,originY:E,overlayX:R,overlayY:p,offsetY:-B}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return Ht(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:_t(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(ji(u=>u!==this._menuItemInstance),ji(()=>this._menuOpen)):_t(),i)}_handleMousedown(t){xw(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(ji(t=>t===this._menuItemInstance&&!t.disabled),p1(0,h1)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof hg&&this.menu._isAnimating?this.menu._animationDone.pipe(_r(1),p1(0,h1),fo(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new Pk(t.templateRef,this._viewContainerRef)),this._portal}static#e=this.\u0275fac=function(i){return new(i||e)(me(_v),me(kn),me(Ta),me(Kk),me(_1,8),me(yv,10),me(Uy,8),me(Ym),me(jt))};static#t=this.\u0275dir=ct({type:e,hostVars:3,hostBindings:function(i,r){1&i&&Ui("click",function(u){return r._handleClick(u)})("mousedown",function(u){return r._handleMousedown(u)})("keydown",function(u){return r._handleKeydown(u)}),2&i&&Qn("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}})}return e})(),l8=(()=>{class e extends a8{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Ii(e)))(r||e)}}();static#t=this.\u0275dir=ct({type:e,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],exportAs:["matMenuTrigger"],features:[Nt]})}return e})(),c8=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({providers:[s8],imports:[K0,Iw,Pa,W6,m1,Pa]})}return e})();const u8=JSON.parse('{"data":[{"id":1,"name":"Japanese Sword Museum","city":"Tokyo","lat":35.6990014,"lng":139.7936025,"photo":"https://www.touken.or.jp/Portals/0/images/museum/img_kv04_\u6b63\u9762\u7384\u95a2.jpg","notes":"Japanese swords spanning several centuries displayed in a modern museum with gardens.","url":"https://www.touken.or.jp/english/"},{"id":2,"name":"Kurashiki Art Sword Museum","city":"Kurashiki","lat":34.577528,"lng":133.8223832,"photo":"https://www.touken-sato.com/top-01.jpg","notes":"Nothing for now","url":"https://touken-sato.com"},{"id":3,"name":"The Metropolitan Museum of Art","city":"New York","lat":40.7794273,"lng":-73.9634904,"photo":"https://cdn.sanity.io/images/cctd4ker/production/73a42b4ea1644b2085acaad2896bfa4699687664-2320x920.jpg","notes":"Over 5,000 years of art from around the world.","url":"https://www.metmuseum.org/"},{"id":4,"name":"Rijksmuseum","city":"Amsterdam","lat":52.359961,"lng":4.8851815,"photo":"https://www.artnews.com/wp-content/uploads/2023/02/GettyImages-1215971600-copy-1.jpg","notes":"Collected Works of Taisei Yamaguchi","url":"https://www.rijksmuseum.nl/","links":[{"name":"Taisei Yamaguchi","url":"https://www.rijksmuseum.nl/en/rijksstudio/3277561--taisei-yamaguchi/collections"}]},{"id":5,"name":"Museo Stibbert","city":"Firenze","lat":43.7928822,"lng":11.2549635,"photo":"https://www.museostibbert.it/frontend/img/header_ridotto5.jpg","notes":"Japanese Armoury","url":"https://www.museostibbert.it"},{"id":6,"name":"Tokyo National Museum","city":"Tokyo","lat":35.7188226,"lng":139.7763666,"photo":"https://www.tnm.jp/uploads/r_db/db_custom_text/20231031_top_hero_1_file.jpg","notes":"Katana from Wikipedia is here","url":"https://www.tnm.jp","links":[{"name":"Wikipedia katana","url":"https://emuseum.nich.go.jp/detail?langId=en&webView=null&content_base_id=100511&content_part_id=001&content_pict_id=001"}]},{"id":7,"name":"The British Museum","city":"London","lat":51.5194,"lng":-0.127,"photo":"https://cdn.britannica.com/12/127112-050-F4DD3B7A/British-Museum-London.jpg","notes":"Holds a variety of Japanese artifacts, including samurai swords and armor.","url":"https://www.britishmuseum.org/","links":[{"name":"Japan collection","url":"https://www.britishmuseum.org/collection/galleries/japan"},{"name":"Katana, Sukenao, Edo period (not on display)","url":"https://www.britishmuseum.org/collection/object/A_1958-0730-67-a-b"},{"name":"\'British Museum katana\' search on Google","url":"https://www.google.com/search?q=British+Museum+katana"}]},{"id":8,"name":"Kyoto National Museum","city":"Kyoto","lat":34.9899705,"lng":135.7731131,"photo":"https://www.kyohaku.go.jp/eng/assets/meijikotokan_pc.png","notes":"Offers a rich collection of Japanese art, including items related to the samurai.","url":"http://www.kyohaku.go.jp/eng/","links":[{"name":"Tachi Sword by Umetada Myoju, Momoyama Period","url":"https://www.kyohaku.go.jp/eng/collection/meihin/kin/item02/"}]},{"id":9,"name":"Samurai Museum","city":"Tokyo","lat":35.69549292481943,"lng":139.7035425830052,"photo":"https://www.samuraimuseum.jp/en/photo/about.jpg","notes":"Dedicated to the samurai culture, with many pieces of armor, weapons, and other related artifacts.","url":"https://samuraimuseum.jp/en/","links":[{"name":"Various experiences","url":"https://www.samuraimuseum.jp/en/experience/index.html"}]},{"id":10,"name":"The National Museum of Japanese History","city":"Sakura","lat":35.72448301315745,"lng":140.21913059795898,"photo":"https://www.rekihaku.ac.jp/english/img/img-top-banner-home.jpg","notes":"Includes exhibits on the samurai class and their equipment.","url":"https://www.rekihaku.ac.jp/english/"},{"id":11,"name":"Mus\xe9e Guimet","city":"Paris","lat":48.865138851614255,"lng":2.2937764931351907,"photo":"https://www.unjourdeplusaparis.com/wp-content/uploads/2012/03/musee-guimet.jpg","notes":"The National Museum of Asian Arts in Paris, with a section dedicated to Japanese arms and armor.","url":"http://www.guimet.fr/en/","links":[{"name":"1","url":"https://www.guimet.fr/event/les-arts-martiaux-du-japon/"},{"name":"3","url":"https://www.guimet.fr/blog/pour-les-enfants-les-armures-de-samourais/"},{"name":"2","url":"https://www.guimet.fr/event/larc-et-le-sabre-imaginaire-guerrier-du-japon/"},{"name":"4","url":"https://www.guimet.fr/blog/daimyo-en-armure-de-guerre-tirant-a-larc/"},{"name":"old photo of blades","url":"https://fr.m.wikipedia.org/wiki/Fichier:Katana_blades.jpg"}]},{"id":12,"name":"Tsukamoto Sword Museum","city":"Sakura","lat":35.7188139,"lng":140.2283056,"photo":"https://www.city.sakura.lg.jp/material/images/group/36/p10-p11_06.jpg","notes":"A small private collection of Japanese Katana swords out in Chiba Prefecture in the town of Sakura. Admission is free and curators are anxious and happy to answer any questions you may have.","url":"https://www.city.sakura.lg.jp/soshiki/sakuranomiryoku/1/3036.html","links":[{"name":"English description on SnapJapan","url":"https://www.snapjapan.com/tsukamoto-museum"}]},{"id":13,"name":"The Royal Armouries Museum","city":"Leeds","lat":53.79180686229316,"lng":-1.532229291999844,"photo":"https://royalarmouries.org/sites/default/files/styles/11_7_media_large/public/2023-07/Royal%20Armouries%20Museum-Leeds-adjusted.jpg","notes":"This museum has a collection of Japanese arms and armor.","url":"https://www.royalarmouries.org/","links":[{"name":"Armour presented to King James I","url":"https://royalarmouries.org/collection/object/object-30423"},{"name":"Katana, Masamitsu, ~1370","url":"https://royalarmouries.org/collection/object/object-36331"}]},{"id":14,"name":"The San Francisco Asian Art Museum","city":"San Francisco","lat":37.78029888268359,"lng":-122.41615947850732,"photo":"https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Terracotta_Warriors_Exhibition_San_Francisco_2013.jpg/1920px-Terracotta_Warriors_Exhibition_San_Francisco_2013.jpg","notes":"Hosts a significant collection of Asian art, including samurai swords.","url":"https://www.asianart.org/","links":[{"name":"Lesson (pdf)","url":"https://education.asianart.org/resources/japanese-swords-trade-and-cultural-exchange/"}]},{"id":15,"name":"The Victoria and Albert Museum","city":"London","lat":51.496639,"lng":-0.17218,"photo":"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ab/Victoria_%26_Albert_Museum_Entrance%2C_London%2C_UK_-_Diliff.jpg/1920px-Victoria_%26_Albert_Museum_Entrance%2C_London%2C_UK_-_Diliff.jpg","notes":"Its East Asian collections include samurai swords and armor.","url":"https://www.vam.ac.uk/","links":[{"name":"1300-1350","url":"https://collections.vam.ac.uk/item/O92843/sword-and-scabbard-masamune/"},{"name":"1869","url":"https://collections.vam.ac.uk/item/O90838/sword-and-scabbard/"},{"name":"1869","url":"https://www.vam.ac.uk/articles/samurai-japanese-arms-armour"},{"name":"Japan room on museum map","url":"https://www.vam.ac.uk/features/digitalmap/find/room/FAC0000_49801?zoom=4&latlng=-3386.45%2C5199.950000000001"}]},{"id":16,"name":"The Ann and Gabriel Barbier-Mueller Museum: The Samurai Collection","city":"Dallas","lat":32.791942245763664,"lng":-96.80668904812639,"photo":"https://harwooddistrict.com/wp-content/uploads/2018/06/arts04.jpg","notes":"One of the largest collections of samurai armor outside of Japan.","url":"https://www.samuraicollection.org/","links":[{"name":"another link","url":"https://harwooddistrict.com/the-samurai-collection/"}]},{"id":17,"name":"Los Angeles County Museum of Art","city":"Los Angeles","lat":34.063932,"lng":-118.359229,"photo":"https://www.lacma.org/sites/default/files/styles/desktop_header/public/basic-page/SF3092_05.jpg","notes":"Has a collection of Japanese art, including samurai swords.","url":"https://www.lacma.org/","links":[{"name":"Sukenaga Yokoyama","url":"https://collections.lacma.org/node/157819"},{"name":"on public domain media","url":"https://picryl.com/topics/weapons+from+japan+in+the+los+angeles+county+museum+of+art"}]}]}');var d8=vs.t(u8,2);let Yk=(()=>{class e{constructor(){this.katanaLocationList=d8.data}getAllKatanaLocations(){return this.katanaLocationList??[]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let Qk=(()=>{class e{constructor(){this.katanaLocationList=[],this.katanaService=Qe(Yk),this.commitHash="95791ed",this.appVersion="0.2.0 (95791ed)",this.katanaLocationList=this.katanaService.getAllKatanaLocations()}onShare(){gtag("event","share",{event_category:"Navbar",event_label:"Share",value:location.href}),navigator.share({url:location.href,title:"Katana Map",text:"Map of places, where to see katana swords"})}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ci({type:e,selectors:[["app-navbar"]],standalone:!0,features:[c0],decls:38,vars:4,consts:[["mat-icon-button","","aria-label","Menu icon",1,"example-icon",3,"matMenuTriggerFor"],[1,"example-spacer"],["color","accent","selected","","disabled",""],["mat-icon-button","","href","https://github.com/aleksandr-vin/katana-map/wiki/Adding-location","aria-label","Add location","target","_blank"],["mat-icon-button","","aria-label","Share",1,"example-icon",3,"click"],["menu","matMenu"],["mat-menu-item","","href","https://github.com/aleksandr-vin/katana-map/wiki/About","aria-label","About","target","_blank"],["mat-menu-item","","href","https://github.com/aleksandr-vin/katana-map/wiki/Adding-location","aria-label","Add location","target","_blank"],["mat-menu-item","","href","https://www.reddit.com/r/KatanaMap/","aria-label","Reddit","target","_blank"],["mat-menu-item","","aria-label","Versions","target","_blank",3,"href"]],template:function(i,r){if(1&i&&(Kt(0,"mat-toolbar")(1,"button",0)(2,"mat-icon"),Ao(3,"menu"),vn()(),Kt(4,"span"),Ao(5,"Katana Map"),vn(),pr(6,"span",1),Kt(7,"mat-chip-option",2),Ao(8),vn(),pr(9,"span",1),Kt(10,"a",3)(11,"mat-icon"),Ao(12,"add"),vn()(),Kt(13,"button",4),Ui("click",function(){return r.onShare()}),Kt(14,"mat-icon"),Ao(15,"share"),vn()()(),Kt(16,"mat-menu",null,5)(18,"a",6)(19,"mat-icon"),Ao(20,"info"),vn(),Kt(21,"span"),Ao(22,"About"),vn()(),Kt(23,"a",7)(24,"mat-icon"),Ao(25,"add"),vn(),Kt(26,"span"),Ao(27,"Add location"),vn()(),Kt(28,"a",8)(29,"mat-icon"),Ao(30,"forum"),vn(),Kt(31,"span"),Ao(32,"r/KatanaMap"),vn()(),Kt(33,"a",9)(34,"mat-icon"),Ao(35,"open_in_new"),vn(),Kt(36,"span"),Ao(37),vn()()()),2&i){const a=function Zx(e){return function ma(e,n){return e[n]}(function Zg(){return Ft.lFrame.contextLView}(),Zt+e)}(17);Ai(1),Xi("matMenuTriggerFor",a),Ai(7),Am(r.katanaLocationList.length),Ai(25),ty("href","https://github.com/aleksandr-vin/katana-map/commit/",r.commitHash,"",nx),Ai(4),ry("Version ",r.appVersion,"")}},dependencies:[bj,vj,fj,pj,hj,nj,tj,r6,c1,c8,r8,yv,l8],styles:[".heading[_ngcontent-%COMP%]{margin:0;padding:0;background-color:#f2f4f5;color:#000}.heading[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{padding:3px;margin:0}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]})}return e})();var Yt=vs(624);const m8="function"==typeof btoa,Qp="function"==typeof Buffer,pg=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),mo=((e=>{let n={};e.forEach((t,i)=>n[t]=i)})(pg),String.fromCharCode.bind(String)),iR=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,n=>"+"==n?"-":"_")),v1=m8?e=>btoa(e):Qp?e=>Buffer.from(e,"binary").toString("base64"):e=>{let n,t,i,r,a="";const u=e.length%3;for(let p=0;p<e.length;){if((t=e.charCodeAt(p++))>255||(i=e.charCodeAt(p++))>255||(r=e.charCodeAt(p++))>255)throw new TypeError("invalid character found");n=t<<16|i<<8|r,a+=pg[n>>18&63]+pg[n>>12&63]+pg[n>>6&63]+pg[63&n]}return u?a.slice(0,u-3)+"===".substring(u):a},b1=Qp?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let i=0,r=e.length;i<r;i+=4096)t.push(mo.apply(null,e.subarray(i,i+4096)));return v1(t.join(""))},C8_fromUint8Array=(e,n=!1)=>n?iR(b1(e)):b1(e);var S8=vs(16);function _R(e,n,t,i,r,a,u){try{var p=e[a](u),y=p.value}catch(E){return void t(E)}p.done?n(y):Promise.resolve(y).then(i,r)}function Vc(e){return function(){var n=this,t=arguments;return new Promise(function(i,r){var a=e.apply(n,t);function u(y){_R(a,i,r,u,p,"next",y)}function p(y){_R(a,i,r,u,p,"throw",y)}u(void 0)})}}Math;const _s=new class k8{constructor(){this._apiKey="",this._fetch=function A8(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}()}set apiKey(n){this._apiKey=n}get apiKey(){return this._apiKey}set fetch(n){this._fetch=n}get fetch(){return this._fetch}};function S1(){return(S1=Vc(function*(e,n={}){if(null===_s.fetch)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(""===new URL(e).searchParams.get("key").trim())throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return _s.fetch(e,n)})).apply(this,arguments)}new Set(Object.values({AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"}));const Fa={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(Fa);class Xu extends Error{constructor(n,t=""){super(`Call to enpoint ${n.url} failed with the status code ${n.status}. ${t}`),this.res=n}}const IR={403:"Key is missing, invalid or restricted"};function A1(){return(A1=Vc(function*(e={}){const n=new URL("geolocation/ip.json",Fa.maptilerApiURL);n.searchParams.set("key",e.apiKey??_s.apiKey);const t=n.toString(),i=yield function Ku(e){return S1.apply(this,arguments)}(t);if(!i.ok)throw new Xu(i,i.status in IR?IR[i.status]:"");return yield i.json()})).apply(this,arguments)}const MR={info:function B8(){return A1.apply(this,arguments)}};function AR(e){let t;const i=e.trim();let r;return r=i.startsWith("http://")||i.startsWith("https://")?i:null!==(t=/^maptiler:\/\/(.*)/.exec(i))?`https://api.maptiler.com/maps/${t[1]}/style.json`:`https://api.maptiler.com/maps/${i}/style.json`,r}class F1{constructor(n,t,i,r,a,u){this.name=n,this.variantType=t,this.id=i,this.referenceStyle=r,this.description=a,this.imageURL=u}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(n){return this.referenceStyle.hasVariant(n)}getVariant(n){return this.referenceStyle.getVariant(n)}getVariants(){return this.referenceStyle.getVariants().filter(n=>n!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return AR(this.getId())}}class O1{constructor(n,t){this.name=n,this.id=t,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(n){this.variants[n.getType()]=n,this.orderedVariants.push(n)}hasVariant(n){return n in this.variants}getVariant(n){return n in this.variants?this.variants[n]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Iv=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function j8(e){return new Proxy(e,{get:(n,t,i)=>n.hasVariant(t)?n.getVariant(t):t.toString().toUpperCase()===t?e.getDefaultVariant():Reflect.get(n,t,i)})}const N1=function $8(){const e={};for(let n=0;n<Iv.length;n+=1){const t=Iv[n],i=j8(new O1(t.name,t.referenceStyleID));for(let r=0;r<t.variants.length;r+=1){const a=t.variants[r],u=new F1(a.name,a.variantType,a.id,i,a.description,a.imageURL);i.addVariant(u)}e[t.referenceStyleID]=i}return e}(),PR={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Mv;const cH=new Uint8Array(16);function uH(){if(!Mv&&(Mv=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Mv))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mv(cH)}const go=[];for(let e=0;e<256;++e)go.push((e+256).toString(16).slice(1));const sl={AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"latin",NON_LATIN:"nonlatin",LOCAL:"",ALBANIAN:"sq",AMHARIC:"am",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BASQUE:"eu",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CORSICAN:"co",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HINDI:"hi",HUNGARIAN:"hu",ICELANDIC:"is",INDONESIAN:"id",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",JAPANESE_HIRAGANA:"ja-Hira",JAPANESE_KANA:"ja_kana",JAPANESE_LATIN:"ja_rm",JAPANESE_2018:"ja-Latn",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",KOREAN_LATIN:"ko-Latn",KURDISH:"ku",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALAYALAM:"ml",MALTESE:"mt",NORWEGIAN:"no",OCCITAN:"oc",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SERBIAN_LATIN:"sr-Latn",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",TAMIL:"ta",TELUGU:"te",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"},pH=new Set(Object.values(sl));function OR(e){return pH.has(e)}const fH=new Set(Object.values(sl));function q1(){if(typeof navigator>"u")return Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];const e=Array.from(new Set(navigator.languages.map(n=>n.split("-")[0]))).filter(n=>fH.has(n));return e.length?e[0]:sl.LATIN}const LR=function dH(e,n,t){if(PR.randomUUID&&!n&&!e)return PR.randomUUID();const i=(e=e||{}).random||(e.rng||uH)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,n){t=t||0;for(let r=0;r<16;++r)n[t+r]=i[r];return n}return function FR(e,n=0){return go[e[n+0]]+go[e[n+1]]+go[e[n+2]]+go[e[n+3]]+"-"+go[e[n+4]]+go[e[n+5]]+"-"+go[e[n+6]]+go[e[n+7]]+"-"+go[e[n+8]]+go[e[n+9]]+"-"+go[e[n+10]]+go[e[n+11]]+go[e[n+12]]+go[e[n+13]]+go[e[n+14]]+go[e[n+15]]}(i)}(),al=new class mH extends S8{constructor(){super(),this.primaryLanguage=sl.AUTO,this.secondaryLanguage=null,this.session=!0,this._unit="metric",this._apiKey=""}set unit(n){this._unit=n,this.emit("unit",n)}get unit(){return this._unit}set apiKey(n){this._apiKey=n,_s.apiKey=n,this.emit("apiKey",n)}get apiKey(){return this._apiKey}set fetch(n){_s.fetch=n}get fetch(){return _s.fetch}},ys={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:sl.AUTO,secondaryLanguage:sl.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(ys);class gH extends Yt.LogoControl{onAdd(n){return super.onAdd(n)}}class NR extends gH{constructor(n={}){var t,i;super(n),this.logoURL="",this.linkURL="",this.logoURL=null!=(t=n.logoURL)?t:ys.maptilerLogoURL,this.linkURL=null!=(i=n.linkURL)?i:ys.maptilerURL}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const t=window.document.createElement("a");return t.style.backgroundRepeat="no-repeat",t.style.cursor="pointer",t.style.display="block",t.style.height="23px",t.style.margin="0 0 -4px -4px",t.style.overflow="hidden",t.style.width="88px",t.style.backgroundImage=`url(${this.logoURL})`,t.style.backgroundSize="100px 30px",t.style.width="100px",t.style.height="30px",t.target="_blank",t.rel="noopener",t.href=this.linkURL,t.setAttribute("aria-label","MapTiler logo"),t.setAttribute("rel","noopener"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var _H=Object.defineProperty,BR=Object.getOwnPropertySymbols,yH=Object.prototype.hasOwnProperty,vH=Object.prototype.propertyIsEnumerable,zR=(e,n,t)=>n in e?_H(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,VR=(e,n)=>{for(var t in n||(n={}))yH.call(n,t)&&zR(e,t,n[t]);if(BR)for(var t of BR(n))vH.call(n,t)&&zR(e,t,n[t]);return e};function vh(e,n,t){const i=window.document.createElement(e);return void 0!==n&&(i.className=n),t&&t.appendChild(i),i}function UR(e,n){let t=null;try{t=new URL(e)}catch{return{url:e}}return t.host===ys.maptilerApiHost&&(t.searchParams.has("key")||t.searchParams.append("key",al.apiKey),al.session&&t.searchParams.append("mtsid",LR)),{url:t.href}}function jR(e=null){return function(n,t){if(e){const i=e(n,t),r=UR(i.url);return VR(VR({},i),r)}return UR(n)}}function $R(e){return e?"string"==typeof e||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:AR(e):e instanceof F1?e.getExpandedStyleURL():e instanceof O1?e.getDefaultVariant().getExpandedStyleURL():e:N1[Iv[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class EH{constructor(){!function xH(e,n){e.forEach(t=>{n[t]&&(n[t]=n[t].bind(n))})}(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(n){return this._map=n,this._container=vh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=vh("button","maplibregl-ctrl-terrain",this._container),vh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){(function wH(e){e.parentNode&&e.parentNode.removeChild(e)})(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}}class CH extends Yt.NavigationControl{onAdd(n){return super.onAdd(n)}}class SH extends CH{constructor(){super({showCompass:!0,showZoom:!0,visualizePitch:!0}),this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",n=>{0===this._map.getPitch()?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})}_createButton(n,t){const i=super._createButton(n,t);return i.clickFunction=t,i}_rotateCompassArrow(){const n=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5))}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n}}class DH extends Yt.GeolocateControl{onAdd(n){return super.onAdd(n)}}var IH=Object.defineProperty,MH=Object.defineProperties,TH=Object.getOwnPropertyDescriptors,HR=Object.getOwnPropertySymbols,AH=Object.prototype.hasOwnProperty,kH=Object.prototype.propertyIsEnumerable,qR=(e,n,t)=>n in e?IH(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const GR=Yt.Marker,WR=Yt.LngLat,FH=Yt.LngLatBounds;class OH extends DH{constructor(){super(...arguments),this.lastUpdatedCenter=new WR(0,0)}_updateCamera(n){const t=new WR(n.coords.longitude,n.coords.latitude),i=n.coords.accuracy,a=(e=((e,n)=>{for(var t in n||(n={}))AH.call(n,t)&&qR(e,t,n[t]);if(HR)for(var t of HR(n))kH.call(n,t)&&qR(e,t,n[t]);return e})({bearing:this._map.getBearing()},this.options.fitBoundsOptions),MH(e,TH({linear:!0}))),u=this._map.getZoom();var e;u>this.options.fitBoundsOptions.maxZoom&&(a.zoom=u),this._map.fitBounds(FH.fromLngLat(t,i),a,{geolocateSource:!0});let p=!1;const y=()=>{p=!0};this._map.once("click",y),this._map.once("dblclick",y),this._map.once("dragstart",y),this._map.once("mousedown",y),this._map.once("touchstart",y),this._map.once("wheel",y),this._map.once("moveend",()=>{this._map.off("click",y),this._map.off("dblclick",y),this._map.off("dragstart",y),this._map.off("mousedown",y),this._map.off("touchstart",y),this._map.off("wheel",y),!p&&(this.lastUpdatedCenter=this._map.getCenter())})}_setupUI(n){if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=vh("button","maplibregl-ctrl-geolocate",this._container),vh("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===n){const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=vh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new GR(this._dotElement),this._circleElement=vh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new GR({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",t=>{const i=t.originalEvent&&"resize"===t.originalEvent.type,r=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!t.geolocateSource&&"ACTIVE_LOCK"===this._watchState&&!i&&r>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}_updateCircleRadius(){if("BACKGROUND"!==this._watchState&&"ACTIVE_LOCK"!==this._watchState)return;const t=this._map.project([this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude]),i=this._map.unproject([t.x,t.y]),r=this._map.unproject([t.x+20,t.y]),a=i.distanceTo(r)/20,u=Math.ceil(2*this._accuracy/a);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}}class LH extends Yt.AttributionControl{onAdd(n){return super.onAdd(n)}}class NH extends Yt.ScaleControl{onAdd(n){return super.onAdd(n)}}class BH extends Yt.FullscreenControl{onAdd(n){return super.onAdd(n)}}var zH=Object.defineProperty,VH=Object.defineProperties,UH=Object.getOwnPropertyDescriptors,ZR=Object.getOwnPropertySymbols,jH=Object.prototype.hasOwnProperty,$H=Object.prototype.propertyIsEnumerable,KR=(e,n,t)=>n in e?zH(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Qu=(e,n,t)=>new Promise((i,r)=>{var a=y=>{try{p(t.next(y))}catch(E){r(E)}},u=y=>{try{p(t.throw(y))}catch(E){r(E)}},p=y=>y.done?i(y.value):Promise.resolve(y.value).then(a,u);p((t=t.apply(e,n)).next())});class WH extends Yt.Map{constructor(n){var t,i,r;n.apiKey&&(al.apiKey=n.apiKey);const a=$R(n.style),u=location.hash;al.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!"),super(((e,n)=>VH(e,UH(n)))(((e,n)=>{for(var t in n||(n={}))jH.call(n,t)&&KR(e,t,n[t]);if(ZR)for(var t of ZR(n))$H.call(n,t)&&KR(e,t,n[t]);return e})({},n),{style:a,maplibreLogo:!1,transformRequest:jR(n.transformRequest)})),this.isTerrainEnabled=!1,this.terrainExaggeration=1,this.primaryLanguage=null,this.secondaryLanguage=null,this.terrainGrowing=!1,this.terrainFlattening=!1,this.primaryLanguage=null!=(t=n.language)?t:al.primaryLanguage,this.secondaryLanguage=al.secondaryLanguage,this.terrainExaggeration=null!=(i=n.terrainExaggeration)?i:this.terrainExaggeration,this.once("styledata",()=>Qu(this,null,function*(){if(!n.geolocate||n.center||n.hash&&u)return;try{if("COUNTRY"===n.geolocate)return void(yield this.fitToIpBounds())}catch(H){console.warn(H.message)}let R=null;try{yield this.centerOnIpPoint(n.zoom),R=this.getCameraHash()}catch(H){console.warn(H.message)}"granted"===(yield navigator.permissions.query({name:"geolocation"})).state&&navigator.geolocation.getCurrentPosition(H=>{R===this.getCameraHash()&&(this.terrain?this.easeTo({center:[H.coords.longitude,H.coords.latitude],zoom:n.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[H.coords.longitude,H.coords.latitude],zoom:n.zoom||12,duration:2e3})}))},null,{maximumAge:864e5,timeout:5e3,enableHighAccuracy:!1})})),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage),this.setSecondaryLanguage(this.secondaryLanguage)}),this.on("styledata",()=>{null===this.getTerrain()&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",()=>Qu(this,null,function*(){!function bH(){"unavailable"===Yt.getRTLTextPluginStatus()&&Yt.setRTLTextPlugin(ys.rtlPluginURL,null,!0)}()})),this.once("load",()=>Qu(this,null,function*(){let R={logo:null};try{const B=Object.keys(this.style.sourceCaches).map(re=>this.getSource(re)).filter(re=>"string"==typeof re.url&&re.url.includes("tiles.json")),H=new URL(B[0].url);H.searchParams.has("key")||H.searchParams.append("key",al.apiKey),R=yield(yield fetch(H.href)).json()}catch{}if("logo"in R&&R.logo?(this.addControl(new NR({logoURL:R.logo}),n.logoPosition),!1===n.attributionControl&&this.addControl(new LH({customAttribution:n.customAttribution}))):n.maptilerLogo&&this.addControl(new NR,n.logoPosition),n.scaleControl){const B=!0===n.scaleControl||void 0===n.scaleControl?"bottom-right":n.scaleControl,H=new NH({unit:al.unit});this.addControl(H,B),al.on("unit",X=>{H.setUnit(X)})}if(!1!==n.navigationControl){const B=!0===n.navigationControl||void 0===n.navigationControl?"top-right":n.navigationControl;this.addControl(new SH,B)}if(!1!==n.geolocateControl){const B=!0===n.geolocateControl||void 0===n.geolocateControl?"top-right":n.geolocateControl;this.addControl(new OH({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),B)}if(n.terrainControl){const B=!0===n.terrainControl||void 0===n.terrainControl?"top-right":n.terrainControl;this.addControl(new EH,B)}if(n.fullscreenControl){const B=!0===n.fullscreenControl||void 0===n.fullscreenControl?"top-right":n.fullscreenControl;this.addControl(new BH({}),B)}}));let p=!1,y=!1,E=null;this.once("load",R=>{p=!0,y&&this.fire("loadWithTerrain",E)});const I=R=>{R.terrain&&(y=!0,E={type:"loadWithTerrain",target:this,terrain:R.terrain},this.off("terrain",I),p&&this.fire("loadWithTerrain",E))};this.on("terrain",I),n.terrain&&this.enableTerrain(null!=(r=n.terrainExaggeration)?r:this.terrainExaggeration)}onLoadAsync(){return Qu(this,null,function*(){return new Promise((n,t)=>{if(this.loaded())return n(this);this.once("load",i=>{n(this)})})})}onLoadWithTerrainAsync(){return Qu(this,null,function*(){return new Promise((n,t)=>{if(this.loaded()&&this.terrain)return n(this);this.once("loadWithTerrain",i=>{n(this)})})})}setStyle(n,t){return super.setStyle($R(n),t)}setLanguage(n=ys.primaryLanguage){if(n===sl.AUTO)return this.setLanguage(q1());this.setPrimaryLanguage(n)}setPrimaryLanguage(n=ys.primaryLanguage){this.primaryLanguage!==sl.STYLE_LOCK?OR(n)&&(this.primaryLanguage=n,this.onStyleReady(()=>{if(n===sl.AUTO)return this.setPrimaryLanguage(q1());const t=this.getStyle().layers,i=/^\s*{\s*name\s*(:\s*(\S*))?\s*}$/,r=/^\s*name\s*(:\s*(\S*))?\s*$/,a=/^\s*{\s*name\s*(:\s*(\S*))?\s*}(\s*){\s*name\s*(:\s*(\S*))?\s*}$/,u=/^(.*)({\s*name\s*(:\s*(\S*))?\s*})(.*)$/,p=n?`name:${n}`:"name",y=["case",["has",p],["get",p],["get","name"]];for(let E=0;E<t.length;E+=1){const I=t[E],R=I.layout;if(!R||!R["text-field"])continue;const B=this.getLayoutProperty(I.id,"text-field");let H;if(Array.isArray(B)&&B.length>=2&&"concat"===B[0].trim().toLowerCase()){const X=B.slice();for(let re=0;re<B.length;re+=1){const _e=B[re];if(("string"==typeof _e||_e instanceof String)&&i.exec(_e.toString())){X[re]=y;break}if(Array.isArray(_e)&&_e.length>=2&&"get"===_e[0].trim().toLowerCase()&&r.exec(_e[1].toString())){X[re]=y;break}if(Array.isArray(_e)&&4===_e.length&&"case"===_e[0].trim().toLowerCase()){X[re]=y;break}}this.setLayoutProperty(I.id,"text-field",X)}else Array.isArray(B)&&B.length>=2&&"get"===B[0].trim().toLowerCase()&&r.exec(B[1].toString())||("string"==typeof B||B instanceof String)&&i.exec(B.toString())||Array.isArray(B)&&4===B.length&&"case"===B[0].trim().toLowerCase()?this.setLayoutProperty(I.id,"text-field",y):("string"==typeof B||B instanceof String)&&null!==(H=a.exec(B.toString()))?this.setLayoutProperty(I.id,"text-field",`{${p}}${H[3]}{name${H[4]||""}}`):("string"==typeof B||B instanceof String)&&null!==(H=u.exec(B.toString()))&&this.setLayoutProperty(I.id,"text-field",`${H[1]}{${p}}${H[5]}`)}})):console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.")}setSecondaryLanguage(n=ys.secondaryLanguage){this.primaryLanguage!==sl.STYLE_LOCK?OR(n)&&(this.secondaryLanguage=n,this.onStyleReady(()=>{if(n===sl.AUTO)return this.setSecondaryLanguage(q1());const t=this.getStyle().layers,i=/^\s*{\s*name\s*(:\s*(\S*))?\s*}$/,r=/^\s*name\s*(:\s*(\S*))?\s*$/,a=/^\s*{\s*name\s*(:\s*(\S*))?\s*}(\s*){\s*name\s*(:\s*(\S*))?\s*}$/;let u;for(let p=0;p<t.length;p+=1){const y=t[p],E=y.layout;if(!E||!E["text-field"])continue;const I=this.getLayoutProperty(y.id,"text-field");let R;if(Array.isArray(I)&&I.length>=2&&"concat"===I[0].trim().toLowerCase()){R=I.slice();let B=0;for(let H=0;H<I.length;H+=1){const X=I[H];if(("string"==typeof X||X instanceof String)&&i.exec(X.toString())){if(1===B){R[H]=`{name:${n}}`;break}B+=1}else if(Array.isArray(X)&&X.length>=2&&"get"===X[0].trim().toLowerCase()&&r.exec(X[1].toString())){if(1===B){R[H][1]=`name:${n}`;break}B+=1}else if(Array.isArray(X)&&4===X.length&&"case"===X[0].trim().toLowerCase()){if(1===B){R[H]=["get",`name:${n}`];break}B+=1}}this.setLayoutProperty(y.id,"text-field",R)}else("string"==typeof I||I instanceof String)&&null!==(u=a.exec(I.toString()))&&(R=`{name${u[1]||""}}${u[3]}{${n?`name:${n}`:"name"}}`,this.setLayoutProperty(y.id,"text-field",R))}})):console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.")}getPrimaryLanguage(){return this.primaryLanguage}getSecondaryLanguage(){return this.secondaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(n,t=1e3){if(!this.terrain)return;const i=performance.now(),r=this.terrain.exaggeration,a=n-r,u=()=>{if(!this.terrain||this.terrainFlattening)return;const p=(performance.now()-i)/t;if(p<.99){const y=1-Math.pow(1-p,4);this.terrain.exaggeration=r+y*a,requestAnimationFrame(u)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=n;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(u)}enableTerrain(n=this.terrainExaggeration){if(n<0)return void console.warn("Terrain exaggeration cannot be negative.");const t=r=>Qu(this,null,function*(){!this.terrain||"data"!==r.type||"source"!==r.dataType||!("source"in r)||"maptiler-terrain"!==r.sourceId||"raster-dem"!==r.source.type||r.isSourceLoaded&&(this.off("data",t),this.growTerrain(n))}),i=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=n,this.on("data",t),this.addSource(ys.terrainSourceId,{type:"raster-dem",url:ys.terrainSourceURL}),this.setTerrain({source:ys.terrainSourceId,exaggeration:0})};if(this.getTerrain())return this.isTerrainEnabled=!0,void this.growTerrain(n);this.loaded()||this.isTerrainEnabled?i():this.once("load",()=>{this.getTerrain()&&this.getSource(ys.terrainSourceId)||i()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const t=performance.now(),i=this.terrain.exaggeration,r=()=>{if(!this.terrain||this.terrainGrowing)return;const a=(performance.now()-t)/1e3;if(a<.99){const u=Math.pow(1-a,4);this.terrain.exaggeration=i*u,requestAnimationFrame(r)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(null),this.getSource(ys.terrainSourceId)&&this.removeSource(ys.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(r)}setTerrainExaggeration(n,t=!0){!t&&this.terrain?(this.terrainExaggeration=n,this.terrain.exaggeration=n,this.triggerRepaint()):this.enableTerrain(n)}onStyleReady(n){this.isStyleLoaded()?n():this.once("styledata",()=>{n()})}fitToIpBounds(){return Qu(this,null,function*(){const n=yield MR.info();this.fitBounds(n.country_bounds,{duration:0,padding:100})})}centerOnIpPoint(n){return Qu(this,null,function*(){const t=yield MR.info();this.jumpTo({center:[t.longitude,t.latitude],zoom:n||11})})}getCameraHash(){const n=new Float32Array(5),t=this.getCenter();return n[0]=t.lng,n[1]=t.lat,n[2]=this.getZoom(),n[3]=this.getPitch(),n[4]=this.getBearing(),C8_fromUint8Array(new Uint8Array(n.buffer))}getSdkConfig(){return al}getMaptilerSessionId(){return LR}setTransformRequest(n){return super.setTransformRequest(jR(n)),this}}class ZH extends Yt.Marker{addTo(n){return super.addTo(n)}}class KH extends Yt.Popup{addTo(n){return super.addTo(n)}}const Av=nc(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function kv(e){return new bn(n=>{Ee(e()).subscribe(n)})}function G1(){return In((e,n)=>{let t=null;e._refCount++;const i=xn(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const r=e._connection,a=t;t=null,r&&(!a||r===a)&&r.unsubscribe(),n.unsubscribe()});e.subscribe(i),i.closed||(t=e.connect())})}class W1 extends bn{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ba(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new Jt;const t=this.getSubject();n.add(this.source.subscribe(xn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=Jt.EMPTY)}return n}refCount(){return G1()(this)}}function Rv(e){return In((n,t)=>{let i=!1;n.subscribe(xn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(e),t.complete()}))})}function XR(e=YH){return In((n,t)=>{let i=!1;n.subscribe(xn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(e())))})}function YH(){return new Av}function bh(e,n){const t=arguments.length>=2;return i=>i.pipe(e?ji((r,a)=>e(r,a,i)):vr,_r(1),t?Rv(n):XR(()=>new Av))}function Z1(e){return e<=0?()=>gn:In((n,t)=>{let i=[];n.subscribe(xn(t,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}const Qt="primary",mg=Symbol("RouteTitle");class tq{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function tf(e){return new tq(e)}function nq(e,n,t){const i=t.path.split("/");if(i.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||i.length<e.length))return null;const r={};for(let a=0;a<i.length;a++){const u=i[a],p=e[a];if(u.startsWith(":"))r[u.substring(1)]=p;else if(u!==p.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function Ql(e,n){const t=e?Object.keys(e):void 0,i=n?Object.keys(n):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let a=0;a<t.length;a++)if(r=t[a],!YR(e[r],n[r]))return!1;return!0}function YR(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),i=[...n].sort();return t.every((r,a)=>i[a]===r)}return e===n}function QR(e){return e.length>0?e[e.length-1]:null}function Ju(e){return function XH(e){return!!e&&(e instanceof bn||$t(e.lift)&&$t(e.subscribe))}(e)?e:Mm(e)?ei(Promise.resolve(e)):_t(e)}const rq={exact:function tP(e,n,t){if(!xh(e.segments,n.segments)||!Pv(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!e.children[i]||!tP(e.children[i],n.children[i],t))return!1;return!0},subset:nP},JR={exact:function oq(e,n){return Ql(e,n)},subset:function sq(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>YR(e[t],n[t]))},ignored:()=>!0};function eP(e,n,t){return rq[t.paths](e.root,n.root,t.matrixParams)&&JR[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function nP(e,n,t){return iP(e,n,n.segments,t)}function iP(e,n,t,i){if(e.segments.length>t.length){const r=e.segments.slice(0,t.length);return!(!xh(r,t)||n.hasChildren()||!Pv(r,t,i))}if(e.segments.length===t.length){if(!xh(e.segments,t)||!Pv(e.segments,t,i))return!1;for(const r in n.children)if(!e.children[r]||!nP(e.children[r],n.children[r],i))return!1;return!0}{const r=t.slice(0,e.segments.length),a=t.slice(e.segments.length);return!!(xh(e.segments,r)&&Pv(e.segments,r,i)&&e.children[Qt])&&iP(e.children[Qt],n,a,i)}}function Pv(e,n,t){return n.every((i,r)=>JR[t](e[r].parameters,i.parameters))}class nf{constructor(n=new Wn([],{}),t={},i=null){this.root=n,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tf(this.queryParams)),this._queryParamMap}toString(){return cq.serialize(this)}}class Wn{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Fv(this)}}class gg{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=tf(this.parameters)),this._parameterMap}toString(){return sP(this)}}function xh(e,n){return e.length===n.length&&e.every((t,i)=>t.path===n[i].path)}let _g=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return new K1},providedIn:"root"})}return e})();class K1{parse(n){const t=new bq(n);return new nf(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${yg(n.root,!0)}`,i=function hq(e){const n=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(r=>`${Ov(t)}=${Ov(r)}`).join("&"):`${Ov(t)}=${Ov(i)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${i}${"string"==typeof n.fragment?`#${function uq(e){return encodeURI(e)}(n.fragment)}`:""}`}}const cq=new K1;function Fv(e){return e.segments.map(n=>sP(n)).join("/")}function yg(e,n){if(!e.hasChildren())return Fv(e);if(n){const t=e.children[Qt]?yg(e.children[Qt],!1):"",i=[];return Object.entries(e.children).forEach(([r,a])=>{r!==Qt&&i.push(`${r}:${yg(a,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function lq(e,n){let t=[];return Object.entries(e.children).forEach(([i,r])=>{i===Qt&&(t=t.concat(n(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==Qt&&(t=t.concat(n(r,i)))}),t}(e,(i,r)=>r===Qt?[yg(e.children[Qt],!1)]:[`${r}:${yg(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Qt]?`${Fv(e)}/${t[0]}`:`${Fv(e)}/(${t.join("//")})`}}function rP(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ov(e){return rP(e).replace(/%3B/gi,";")}function X1(e){return rP(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Lv(e){return decodeURIComponent(e)}function oP(e){return Lv(e.replace(/\+/g,"%20"))}function sP(e){return`${X1(e.path)}${function dq(e){return Object.keys(e).map(n=>`;${X1(n)}=${X1(e[n])}`).join("")}(e.parameters)}`}const pq=/^[^\/()?;#]+/;function Y1(e){const n=e.match(pq);return n?n[0]:""}const fq=/^[^\/()?;=#]+/,gq=/^[^=?&#]+/,yq=/^[^&#]+/;class bq{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Wn([],{}):new Wn([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(i[Qt]=new Wn(n,t)),i}parseSegment(){const n=Y1(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new be(4009,!1);return this.capture(n),new gg(Lv(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function mq(e){const n=e.match(fq);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Y1(this.remaining);r&&(i=r,this.capture(i))}n[Lv(t)]=Lv(i)}parseQueryParam(n){const t=function _q(e){const n=e.match(gq);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const u=function vq(e){const n=e.match(yq);return n?n[0]:""}(this.remaining);u&&(i=u,this.capture(i))}const r=oP(t),a=oP(i);if(n.hasOwnProperty(r)){let u=n[r];Array.isArray(u)||(u=[u],n[r]=u),u.push(a)}else n[r]=a}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Y1(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new be(4010,!1);let a;i.indexOf(":")>-1?(a=i.slice(0,i.indexOf(":")),this.capture(a),this.capture(":")):n&&(a=Qt);const u=this.parseChildren();t[a]=1===Object.keys(u).length?u[Qt]:new Wn([],u),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new be(4011,!1)}}function aP(e){return e.segments.length>0?new Wn([],{[Qt]:e}):e}function lP(e){const n={};for(const i of Object.keys(e.children)){const a=lP(e.children[i]);if(i===Qt&&0===a.segments.length&&a.hasChildren())for(const[u,p]of Object.entries(a.children))n[u]=p;else(a.segments.length>0||a.hasChildren())&&(n[i]=a)}return function xq(e){if(1===e.numberOfChildren&&e.children[Qt]){const n=e.children[Qt];return new Wn(e.segments.concat(n.segments),n.children)}return e}(new Wn(e.segments,n))}function wh(e){return e instanceof nf}function cP(e){let n;const r=aP(function t(a){const u={};for(const y of a.children){const E=t(y);u[y.outlet]=E}const p=new Wn(a.url,u);return a===e&&(n=p),p}(e.root));return n??r}function uP(e,n,t,i){let r=e;for(;r.parent;)r=r.parent;if(0===n.length)return Q1(r,r,r,t,i);const a=function Eq(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new hP(!0,0,e);let n=0,t=!1;const i=e.reduce((r,a,u)=>{if("object"==typeof a&&null!=a){if(a.outlets){const p={};return Object.entries(a.outlets).forEach(([y,E])=>{p[y]="string"==typeof E?E.split("/"):E}),[...r,{outlets:p}]}if(a.segmentPath)return[...r,a.segmentPath]}return"string"!=typeof a?[...r,a]:0===u?(a.split("/").forEach((p,y)=>{0==y&&"."===p||(0==y&&""===p?t=!0:".."===p?n++:""!=p&&r.push(p))}),r):[...r,a]},[]);return new hP(t,n,i)}(n);if(a.toRoot())return Q1(r,r,new Wn([],{}),t,i);const u=function Cq(e,n,t){if(e.isAbsolute)return new Bv(n,!0,0);if(!t)return new Bv(n,!1,NaN);if(null===t.parent)return new Bv(t,!0,0);const i=Nv(e.commands[0])?0:1;return function Sq(e,n,t){let i=e,r=n,a=t;for(;a>r;){if(a-=r,i=i.parent,!i)throw new be(4005,!1);r=i.segments.length}return new Bv(i,!1,r-a)}(t,t.segments.length-1+i,e.numberOfDoubleDots)}(a,r,e),p=u.processChildren?bg(u.segmentGroup,u.index,a.commands):pP(u.segmentGroup,u.index,a.commands);return Q1(r,u.segmentGroup,p,t,i)}function Nv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function vg(e){return"object"==typeof e&&null!=e&&e.outlets}function Q1(e,n,t,i,r){let u,a={};i&&Object.entries(i).forEach(([y,E])=>{a[y]=Array.isArray(E)?E.map(I=>`${I}`):`${E}`}),u=e===n?t:dP(e,n,t);const p=aP(lP(u));return new nf(p,a,r)}function dP(e,n,t){const i={};return Object.entries(e.children).forEach(([r,a])=>{i[r]=a===n?t:dP(a,n,t)}),new Wn(e.segments,i)}class hP{constructor(n,t,i){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=i,n&&i.length>0&&Nv(i[0]))throw new be(4003,!1);const r=i.find(vg);if(r&&r!==QR(i))throw new be(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Bv{constructor(n,t,i){this.segmentGroup=n,this.processChildren=t,this.index=i}}function pP(e,n,t){if(e||(e=new Wn([],{})),0===e.segments.length&&e.hasChildren())return bg(e,n,t);const i=function Iq(e,n,t){let i=0,r=n;const a={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=t.length)return a;const u=e.segments[r],p=t[i];if(vg(p))break;const y=`${p}`,E=i<t.length-1?t[i+1]:null;if(r>0&&void 0===y)break;if(y&&E&&"object"==typeof E&&void 0===E.outlets){if(!mP(y,E,u))return a;i+=2}else{if(!mP(y,{},u))return a;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,n,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const a=new Wn(e.segments.slice(0,i.pathIndex),{});return a.children[Qt]=new Wn(e.segments.slice(i.pathIndex),e.children),bg(a,0,r)}return i.match&&0===r.length?new Wn(e.segments,{}):i.match&&!e.hasChildren()?J1(e,n,t):i.match?bg(e,0,r):J1(e,n,t)}function bg(e,n,t){if(0===t.length)return new Wn(e.segments,{});{const i=function Dq(e){return vg(e[0])?e[0].outlets:{[Qt]:e}}(t),r={};if(Object.keys(i).some(a=>a!==Qt)&&e.children[Qt]&&1===e.numberOfChildren&&0===e.children[Qt].segments.length){const a=bg(e.children[Qt],n,t);return new Wn(e.segments,a.children)}return Object.entries(i).forEach(([a,u])=>{"string"==typeof u&&(u=[u]),null!==u&&(r[a]=pP(e.children[a],n,u))}),Object.entries(e.children).forEach(([a,u])=>{void 0===i[a]&&(r[a]=u)}),new Wn(e.segments,r)}}function J1(e,n,t){const i=e.segments.slice(0,n);let r=0;for(;r<t.length;){const a=t[r];if(vg(a)){const y=Mq(a.outlets);return new Wn(i,y)}if(0===r&&Nv(t[0])){i.push(new gg(e.segments[n].path,fP(t[0]))),r++;continue}const u=vg(a)?a.outlets[Qt]:`${a}`,p=r<t.length-1?t[r+1]:null;u&&p&&Nv(p)?(i.push(new gg(u,fP(p))),r+=2):(i.push(new gg(u,{})),r++)}return new Wn(i,{})}function Mq(e){const n={};return Object.entries(e).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(n[t]=J1(new Wn([],{}),0,i))}),n}function fP(e){const n={};return Object.entries(e).forEach(([t,i])=>n[t]=`${i}`),n}function mP(e,n,t){return e==t.path&&Ql(n,t.parameters)}const xg="imperative";class Jl{constructor(n,t){this.id=n,this.url=t}}class eE extends Jl{constructor(n,t,i="imperative",r=null){super(n,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class rf extends Jl{constructor(n,t,i){super(n,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class wg extends Jl{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Eg extends Jl{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=16}}class zv extends Jl{constructor(n,t,i,r){super(n,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class gP extends Jl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tq extends Jl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Aq extends Jl{constructor(n,t,i,r,a){super(n,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class kq extends Jl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rq extends Jl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pq{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Fq{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Oq{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Lq{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Nq{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Bq{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tE{}class nE{constructor(n){this.url=n}}class zq{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Cg,this.attachRef=null}}let Cg=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new zq,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class _P{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=iE(n,this._root);return t?t.children.map(i=>i.value):[]}firstChild(n){const t=iE(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=rE(n,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return rE(n,this._root).map(t=>t.value)}}function iE(e,n){if(e===n.value)return n;for(const t of n.children){const i=iE(e,t);if(i)return i}return null}function rE(e,n){if(e===n.value)return[n];for(const t of n.children){const i=rE(e,t);if(i.length)return i.unshift(n),i}return[]}class Uc{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function sf(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class yP extends _P{constructor(n,t){super(n),this.snapshot=t,oE(this,n)}toString(){return this.snapshot.toString()}}function vP(e,n){const t=function Vq(e,n){const u=new Vv([],{},{},"",{},Qt,n,null,{});return new xP("",new Uc(u,[]))}(0,n),i=new wi([new gg("",{})]),r=new wi({}),a=new wi({}),u=new wi({}),p=new wi(""),y=new af(i,r,u,p,a,Qt,n,t.root);return y.snapshot=t.root,new yP(new Uc(y,[]),t)}class af{constructor(n,t,i,r,a,u,p,y){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=a,this.outlet=u,this.component=p,this._futureSnapshot=y,this.title=this.dataSubject?.pipe(wt(E=>E[mg]))??_t(void 0),this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(wt(n=>tf(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(wt(n=>tf(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function bP(e,n="emptyOnly"){const t=e.pathFromRoot;let i=0;if("always"!==n)for(i=t.length-1;i>=1;){const r=t[i],a=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(a.component)break;i--}}return function Uq(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Vv{get title(){return this.data?.[mg]}constructor(n,t,i,r,a,u,p,y,E){this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=a,this.outlet=u,this.component=p,this.routeConfig=y,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=tf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class xP extends _P{constructor(n,t){super(t),this.url=n,oE(this,t)}toString(){return wP(this._root)}}function oE(e,n){n.value._routerState=e,n.children.forEach(t=>oE(e,t))}function wP(e){const n=e.children.length>0?` { ${e.children.map(wP).join(", ")} } `:"";return`${e.value}${n}`}function sE(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Ql(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Ql(n.params,t.params)||e.paramsSubject.next(t.params),function iq(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Ql(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),Ql(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function aE(e,n){const t=Ql(e.params,n.params)&&function aq(e,n){return xh(e,n)&&e.every((t,i)=>Ql(t.parameters,n[i].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||aE(e.parent,n.parent))}let EP=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Qt,this.activateEvents=new Dn,this.deactivateEvents=new Dn,this.attachEvents=new Dn,this.detachEvents=new Dn,this.parentContexts=Qe(Cg),this.location=Qe(Ta),this.changeDetector=Qe(Aa),this.environmentInjector=Qe(el),this.inputBinder=Qe(Uv,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new be(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new be(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new be(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new be(4013,!1);this._activatedRoute=t;const r=this.location,u=t.snapshot.component,p=this.parentContexts.getOrCreateContext(this.name).children,y=new jq(t,p,r.injector);this.activated=r.createComponent(u,{index:r.length,injector:y,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=ct({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Go]})}return e})();class jq{constructor(n,t,i){this.route=n,this.childContexts=t,this.parent=i}get(n,t){return n===af?this.route:n===Cg?this.childContexts:this.parent.get(n,t)}}const Uv=new Re("");function Sg(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=n.value;const r=function Hq(e,n,t){return n.children.map(i=>{for(const r of t.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return Sg(e,i,r);return Sg(e,i)})}(e,n,t);return new Uc(i,r)}{if(e.shouldAttach(n.value)){const a=e.retrieve(n.value);if(null!==a){const u=a.route;return u.value._futureSnapshot=n.value,u.children=n.children.map(p=>Sg(e,p)),u}}const i=function qq(e){return new af(new wi(e.url),new wi(e.params),new wi(e.queryParams),new wi(e.fragment),new wi(e.data),e.outlet,e.component,e)}(n.value),r=n.children.map(a=>Sg(e,a));return new Uc(i,r)}}const lE="ngNavigationCancelingError";function SP(e,n){const{redirectTo:t,navigationBehaviorOptions:i}=wh(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=DP(!1,0,n);return r.url=t,r.navigationBehaviorOptions=i,r}function DP(e,n,t){const i=new Error("NavigationCancelingError: "+(e||""));return i[lE]=!0,i.cancellationCode=n,t&&(i.url=t),i}function IP(e){return e&&e[lE]}let MP=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ci({type:e,selectors:[["ng-component"]],standalone:!0,features:[c0],decls:1,vars:0,template:function(i,r){1&i&&pr(0,"router-outlet")},dependencies:[EP],encapsulation:2})}return e})();function cE(e){const n=e.children&&e.children.map(cE),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Qt&&(t.component=MP),t}function ll(e){return e.outlet||Qt}function Dg(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Jq{constructor(n,t,i,r,a){this.routeReuseStrategy=n,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=a}activate(n){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,n),sE(this.futureState.root),this.activateChildRoutes(t,i,n)}deactivateChildRoutes(n,t,i){const r=sf(t);n.children.forEach(a=>{const u=a.value.outlet;this.deactivateRoutes(a,r[u],i),delete r[u]}),Object.values(r).forEach(a=>{this.deactivateRouteAndItsChildren(a,i)})}deactivateRoutes(n,t,i){const r=n.value,a=t?t.value:null;if(r===a)if(r.component){const u=i.getContext(r.outlet);u&&this.deactivateChildRoutes(n,t,u.children)}else this.deactivateChildRoutes(n,t,i);else a&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,a=sf(n);for(const u of Object.keys(a))this.deactivateRouteAndItsChildren(a[u],r);if(i&&i.outlet){const u=i.outlet.detach(),p=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:u,route:n,contexts:p})}}deactivateRouteAndOutlet(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,a=sf(n);for(const u of Object.keys(a))this.deactivateRouteAndItsChildren(a[u],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(n,t,i){const r=sf(t);n.children.forEach(a=>{this.activateRoutes(a,r[a.value.outlet],i),this.forwardEvent(new Bq(a.value.snapshot))}),n.children.length&&this.forwardEvent(new Lq(n.value.snapshot))}activateRoutes(n,t,i){const r=n.value,a=t?t.value:null;if(sE(r),r===a)if(r.component){const u=i.getOrCreateContext(r.outlet);this.activateChildRoutes(n,t,u.children)}else this.activateChildRoutes(n,t,i);else if(r.component){const u=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const p=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),u.children.onOutletReAttached(p.contexts),u.attachRef=p.componentRef,u.route=p.route.value,u.outlet&&u.outlet.attach(p.componentRef,p.route.value),sE(p.route.value),this.activateChildRoutes(n,null,u.children)}else{const p=Dg(r.snapshot);u.attachRef=null,u.route=r,u.injector=p,u.outlet&&u.outlet.activateWith(r,u.injector),this.activateChildRoutes(n,null,u.children)}}else this.activateChildRoutes(n,null,i)}}class TP{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class jv{constructor(n,t){this.component=n,this.route=t}}function eG(e,n,t){const i=e._root;return Ig(i,n?n._root:null,t,[i.value])}function lf(e,n){const t=Symbol(),i=n.get(e,t);return i===t?"function"!=typeof e||function iu(e){return null!==wl(e)}(e)?n.get(e):e:i}function Ig(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const a=sf(n);return e.children.forEach(u=>{(function nG(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const a=e.value,u=n?n.value:null,p=t?t.getContext(e.value.outlet):null;if(u&&a.routeConfig===u.routeConfig){const y=function iG(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!xh(e.url,n.url);case"pathParamsOrQueryParamsChange":return!xh(e.url,n.url)||!Ql(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!aE(e,n)||!Ql(e.queryParams,n.queryParams);default:return!aE(e,n)}}(u,a,a.routeConfig.runGuardsAndResolvers);y?r.canActivateChecks.push(new TP(i)):(a.data=u.data,a._resolvedData=u._resolvedData),Ig(e,n,a.component?p?p.children:null:t,i,r),y&&p&&p.outlet&&p.outlet.isActivated&&r.canDeactivateChecks.push(new jv(p.outlet.component,u))}else u&&Mg(n,p,r),r.canActivateChecks.push(new TP(i)),Ig(e,null,a.component?p?p.children:null:t,i,r)})(u,a[u.value.outlet],t,i.concat([u.value]),r),delete a[u.value.outlet]}),Object.entries(a).forEach(([u,p])=>Mg(p,t.getContext(u),r)),r}function Mg(e,n,t){const i=sf(e),r=e.value;Object.entries(i).forEach(([a,u])=>{Mg(u,r.component?n?n.children.getContext(a):null:n,t)}),t.canDeactivateChecks.push(new jv(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function Tg(e){return"function"==typeof e}function AP(e){return e instanceof Av||"EmptyError"===e?.name}const $v=Symbol("INITIAL_VALUE");function cf(){return ir(e=>bw(e.map(n=>n.pipe(_r(1),Oc($v)))).pipe(wt(n=>{for(const t of n)if(!0!==t){if(t===$v)return $v;if(!1===t||t instanceof nf)return t}return!0}),ji(n=>n!==$v),_r(1)))}function kP(e){return function hl(...e){return Ks(e)}(mr(n=>{if(wh(n))throw SP(0,n)}),wt(n=>!0===n))}class Hv{constructor(n){this.segmentGroup=n||null}}class RP{constructor(n){this.urlTree=n}}function uf(e){return hh(new Hv(e))}function PP(e){return hh(new RP(e))}class EG{constructor(n,t){this.urlSerializer=n,this.urlTree=t}noMatchError(n){return new be(4002,!1)}lineralizeSegments(n,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return _t(i);if(r.numberOfChildren>1||!r.children[Qt])return hh(new be(4e3,!1));r=r.children[Qt]}}applyRedirectCommands(n,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,i)}applyRedirectCreateUrlTree(n,t,i,r){const a=this.createSegmentGroup(n,t.root,i,r);return new nf(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const i={};return Object.entries(n).forEach(([r,a])=>{if("string"==typeof a&&a.startsWith(":")){const p=a.substring(1);i[r]=t[p]}else i[r]=a}),i}createSegmentGroup(n,t,i,r){const a=this.createSegments(n,t.segments,i,r);let u={};return Object.entries(t.children).forEach(([p,y])=>{u[p]=this.createSegmentGroup(n,y,i,r)}),new Wn(a,u)}createSegments(n,t,i,r){return t.map(a=>a.path.startsWith(":")?this.findPosParam(n,a,r):this.findOrReturn(a,i))}findPosParam(n,t,i){const r=i[t.path.substring(1)];if(!r)throw new be(4001,!1);return r}findOrReturn(n,t){let i=0;for(const r of t){if(r.path===n.path)return t.splice(i),r;i++}return n}}const uE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function CG(e,n,t,i,r){const a=dE(e,n,t);return a.matched?(i=function Wq(e,n){return e.providers&&!e._injector&&(e._injector=nI(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,i),function bG(e,n,t,i){const r=n.canMatch;return r&&0!==r.length?_t(r.map(u=>{const p=lf(u,e);return Ju(function cG(e){return e&&Tg(e.canMatch)}(p)?p.canMatch(n,t):e.runInContext(()=>p(n,t)))})).pipe(cf(),kP()):_t(!0)}(i,n,t).pipe(wt(u=>!0===u?a:{...uE}))):_t(a)}function dE(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...uE}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(n.matcher||nq)(t,e,n);if(!r)return{...uE};const a={};Object.entries(r.posParams??{}).forEach(([p,y])=>{a[p]=y.path});const u=r.consumed.length>0?{...a,...r.consumed[r.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:u,positionalParamSegments:r.posParams??{}}}function FP(e,n,t,i){return t.length>0&&function IG(e,n,t){return t.some(i=>qv(e,n,i)&&ll(i)!==Qt)}(e,t,i)?{segmentGroup:new Wn(n,DG(i,new Wn(t,e.children))),slicedSegments:[]}:0===t.length&&function MG(e,n,t){return t.some(i=>qv(e,n,i))}(e,t,i)?{segmentGroup:new Wn(e.segments,SG(e,0,t,i,e.children)),slicedSegments:t}:{segmentGroup:new Wn(e.segments,e.children),slicedSegments:t}}function SG(e,n,t,i,r){const a={};for(const u of i)if(qv(e,t,u)&&!r[ll(u)]){const p=new Wn([],{});a[ll(u)]=p}return{...r,...a}}function DG(e,n){const t={};t[Qt]=n;for(const i of e)if(""===i.path&&ll(i)!==Qt){const r=new Wn([],{});t[ll(i)]=r}return t}function qv(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class RG{constructor(n,t,i,r,a,u,p){this.injector=n,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=a,this.paramsInheritanceStrategy=u,this.urlSerializer=p,this.allowRedirects=!0,this.applyRedirects=new EG(this.urlSerializer,this.urlTree)}noMatchError(n){return new be(4002,!1)}recognize(){const n=FP(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Qt).pipe($u(t=>{if(t instanceof RP)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Hv?this.noMatchError(t):t}),wt(t=>{const i=new Vv([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Qt,this.rootComponentType,null,{}),r=new Uc(i,t),a=new xP("",r),u=function wq(e,n,t=null,i=null){return uP(cP(e),n,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return u.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(u),this.inheritParamsAndData(a._root),{state:a,tree:u}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,Qt).pipe($u(i=>{throw i instanceof Hv?this.noMatchError(i):i}))}inheritParamsAndData(n){const t=n.value,i=bP(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),n.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(n,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(n,t,i):this.processSegment(n,t,i,i.segments,r,!0)}processChildren(n,t,i){const r=[];for(const a of Object.keys(i.children))"primary"===a?r.unshift(a):r.push(a);return ei(r).pipe(eg(a=>{const u=i.children[a],p=function Yq(e,n){const t=e.filter(i=>ll(i)===n);return t.push(...e.filter(i=>ll(i)!==n)),t}(t,a);return this.processSegmentGroup(n,p,u,a)}),function JH(e,n){return In(function QH(e,n,t,i,r){return(a,u)=>{let p=t,y=n,E=0;a.subscribe(xn(u,I=>{const R=E++;y=p?e(y,I,R):(p=!0,I),i&&u.next(y)},r&&(()=>{p&&u.next(y),u.complete()})))}}(e,n,arguments.length>=2,!0))}((a,u)=>(a.push(...u),a)),Rv(null),function eq(e,n){const t=arguments.length>=2;return i=>i.pipe(e?ji((r,a)=>e(r,a,i)):vr,Z1(1),t?Rv(n):XR(()=>new Av))}(),tn(a=>{if(null===a)return uf(i);const u=OP(a);return function PG(e){e.sort((n,t)=>n.value.outlet===Qt?-1:t.value.outlet===Qt?1:n.value.outlet.localeCompare(t.value.outlet))}(u),_t(u)}))}processSegment(n,t,i,r,a,u){return ei(t).pipe(eg(p=>this.processSegmentAgainstRoute(p._injector??n,t,p,i,r,a,u).pipe($u(y=>{if(y instanceof Hv)return _t(null);throw y}))),bh(p=>!!p),$u(p=>{if(AP(p))return function AG(e,n,t){return 0===n.length&&!e.children[t]}(i,r,a)?_t([]):uf(i);throw p}))}processSegmentAgainstRoute(n,t,i,r,a,u,p){return function TG(e,n,t,i){return!!(ll(e)===i||i!==Qt&&qv(n,t,e))&&("**"===e.path||dE(n,e,t).matched)}(i,r,a,u)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,r,i,a,u,p):p&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,r,t,i,a,u):uf(r):uf(r)}expandSegmentAgainstRouteUsingRedirect(n,t,i,r,a,u){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,r,u):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,a,u)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,i,r){const a=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?PP(a):this.applyRedirects.lineralizeSegments(i,a).pipe(tn(u=>{const p=new Wn(u,{});return this.processSegment(n,t,p,u,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,a,u){const{matched:p,consumedSegments:y,remainingSegments:E,positionalParamSegments:I}=dE(t,r,a);if(!p)return uf(t);const R=this.applyRedirects.applyRedirectCommands(y,r.redirectTo,I);return r.redirectTo.startsWith("/")?PP(R):this.applyRedirects.lineralizeSegments(r,R).pipe(tn(B=>this.processSegment(n,i,t,B.concat(E),u,!1)))}matchSegmentAgainstRoute(n,t,i,r,a,u){let p;if("**"===i.path){const y=r.length>0?QR(r).parameters:{};p=_t({snapshot:new Vv(r,y,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,LP(i),ll(i),i.component??i._loadedComponent??null,i,NP(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else p=CG(t,i,r,n).pipe(wt(({matched:y,consumedSegments:E,remainingSegments:I,parameters:R})=>y?{snapshot:new Vv(E,R,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,LP(i),ll(i),i.component??i._loadedComponent??null,i,NP(i)),consumedSegments:E,remainingSegments:I}:null));return p.pipe(ir(y=>null===y?uf(t):this.getChildConfig(n=i._injector??n,i,r).pipe(ir(({routes:E})=>{const I=i._loadedInjector??n,{snapshot:R,consumedSegments:B,remainingSegments:H}=y,{segmentGroup:X,slicedSegments:re}=FP(t,B,H,E);if(0===re.length&&X.hasChildren())return this.processChildren(I,E,X).pipe(wt(Se=>null===Se?null:[new Uc(R,Se)]));if(0===E.length&&0===re.length)return _t([new Uc(R,[])]);const _e=ll(i)===a;return this.processSegment(I,E,X,re,_e?Qt:a,!0).pipe(wt(Se=>[new Uc(R,Se)]))}))))}getChildConfig(n,t,i){return t.children?_t({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?_t({routes:t._loadedRoutes,injector:t._loadedInjector}):function vG(e,n,t,i){const r=n.canLoad;return void 0===r||0===r.length?_t(!0):_t(r.map(u=>{const p=lf(u,e);return Ju(function oG(e){return e&&Tg(e.canLoad)}(p)?p.canLoad(n,t):e.runInContext(()=>p(n,t)))})).pipe(cf(),kP())}(n,t,i).pipe(tn(r=>r?this.configLoader.loadChildren(n,t).pipe(mr(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function wG(e){return hh(DP(!1,3))}())):_t({routes:[],injector:n})}}function FG(e){const n=e.value.routeConfig;return n&&""===n.path}function OP(e){const n=[],t=new Set;for(const i of e){if(!FG(i)){n.push(i);continue}const r=n.find(a=>i.value.routeConfig===a.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):n.push(i)}for(const i of t){const r=OP(i.children);n.push(new Uc(i.value,r))}return n.filter(i=>!t.has(i))}function LP(e){return e.data||{}}function NP(e){return e.resolve||{}}function BP(e){return"string"==typeof e.title||null===e.title}function hE(e){return ir(n=>{const t=e(n);return t?ei(t).pipe(wt(()=>n)):_t(n)})}const Gv=new Re("ROUTES");let zP=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Qe(Oz)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return _t(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Ju(t.loadComponent()).pipe(wt(VP),mr(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),Gy(()=>{this.componentLoaders.delete(t)})),r=new W1(i,()=>new St).pipe(G1());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return _t({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const a=function UG(e,n,t,i){return Ju(e.loadChildren()).pipe(wt(VP),tn(r=>r instanceof eI||Array.isArray(r)?_t(r):ei(n.compileModuleAsync(r))),wt(r=>{i&&i(e);let a,u,p=!1;return Array.isArray(r)?(u=r,!0):(a=r.create(t).injector,u=a.get(Gv,[],{optional:!0,self:!0}).flat()),{routes:u.map(cE),injector:a}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(Gy(()=>{this.childrenLoaders.delete(i)})),u=new W1(a,()=>new St).pipe(G1());return this.childrenLoaders.set(i,u),u}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function VP(e){return function jG(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let Wv=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new St,this.transitionAbortSubject=new St,this.configLoader=Qe(zP),this.environmentInjector=Qe(el),this.urlSerializer=Qe(_g),this.rootContexts=Qe(Cg),this.inputBindingEnabled=null!==Qe(Uv,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>_t(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Fq(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Pq(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new wi({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:xg,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ji(a=>0!==a.id),wt(a=>({...a,extractedUrl:t.urlHandlingStrategy.extract(a.rawUrl)})),ir(a=>{this.currentTransition=a;let u=!1,p=!1;return _t(a).pipe(mr(y=>{this.currentNavigation={id:y.id,initialUrl:y.rawUrl,extractedUrl:y.extractedUrl,trigger:y.source,extras:y.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ir(y=>{const E=y.currentBrowserUrl.toString(),I=!t.navigated||y.extractedUrl.toString()!==E||E!==y.currentUrlTree.toString();if(!I&&"reload"!==(y.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const B="";return this.events.next(new Eg(y.id,this.urlSerializer.serialize(y.rawUrl),B,0)),y.resolve(null),gn}if(t.urlHandlingStrategy.shouldProcessUrl(y.rawUrl))return _t(y).pipe(ir(B=>{const H=this.transitions?.getValue();return this.events.next(new eE(B.id,this.urlSerializer.serialize(B.extractedUrl),B.source,B.restoredState)),H!==this.transitions?.getValue()?gn:Promise.resolve(B)}),function OG(e,n,t,i,r,a){return tn(u=>function kG(e,n,t,i,r,a,u="emptyOnly"){return new RG(e,n,t,i,r,u,a).recognize()}(e,n,t,i,u.extractedUrl,r,a).pipe(wt(({state:p,tree:y})=>({...u,targetSnapshot:p,urlAfterRedirects:y}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),mr(B=>{a.targetSnapshot=B.targetSnapshot,a.urlAfterRedirects=B.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:B.urlAfterRedirects};const H=new gP(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(H)}));if(I&&t.urlHandlingStrategy.shouldProcessUrl(y.currentRawUrl)){const{id:B,extractedUrl:H,source:X,restoredState:re,extras:_e}=y,Se=new eE(B,this.urlSerializer.serialize(H),X,re);this.events.next(Se);const ye=vP(0,this.rootComponentType).snapshot;return this.currentTransition=a={...y,targetSnapshot:ye,urlAfterRedirects:H,extras:{..._e,skipLocationChange:!1,replaceUrl:!1}},_t(a)}{const B="";return this.events.next(new Eg(y.id,this.urlSerializer.serialize(y.extractedUrl),B,1)),y.resolve(null),gn}}),mr(y=>{const E=new Tq(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects),y.targetSnapshot);this.events.next(E)}),wt(y=>(this.currentTransition=a={...y,guards:eG(y.targetSnapshot,y.currentSnapshot,this.rootContexts)},a)),function dG(e,n){return tn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:a,canDeactivateChecks:u}}=t;return 0===u.length&&0===a.length?_t({...t,guardsResult:!0}):function hG(e,n,t,i){return ei(e).pipe(tn(r=>function yG(e,n,t,i,r){const a=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return a&&0!==a.length?_t(a.map(p=>{const y=Dg(n)??r,E=lf(p,y);return Ju(function lG(e){return e&&Tg(e.canDeactivate)}(E)?E.canDeactivate(e,n,t,i):y.runInContext(()=>E(e,n,t,i))).pipe(bh())})).pipe(cf()):_t(!0)}(r.component,r.route,t,n,i)),bh(r=>!0!==r,!0))}(u,i,r,e).pipe(tn(p=>p&&function rG(e){return"boolean"==typeof e}(p)?function pG(e,n,t,i){return ei(n).pipe(eg(r=>Wp(function mG(e,n){return null!==e&&n&&n(new Oq(e)),_t(!0)}(r.route.parent,i),function fG(e,n){return null!==e&&n&&n(new Nq(e)),_t(!0)}(r.route,i),function _G(e,n,t){const i=n[n.length-1],a=n.slice(0,n.length-1).reverse().map(u=>function tG(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(u)).filter(u=>null!==u).map(u=>kv(()=>_t(u.guards.map(y=>{const E=Dg(u.node)??t,I=lf(y,E);return Ju(function aG(e){return e&&Tg(e.canActivateChild)}(I)?I.canActivateChild(i,e):E.runInContext(()=>I(i,e))).pipe(bh())})).pipe(cf())));return _t(a).pipe(cf())}(e,r.path,t),function gG(e,n,t){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return _t(!0);const r=i.map(a=>kv(()=>{const u=Dg(n)??t,p=lf(a,u);return Ju(function sG(e){return e&&Tg(e.canActivate)}(p)?p.canActivate(n,e):u.runInContext(()=>p(n,e))).pipe(bh())}));return _t(r).pipe(cf())}(e,r.route,t))),bh(r=>!0!==r,!0))}(i,a,e,n):_t(p)),wt(p=>({...t,guardsResult:p})))})}(this.environmentInjector,y=>this.events.next(y)),mr(y=>{if(a.guardsResult=y.guardsResult,wh(y.guardsResult))throw SP(0,y.guardsResult);const E=new Aq(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects),y.targetSnapshot,!!y.guardsResult);this.events.next(E)}),ji(y=>!!y.guardsResult||(this.cancelNavigationTransition(y,"",3),!1)),hE(y=>{if(y.guards.canActivateChecks.length)return _t(y).pipe(mr(E=>{const I=new kq(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(I)}),ir(E=>{let I=!1;return _t(E).pipe(function LG(e,n){return tn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return _t(t);let a=0;return ei(r).pipe(eg(u=>function NG(e,n,t,i){const r=e.routeConfig,a=e._resolve;return void 0!==r?.title&&!BP(r)&&(a[mg]=r.title),function BG(e,n,t,i){const r=function zG(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===r.length)return _t({});const a={};return ei(r).pipe(tn(u=>function VG(e,n,t,i){const r=Dg(n)??i,a=lf(e,r);return Ju(a.resolve?a.resolve(n,t):r.runInContext(()=>a(n,t)))}(e[u],n,t,i).pipe(bh(),mr(p=>{a[u]=p}))),Z1(1),Ak(a),$u(u=>AP(u)?gn:hh(u)))}(a,e,n,i).pipe(wt(u=>(e._resolvedData=u,e.data=bP(e,t).resolve,r&&BP(r)&&(e.data[mg]=r.title),null)))}(u.route,i,e,n)),mr(()=>a++),Z1(1),tn(u=>a===r.length?_t(t):gn))})}(t.paramsInheritanceStrategy,this.environmentInjector),mr({next:()=>I=!0,complete:()=>{I||this.cancelNavigationTransition(E,"",2)}}))}),mr(E=>{const I=new Rq(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(I)}))}),hE(y=>{const E=I=>{const R=[];I.routeConfig?.loadComponent&&!I.routeConfig._loadedComponent&&R.push(this.configLoader.loadComponent(I.routeConfig).pipe(mr(B=>{I.component=B}),wt(()=>{})));for(const B of I.children)R.push(...E(B));return R};return bw(E(y.targetSnapshot.root)).pipe(Rv(),_r(1))}),hE(()=>this.afterPreactivation()),wt(y=>{const E=function $q(e,n,t){const i=Sg(e,n._root,t?t._root:void 0);return new yP(i,n)}(t.routeReuseStrategy,y.targetSnapshot,y.currentRouterState);return this.currentTransition=a={...y,targetRouterState:E},a}),mr(()=>{this.events.next(new tE)}),((e,n,t,i)=>wt(r=>(new Jq(n,r.targetRouterState,r.currentRouterState,t,i).activate(e),r)))(this.rootContexts,t.routeReuseStrategy,y=>this.events.next(y),this.inputBindingEnabled),_r(1),mr({next:y=>{u=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new rf(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects))),t.titleStrategy?.updateTitle(y.targetRouterState.snapshot),y.resolve(!0)},complete:()=>{u=!0}}),fo(this.transitionAbortSubject.pipe(mr(y=>{throw y}))),Gy(()=>{u||p||this.cancelNavigationTransition(a,"",1),this.currentNavigation?.id===a.id&&(this.currentNavigation=null)}),$u(y=>{if(p=!0,IP(y))this.events.next(new wg(a.id,this.urlSerializer.serialize(a.extractedUrl),y.message,y.cancellationCode)),function Gq(e){return IP(e)&&wh(e.url)}(y)?this.events.next(new nE(y.url)):a.resolve(!1);else{this.events.next(new zv(a.id,this.urlSerializer.serialize(a.extractedUrl),y,a.targetSnapshot??void 0));try{a.resolve(t.errorHandler(y))}catch(E){a.reject(E)}}return gn}))}))}cancelNavigationTransition(t,i,r){const a=new wg(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(a),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function UP(e){return e!==xg}let jP=(()=>{class e{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(a=>a.outlet===Qt);return i}getResolvedTitleForRoute(t){return t.data[mg]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return Qe($G)},providedIn:"root"})}return e})(),$G=(()=>{class e extends jP{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(pT))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),HG=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return Qe(GG)},providedIn:"root"})}return e})();class qG{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let GG=(()=>{class e extends qG{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Ii(e)))(r||e)}}();static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const pE=new Re("",{providedIn:"root",factory:()=>({})});let WG=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:function(){return Qe(ZG)},providedIn:"root"})}return e})(),ZG=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Ag=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(Ag||{});function KG(e){throw e}function XG(e,n,t){return n.parse("/")}const YG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},QG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let cl=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Qe(GI),this.isNgZoneEnabled=!1,this._events=new St,this.options=Qe(pE,{optional:!0})||{},this.pendingTasks=Qe(WI),this.errorHandler=this.options.errorHandler||KG,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||XG,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Qe(WG),this.routeReuseStrategy=Qe(HG),this.titleStrategy=Qe(jP),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Qe(Gv,{optional:!0})?.flat()??[],this.navigationTransitions=Qe(Wv),this.urlSerializer=Qe(_g),this.location=Qe(by),this.componentInputBindingEnabled=!!Qe(Uv,{optional:!0}),this.eventsSubscription=new Jt,this.isNgZoneEnabled=Qe(jt)instanceof jt&&jt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new nf,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=vP(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(HP(i)&&this._events.next(i));if(i instanceof eE)UP(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Eg)this.rawUrlTree=r.rawUrl;else if(i instanceof gP){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const a=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(a,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof tE)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof wg)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof nE){const a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),u={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||UP(r.source)};this.scheduleNavigation(a,xg,null,u,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof zv&&this.restoreHistory(r,!0),i instanceof rf&&(this.navigated=!0),HP(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),xg,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const a={replaceUrl:!0},u=r?.navigationId?r:null;if(r){const y={...r};delete y.navigationId,delete y.\u0275routerPageId,0!==Object.keys(y).length&&(a.state=y)}const p=this.parseUrl(t);this.scheduleNavigation(p,i,u,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(cE),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:a,fragment:u,queryParamsHandling:p,preserveFragment:y}=i,E=y?this.currentUrlTree.fragment:u;let R,I=null;switch(p){case"merge":I={...this.currentUrlTree.queryParams,...a};break;case"preserve":I=this.currentUrlTree.queryParams;break;default:I=a||null}null!==I&&(I=this.removeEmptyProps(I));try{R=cP(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),R=this.currentUrlTree.root}return uP(R,t,I,E??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=wh(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(a,xg,null,i)}navigate(t,i={skipLocationChange:!1}){return function JG(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new be(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...YG}:!1===i?{...QG}:i,wh(t))return eP(this.currentUrlTree,t,r);const a=this.parseUrl(t);return eP(this.currentUrlTree,a,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const a=t[r];return null!=a&&(i[r]=a),i},{})}scheduleNavigation(t,i,r,a,u){if(this.disposed)return Promise.resolve(!1);let p,y,E;u?(p=u.resolve,y=u.reject,E=u.promise):E=new Promise((R,B)=>{p=R,y=B});const I=this.pendingTasks.add();return function $P(e,n){e.events.pipe(ji(t=>t instanceof rf||t instanceof wg||t instanceof zv||t instanceof Eg),wt(t=>t instanceof rf||t instanceof Eg?Ag.COMPLETE:t instanceof wg&&(0===t.code||1===t.code)?Ag.REDIRECTING:Ag.FAILED),ji(t=>t!==Ag.REDIRECTING),_r(1)).subscribe(()=>{n()})}(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(I))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:a,resolve:p,reject:y,promise:E,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),E.catch(R=>Promise.reject(R))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const u={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",u)}else{const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",a)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-this.browserPageId;0!==a?this.location.historyGo(a):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===a&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function HP(e){return!(e instanceof tE||e instanceof nE)}const a9=["map"];let l9=(()=>{class e{constructor(t){this.router=t,this.katanaLocationList=[],this.katanaService=Qe(Yk),this.locationZoom=12,this.persistInUrl=i=>{null===i.id?this.selectedKatanaLocationId=void 0:void 0!==i.id&&(this.selectedKatanaLocationId=i.id);const r=this.map.getCenter(),a=this.map.getZoom(),u=`${r.lat.toFixed(7)},${r.lng.toFixed(7)},${a.toFixed(1)}z`;this.router.navigate([],null==this.selectedKatanaLocationId?{fragment:`@${u}`}:{fragment:`${this.selectedKatanaLocationId}@${u}`})},this.katanaLocationList=this.katanaService.getAllKatanaLocations()}ngOnInit(){al.apiKey="s3Z3dlUtjpkA63HXA5LH",this.loadStateFromFragment()}ngAfterViewInit(){let t={lat:this.initialLat??24.577528,lng:this.initialLng??133.8223832,zoom:this.initialZoom??2};if(this.selectedKatanaLocationId){const i=this.getKatanaLocationById(this.selectedKatanaLocationId);i&&(t={lat:i.lat,lng:i.lng,zoom:this.locationZoom})}this.map=new WH({container:this.mapContainer.nativeElement,style:N1.STREETS,center:[t.lng,t.lat],zoom:t.zoom}),this.map.on("moveend",()=>{this.persistInUrl({})});for(const i of this.katanaLocationList){let r=(i.links??[]).map(E=>`\n        <button aria-label="Link-${E.name}" onclick="\n          gtag('event', 'item-link-click', {\n            'event_category': 'Map',\n            'event_label': 'Open Item Link',\n            'link_url': '${E.url}',\n            'location_id': '${i.id}'\n          });\n          window.open('${E.url}', '_blank');\n        ">\n          ${E.name}\n        </button>\n      `).join(),a=`${location.href}#${i.id}`,u=`https://www.google.com/maps/@${i.lat},${i.lng},20z`,p=`maps://maps.google.com/?q=${i.lat},${i.lng}`,y=new ZH({color:"#FF0011"}).setLngLat([i.lng,i.lat]).addTo(this.map).setPopup((new KH).setMaxWidth("500px").setHTML(`\n            <div align="left">\n              <img src="${i.photo}" width="450px" alt="Photo of ${i.name}" />\n              <h3>\n                <a href="${i.url}" target="_blank">${i.name}</a>\n                <button aria-label="Share" onclick="\n                  gtag('event', 'share', {\n                    'event_category': 'Popup',\n                    'event_label': 'Share',\n                    'value': '${a}',\n                    'location_id': '${i.id}'\n                  });\n                  navigator.share({ url: '${a}', title: '${i.name} on Katana Map', text: '${i.name} on Katana Map --- map of places, where you can see katana swords' });\n                ">\n                  share\n                </button>\n                <button aria-label="google-maps-link-${i.name}" onclick="\n                  gtag('event', 'google-maps-click', {\n                    'event_category': 'Map',\n                    'event_label': 'Open Google Maps Link',\n                    'link_url': '${u}',\n                    'location_id': '${i.id}'\n                  });\n                  window.open('${u}', '_blank');\n                ">\n                  google maps\n                </button>\n                <button aria-label="maps-link-${i.name}" onclick="\n                  gtag('event', 'maps-click', {\n                    'event_category': 'Map',\n                    'event_label': 'Open Maps Link',\n                    'link_url': '${p}',\n                    'location_id': '${i.id}'\n                  });\n                  window.open('${p}');\n                ">\n                  open in maps\n                </button>\n              </h3>\n              <h4>\n                ${i.city}\n              </h4>\n              <p>\n                ${i.notes}\n              </p>\n              <p>\n                ${r}\n              </p>\n            </div>\n          `).on("open",()=>{this.map.getZoom()<this.locationZoom&&this.map.flyTo({center:[i.lng,i.lat],zoom:this.locationZoom,duration:2e3,essential:!0}),this.persistInUrl({id:i.id}),gtag("event","open-popup",{event_category:"Map",event_label:"Open Popup",value:location.href,location_id:`${i.id}`})}).on("close",()=>{this.persistInUrl({id:null})}));this.selectedKatanaLocationId==i.id&&y.togglePopup()}}ngOnDestroy(){this.map?.remove()}getKatanaLocationById(t){return this.katanaLocationList.find(i=>i.id===t)}loadStateFromFragment(){let t=location.href.replace(/^.*[#]/,"");if(t.length>0){let[i,r]=t.split("@");try{this.selectedKatanaLocationId=parseInt(i),isNaN(this.selectedKatanaLocationId)&&(this.selectedKatanaLocationId=void 0)}catch(a){console.warn("location id parsing failed:",a)}try{if(r.endsWith("z")){let a=r.split(","),[u,p,y]=[a[0],a[1],a[2].slice(0,-1)].map(E=>{const I=parseFloat(E);if(!isNaN(I))return I});this.initialLat=u,this.initialLng=p,this.initialZoom=y}}catch(a){console.warn("map settings parsing failed:",a)}}}static#e=this.\u0275fac=function(i){return new(i||e)(me(cl))};static#t=this.\u0275cmp=Ci({type:e,selectors:[["app-map"]],viewQuery:function(i,r){if(1&i&&Bm(a9,5),2&i){let a;Rr(a=Pr())&&(r.mapContainer=a.first)}},decls:3,vars:0,consts:[[1,"map-wrap"],[1,"map"],["map",""]],template:function(i,r){1&i&&(Kt(0,"div",0),pr(1,"div",1,2),vn())},styles:[".map-wrap[_ngcontent-%COMP%]{position:relative;width:100%;height:calc(100vh - 64px)}.map[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}"]})}return e})(),c9=(()=>{class e{constructor(){this.title="katana-map"}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ci({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"App"]],template:function(i,r){1&i&&(Kt(0,"div",0),pr(1,"app-navbar")(2,"app-map"),vn())},dependencies:[Qk,l9],styles:[".App[_ngcontent-%COMP%]{text-align:center}"]})}return e})();const ed=new bn(no),d9={connector:()=>new St};function YP(e,n=d9){const{connector:t}=n;return In((i,r)=>{const a=t();Ee(e(function u9(e){return new bn(n=>e.subscribe(n))}(a))).subscribe(r),r.add(i.subscribe(a))})}const kg="Service workers are disabled or not supported by this browser";class Zv{constructor(n){if(this.serviceWorker=n,n){const i=ug(n,"controllerchange").pipe(wt(()=>n.controller)),a=Wp(kv(()=>_t(n.controller)),i);this.worker=a.pipe(ji(I=>!!I)),this.registration=this.worker.pipe(ir(()=>n.getRegistration()));const E=ug(n,"message").pipe(wt(I=>I.data)).pipe(ji(I=>I&&I.type)).pipe(function p9(e){return e?n=>YP(e)(n):n=>function h9(e,n){const t=$t(e)?e:()=>e;return $t(n)?YP(n,{connector:t}):i=>new W1(i,t)}(new St)(n)}());E.connect(),this.events=E}else this.worker=this.events=this.registration=function f9(e){return kv(()=>hh(new Error(e)))}(kg)}postMessage(n,t){return this.worker.pipe(_r(1),mr(i=>{i.postMessage({action:n,...t})})).toPromise().then(()=>{})}postMessageWithOperation(n,t,i){const r=this.waitForOperationCompleted(i),a=this.postMessage(n,t);return Promise.all([a,r]).then(([,u])=>u)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let t;return t="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(ji(t))}nextEventOfType(n){return this.eventsOfType(n).pipe(_r(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(ji(t=>t.nonce===n),_r(1),wt(t=>{if(void 0!==t.result)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let QP=(()=>{class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new St,!t.isEnabled)return this.messages=ed,this.notificationClicks=ed,void(this.subscription=ed);this.messages=this.sw.eventsOfType("PUSH").pipe(wt(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(wt(r=>r.data)),this.pushManager=this.sw.registration.pipe(wt(r=>r.pushManager));const i=this.pushManager.pipe(ir(r=>r.getSubscription()));this.subscription=Ht(i,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(kg));const i={userVisibleOnly:!0};let r=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(r.length));for(let u=0;u<r.length;u++)a[u]=r.charCodeAt(u);return i.applicationServerKey=a,this.pushManager.pipe(ir(u=>u.subscribe(i)),_r(1)).toPromise().then(u=>(this.subscriptionChanges.next(u),u))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(_r(1),ir(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(kg))}decodeBase64(t){return atob(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Zv))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})(),_E=(()=>{class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled)return this.versionUpdates=ed,this.available=ed,this.activated=ed,void(this.unrecoverable=ed);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(ji(i=>"VERSION_READY"===i.type),wt(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(kg));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(kg));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(Zv))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();const JP=new Re("NGSW_REGISTER_SCRIPT");function m9(e,n,t,i){return()=>{if(!X0(i)||!("serviceWorker"in navigator)||!1===t.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof t.registrationStrategy)r=t.registrationStrategy();else{const[u,...p]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(u){case"registerImmediately":r=_t(null);break;case"registerWithDelay":r=e2(+p[0]||0);break;case"registerWhenStable":r=p[0]?Ht(t2(e),e2(+p[0])):t2(e);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}e.get(jt).runOutsideAngular(()=>r.pipe(_r(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:t.scope}).catch(u=>console.error("Service worker registration failed with:",u))))}}function e2(e){return _t(null).pipe(p1(e))}function t2(e){return e.get(zu).isStable.pipe(ji(t=>t))}function g9(e,n){return new Zv(X0(n)&&!1!==e.enabled?navigator.serviceWorker:void 0)}class yE{}function _9(e,n={}){return function rx(e){return{\u0275providers:e}}([QP,_E,{provide:JP,useValue:e},{provide:yE,useValue:n},{provide:Zv,useFactory:g9,deps:[yE,Mc]},{provide:qI,useFactory:m9,deps:[Jo,JP,yE,Mc],multi:!0}])}let y9=(()=>{class e{static register(t,i={}){return{ngModule:e,providers:[_9(t,i)]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({providers:[QP,_E]})}return e})();function n2(e){return new be(3e3,!1)}function td(e){switch(e.length){case 0:return new cg;case 1:return e[0];default:return new wk(e)}}function r2(e,n,t=new Map,i=new Map){const r=[],a=[];let u=-1,p=null;if(n.forEach(y=>{const E=y.get("offset"),I=E==u,R=I&&p||new Map;y.forEach((B,H)=>{let X=H,re=B;if("offset"!==H)switch(X=e.normalizePropertyName(X,r),re){case"!":re=t.get(H);break;case Bc:re=i.get(H);break;default:re=e.normalizeStyleValue(H,X,re,r)}R.set(X,re)}),I||a.push(R),p=R,u=E}),r.length)throw function U9(e){return new be(3502,!1)}();return a}function vE(e,n,t,i){switch(n){case"start":e.onStart(()=>i(t&&bE(t,"start",e)));break;case"done":e.onDone(()=>i(t&&bE(t,"done",e)));break;case"destroy":e.onDestroy(()=>i(t&&bE(t,"destroy",e)))}}function bE(e,n,t){const a=xE(e.element,e.triggerName,e.fromState,e.toState,n||e.phaseName,t.totalTime??e.totalTime,!!t.disabled),u=e._data;return null!=u&&(a._data=u),a}function xE(e,n,t,i,r="",a=0,u){return{element:e,triggerName:n,fromState:t,toState:i,phaseName:r,totalTime:a,disabled:!!u}}function qs(e,n,t){let i=e.get(n);return i||e.set(n,i=t),i}function o2(e){const n=e.indexOf(":");return[e.substring(1,n),e.slice(n+1)]}const J9=(()=>typeof document>"u"?null:document.documentElement)();function wE(e){const n=e.parentNode||e.host||null;return n===J9?null:n}let Eh=null,s2=!1;function a2(e,n){for(;n;){if(n===e)return!0;n=wE(n)}return!1}function l2(e,n,t){if(t)return Array.from(e.querySelectorAll(n));const i=e.querySelector(n);return i?[i]:[]}let c2=(()=>{class e{validateStyleProperty(t){return function t7(e){Eh||(Eh=function n7(){return typeof document<"u"?document.body:null}()||{},s2=!!Eh.style&&"WebkitAppearance"in Eh.style);let n=!0;return Eh.style&&!function e7(e){return"ebkit"==e.substring(1,6)}(e)&&(n=e in Eh.style,!n&&s2&&(n="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in Eh.style)),n}(t)}matchesElement(t,i){return!1}containsElement(t,i){return a2(t,i)}getParentElement(t){return wE(t)}query(t,i,r){return l2(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,a,u,p=[],y){return new cg(r,a)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})(),EE=(()=>{class e{static#e=this.NOOP=new c2}return e})();const i7=1e3,CE="ng-enter",Kv="ng-leave",Xv="ng-trigger",Yv=".ng-trigger",d2="ng-animating",SE=".ng-animating";function $c(e){if("number"==typeof e)return e;const n=e.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:DE(parseFloat(n[1]),n[2])}function DE(e,n){return"s"===n?e*i7:e}function Qv(e,n,t){return e.hasOwnProperty("duration")?e:function o7(e,n,t){let r,a=0,u="";if("string"==typeof e){const p=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===p)return n.push(n2()),{duration:0,delay:0,easing:""};r=DE(parseFloat(p[1]),p[2]);const y=p[3];null!=y&&(a=DE(parseFloat(y),p[4]));const E=p[5];E&&(u=E)}else r=e;if(!t){let p=!1,y=n.length;r<0&&(n.push(function v9(){return new be(3100,!1)}()),p=!0),a<0&&(n.push(function b9(){return new be(3101,!1)}()),p=!0),p&&n.splice(y,0,n2())}return{duration:r,delay:a,easing:u}}(e,n,t)}function Rg(e,n={}){return Object.keys(e).forEach(t=>{n[t]=e[t]}),n}function h2(e){const n=new Map;return Object.keys(e).forEach(t=>{n.set(t,e[t])}),n}function nd(e,n=new Map,t){if(t)for(let[i,r]of t)n.set(i,r);for(let[i,r]of e)n.set(i,r);return n}function ec(e,n,t){n.forEach((i,r)=>{const a=ME(r);t&&!t.has(r)&&t.set(r,e.style[a]),e.style[a]=i})}function Ch(e,n){n.forEach((t,i)=>{const r=ME(i);e.style[r]=""})}function Pg(e){return Array.isArray(e)?1==e.length?e[0]:xk(e):e}const IE=new RegExp("{{\\s*(.+?)\\s*}}","g");function f2(e){let n=[];if("string"==typeof e){let t;for(;t=IE.exec(e);)n.push(t[1]);IE.lastIndex=0}return n}function Fg(e,n,t){const i=e.toString(),r=i.replace(IE,(a,u)=>{let p=n[u];return null==p&&(t.push(function w9(e){return new be(3003,!1)}()),p=""),p.toString()});return r==i?e:r}function Jv(e){const n=[];let t=e.next();for(;!t.done;)n.push(t.value),t=e.next();return n}const l7=/-+([a-z0-9])/g;function ME(e){return e.replace(l7,(...n)=>n[1].toUpperCase())}function Gs(e,n,t){switch(n.type){case 7:return e.visitTrigger(n,t);case 0:return e.visitState(n,t);case 1:return e.visitTransition(n,t);case 2:return e.visitSequence(n,t);case 3:return e.visitGroup(n,t);case 4:return e.visitAnimate(n,t);case 5:return e.visitKeyframes(n,t);case 6:return e.visitStyle(n,t);case 8:return e.visitReference(n,t);case 9:return e.visitAnimateChild(n,t);case 10:return e.visitAnimateRef(n,t);case 11:return e.visitQuery(n,t);case 12:return e.visitStagger(n,t);default:throw function E9(e){return new be(3004,!1)}()}}function m2(e,n){return window.getComputedStyle(e)[n]}const eb="*";function d7(e,n){const t=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function h7(e,n,t){if(":"==e[0]){const y=function p7(e,n){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return n.push(function N9(e){return new be(3016,!1)}()),"* => *"}}(e,t);if("function"==typeof y)return void n.push(y);e=y}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function L9(e){return new be(3015,!1)}()),n;const r=i[1],a=i[2],u=i[3];n.push(g2(r,u));"<"==a[0]&&!(r==eb&&u==eb)&&n.push(g2(u,r))}(i,t,n)):t.push(e),t}const tb=new Set(["true","1"]),nb=new Set(["false","0"]);function g2(e,n){const t=tb.has(e)||nb.has(e),i=tb.has(n)||nb.has(n);return(r,a)=>{let u=e==eb||e==r,p=n==eb||n==a;return!u&&t&&"boolean"==typeof r&&(u=r?tb.has(e):nb.has(e)),!p&&i&&"boolean"==typeof a&&(p=a?tb.has(n):nb.has(n)),u&&p}}const f7=new RegExp("s*:selfs*,?","g");function TE(e,n,t,i){return new m7(e).build(n,t,i)}class m7{constructor(n){this._driver=n}build(n,t,i){const r=new y7(t);return this._resetContextStyleTimingState(r),Gs(this,Pg(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,t){let i=t.queryCount=0,r=t.depCount=0;const a=[],u=[];return"@"==n.name.charAt(0)&&t.errors.push(function S9(){return new be(3006,!1)}()),n.definitions.forEach(p=>{if(this._resetContextStyleTimingState(t),0==p.type){const y=p,E=y.name;E.toString().split(/\s*,\s*/).forEach(I=>{y.name=I,a.push(this.visitState(y,t))}),y.name=E}else if(1==p.type){const y=this.visitTransition(p,t);i+=y.queryCount,r+=y.depCount,u.push(y)}else t.errors.push(function D9(){return new be(3007,!1)}())}),{type:7,name:n.name,states:a,transitions:u,queryCount:i,depCount:r,options:null}}visitState(n,t){const i=this.visitStyle(n.styles,t),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const a=new Set,u=r||{};i.styles.forEach(p=>{p instanceof Map&&p.forEach(y=>{f2(y).forEach(E=>{u.hasOwnProperty(E)||a.add(E)})})}),a.size&&(Jv(a.values()),t.errors.push(function I9(e,n){return new be(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,t){t.queryCount=0,t.depCount=0;const i=Gs(this,Pg(n.animation),t);return{type:1,matchers:d7(n.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Sh(n.options)}}visitSequence(n,t){return{type:2,steps:n.steps.map(i=>Gs(this,i,t)),options:Sh(n.options)}}visitGroup(n,t){const i=t.currentTime;let r=0;const a=n.steps.map(u=>{t.currentTime=i;const p=Gs(this,u,t);return r=Math.max(r,t.currentTime),p});return t.currentTime=r,{type:3,steps:a,options:Sh(n.options)}}visitAnimate(n,t){const i=function b7(e,n){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return AE(Qv(e,n).duration,0,"");const t=e;if(t.split(/\s+/).some(a=>"{"==a.charAt(0)&&"{"==a.charAt(1))){const a=AE(0,0,"");return a.dynamic=!0,a.strValue=t,a}const r=Qv(t,n);return AE(r.duration,r.delay,r.easing)}(n.timings,t.errors);t.currentAnimateTimings=i;let r,a=n.styles?n.styles:zc({});if(5==a.type)r=this.visitKeyframes(a,t);else{let u=n.styles,p=!1;if(!u){p=!0;const E={};i.easing&&(E.easing=i.easing),u=zc(E)}t.currentTime+=i.duration+i.delay;const y=this.visitStyle(u,t);y.isEmptyStep=p,r=y}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,t){const i=this._makeStyleAst(n,t);return this._validateStyleAst(i,t),i}_makeStyleAst(n,t){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let p of r)"string"==typeof p?p===Bc?i.push(p):t.errors.push(new be(3002,!1)):i.push(h2(p));let a=!1,u=null;return i.forEach(p=>{if(p instanceof Map&&(p.has("easing")&&(u=p.get("easing"),p.delete("easing")),!a))for(let y of p.values())if(y.toString().indexOf("{{")>=0){a=!0;break}}),{type:6,styles:i,easing:u,offset:n.offset,containsDynamicStyles:a,options:null}}_validateStyleAst(n,t){const i=t.currentAnimateTimings;let r=t.currentTime,a=t.currentTime;i&&a>0&&(a-=i.duration+i.delay),n.styles.forEach(u=>{"string"!=typeof u&&u.forEach((p,y)=>{const E=t.collectedStyles.get(t.currentQuerySelector),I=E.get(y);let R=!0;I&&(a!=r&&a>=I.startTime&&r<=I.endTime&&(t.errors.push(function T9(e,n,t,i,r){return new be(3010,!1)}()),R=!1),a=I.startTime),R&&E.set(y,{startTime:a,endTime:r}),t.options&&function a7(e,n,t){const i=n.params||{},r=f2(e);r.length&&r.forEach(a=>{i.hasOwnProperty(a)||t.push(function x9(e){return new be(3001,!1)}())})}(p,t.options,t.errors)})})}visitKeyframes(n,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function A9(){return new be(3011,!1)}()),i;let a=0;const u=[];let p=!1,y=!1,E=0;const I=n.steps.map(Se=>{const ye=this._makeStyleAst(Se,t);let ot=null!=ye.offset?ye.offset:function v7(e){if("string"==typeof e)return null;let n=null;if(Array.isArray(e))e.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const t=e;n=parseFloat(t.get("offset")),t.delete("offset")}return n}(ye.styles),lt=0;return null!=ot&&(a++,lt=ye.offset=ot),y=y||lt<0||lt>1,p=p||lt<E,E=lt,u.push(lt),ye});y&&t.errors.push(function k9(){return new be(3012,!1)}()),p&&t.errors.push(function R9(){return new be(3200,!1)}());const R=n.steps.length;let B=0;a>0&&a<R?t.errors.push(function P9(){return new be(3202,!1)}()):0==a&&(B=1/(R-1));const H=R-1,X=t.currentTime,re=t.currentAnimateTimings,_e=re.duration;return I.forEach((Se,ye)=>{const ot=B>0?ye==H?1:B*ye:u[ye],lt=ot*_e;t.currentTime=X+re.delay+lt,re.duration=lt,this._validateStyleAst(Se,t),Se.offset=ot,i.styles.push(Se)}),i}visitReference(n,t){return{type:8,animation:Gs(this,Pg(n.animation),t),options:Sh(n.options)}}visitAnimateChild(n,t){return t.depCount++,{type:9,options:Sh(n.options)}}visitAnimateRef(n,t){return{type:10,animation:this.visitReference(n.animation,t),options:Sh(n.options)}}visitQuery(n,t){const i=t.currentQuerySelector,r=n.options||{};t.queryCount++,t.currentQuery=n;const[a,u]=function g7(e){const n=!!e.split(/\s*,\s*/).find(t=>":self"==t);return n&&(e=e.replace(f7,"")),e=e.replace(/@\*/g,Yv).replace(/@\w+/g,t=>Yv+"-"+t.slice(1)).replace(/:animating/g,SE),[e,n]}(n.selector);t.currentQuerySelector=i.length?i+" "+a:a,qs(t.collectedStyles,t.currentQuerySelector,new Map);const p=Gs(this,Pg(n.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:a,limit:r.limit||0,optional:!!r.optional,includeSelf:u,animation:p,originalSelector:n.selector,options:Sh(n.options)}}visitStagger(n,t){t.currentQuery||t.errors.push(function F9(){return new be(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:Qv(n.timings,t.errors,!0);return{type:12,animation:Gs(this,Pg(n.animation),t),timings:i,options:null}}}class y7{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Sh(e){return e?(e=Rg(e)).params&&(e.params=function _7(e){return e?Rg(e):null}(e.params)):e={},e}function AE(e,n,t){return{duration:e,delay:n,easing:t}}function kE(e,n,t,i,r,a,u=null,p=!1){return{type:1,element:e,keyframes:n,preStyleProps:t,postStyleProps:i,duration:r,delay:a,totalTime:r+a,easing:u,subTimeline:p}}class ib{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,t){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...t)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const E7=new RegExp(":enter","g"),S7=new RegExp(":leave","g");function RE(e,n,t,i,r,a=new Map,u=new Map,p,y,E=[]){return(new D7).buildKeyframes(e,n,t,i,r,a,u,p,y,E)}class D7{buildKeyframes(n,t,i,r,a,u,p,y,E,I=[]){E=E||new ib;const R=new PE(n,t,E,r,a,I,[]);R.options=y;const B=y.delay?$c(y.delay):0;R.currentTimeline.delayNextStep(B),R.currentTimeline.setStyles([u],null,R.errors,y),Gs(this,i,R);const H=R.timelines.filter(X=>X.containsAnimation());if(H.length&&p.size){let X;for(let re=H.length-1;re>=0;re--){const _e=H[re];if(_e.element===t){X=_e;break}}X&&!X.allowOnlyTimelineStyles()&&X.setStyles([p],null,R.errors,y)}return H.length?H.map(X=>X.buildKeyframes()):[kE(t,[],[],[],0,B,"",!1)]}visitTrigger(n,t){}visitState(n,t){}visitTransition(n,t){}visitAnimateChild(n,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(n.options),a=t.currentTimeline.currentTime,u=this._visitSubInstructions(i,r,r.options);a!=u&&t.transformIntoNewTimeline(u)}t.previousNode=n}visitAnimateRef(n,t){const i=t.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],t,i),this.visitReference(n.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=n}_applyAnimationRefDelays(n,t,i){for(const r of n){const a=r?.delay;if(a){const u="number"==typeof a?a:$c(Fg(a,r?.params??{},t.errors));i.delayNextStep(u)}}}_visitSubInstructions(n,t,i){let a=t.currentTimeline.currentTime;const u=null!=i.duration?$c(i.duration):null,p=null!=i.delay?$c(i.delay):null;return 0!==u&&n.forEach(y=>{const E=t.appendInstructionToTimeline(y,u,p);a=Math.max(a,E.duration+E.delay)}),a}visitReference(n,t){t.updateOptions(n.options,!0),Gs(this,n.animation,t),t.previousNode=n}visitSequence(n,t){const i=t.subContextCount;let r=t;const a=n.options;if(a&&(a.params||a.delay)&&(r=t.createSubContext(a),r.transformIntoNewTimeline(),null!=a.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=rb);const u=$c(a.delay);r.delayNextStep(u)}n.steps.length&&(n.steps.forEach(u=>Gs(this,u,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=n}visitGroup(n,t){const i=[];let r=t.currentTimeline.currentTime;const a=n.options&&n.options.delay?$c(n.options.delay):0;n.steps.forEach(u=>{const p=t.createSubContext(n.options);a&&p.delayNextStep(a),Gs(this,u,p),r=Math.max(r,p.currentTimeline.currentTime),i.push(p.currentTimeline)}),i.forEach(u=>t.currentTimeline.mergeTimelineCollectedStyles(u)),t.transformIntoNewTimeline(r),t.previousNode=n}_visitTiming(n,t){if(n.dynamic){const i=n.strValue;return Qv(t.params?Fg(i,t.params,t.errors):i,t.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,t){const i=t.currentAnimateTimings=this._visitTiming(n.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const a=n.style;5==a.type?this.visitKeyframes(a,t):(t.incrementTime(i.duration),this.visitStyle(a,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=n}visitStyle(n,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const a=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(a):i.setStyles(n.styles,a,t.errors,t.options),t.previousNode=n}visitKeyframes(n,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,a=i.duration,p=t.createSubContext().currentTimeline;p.easing=i.easing,n.styles.forEach(y=>{p.forwardTime((y.offset||0)*a),p.setStyles(y.styles,y.easing,t.errors,t.options),p.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(p),t.transformIntoNewTimeline(r+a),t.previousNode=n}visitQuery(n,t){const i=t.currentTimeline.currentTime,r=n.options||{},a=r.delay?$c(r.delay):0;a&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=rb);let u=i;const p=t.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=p.length;let y=null;p.forEach((E,I)=>{t.currentQueryIndex=I;const R=t.createSubContext(n.options,E);a&&R.delayNextStep(a),E===t.element&&(y=R.currentTimeline),Gs(this,n.animation,R),R.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,R.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(u),y&&(t.currentTimeline.mergeTimelineCollectedStyles(y),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=n}visitStagger(n,t){const i=t.parentContext,r=t.currentTimeline,a=n.timings,u=Math.abs(a.duration),p=u*(t.currentQueryTotal-1);let y=u*t.currentQueryIndex;switch(a.duration<0?"reverse":a.easing){case"reverse":y=p-y;break;case"full":y=i.currentStaggerTime}const I=t.currentTimeline;y&&I.delayNextStep(y);const R=I.currentTime;Gs(this,n.animation,t),t.previousNode=n,i.currentStaggerTime=r.currentTime-R+(r.startTime-i.currentTimeline.startTime)}}const rb={};class PE{constructor(n,t,i,r,a,u,p,y){this._driver=n,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=a,this.errors=u,this.timelines=p,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=rb,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=y||new ob(this._driver,t,0),p.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,t){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=$c(i.duration)),null!=i.delay&&(r.delay=$c(i.delay));const a=i.params;if(a){let u=r.params;u||(u=this.options.params={}),Object.keys(a).forEach(p=>{(!t||!u.hasOwnProperty(p))&&(u[p]=Fg(a[p],u,this.errors))})}}_copyOptions(){const n={};if(this.options){const t=this.options.params;if(t){const i=n.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return n}createSubContext(n=null,t,i){const r=t||this.element,a=new PE(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(n),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}transformIntoNewTimeline(n){return this.previousNode=rb,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,t,i){const r={duration:t??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},a=new I7(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(a),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,t,i,r,a,u){let p=[];if(r&&p.push(this.element),n.length>0){n=(n=n.replace(E7,"."+this._enterClassName)).replace(S7,"."+this._leaveClassName);let E=this._driver.query(this.element,n,1!=i);0!==i&&(E=i<0?E.slice(E.length+i,E.length):E.slice(0,i)),p.push(...E)}return!a&&0==p.length&&u.push(function O9(e){return new be(3014,!1)}()),p}}class ob{constructor(n,t,i,r){this._driver=n,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+n),t&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,t){return this.applyStylesToKeyframe(),new ob(this._driver,n,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,t){this._localTimelineStyles.set(n,t),this._globalTimelineStyles.set(n,t),this._styleSummary.set(n,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Bc),this._currentKeyframe.set(t,Bc);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,t,i,r){t&&this._previousKeyframe.set("easing",t);const a=r&&r.params||{},u=function M7(e,n){const t=new Map;let i;return e.forEach(r=>{if("*"===r){i=i||n.keys();for(let a of i)t.set(a,Bc)}else nd(r,t)}),t}(n,this._globalTimelineStyles);for(let[p,y]of u){const E=Fg(y,a,i);this._pendingStyles.set(p,E),this._localTimelineStyles.has(p)||this._backFill.set(p,this._globalTimelineStyles.get(p)??Bc),this._updateStyle(p,E)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,t)=>{this._currentKeyframe.set(t,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,n)}))}snapshotCurrentStyles(){for(let[n,t]of this._localTimelineStyles)this._pendingStyles.set(n,t),this._updateStyle(n,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let t in this._currentKeyframe)n.push(t);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((p,y)=>{const E=nd(p,new Map,this._backFill);E.forEach((I,R)=>{"!"===I?n.add(R):I===Bc&&t.add(R)}),i||E.set("offset",y/this.duration),r.push(E)});const a=n.size?Jv(n.values()):[],u=t.size?Jv(t.values()):[];if(i){const p=r[0],y=new Map(p);p.set("offset",0),y.set("offset",1),r=[p,y]}return kE(this.element,r,a,u,this.duration,this.startTime,this.easing,!1)}}class I7 extends ob{constructor(n,t,i,r,a,u,p=!1){super(n,t,u.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=a,this._stretchStartingKeyframe=p,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const a=[],u=i+t,p=t/u,y=nd(n[0]);y.set("offset",0),a.push(y);const E=nd(n[0]);E.set("offset",v2(p)),a.push(E);const I=n.length-1;for(let R=1;R<=I;R++){let B=nd(n[R]);const H=B.get("offset");B.set("offset",v2((t+H*i)/u)),a.push(B)}i=u,t=0,r="",n=a}return kE(this.element,n,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function v2(e,n=3){const t=Math.pow(10,n-1);return Math.round(e*t)/t}class FE{}const T7=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class A7 extends FE{normalizePropertyName(n,t){return ME(n)}normalizeStyleValue(n,t,i,r){let a="";const u=i.toString().trim();if(T7.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)a="px";else{const p=i.match(/^[+-]?[\d\.]+([a-z]*)$/);p&&0==p[1].length&&r.push(function C9(e,n){return new be(3005,!1)}())}return u+a}}function b2(e,n,t,i,r,a,u,p,y,E,I,R,B){return{type:0,element:e,triggerName:n,isRemovalTransition:r,fromState:t,fromStyles:a,toState:i,toStyles:u,timelines:p,queriedElements:y,preStyleProps:E,postStyleProps:I,totalTime:R,errors:B}}const OE={};class x2{constructor(n,t,i){this._triggerName=n,this.ast=t,this._stateStyles=i}match(n,t,i,r){return function k7(e,n,t,i,r){return e.some(a=>a(n,t,i,r))}(this.ast.matchers,n,t,i,r)}buildStyles(n,t,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(t,i):new Map}build(n,t,i,r,a,u,p,y,E,I){const R=[],B=this.ast.options&&this.ast.options.params||OE,X=this.buildStyles(i,p&&p.params||OE,R),re=y&&y.params||OE,_e=this.buildStyles(r,re,R),Se=new Set,ye=new Map,ot=new Map,lt="void"===r,Gt={params:R7(re,B),delay:this.ast.options?.delay},Jn=I?[]:RE(n,t,this.ast.animation,a,u,X,_e,Gt,E,R);let di=0;if(Jn.forEach(Ws=>{di=Math.max(Ws.duration+Ws.delay,di)}),R.length)return b2(t,this._triggerName,i,r,lt,X,_e,[],[],ye,ot,di,R);Jn.forEach(Ws=>{const dl=Ws.element,cb=qs(ye,dl,new Set);Ws.preStyleProps.forEach(Dh=>cb.add(Dh));const Lg=qs(ot,dl,new Set);Ws.postStyleProps.forEach(Dh=>Lg.add(Dh)),dl!==t&&Se.add(dl)});const _o=Jv(Se.values());return b2(t,this._triggerName,i,r,lt,X,_e,Jn,_o,ye,ot,di)}}function R7(e,n){const t=Rg(n);for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&(t[i]=e[i]);return t}class P7{constructor(n,t,i){this.styles=n,this.defaultParams=t,this.normalizer=i}buildStyles(n,t){const i=new Map,r=Rg(this.defaultParams);return Object.keys(n).forEach(a=>{const u=n[a];null!==u&&(r[a]=u)}),this.styles.styles.forEach(a=>{"string"!=typeof a&&a.forEach((u,p)=>{u&&(u=Fg(u,r,t));const y=this.normalizer.normalizePropertyName(p,t);u=this.normalizer.normalizeStyleValue(p,y,u,t),i.set(p,u)})}),i}}class O7{constructor(n,t,i){this.name=n,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new P7(r.style,r.options&&r.options.params||{},i))}),w2(this.states,"true","1"),w2(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new x2(n,r,this.states))}),this.fallbackTransition=function L7(e,n,t){return new x2(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,p)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,t,i,r){return this.transitionFactories.find(u=>u.match(n,t,i,r))||null}matchStyles(n,t,i){return this.fallbackTransition.buildStyles(n,t,i)}}function w2(e,n,t){e.has(n)?e.has(t)||e.set(t,e.get(n)):e.has(t)&&e.set(n,e.get(t))}const N7=new ib;class B7{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,t){const i=[],a=TE(this._driver,t,i,[]);if(i.length)throw function j9(e){return new be(3503,!1)}();this._animations.set(n,a)}_buildPlayer(n,t,i){const r=n.element,a=r2(this._normalizer,n.keyframes,t,i);return this._driver.animate(r,a,n.duration,n.delay,n.easing,[],!0)}create(n,t,i={}){const r=[],a=this._animations.get(n);let u;const p=new Map;if(a?(u=RE(this._driver,t,a,CE,Kv,new Map,new Map,i,N7,r),u.forEach(I=>{const R=qs(p,I.element,new Map);I.postStyleProps.forEach(B=>R.set(B,null))})):(r.push(function $9(){return new be(3300,!1)}()),u=[]),r.length)throw function H9(e){return new be(3504,!1)}();p.forEach((I,R)=>{I.forEach((B,H)=>{I.set(H,this._driver.computeStyle(R,H,Bc))})});const E=td(u.map(I=>{const R=p.get(I.element);return this._buildPlayer(I,new Map,R)}));return this._playersById.set(n,E),E.onDestroy(()=>this.destroy(n)),this.players.push(E),E}destroy(n){const t=this._getPlayer(n);t.destroy(),this._playersById.delete(n);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(n){const t=this._playersById.get(n);if(!t)throw function q9(e){return new be(3301,!1)}();return t}listen(n,t,i,r){const a=xE(t,"","","");return vE(this._getPlayer(n),i,a,r),()=>{}}command(n,t,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,t,r[0]||{});const a=this._getPlayer(n);switch(i){case"play":a.play();break;case"pause":a.pause();break;case"reset":a.reset();break;case"restart":a.restart();break;case"finish":a.finish();break;case"init":a.init();break;case"setPosition":a.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const E2="ng-animate-queued",LE="ng-animate-disabled",$7=[],C2={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},H7={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ul="__ng_removed";class NE{get params(){return this.options.params}constructor(n,t=""){this.namespaceId=t;const i=n&&n.hasOwnProperty("value");if(this.value=function Z7(e){return e??null}(i?n.value:n),i){const a=Rg(n);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const t=n.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Og="void",BE=new NE(Og);class q7{constructor(n,t,i){this.id=n,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Oa(t,this._hostClassName)}listen(n,t,i,r){if(!this._triggers.has(t))throw function G9(e,n){return new be(3302,!1)}();if(null==i||0==i.length)throw function W9(e){return new be(3303,!1)}();if(!function K7(e){return"start"==e||"done"==e}(i))throw function Z9(e,n){return new be(3400,!1)}();const a=qs(this._elementListeners,n,[]),u={name:t,phase:i,callback:r};a.push(u);const p=qs(this._engine.statesByElement,n,new Map);return p.has(t)||(Oa(n,Xv),Oa(n,Xv+"-"+t),p.set(t,BE)),()=>{this._engine.afterFlush(()=>{const y=a.indexOf(u);y>=0&&a.splice(y,1),this._triggers.has(t)||p.delete(t)})}}register(n,t){return!this._triggers.has(n)&&(this._triggers.set(n,t),!0)}_getTrigger(n){const t=this._triggers.get(n);if(!t)throw function K9(e){return new be(3401,!1)}();return t}trigger(n,t,i,r=!0){const a=this._getTrigger(t),u=new zE(this.id,t,n);let p=this._engine.statesByElement.get(n);p||(Oa(n,Xv),Oa(n,Xv+"-"+t),this._engine.statesByElement.set(n,p=new Map));let y=p.get(t);const E=new NE(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&y&&E.absorbOptions(y.options),p.set(t,E),y||(y=BE),E.value!==Og&&y.value===E.value){if(!function Q7(e,n){const t=Object.keys(e),i=Object.keys(n);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const a=t[r];if(!n.hasOwnProperty(a)||e[a]!==n[a])return!1}return!0}(y.params,E.params)){const re=[],_e=a.matchStyles(y.value,y.params,re),Se=a.matchStyles(E.value,E.params,re);re.length?this._engine.reportError(re):this._engine.afterFlush(()=>{Ch(n,_e),ec(n,Se)})}return}const B=qs(this._engine.playersByElement,n,[]);B.forEach(re=>{re.namespaceId==this.id&&re.triggerName==t&&re.queued&&re.destroy()});let H=a.matchTransition(y.value,E.value,n,E.params),X=!1;if(!H){if(!r)return;H=a.fallbackTransition,X=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:t,transition:H,fromState:y,toState:E,player:u,isFallbackTransition:X}),X||(Oa(n,E2),u.onStart(()=>{df(n,E2)})),u.onDone(()=>{let re=this.players.indexOf(u);re>=0&&this.players.splice(re,1);const _e=this._engine.playersByElement.get(n);if(_e){let Se=_e.indexOf(u);Se>=0&&_e.splice(Se,1)}}),this.players.push(u),B.push(u),u}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(t=>t.delete(n)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const t=this._engine.playersByElement.get(n);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,t){const i=this._engine.driver.query(n,Yv,!0);i.forEach(r=>{if(r[ul])return;const a=this._engine.fetchNamespacesByElement(r);a.size?a.forEach(u=>u.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,t,i,r){const a=this._engine.statesByElement.get(n),u=new Map;if(a){const p=[];if(a.forEach((y,E)=>{if(u.set(E,y.value),this._triggers.has(E)){const I=this.trigger(n,E,Og,r);I&&p.push(I)}}),p.length)return this._engine.markElementAsRemoved(this.id,n,!0,t,u),i&&td(p).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const t=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(t&&i){const r=new Set;t.forEach(a=>{const u=a.name;if(r.has(u))return;r.add(u);const y=this._triggers.get(u).fallbackTransition,E=i.get(u)||BE,I=new NE(Og),R=new zE(this.id,u,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:u,transition:y,fromState:E,toState:I,player:R,isFallbackTransition:!0})})}}removeNode(n,t){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,t),this.triggerLeaveAnimation(n,t,!0))return;let r=!1;if(i.totalAnimations){const a=i.players.length?i.playersByQueriedElement.get(n):[];if(a&&a.length)r=!0;else{let u=n;for(;u=u.parentNode;)if(i.statesByElement.get(u)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,t);else{const a=n[ul];(!a||a===C2)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,t))}}insertNode(n,t){Oa(n,this._hostClassName)}drainQueuedTransitions(n){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const a=i.element,u=this._elementListeners.get(a);u&&u.forEach(p=>{if(p.name==i.triggerName){const y=xE(a,i.triggerName,i.fromState.value,i.toState.value);y._data=n,vE(i.player,p.phase,y,p.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const a=i.transition.ast.depCount,u=r.transition.ast.depCount;return 0==a||0==u?a-u:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class G7{_onRemovalComplete(n,t){this.onRemovalComplete(n,t)}constructor(n,t,i){this.bodyNode=n,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,a)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,t){const i=new q7(n,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let u=!1,p=this.driver.getParentElement(t);for(;p;){const y=r.get(p);if(y){const E=i.indexOf(y);i.splice(E+1,0,n),u=!0;break}p=this.driver.getParentElement(p)}u||i.unshift(n)}else i.push(n);return r.set(t,n),n}register(n,t){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,t)),i}registerTrigger(n,t,i){let r=this._namespaceLookup[n];r&&r.register(t,i)&&this.totalAnimations++}destroy(n,t){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const t=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const a=this._fetchNamespace(r.namespaceId);a&&t.add(a)}return t}trigger(n,t,i,r){if(sb(t)){const a=this._fetchNamespace(n);if(a)return a.trigger(t,i,r),!0}return!1}insertNode(n,t,i,r){if(!sb(t))return;const a=t[ul];if(a&&a.setForRemoval){a.setForRemoval=!1,a.setForMove=!0;const u=this.collectedLeaveElements.indexOf(t);u>=0&&this.collectedLeaveElements.splice(u,1)}if(n){const u=this._fetchNamespace(n);u&&u.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,t){t?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Oa(n,LE)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),df(n,LE))}removeNode(n,t,i){if(sb(t)){const r=n?this._fetchNamespace(n):null;r?r.removeNode(t,i):this.markElementAsRemoved(n,t,!1,i);const a=this.namespacesByHostElement.get(t);a&&a.id!==n&&a.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(n,t,i,r,a){this.collectedLeaveElements.push(t),t[ul]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:a}}listen(n,t,i,r,a){return sb(t)?this._fetchNamespace(n).listen(t,i,r,a):()=>{}}_buildInstruction(n,t,i,r,a){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,t,a)}destroyInnerAnimations(n){let t=this.driver.query(n,Yv,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(n,SE,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const t=this.playersByElement.get(n);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const t=this.playersByQueriedElement.get(n);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return td(this.players).onDone(()=>n());n()})}processLeaveNode(n){const t=n[ul];if(t&&t.setForRemoval){if(n[ul]=C2,t.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,t.setForRemoval)}n.classList?.contains(LE)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Oa(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?td(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function X9(e){return new be(3402,!1)}()}_flushAnimations(n,t){const i=new ib,r=[],a=new Map,u=[],p=new Map,y=new Map,E=new Map,I=new Set;this.disabledNodes.forEach(vt=>{I.add(vt);const kt=this.driver.query(vt,".ng-animate-queued",!0);for(let Lt=0;Lt<kt.length;Lt++)I.add(kt[Lt])});const R=this.bodyNode,B=Array.from(this.statesByElement.keys()),H=I2(B,this.collectedEnterElements),X=new Map;let re=0;H.forEach((vt,kt)=>{const Lt=CE+re++;X.set(kt,Lt),vt.forEach(Pn=>Oa(Pn,Lt))});const _e=[],Se=new Set,ye=new Set;for(let vt=0;vt<this.collectedLeaveElements.length;vt++){const kt=this.collectedLeaveElements[vt],Lt=kt[ul];Lt&&Lt.setForRemoval&&(_e.push(kt),Se.add(kt),Lt.hasAnimation?this.driver.query(kt,".ng-star-inserted",!0).forEach(Pn=>Se.add(Pn)):ye.add(kt))}const ot=new Map,lt=I2(B,Array.from(Se));lt.forEach((vt,kt)=>{const Lt=Kv+re++;ot.set(kt,Lt),vt.forEach(Pn=>Oa(Pn,Lt))}),n.push(()=>{H.forEach((vt,kt)=>{const Lt=X.get(kt);vt.forEach(Pn=>df(Pn,Lt))}),lt.forEach((vt,kt)=>{const Lt=ot.get(kt);vt.forEach(Pn=>df(Pn,Lt))}),_e.forEach(vt=>{this.processLeaveNode(vt)})});const Gt=[],Jn=[];for(let vt=this._namespaceList.length-1;vt>=0;vt--)this._namespaceList[vt].drainQueuedTransitions(t).forEach(Lt=>{const Pn=Lt.player,eo=Lt.element;if(Gt.push(Pn),this.collectedEnterElements.length){const Po=eo[ul];if(Po&&Po.setForMove){if(Po.previousTriggersValues&&Po.previousTriggersValues.has(Lt.triggerName)){const Ih=Po.previousTriggersValues.get(Lt.triggerName),La=this.statesByElement.get(Lt.element);if(La&&La.has(Lt.triggerName)){const ub=La.get(Lt.triggerName);ub.value=Ih,La.set(Lt.triggerName,ub)}}return void Pn.destroy()}}const tc=!R||!this.driver.containsElement(R,eo),Zs=ot.get(eo),id=X.get(eo),$i=this._buildInstruction(Lt,i,id,Zs,tc);if($i.errors&&$i.errors.length)return void Jn.push($i);if(tc)return Pn.onStart(()=>Ch(eo,$i.fromStyles)),Pn.onDestroy(()=>ec(eo,$i.toStyles)),void r.push(Pn);if(Lt.isFallbackTransition)return Pn.onStart(()=>Ch(eo,$i.fromStyles)),Pn.onDestroy(()=>ec(eo,$i.toStyles)),void r.push(Pn);const B2=[];$i.timelines.forEach(Po=>{Po.stretchStartingKeyframe=!0,this.disabledNodes.has(Po.element)||B2.push(Po)}),$i.timelines=B2,i.append(eo,$i.timelines),u.push({instruction:$i,player:Pn,element:eo}),$i.queriedElements.forEach(Po=>qs(p,Po,[]).push(Pn)),$i.preStyleProps.forEach((Po,Ih)=>{if(Po.size){let La=y.get(Ih);La||y.set(Ih,La=new Set),Po.forEach((ub,jE)=>La.add(jE))}}),$i.postStyleProps.forEach((Po,Ih)=>{let La=E.get(Ih);La||E.set(Ih,La=new Set),Po.forEach((ub,jE)=>La.add(jE))})});if(Jn.length){const vt=[];Jn.forEach(kt=>{vt.push(function Y9(e,n){return new be(3505,!1)}())}),Gt.forEach(kt=>kt.destroy()),this.reportError(vt)}const di=new Map,_o=new Map;u.forEach(vt=>{const kt=vt.element;i.has(kt)&&(_o.set(kt,kt),this._beforeAnimationBuild(vt.player.namespaceId,vt.instruction,di))}),r.forEach(vt=>{const kt=vt.element;this._getPreviousPlayers(kt,!1,vt.namespaceId,vt.triggerName,null).forEach(Pn=>{qs(di,kt,[]).push(Pn),Pn.destroy()})});const Ws=_e.filter(vt=>T2(vt,y,E)),dl=new Map;D2(dl,this.driver,ye,E,Bc).forEach(vt=>{T2(vt,y,E)&&Ws.push(vt)});const Lg=new Map;H.forEach((vt,kt)=>{D2(Lg,this.driver,new Set(vt),y,"!")}),Ws.forEach(vt=>{const kt=dl.get(vt),Lt=Lg.get(vt);dl.set(vt,new Map([...kt?.entries()??[],...Lt?.entries()??[]]))});const Dh=[],L2=[],N2={};u.forEach(vt=>{const{element:kt,player:Lt,instruction:Pn}=vt;if(i.has(kt)){if(I.has(kt))return Lt.onDestroy(()=>ec(kt,Pn.toStyles)),Lt.disabled=!0,Lt.overrideTotalTime(Pn.totalTime),void r.push(Lt);let eo=N2;if(_o.size>1){let Zs=kt;const id=[];for(;Zs=Zs.parentNode;){const $i=_o.get(Zs);if($i){eo=$i;break}id.push(Zs)}id.forEach($i=>_o.set($i,eo))}const tc=this._buildAnimation(Lt.namespaceId,Pn,di,a,Lg,dl);if(Lt.setRealPlayer(tc),eo===N2)Dh.push(Lt);else{const Zs=this.playersByElement.get(eo);Zs&&Zs.length&&(Lt.parentPlayer=td(Zs)),r.push(Lt)}}else Ch(kt,Pn.fromStyles),Lt.onDestroy(()=>ec(kt,Pn.toStyles)),L2.push(Lt),I.has(kt)&&r.push(Lt)}),L2.forEach(vt=>{const kt=a.get(vt.element);if(kt&&kt.length){const Lt=td(kt);vt.setRealPlayer(Lt)}}),r.forEach(vt=>{vt.parentPlayer?vt.syncPlayerEvents(vt.parentPlayer):vt.destroy()});for(let vt=0;vt<_e.length;vt++){const kt=_e[vt],Lt=kt[ul];if(df(kt,Kv),Lt&&Lt.hasAnimation)continue;let Pn=[];if(p.size){let tc=p.get(kt);tc&&tc.length&&Pn.push(...tc);let Zs=this.driver.query(kt,SE,!0);for(let id=0;id<Zs.length;id++){let $i=p.get(Zs[id]);$i&&$i.length&&Pn.push(...$i)}}const eo=Pn.filter(tc=>!tc.destroyed);eo.length?X7(this,kt,eo):this.processLeaveNode(kt)}return _e.length=0,Dh.forEach(vt=>{this.players.push(vt),vt.onDone(()=>{vt.destroy();const kt=this.players.indexOf(vt);this.players.splice(kt,1)}),vt.play()}),Dh}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,t,i,r,a){let u=[];if(t){const p=this.playersByQueriedElement.get(n);p&&(u=p)}else{const p=this.playersByElement.get(n);if(p){const y=!a||a==Og;p.forEach(E=>{E.queued||!y&&E.triggerName!=r||u.push(E)})}}return(i||r)&&(u=u.filter(p=>!(i&&i!=p.namespaceId||r&&r!=p.triggerName))),u}_beforeAnimationBuild(n,t,i){const a=t.element,u=t.isRemovalTransition?void 0:n,p=t.isRemovalTransition?void 0:t.triggerName;for(const y of t.timelines){const E=y.element,I=E!==a,R=qs(i,E,[]);this._getPreviousPlayers(E,I,u,p,t.toState).forEach(H=>{const X=H.getRealPlayer();X.beforeDestroy&&X.beforeDestroy(),H.destroy(),R.push(H)})}Ch(a,t.fromStyles)}_buildAnimation(n,t,i,r,a,u){const p=t.triggerName,y=t.element,E=[],I=new Set,R=new Set,B=t.timelines.map(X=>{const re=X.element;I.add(re);const _e=re[ul];if(_e&&_e.removedBeforeQueried)return new cg(X.duration,X.delay);const Se=re!==y,ye=function Y7(e){const n=[];return M2(e,n),n}((i.get(re)||$7).map(di=>di.getRealPlayer())).filter(di=>!!di.element&&di.element===re),ot=a.get(re),lt=u.get(re),Gt=r2(this._normalizer,X.keyframes,ot,lt),Jn=this._buildPlayer(X,Gt,ye);if(X.subTimeline&&r&&R.add(re),Se){const di=new zE(n,p,re);di.setRealPlayer(Jn),E.push(di)}return Jn});E.forEach(X=>{qs(this.playersByQueriedElement,X.element,[]).push(X),X.onDone(()=>function W7(e,n,t){let i=e.get(n);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&e.delete(n)}return i}(this.playersByQueriedElement,X.element,X))}),I.forEach(X=>Oa(X,d2));const H=td(B);return H.onDestroy(()=>{I.forEach(X=>df(X,d2)),ec(y,t.toStyles)}),R.forEach(X=>{qs(r,X,[]).push(H)}),H}_buildPlayer(n,t,i){return t.length>0?this.driver.animate(n.element,t,n.duration,n.delay,n.easing,i):new cg(n.duration,n.delay)}}class zE{constructor(n,t,i){this.namespaceId=n,this.triggerName=t,this.element=i,this._player=new cg,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>vE(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const t=this._player;t.triggerCallback&&n.onStart(()=>t.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,t){qs(this._queuedCallbacks,n,[]).push(t)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const t=this._player;t.triggerCallback&&t.triggerCallback(n)}}function sb(e){return e&&1===e.nodeType}function S2(e,n){const t=e.style.display;return e.style.display=n??"none",t}function D2(e,n,t,i,r){const a=[];t.forEach(y=>a.push(S2(y)));const u=[];i.forEach((y,E)=>{const I=new Map;y.forEach(R=>{const B=n.computeStyle(E,R,r);I.set(R,B),(!B||0==B.length)&&(E[ul]=H7,u.push(E))}),e.set(E,I)});let p=0;return t.forEach(y=>S2(y,a[p++])),u}function I2(e,n){const t=new Map;if(e.forEach(p=>t.set(p,[])),0==n.length)return t;const r=new Set(n),a=new Map;function u(p){if(!p)return 1;let y=a.get(p);if(y)return y;const E=p.parentNode;return y=t.has(E)?E:r.has(E)?1:u(E),a.set(p,y),y}return n.forEach(p=>{const y=u(p);1!==y&&t.get(y).push(p)}),t}function Oa(e,n){e.classList?.add(n)}function df(e,n){e.classList?.remove(n)}function X7(e,n,t){td(t).onDone(()=>e.processLeaveNode(n))}function M2(e,n){for(let t=0;t<e.length;t++){const i=e[t];i instanceof wk?M2(i.players,n):n.push(i)}}function T2(e,n,t){const i=t.get(e);if(!i)return!1;let r=n.get(e);return r?i.forEach(a=>r.add(a)):n.set(e,i),t.delete(e),!0}class ab{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,a)=>{},this._transitionEngine=new G7(n,t,i),this._timelineEngine=new B7(n,t,i),this._transitionEngine.onRemovalComplete=(r,a)=>this.onRemovalComplete(r,a)}registerTrigger(n,t,i,r,a){const u=n+"-"+r;let p=this._triggerCache[u];if(!p){const y=[],I=TE(this._driver,a,y,[]);if(y.length)throw function V9(e,n){return new be(3404,!1)}();p=function F7(e,n,t){return new O7(e,n,t)}(r,I,this._normalizer),this._triggerCache[u]=p}this._transitionEngine.registerTrigger(t,r,p)}register(n,t){this._transitionEngine.register(n,t)}destroy(n,t){this._transitionEngine.destroy(n,t)}onInsert(n,t,i,r){this._transitionEngine.insertNode(n,t,i,r)}onRemove(n,t,i){this._transitionEngine.removeNode(n,t,i)}disableAnimations(n,t){this._transitionEngine.markElementAsDisabled(n,t)}process(n,t,i,r){if("@"==i.charAt(0)){const[a,u]=o2(i);this._timelineEngine.command(a,t,u,r)}else this._transitionEngine.trigger(n,t,i,r)}listen(n,t,i,r,a){if("@"==i.charAt(0)){const[u,p]=o2(i);return this._timelineEngine.listen(u,t,p,a)}return this._transitionEngine.listen(n,t,i,r,a)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let eW=(()=>{class e{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let a=e.initialStylesByElement.get(t);a||e.initialStylesByElement.set(t,a=new Map),this._initialStyles=a}start(){this._state<1&&(this._startStyles&&ec(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ec(this._element,this._initialStyles),this._endStyles&&(ec(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Ch(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ch(this._element,this._endStyles),this._endStyles=null),ec(this._element,this._initialStyles),this._state=3)}}return e})();function VE(e){let n=null;return e.forEach((t,i)=>{(function tW(e){return"display"===e||"position"===e})(i)&&(n=n||new Map,n.set(i,t))}),n}class A2{constructor(n,t,i,r){this.element=n,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const t=[];return n.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(n,t,i){return n.animate(this._convertKeyframesToObject(t),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:m2(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const t="start"===n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class nW{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,t){return!1}containsElement(n,t){return a2(n,t)}getParentElement(n){return wE(n)}query(n,t,i){return l2(n,t,i)}computeStyle(n,t,i){return window.getComputedStyle(n)[t]}animate(n,t,i,r,a,u=[]){const y={duration:i,delay:r,fill:0==r?"both":"forwards"};a&&(y.easing=a);const E=new Map,I=u.filter(H=>H instanceof A2);(function c7(e,n){return 0===e||0===n})(i,r)&&I.forEach(H=>{H.currentSnapshot.forEach((X,re)=>E.set(re,X))});let R=function s7(e){return e.length?e[0]instanceof Map?e:e.map(n=>h2(n)):[]}(t).map(H=>nd(H));R=function u7(e,n,t){if(t.size&&n.length){let i=n[0],r=[];if(t.forEach((a,u)=>{i.has(u)||r.push(u),i.set(u,a)}),r.length)for(let a=1;a<n.length;a++){let u=n[a];r.forEach(p=>u.set(p,m2(e,p)))}}return n}(n,R,E);const B=function J7(e,n){let t=null,i=null;return Array.isArray(n)&&n.length?(t=VE(n[0]),n.length>1&&(i=VE(n[n.length-1]))):n instanceof Map&&(t=VE(n)),t||i?new eW(e,t,i):null}(n,R);return new A2(n,R,y,B)}}let iW=(()=>{class e extends bk{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:rr.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?xk(t):t;return k2(this._renderer,null,i,"register",[r]),new rW(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||e)(Me(ym),Me(hn))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();class rW extends b${constructor(n,t){super(),this._id=n,this._renderer=t}create(n,t){return new oW(this._id,n,t||{},this._renderer)}}class oW{constructor(n,t,i,r){this.id=n,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,t){return this._renderer.listen(this.element,`@@${this.id}:${n}`,t)}_command(n,...t){return k2(this._renderer,this.element,this.id,n,t)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function k2(e,n,t,i,r){return e.setProperty(n,`@@${t}:${i}`,r)}const R2="@.disabled";let sW=(()=>{class e{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(a,u)=>{const p=u?.parentNode(a);p&&u.removeChild(p,a)}}createRenderer(t,i){const a=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let I=this._rendererCache.get(a);return I||(I=new P2("",a,this.engine,()=>this._rendererCache.delete(a)),this._rendererCache.set(a,I)),I}const u=i.id,p=i.id+"-"+this._currentId;this._currentId++,this.engine.register(p,t);const y=I=>{Array.isArray(I)?I.forEach(y):this.engine.registerTrigger(u,p,t,I.name,I)};return i.data.animation.forEach(y),new aW(this,p,a,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(a=>{const[u,p]=a;u(p)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||e)(Me(ym),Me(ab),Me(jt))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})();class P2{constructor(n,t,i,r){this.namespaceId=n,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,t){return this.delegate.createElement(n,t)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,t){this.delegate.appendChild(n,t),this.engine.onInsert(this.namespaceId,t,n,!1)}insertBefore(n,t,i,r=!0){this.delegate.insertBefore(n,t,i),this.engine.onInsert(this.namespaceId,t,n,r)}removeChild(n,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(n,t){return this.delegate.selectRootElement(n,t)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,t,i,r){this.delegate.setAttribute(n,t,i,r)}removeAttribute(n,t,i){this.delegate.removeAttribute(n,t,i)}addClass(n,t){this.delegate.addClass(n,t)}removeClass(n,t){this.delegate.removeClass(n,t)}setStyle(n,t,i,r){this.delegate.setStyle(n,t,i,r)}removeStyle(n,t,i){this.delegate.removeStyle(n,t,i)}setProperty(n,t,i){"@"==t.charAt(0)&&t==R2?this.disableAnimations(n,!!i):this.delegate.setProperty(n,t,i)}setValue(n,t){this.delegate.setValue(n,t)}listen(n,t,i){return this.delegate.listen(n,t,i)}disableAnimations(n,t){this.engine.disableAnimations(n,t)}}class aW extends P2{constructor(n,t,i,r,a){super(t,i,r,a),this.factory=n,this.namespaceId=t}setProperty(n,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==R2?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,t.slice(1),i):this.delegate.setProperty(n,t,i)}listen(n,t,i){if("@"==t.charAt(0)){const r=function lW(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(n);let a=t.slice(1),u="";return"@"!=a.charAt(0)&&([a,u]=function cW(e){const n=e.indexOf(".");return[e.substring(0,n),e.slice(n+1)]}(a)),this.engine.listen(this.namespaceId,r,a,u,p=>{this.factory.scheduleListenerCallback(p._data||-1,i,p)})}return this.delegate.listen(n,t,i)}}const F2=[{provide:bk,useClass:iW},{provide:FE,useFactory:function dW(){return new A7}},{provide:ab,useClass:(()=>{class e extends ab{constructor(t,i,r,a){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||e)(Me(hn),Me(EE),Me(FE),Me(zu))};static#t=this.\u0275prov=et({token:e,factory:e.\u0275fac})}return e})()},{provide:ym,useFactory:function hW(e,n,t){return new sW(e,n,t)},deps:[rw,ab,jt]}],UE=[{provide:EE,useFactory:()=>new nW},{provide:Tc,useValue:"BrowserAnimations"},...F2],O2=[{provide:EE,useClass:c2},{provide:Tc,useValue:"NoopAnimations"},...F2];let pW=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?O2:UE}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=mi({type:e});static#n=this.\u0275inj=pi({providers:UE,imports:[hT]})}return e})(),mW=(()=>{class e{constructor(t){t.versionUpdates.pipe(ji(i=>"VERSION_READY"===i.type)).subscribe(i=>{document.location.reload()})}static#e=this.\u0275fac=function(i){return new(i||e)(Me(_E))};static#t=this.\u0275mod=mi({type:e,bootstrap:[c9]});static#n=this.\u0275inj=pi({imports:[hT,y9.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:1000"}),pW,Qk]})}return e})();e5().bootstrapModule(mW).catch(e=>console.error(e))},16:Hc=>{"use strict";var $t,Fo="object"==typeof Reflect?Reflect:null,vs=Fo&&"function"==typeof Fo.apply?Fo.apply:function(ze,We,dt){return Function.prototype.apply.call(ze,We,dt)};$t=Fo&&"function"==typeof Fo.ownKeys?Fo.ownKeys:Object.getOwnPropertySymbols?function(ze){return Object.getOwnPropertyNames(ze).concat(Object.getOwnPropertySymbols(ze))}:function(ze){return Object.getOwnPropertyNames(ze)};var qc=Number.isNaN||function(ze){return ze!=ze};function v(){v.init.call(this)}Hc.exports=v,Hc.exports.once=function Ri(He,ze){return new Promise(function(We,dt){function mt(Bt){He.removeListener(ze,ht),dt(Bt)}function ht(){"function"==typeof He.removeListener&&He.removeListener("error",mt),We([].slice.call(arguments))}Lo(He,ze,ht,{once:!0}),"error"!==ze&&function Oo(He,ze,We){"function"==typeof He.on&&Lo(He,"error",ze,We)}(He,mt,{once:!0})})},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var Jt=10;function xe(He){if("function"!=typeof He)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof He)}function Qi(He){return void 0===He._maxListeners?v.defaultMaxListeners:He._maxListeners}function ut(He,ze,We,dt){var mt,ht,Bt;if(xe(We),void 0===(ht=He._events)?(ht=He._events=Object.create(null),He._eventsCount=0):(void 0!==ht.newListener&&(He.emit("newListener",ze,We.listener?We.listener:We),ht=He._events),Bt=ht[ze]),void 0===Bt)Bt=ht[ze]=We,++He._eventsCount;else if("function"==typeof Bt?Bt=ht[ze]=dt?[We,Bt]:[Bt,We]:dt?Bt.unshift(We):Bt.push(We),(mt=Qi(He))>0&&Bt.length>mt&&!Bt.warned){Bt.warned=!0;var Zn=new Error("Possible EventEmitter memory leak detected. "+Bt.length+" "+String(ze)+" listeners added. Use emitter.setMaxListeners() to increase limit");Zn.name="MaxListenersExceededWarning",Zn.emitter=He,Zn.type=ze,Zn.count=Bt.length,function nc(He){console&&console.warn&&console.warn(He)}(Zn)}return He}function yr(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function to(He,ze,We){var dt={fired:!1,wrapFn:void 0,target:He,type:ze,listener:We},mt=yr.bind(dt);return mt.listener=We,dt.wrapFn=mt,mt}function bs(He,ze,We){var dt=He._events;if(void 0===dt)return[];var mt=dt[ze];return void 0===mt?[]:"function"==typeof mt?We?[mt.listener||mt]:[mt]:We?function yo(He){for(var ze=new Array(He.length),We=0;We<ze.length;++We)ze[We]=He[We].listener||He[We];return ze}(mt):rs(mt,mt.length)}function no(He){var ze=this._events;if(void 0!==ze){var We=ze[He];if("function"==typeof We)return 1;if(void 0!==We)return We.length}return 0}function rs(He,ze){for(var We=new Array(ze),dt=0;dt<ze;++dt)We[dt]=He[dt];return We}function Lo(He,ze,We,dt){if("function"==typeof He.on)dt.once?He.once(ze,We):He.on(ze,We);else{if("function"!=typeof He.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof He);He.addEventListener(ze,function mt(ht){dt.once&&He.removeEventListener(ze,mt),We(ht)})}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return Jt},set:function(He){if("number"!=typeof He||He<0||qc(He))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+He+".");Jt=He}}),v.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(ze){if("number"!=typeof ze||ze<0||qc(ze))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ze+".");return this._maxListeners=ze,this},v.prototype.getMaxListeners=function(){return Qi(this)},v.prototype.emit=function(ze){for(var We=[],dt=1;dt<arguments.length;dt++)We.push(arguments[dt]);var mt="error"===ze,ht=this._events;if(void 0!==ht)mt=mt&&void 0===ht.error;else if(!mt)return!1;if(mt){var Bt;if(We.length>0&&(Bt=We[0]),Bt instanceof Error)throw Bt;var Zn=new Error("Unhandled error."+(Bt?" ("+Bt.message+")":""));throw Zn.context=Bt,Zn}var Ji=ht[ze];if(void 0===Ji)return!1;if("function"==typeof Ji)vs(Ji,this,We);else{var No=Ji.length,Bo=rs(Ji,No);for(dt=0;dt<No;++dt)vs(Bo[dt],this,We)}return!0},v.prototype.on=v.prototype.addListener=function(ze,We){return ut(this,ze,We,!1)},v.prototype.prependListener=function(ze,We){return ut(this,ze,We,!0)},v.prototype.once=function(ze,We){return xe(We),this.on(ze,to(this,ze,We)),this},v.prototype.prependOnceListener=function(ze,We){return xe(We),this.prependListener(ze,to(this,ze,We)),this},v.prototype.off=v.prototype.removeListener=function(ze,We){var dt,mt,ht,Bt,Zn;if(xe(We),void 0===(mt=this._events))return this;if(void 0===(dt=mt[ze]))return this;if(dt===We||dt.listener===We)0==--this._eventsCount?this._events=Object.create(null):(delete mt[ze],mt.removeListener&&this.emit("removeListener",ze,dt.listener||We));else if("function"!=typeof dt){for(ht=-1,Bt=dt.length-1;Bt>=0;Bt--)if(dt[Bt]===We||dt[Bt].listener===We){Zn=dt[Bt].listener,ht=Bt;break}if(ht<0)return this;0===ht?dt.shift():function qn(He,ze){for(;ze+1<He.length;ze++)He[ze]=He[ze+1];He.pop()}(dt,ht),1===dt.length&&(mt[ze]=dt[0]),void 0!==mt.removeListener&&this.emit("removeListener",ze,Zn||We)}return this},v.prototype.removeAllListeners=function(ze){var We,dt,mt;if(void 0===(dt=this._events))return this;if(void 0===dt.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==dt[ze]&&(0==--this._eventsCount?this._events=Object.create(null):delete dt[ze]),this;if(0===arguments.length){var Bt,ht=Object.keys(dt);for(mt=0;mt<ht.length;++mt)"removeListener"!==(Bt=ht[mt])&&this.removeAllListeners(Bt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(We=dt[ze]))this.removeListener(ze,We);else if(void 0!==We)for(mt=We.length-1;mt>=0;mt--)this.removeListener(ze,We[mt]);return this},v.prototype.listeners=function(ze){return bs(this,ze,!0)},v.prototype.rawListeners=function(ze){return bs(this,ze,!1)},v.listenerCount=function(He,ze){return"function"==typeof He.listenerCount?He.listenerCount(ze):no.call(He,ze)},v.prototype.listenerCount=no,v.prototype.eventNames=function(){return this._eventsCount>0?$t(this._events):[]}},624:function(Hc){Hc.exports=function(){"use strict";var Fo,vs,$t;function nc(v,Jt){if(Fo)if(vs){var xe="var sharedChunk = {}; ("+Fo+")(sharedChunk); ("+vs+")(sharedChunk);",Qi={};Fo(Qi),$t=Jt(Qi),typeof window<"u"&&($t.workerUrl=window.URL.createObjectURL(new Blob([xe],{type:"text/javascript"})))}else vs=Jt;else Fo=Jt}return nc(0,function(v){function Jt(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var xe=Qi;function Qi(l,o){this.x=l,this.y=o}Qi.prototype={clone:function(){return new Qi(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,o){return this.clone()._rotateAround(l,o)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var o=l.x-this.x,c=l.y-this.y;return o*o+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,o){return Math.atan2(this.x*o-this.y*l,this.x*l+this.y*o)},_matMult:function(l){var o=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=o,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var o=Math.cos(l),c=Math.sin(l),h=c*this.x+o*this.y;return this.x=o*this.x-c*this.y,this.y=h,this},_rotateAround:function(l,o){var c=Math.cos(l),h=Math.sin(l),g=o.y+h*(this.x-o.x)+c*(this.y-o.y);return this.x=o.x+c*(this.x-o.x)-h*(this.y-o.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qi.convert=function(l){return l instanceof Qi?l:Array.isArray(l)?new Qi(l[0],l[1]):l};var ut=Jt(xe),yr=to;function to(l,o,c,h){this.cx=3*l,this.bx=3*(c-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(h-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=o,this.p2x=c,this.p2y=h}to.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,o){if(void 0===o&&(o=1e-6),l<0)return 0;if(l>1)return 1;for(var c=l,h=0;h<8;h++){var g=this.sampleCurveX(c)-l;if(Math.abs(g)<o)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=g/b}var x=0,C=1;for(c=l,h=0;h<20&&(g=this.sampleCurveX(c),!(Math.abs(g-l)<o));h++)l>g?x=c:C=c,c=.5*(C-x)+x;return c},solve:function(l,o){return this.sampleCurveY(this.solveCurveX(l,o))}};var bs=Jt(yr);function no(l,o,c,h){const g=new bs(l,o,c,h);return function(b){return g.solve(b)}}const rs=no(.25,.1,.25,1);function qn(l,o,c){return Math.min(c,Math.max(o,l))}function yo(l,o,c){const h=c-o,g=((l-o)%h+h)%h+o;return g===o?c:g}function Ri(l,...o){for(const c of o)for(const h in c)l[h]=c[h];return l}let Oo=1;function Lo(l,o){l.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function He(l,o,c){const h={};for(const g in l)h[g]=o.call(c||this,l[g],g,l);return h}function ze(l,o,c){const h={};for(const g in l)o.call(c||this,l[g],g,l)&&(h[g]=l[g]);return h}function We(l){return Array.isArray(l)?l.map(We):"object"==typeof l&&l?He(l,We):l}const dt={};function mt(l){dt[l]||(typeof console<"u"&&console.warn(l),dt[l]=!0)}function ht(l,o,c){return(c.y-l.y)*(o.x-l.x)>(o.y-l.y)*(c.x-l.x)}function Bt(l){let o=0;for(let c,h,g=0,b=l.length,x=b-1;g<b;x=g++)c=l[g],h=l[x],o+=(h.x-c.x)*(c.y+h.y);return o}function Zn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ji=null;function No(l){if(null==Ji){const o=l.navigator?l.navigator.userAgent:null;Ji=!!l.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Ji}function Bo(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const vr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let hl,Ks;const bn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(l){const o=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(l,o=0){return this.getImageCanvasContext(l).getImageData(-o,-o,l.width+2*o,l.height+2*o)},getImageCanvasContext(l){const o=window.document.createElement("canvas"),c=o.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return o.width=l.width,o.height=l.height,c.drawImage(l,0,0,l.width,l.height),c},resolveURL:l=>(hl||(hl=document.createElement("a")),hl.href=l,hl.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==Ks&&(Ks=matchMedia("(prefers-reduced-motion: reduce)")),Ks.matches)}},pl={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Xs extends Error{constructor(o,c,h,g){super(`AJAXError: ${c} (${o}): ${h}`),this.status=o,this.statusText=c,this.url=h,this.body=g}}const Lr=Zn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,vo=l=>pl.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))];function St(l,o){const c=new AbortController,h=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Lr(),signal:c.signal});let g=!1,b=!1;return"json"===l.type&&h.headers.set("Accept","application/json"),b||fetch(h).then(x=>{return x.ok?(C=x,void("arrayBuffer"===l.type||"image"===l.type?C.arrayBuffer():"json"===l.type?C.json():C.text()).then(D=>{b||(g=!0,o(null,D,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(D=>{b||o(new Error(D.message))})):x.blob().then(C=>o(new Xs(x.status,x.statusText,l.url,C)));var C}).catch(x=>{20!==x.code&&o(new Error(x.message))}),{cancel:()=>{b=!0,g||c.abort()}}}const Na=function(l,o){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){if(Zn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,o);if(!Zn())return(vo(l.url)||St)(l,o)}if(!(/^file:/.test(c=l.url)||/^file:/.test(Lr())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return St(l,o);if(Zn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,o,void 0,!0)}var c;return function(h,g){const b=new XMLHttpRequest;b.open(h.method||"GET",h.url,!0),"arrayBuffer"!==h.type&&"image"!==h.type||(b.responseType="arraybuffer");for(const x in h.headers)b.setRequestHeader(x,h.headers[x]);return"json"===h.type&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials="include"===h.credentials,b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||0===b.status)&&null!==b.response){let x=b.response;if("json"===h.type)try{x=JSON.parse(b.response)}catch(C){return g(C)}g(null,x,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const x=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});g(new Xs(b.status,b.statusText,h.url,x))}},b.send(h.body),{cancel:()=>b.abort()}}(l,o)},Ba=function(l,o){return Na(Ri(l,{type:"arrayBuffer"}),o)};function In(l){if(!l||l.indexOf("://")<=0||0===l.indexOf("data:image/")||0===l.indexOf("blob:"))return!0;const o=new URL(l),c=window.location;return o.protocol===c.protocol&&o.host===c.host}function xn(l,o,c){c[l]&&-1!==c[l].indexOf(o)||(c[l]=c[l]||[],c[l].push(o))}function xs(l,o,c){if(c&&c[l]){const h=c[l].indexOf(o);-1!==h&&c[l].splice(h,1)}}class wt{constructor(o,c={}){Ri(this,c),this.type=o}}class qr extends wt{constructor(o,c={}){super("error",Ri({error:o},c))}}class fl{on(o,c){return this._listeners=this._listeners||{},xn(o,c,this._listeners),this}off(o,c){return xs(o,c,this._listeners),xs(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},xn(o,c,this._oneTimeListeners),this):new Promise(h=>this.once(o,h))}fire(o,c){"string"==typeof o&&(o=new wt(o,c||{}));const h=o.type;if(this.listens(h)){o.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const C of g)C.call(this,o);const b=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const C of b)xs(h,C,this._oneTimeListeners),C.call(this,o);const x=this._eventedParent;x&&(Ri(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),x.fire(o))}else o instanceof qr&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}var we={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ys=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ic(l,o){const c={};for(const h in l)"ref"!==h&&(c[h]=l[h]);return Ys.forEach(h=>{h in o&&(c[h]=o[h])}),c}function Fn(l,o){if(Array.isArray(l)){if(!Array.isArray(o)||l.length!==o.length)return!1;for(let c=0;c<l.length;c++)if(!Fn(l[c],o[c]))return!1;return!0}if("object"==typeof l&&null!==l&&null!==o){if("object"!=typeof o||Object.keys(l).length!==Object.keys(o).length)return!1;for(const c in l)if(!Fn(l[c],o[c]))return!1;return!0}return l===o}const pn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ml(l,o,c){c.push({command:pn.addSource,args:[l,o[l]]})}function Gc(l,o,c){o.push({command:pn.removeSource,args:[l]}),c[l]=!0}function rd(l,o,c,h){Gc(l,c,h),ml(l,o,c)}function vi(l,o,c){let h;for(h in l[c])if(Object.prototype.hasOwnProperty.call(l[c],h)&&"data"!==h&&!Fn(l[c][h],o[c][h]))return!1;for(h in o[c])if(Object.prototype.hasOwnProperty.call(o[c],h)&&"data"!==h&&!Fn(l[c][h],o[c][h]))return!1;return!0}function Qs(l,o,c,h,g,b){let x;for(x in o=o||{},l=l||{})Object.prototype.hasOwnProperty.call(l,x)&&(Fn(l[x],o[x])||c.push({command:b,args:[h,x,o[x],g]}));for(x in o)Object.prototype.hasOwnProperty.call(o,x)&&!Object.prototype.hasOwnProperty.call(l,x)&&(Fn(l[x],o[x])||c.push({command:b,args:[h,x,o[x],g]}))}function gl(l){return l.id}function ws(l,o){return l[o.id]=o,l}class je{constructor(o,c,h,g){this.message=(o?`${o}: `:"")+h,g&&(this.identifier=g),null!=c&&c.__line__&&(this.line=c.__line__)}}function bo(l,...o){for(const c of o)for(const h in c)l[h]=c[h];return l}class er extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}class _l{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[h,g]of c)this.bindings[h]=g}concat(o){return new _l(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Js={kind:"null"},Ve={kind:"number"},Dt={kind:"string"},Rt={kind:"boolean"},Gr={kind:"color"},bi={kind:"object"},Pt={kind:"value"},Es={kind:"collator"},Cs={kind:"formatted"},zo={kind:"padding"},Ss={kind:"resolvedImage"};function tr(l,o){return{kind:"array",itemType:l,N:o}}function Ln(l){if("array"===l.kind){const o=Ln(l.itemType);return"number"==typeof l.N?`array<${o}, ${l.N}>`:"value"===l.itemType.kind?"array":`array<${o}>`}return l.kind}const rc=[Js,Ve,Dt,Rt,Gr,Cs,bi,tr(Pt),zo,Ss];function os(l,o){if("error"===o.kind)return null;if("array"===l.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!os(l.itemType,o.itemType))&&("number"!=typeof l.N||l.N===o.N))return null}else{if(l.kind===o.kind)return null;if("value"===l.kind)for(const c of rc)if(!os(c,o))return null}return`Expected ${Ln(l)} but found ${Ln(o)} instead.`}function Q(l,o){return o.some(c=>c.kind===l.kind)}function N(l,o){return o.some(c=>"null"===c?null===l:"array"===c?Array.isArray(l):"object"===c?l&&!Array.isArray(l)&&"object"==typeof l:c===typeof l)}function V(l,o){return"array"===l.kind&&"array"===o.kind?l.itemType.kind===o.itemType.kind&&"number"==typeof l.N:l.kind===o.kind}const q=.96422,ne=4/29,ce=6/29,ae=3*ce*ce,ie=ce*ce*ce,de=Math.PI/180,Ie=180/Math.PI;function Te(l){return(l%=360)<0&&(l+=360),l}function Ee([l,o,c,h]){let g,b;const x=It((.2225045*(l=gt(l))+.7168786*(o=gt(o))+.0606169*(c=gt(c)))/1);l===o&&o===c?g=b=x:(g=It((.4360747*l+.3850649*o+.1430804*c)/q),b=It((.0139322*l+.0971045*o+.7141733*c)/.82521));const C=116*x-16;return[C<0?0:C,500*(g-x),200*(x-b),h]}function gt(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function It(l){return l>ie?Math.pow(l,1/3):l/ae+ne}function it([l,o,c,h]){let g=(l+16)/116,b=isNaN(o)?g:g+o/500,x=isNaN(c)?g:g-c/200;return g=1*Ct(g),b=q*Ct(b),x=.82521*Ct(x),[pt(3.1338561*b-1.6168667*g-.4906146*x),pt(-.9787684*b+1.9161415*g+.033454*x),pt(.0719453*b-.2289914*g+1.4052427*x),h]}function pt(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function Ct(l){return l>ce?l*l*l:ae*(l-ne)}function en(l){return parseInt(l.padEnd(2,l),16)/255}function zt(l,o){return Vt(o?l/100:l,0,1)}function Vt(l,o,c){return Math.min(Math.max(o,l),c)}function On(l){return!l.some(Number.isNaN)}const tn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class xt{constructor(o,c,h,g=1,b=!0){this.r=o,this.g=c,this.b=h,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[o,c,h,g]))}static parse(o){if(o instanceof xt)return o;if("string"!=typeof o)return;const c=function(h){if("transparent"===(h=h.toLowerCase()))return[0,0,0,0];const g=tn[h];if(g){const[x,C,D]=g;return[x/255,C/255,D/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const x=h.length<6?1:2;let C=1;return[en(h.slice(C,C+=x)),en(h.slice(C,C+=x)),en(h.slice(C,C+=x)),en(h.slice(C,C+x)||"ff")]}if(h.startsWith("rgb")){const x=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[C,D,A,P,L,z,U,$,Y,W,se,ue]=x,oe=[P||" ",U||" ",W].join("");if("  "===oe||"  /"===oe||",,"===oe||",,,"===oe){const he=[A,z,Y].join(""),ge="%%%"===he?100:""===he?255:0;if(ge){const Ce=[Vt(+D/ge,0,1),Vt(+L/ge,0,1),Vt(+$/ge,0,1),se?zt(+se,ue):1];if(On(Ce))return Ce}}return}}const b=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[x,C,D,A,P,L,z,U,$]=b,Y=[D||" ",P||" ",z].join("");if("  "===Y||"  /"===Y||",,"===Y||",,,"===Y){const W=[+C,Vt(+A,0,100),Vt(+L,0,100),U?zt(+U,$):1];if(On(W))return function([se,ue,oe,he]){function ge(Ce){const Je=(Ce+se/30)%12,rt=ue*Math.min(oe,1-oe);return oe-rt*Math.max(-1,Math.min(Je-3,9-Je,1))}return se=Te(se),ue/=100,oe/=100,[ge(0),ge(8),ge(4),he]}(W)}}}(o);return c?new xt(...c,!1):void 0}get rgb(){const{r:o,g:c,b:h,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[o/b,c/b,h/b,g])}get hcl(){return this.overwriteGetter("hcl",function(o){const[c,h,g,b]=Ee(o),x=Math.sqrt(h*h+g*g);return[Math.round(1e4*x)?Te(Math.atan2(g,h)*Ie):NaN,x,c,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ee(this.rgb))}overwriteGetter(o,c){return Object.defineProperty(this,o,{value:c}),c}toString(){const[o,c,h,g]=this.rgb;return`rgba(${[o,c,h].map(b=>Math.round(255*b)).join(",")},${g})`}}xt.black=new xt(0,0,0,1),xt.white=new xt(1,1,1,1),xt.transparent=new xt(0,0,0,0),xt.red=new xt(1,0,0,1);class gn{constructor(o,c,h){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class za{constructor(o,c,h,g,b){this.text=o,this.image=c,this.scale=h,this.fontStack=g,this.textColor=b}}class nr{constructor(o){this.sections=o}static fromString(o){return new nr([new za(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof nr?o:nr.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}}class Wr{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof Wr)return o;if("number"==typeof o)return new Wr([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const c of o)if("number"!=typeof c)return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new Wr(o)}}toString(){return JSON.stringify(this.values)}}class Zr{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Zr({name:o,available:!1}):null}}function Va(l,o,c,h){return"number"==typeof l&&l>=0&&l<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===h||"number"==typeof h&&h>=0&&h<=1?null:`Invalid rgba value [${[l,o,c,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof h?[l,o,c,h]:[l,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ea(l){if(null===l||"string"==typeof l||"boolean"==typeof l||"number"==typeof l||l instanceof xt||l instanceof gn||l instanceof nr||l instanceof Wr||l instanceof Zr)return!0;if(Array.isArray(l)){for(const o of l)if(!ea(o))return!1;return!0}if("object"==typeof l){for(const o in l)if(!ea(l[o]))return!1;return!0}return!1}function xi(l){if(null===l)return Js;if("string"==typeof l)return Dt;if("boolean"==typeof l)return Rt;if("number"==typeof l)return Ve;if(l instanceof xt)return Gr;if(l instanceof gn)return Es;if(l instanceof nr)return Cs;if(l instanceof Wr)return zo;if(l instanceof Zr)return Ss;if(Array.isArray(l)){const o=l.length;let c;for(const h of l){const g=xi(h);if(c){if(c===g)continue;c=Pt;break}c=g}return tr(c||Pt,o)}return bi}function yl(l){const o=typeof l;return null===l?"":"string"===o||"number"===o||"boolean"===o?String(l):l instanceof xt||l instanceof nr||l instanceof Wr||l instanceof Zr?l.toString():JSON.stringify(l)}class Ds{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(2!==o.length)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!ea(o[1]))return c.error("invalid value");const h=o[1];let g=xi(h);const b=c.expectedType;return"array"!==g.kind||0!==g.N||!b||"array"!==b.kind||"number"==typeof b.N&&0!==b.N||(g=b),new Ds(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class hi{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Wc={string:Dt,number:Ve,boolean:Rt,object:bi};class Vo{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let h,g=1;const b=o[0];if("array"===b){let C,D;if(o.length>2){const A=o[1];if("string"!=typeof A||!(A in Wc)||"object"===A)return c.error('The item type argument of "array" must be one of string, number, boolean',1);C=Wc[A],g++}else C=Pt;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);D=o[2],g++}h=tr(C,D)}else{if(!Wc[b])throw new Error(`Types doesn't contain name = ${b}`);h=Wc[b]}const x=[];for(;g<o.length;g++){const C=c.parse(o[g],g,Pt);if(!C)return null;x.push(C)}return new Vo(h,x)}evaluate(o){for(let c=0;c<this.args.length;c++){const h=this.args[c].evaluate(o);if(!os(this.type,xi(h)))return h;if(c===this.args.length-1)throw new hi(`Expected value to be of type ${Ln(this.type)}, but found ${Ln(xi(h))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const Mh={"to-boolean":Rt,"to-color":Gr,"to-number":Ve,"to-string":Dt};class Hi{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const h=o[0];if(!Mh[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if(("to-boolean"===h||"to-string"===h)&&2!==o.length)return c.error("Expected one argument.");const g=Mh[h],b=[];for(let x=1;x<o.length;x++){const C=c.parse(o[x],x,Pt);if(!C)return null;b.push(C)}return new Hi(g,b)}evaluate(o){if("boolean"===this.type.kind)return!!this.args[0].evaluate(o);if("color"===this.type.kind){let c,h;for(const g of this.args){if(c=g.evaluate(o),h=null,c instanceof xt)return c;if("string"==typeof c){const b=o.parseColor(c);if(b)return b}else if(Array.isArray(c)&&(h=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Va(c[0],c[1],c[2],c[3]),!h))return new xt(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new hi(h||`Could not parse color from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}if("padding"===this.type.kind){let c;for(const h of this.args){c=h.evaluate(o);const g=Wr.parse(c);if(g)return g}throw new hi(`Could not parse padding from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}if("number"===this.type.kind){let c=null;for(const h of this.args){if(c=h.evaluate(o),null===c)return 0;const g=Number(c);if(!isNaN(g))return g}throw new hi(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?nr.fromString(yl(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Zr.fromString(yl(this.args[0].evaluate(o))):yl(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const od=["Unknown","Point","LineString","Polygon"];class Zc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?od[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let c=this._parseColorCache[o];return c||(c=this._parseColorCache[o]=xt.parse(o)),c}}class ei{constructor(o,c,h=[],g,b=new _l,x=[]){this.registry=o,this.path=h,this.key=h.map(C=>`[${C}]`).join(""),this.scope=b,this.errors=x,this.expectedType=g,this._isConstant=c}parse(o,c,h,g,b={}){return c?this.concat(c,h,g)._parse(o,b):this._parse(o,b)}_parse(o,c){function h(g,b,x){return"assert"===x?new Vo(b,[g]):"coerce"===x?new Hi(b,[g]):g}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=o[0];if("string"!=typeof g)return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let x=b.parse(o,this);if(!x)return null;if(this.expectedType){const C=this.expectedType,D=x.type;if("string"!==C.kind&&"number"!==C.kind&&"boolean"!==C.kind&&"object"!==C.kind&&"array"!==C.kind||"value"!==D.kind)if("color"!==C.kind&&"formatted"!==C.kind&&"resolvedImage"!==C.kind||"value"!==D.kind&&"string"!==D.kind)if("padding"!==C.kind||"value"!==D.kind&&"number"!==D.kind&&"array"!==D.kind){if(this.checkSubtype(C,D))return null}else x=h(x,C,c.typeAnnotation||"coerce");else x=h(x,C,c.typeAnnotation||"coerce");else x=h(x,C,c.typeAnnotation||"assert")}if(!(x instanceof Ds)&&"resolvedImage"!==x.type.kind&&this._isConstant(x)){const C=new Zc;try{x=new Ds(x.type,x.evaluate(C))}catch(D){return this.error(D.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,h){const g="number"==typeof o?this.path.concat(o):this.path,b=h?this.scope.concat(h):this.scope;return new ei(this.registry,this._isConstant,g,c||null,b,this.errors)}error(o,...c){const h=`${this.key}${c.map(g=>`[${g}]`).join("")}`;this.errors.push(new er(h,o))}checkSubtype(o,c){const h=os(o,c);return h&&this.error(h),h}}class Ht{constructor(o,c,h){this.type=Es,this.locale=h,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(2!==o.length)return c.error("Expected one argument.");const h=o[1];if("object"!=typeof h||Array.isArray(h))return c.error("Collator options argument must be an object.");const g=c.parse(void 0!==h["case-sensitive"]&&h["case-sensitive"],1,Rt);if(!g)return null;const b=c.parse(void 0!==h["diacritic-sensitive"]&&h["diacritic-sensitive"],1,Rt);if(!b)return null;let x=null;return h.locale&&(x=c.parse(h.locale,1,Dt),!x)?null:new Ht(g,b,x)}evaluate(o){return new gn(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}const wi=8192;function _t(l,o){l[0]=Math.min(l[0],o[0]),l[1]=Math.min(l[1],o[1]),l[2]=Math.max(l[2],o[0]),l[3]=Math.max(l[3],o[1])}function vl(l,o){return!(l[0]<=o[0]||l[2]>=o[2]||l[1]<=o[1]||l[3]>=o[3])}function Kc(l,o){const c=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,g=Math.pow(2,o.z);return[Math.round(c*g*wi),Math.round(h*g*wi)]}function ir(l,o,c){const h=l[0]-o[0],g=l[1]-o[1],b=l[0]-c[0],x=l[1]-c[1];return h*x-b*g==0&&h*b<=0&&g*x<=0}function Xc(l,o){let c=!1;for(let x=0,C=o.length;x<C;x++){const D=o[x];for(let A=0,P=D.length;A<P-1;A++){if(ir(l,D[A],D[A+1]))return!1;(g=D[A])[1]>(h=l)[1]!=(b=D[A+1])[1]>h[1]&&h[0]<(b[0]-g[0])*(h[1]-g[1])/(b[1]-g[1])+g[0]&&(c=!c)}}var h,g,b;return c}function Th(l,o){for(let c=0;c<o.length;c++)if(Xc(l,o[c]))return!0;return!1}function wn(l,o,c,h){const g=h[0]-c[0],b=h[1]-c[1],x=(l[0]-c[0])*b-g*(l[1]-c[1]),C=(o[0]-c[0])*b-g*(o[1]-c[1]);return x>0&&C<0||x<0&&C>0}function Yc(l,o,c){for(const A of c)for(let P=0;P<A.length-1;++P)if((C=[(x=A[P+1])[0]-(b=A[P])[0],x[1]-b[1]])[0]*(D=[(g=o)[0]-(h=l)[0],g[1]-h[1]])[1]-C[1]*D[0]!=0&&wn(h,g,b,x)&&wn(b,x,h,g))return!0;var h,g,b,x,C,D;return!1}function Ei(l,o){for(let c=0;c<l.length;++c)if(!Xc(l[c],o))return!1;for(let c=0;c<l.length-1;++c)if(Yc(l[c],l[c+1],o))return!1;return!0}function sd(l,o){for(let c=0;c<o.length;c++)if(Ei(l,o[c]))return!0;return!1}function ad(l,o,c){const h=[];for(let g=0;g<l.length;g++){const b=[];for(let x=0;x<l[g].length;x++){const C=Kc(l[g][x],c);_t(o,C),b.push(C)}h.push(b)}return h}function Mn(l,o,c){const h=[];for(let g=0;g<l.length;g++){const b=ad(l[g],o,c);h.push(b)}return h}function Mt(l,o,c,h){if(l[0]<c[0]||l[0]>c[2]){const g=.5*h;let b=l[0]-c[0]>g?-h:c[0]-l[0]>g?h:0;0===b&&(b=l[0]-c[2]>g?-h:c[2]-l[0]>g?h:0),l[0]+=b}_t(o,l)}function Qc(l,o,c,h){const g=Math.pow(2,h.z)*wi,b=[h.x*wi,h.y*wi],x=[];for(const C of l)for(const D of C){const A=[D.x+b[0],D.y+b[1]];Mt(A,o,c,g),x.push(A)}return x}function Jc(l,o,c,h){const g=Math.pow(2,h.z)*wi,b=[h.x*wi,h.y*wi],x=[];for(const D of l){const A=[];for(const P of D){const L=[P.x+b[0],P.y+b[1]];_t(o,L),A.push(L)}x.push(A)}if(o[2]-o[0]<=g/2){(C=o)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const D of x)for(const A of D)Mt(A,o,c,g)}var C;return x}class ta{constructor(o,c){this.type=Rt,this.geojson=o,this.geometries=c}static parse(o,c){if(2!==o.length)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(ea(o[1])){const h=o[1];if("FeatureCollection"===h.type)for(let g=0;g<h.features.length;++g){const b=h.features[g].geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new ta(h,h.features[g].geometry)}else if("Feature"===h.type){const g=h.geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new ta(h,h.geometry)}else if("Polygon"===h.type||"MultiPolygon"===h.type)return new ta(h,h)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(c,h){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if("Polygon"===h.type){const C=ad(h.coordinates,b,x),D=Qc(c.geometry(),g,b,x);if(!vl(g,b))return!1;for(const A of D)if(!Xc(A,C))return!1}if("MultiPolygon"===h.type){const C=Mn(h.coordinates,b,x),D=Qc(c.geometry(),g,b,x);if(!vl(g,b))return!1;for(const A of D)if(!Th(A,C))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(c,h){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if("Polygon"===h.type){const C=ad(h.coordinates,b,x),D=Jc(c.geometry(),g,b,x);if(!vl(g,b))return!1;for(const A of D)if(!Ei(A,C))return!1}if("MultiPolygon"===h.type){const C=Mn(h.coordinates,b,x),D=Jc(c.geometry(),g,b,x);if(!vl(g,b))return!1;for(const A of D)if(!sd(A,C))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class oc{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(2!==o.length||"string"!=typeof o[1])return c.error("'var' expression requires exactly one string literal argument.");const h=o[1];return c.scope.has(h)?new oc(h,c.scope.get(h)):c.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class be{constructor(o,c,h,g){this.name=o,this.type=c,this._evaluate=h,this.args=g}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,c){const h=o[0],g=be.definitions[h];if(!g)return c.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=x.filter(([A])=>!Array.isArray(A)||A.length===o.length-1);let D=null;for(const[A,P]of C){D=new ei(c.registry,Ua,c.path,null,c.scope);const L=[];let z=!1;for(let U=1;U<o.length;U++){const $=o[U],Y=Array.isArray(A)?A[U-1]:A.type,W=D.parse($,1+L.length,Y);if(!W){z=!0;break}L.push(W)}if(!z)if(Array.isArray(A)&&A.length!==L.length)D.error(`Expected ${A.length} arguments, but found ${L.length} instead.`);else{for(let U=0;U<L.length;U++){const $=Array.isArray(A)?A[U]:A.type,Y=L[U];D.concat(U+1).checkSubtype($,Y.type)}if(0===D.errors.length)return new be(h,b,P,L)}}if(1===C.length)c.errors.push(...D.errors);else{const A=(C.length?C:x).map(([L])=>{return z=L,Array.isArray(z)?`(${z.map(Ln).join(", ")})`:`(${Ln(z.type)}...)`;var z}).join(" | "),P=[];for(let L=1;L<o.length;L++){const z=c.parse(o[L],1+P.length);if(!z)return null;P.push(Ln(z.type))}c.error(`Expected arguments of type ${A}, but found (${P.join(", ")}) instead.`)}return null}static register(o,c){be.definitions=c;for(const h in c)o[h]=be}}function Ua(l){if(l instanceof oc)return Ua(l.boundExpression);if(l instanceof be&&"error"===l.name||l instanceof Ht||l instanceof ta)return!1;const o=l instanceof Hi||l instanceof Vo;let c=!0;return l.eachChild(h=>{c=o?c&&Ua(h):c&&h instanceof Ds}),!!c&&Tt(l)&&eu(l,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Tt(l){if(l instanceof be&&("get"===l.name&&1===l.args.length||"feature-state"===l.name||"has"===l.name&&1===l.args.length||"properties"===l.name||"geometry-type"===l.name||"id"===l.name||/^filter-/.test(l.name))||l instanceof ta)return!1;let o=!0;return l.eachChild(c=>{o&&!Tt(c)&&(o=!1)}),o}function on(l){if(l instanceof be&&"feature-state"===l.name)return!1;let o=!0;return l.eachChild(c=>{o&&!on(c)&&(o=!1)}),o}function eu(l,o){if(l instanceof be&&o.indexOf(l.name)>=0)return!1;let c=!0;return l.eachChild(h=>{c&&!eu(h,o)&&(c=!1)}),c}function ld(l,o){const c=l.length-1;let h,g,b=0,x=c,C=0;for(;b<=x;)if(C=Math.floor((b+x)/2),h=l[C],g=l[C+1],h<=o){if(C===c||o<g)return C;b=C+1}else{if(!(h>o))throw new hi("Input is not a number.");x=C-1}return 0}class bl{constructor(o,c,h){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[g,b]of h)this.labels.push(g),this.outputs.push(b)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const h=c.parse(o[1],1,Ve);if(!h)return null;const g=[];let b=null;c.expectedType&&"value"!==c.expectedType.kind&&(b=c.expectedType);for(let x=1;x<o.length;x+=2){const C=1===x?-1/0:o[x],D=o[x+1],A=x,P=x+1;if("number"!=typeof C)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(g.length&&g[g.length-1][0]>=C)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const L=c.parse(D,P,b);if(!L)return null;b=b||L.type,g.push([C,L])}return new bl(b,h,g)}evaluate(o){const c=this.labels,h=this.outputs;if(1===c.length)return h[0].evaluate(o);const g=this.input.evaluate(o);if(g<=c[0])return h[0].evaluate(o);const b=c.length;return g>=c[b-1]?h[b-1].evaluate(o):h[ld(c,g)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function na(l,o,c){return l+c*(o-l)}function br(l,o,c){return l.map((h,g)=>na(h,o[g],c))}const xo={number:na,color:function(l,o,c,h="rgb"){switch(h){case"rgb":{const[g,b,x,C]=br(l.rgb,o.rgb,c);return new xt(g,b,x,C,!1)}case"hcl":{const[g,b,x,C]=l.hcl,[D,A,P,L]=o.hcl;let z,U;if(isNaN(g)||isNaN(D))isNaN(g)?isNaN(D)?z=NaN:(z=D,1!==x&&0!==x||(U=A)):(z=g,1!==P&&0!==P||(U=b));else{let ue=D-g;D>g&&ue>180?ue-=360:D<g&&g-D>180&&(ue+=360),z=g+c*ue}const[$,Y,W,se]=function([ue,oe,he,ge]){return ue=isNaN(ue)?0:ue*de,it([he,Math.cos(ue)*oe,Math.sin(ue)*oe,ge])}([z,U??na(b,A,c),na(x,P,c),na(C,L,c)]);return new xt($,Y,W,se,!1)}case"lab":{const[g,b,x,C]=it(br(l.lab,o.lab,c));return new xt(g,b,x,C,!1)}}},array:br,padding:function(l,o,c){return new Wr(br(l.values,o.values,c))}};class io{constructor(o,c,h,g,b){this.type=o,this.operator=c,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[x,C]of b)this.labels.push(x),this.outputs.push(C)}static interpolationFactor(o,c,h,g){let b=0;if("exponential"===o.name)b=Ah(c,o.base,h,g);else if("linear"===o.name)b=Ah(c,1,h,g);else if("cubic-bezier"===o.name){const x=o.controlPoints;b=new bs(x[0],x[1],x[2],x[3]).solve(Ah(c,1,h,g))}return b}static parse(o,c){let[h,g,b,...x]=o;if(!Array.isArray(g)||0===g.length)return c.error("Expected an interpolation type expression.",1);if("linear"===g[0])g={name:"linear"};else if("exponential"===g[0]){const A=g[1];if("number"!=typeof A)return c.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:A}}else{if("cubic-bezier"!==g[0])return c.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const A=g.slice(1);if(4!==A.length||A.some(P=>"number"!=typeof P||P<0||P>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:A}}}if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(b=c.parse(b,2,Ve),!b)return null;const C=[];let D=null;"interpolate-hcl"===h||"interpolate-lab"===h?D=Gr:c.expectedType&&"value"!==c.expectedType.kind&&(D=c.expectedType);for(let A=0;A<x.length;A+=2){const P=x[A],L=x[A+1],z=A+3,U=A+4;if("number"!=typeof P)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(C.length&&C[C.length-1][0]>=P)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const $=c.parse(L,U,D);if(!$)return null;D=D||$.type,C.push([P,$])}return V(D,Ve)||V(D,Gr)||V(D,zo)||V(D,tr(Ve))?new io(D,h,g,b,C):c.error(`Type ${Ln(D)} is not interpolatable.`)}evaluate(o){const c=this.labels,h=this.outputs;if(1===c.length)return h[0].evaluate(o);const g=this.input.evaluate(o);if(g<=c[0])return h[0].evaluate(o);const b=c.length;if(g>=c[b-1])return h[b-1].evaluate(o);const x=ld(c,g),C=io.interpolationFactor(this.interpolation,g,c[x],c[x+1]),D=h[x].evaluate(o),A=h[x+1].evaluate(o);switch(this.operator){case"interpolate":return xo[this.type.kind](D,A,C);case"interpolate-hcl":return xo.color(D,A,C,"hcl");case"interpolate-lab":return xo.color(D,A,C,"lab")}}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function Ah(l,o,c,h){const g=h-c,b=l-c;return 0===g?0:1===o?b/g:(Math.pow(o,b)-1)/(Math.pow(o,g)-1)}class ss{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let h=null;const g=c.expectedType;g&&"value"!==g.kind&&(h=g);const b=[];for(const C of o.slice(1)){const D=c.parse(C,1+b.length,h,void 0,{typeAnnotation:"omit"});if(!D)return null;h=h||D.type,b.push(D)}if(!h)throw new Error("No output type");const x=g&&b.some(C=>os(g,C.type));return new ss(x?Pt:h,b)}evaluate(o){let c,h=null,g=0;for(const b of this.args)if(g++,h=b.evaluate(o),h&&h instanceof Zr&&!h.available&&(c||(c=h.name),h=null,g===this.args.length&&(h=c)),null!==h)break;return h}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}class cd{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const h=[];for(let b=1;b<o.length-1;b+=2){const x=o[b];if("string"!=typeof x)return c.error(`Expected string, but found ${typeof x} instead.`,b);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",b);const C=c.parse(o[b+1],b+1);if(!C)return null;h.push([x,C])}const g=c.parse(o[o.length-1],o.length-1,c.expectedType,h);return g?new cd(h,g):null}outputDefined(){return this.result.outputDefined()}}class kh{constructor(o,c,h){this.type=o,this.index=c,this.input=h}static parse(o,c){if(3!==o.length)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,Ve),g=c.parse(o[2],2,tr(c.expectedType||Pt));return h&&g?new kh(g.type.itemType,h,g):null}evaluate(o){const c=this.index.evaluate(o),h=this.input.evaluate(o);if(c<0)throw new hi(`Array index out of bounds: ${c} < 0.`);if(c>=h.length)throw new hi(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c!==Math.floor(c))throw new hi(`Array index must be an integer, but found ${c} instead.`);return h[c]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class tu{constructor(o,c){this.type=Rt,this.needle=o,this.haystack=c}static parse(o,c){if(3!==o.length)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,Pt),g=c.parse(o[2],2,Pt);return h&&g?Q(h.type,[Rt,Dt,Ve,Js,Pt])?new tu(h,g):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(h.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),h=this.haystack.evaluate(o);if(!h)return!1;if(!N(c,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(xi(c))} instead.`);if(!N(h,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${Ln(xi(h))} instead.`);return h.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class xl{constructor(o,c,h){this.type=Ve,this.needle=o,this.haystack=c,this.fromIndex=h}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,Pt),g=c.parse(o[2],2,Pt);if(!h||!g)return null;if(!Q(h.type,[Rt,Dt,Ve,Js,Pt]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(h.type)} instead`);if(4===o.length){const b=c.parse(o[3],3,Ve);return b?new xl(h,g,b):null}return new xl(h,g)}evaluate(o){const c=this.needle.evaluate(o),h=this.haystack.evaluate(o);if(!N(c,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(xi(c))} instead.`);if(!N(h,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${Ln(xi(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(o);return h.indexOf(c,g)}return h.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class ln{constructor(o,c,h,g,b,x){this.inputType=o,this.type=c,this.input=h,this.cases=g,this.outputs=b,this.otherwise=x}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let h,g;c.expectedType&&"value"!==c.expectedType.kind&&(g=c.expectedType);const b={},x=[];for(let A=2;A<o.length-1;A+=2){let P=o[A];const L=o[A+1];Array.isArray(P)||(P=[P]);const z=c.concat(A);if(0===P.length)return z.error("Expected at least one branch label.");for(const $ of P){if("number"!=typeof $&&"string"!=typeof $)return z.error("Branch labels must be numbers or strings.");if("number"==typeof $&&Math.abs($)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof $&&Math.floor($)!==$)return z.error("Numeric branch labels must be integer values.");if(h){if(z.checkSubtype(h,xi($)))return null}else h=xi($);if(void 0!==b[String($)])return z.error("Branch labels must be unique.");b[String($)]=x.length}const U=c.parse(L,A,g);if(!U)return null;g=g||U.type,x.push(U)}const C=c.parse(o[1],1,Pt);if(!C)return null;const D=c.parse(o[o.length-1],o.length-1,g);return D?"value"!==C.type.kind&&c.concat(1).checkSubtype(h,C.type)?null:new ln(h,g,C,b,x,D):null}evaluate(o){const c=this.input.evaluate(o);return(xi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class Rh{constructor(o,c,h){this.type=o,this.branches=c,this.otherwise=h}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let h;c.expectedType&&"value"!==c.expectedType.kind&&(h=c.expectedType);const g=[];for(let x=1;x<o.length-1;x+=2){const C=c.parse(o[x],x,Rt);if(!C)return null;const D=c.parse(o[x+1],x+1,h);if(!D)return null;g.push([C,D]),h=h||D.type}const b=c.parse(o[o.length-1],o.length-1,h);if(!b)return null;if(!h)throw new Error("Can't infer output type");return new Rh(h,g,b)}evaluate(o){for(const[c,h]of this.branches)if(c.evaluate(o))return h.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,h]of this.branches)o(c),o(h);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class nu{constructor(o,c,h,g){this.type=o,this.input=c,this.beginIndex=h,this.endIndex=g}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,Pt),g=c.parse(o[2],2,Ve);if(!h||!g)return null;if(!Q(h.type,[tr(Pt),Dt,Pt]))return c.error(`Expected first argument to be of type array or string, but found ${Ln(h.type)} instead`);if(4===o.length){const b=c.parse(o[3],3,Ve);return b?new nu(h.type,h,g,b):null}return new nu(h.type,h,g)}evaluate(o){const c=this.input.evaluate(o),h=this.beginIndex.evaluate(o);if(!N(c,["string","array"]))throw new hi(`Expected first argument to be of type array or string, but found ${Ln(xi(c))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(o);return c.slice(h,g)}return c.slice(h)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function hf(l,o){return"=="===l||"!="===l?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function ro(l,o,c,h){return 0===h.compare(o,c)}function Et(l,o,c){const h="=="!==l&&"!="!==l;return class z2{constructor(b,x,C){this.type=Rt,this.lhs=b,this.rhs=x,this.collator=C,this.hasUntypedArgument="value"===b.type.kind||"value"===x.type.kind}static parse(b,x){if(3!==b.length&&4!==b.length)return x.error("Expected two or three arguments.");const C=b[0];let D=x.parse(b[1],1,Pt);if(!D)return null;if(!hf(C,D.type))return x.concat(1).error(`"${C}" comparisons are not supported for type '${Ln(D.type)}'.`);let A=x.parse(b[2],2,Pt);if(!A)return null;if(!hf(C,A.type))return x.concat(2).error(`"${C}" comparisons are not supported for type '${Ln(A.type)}'.`);if(D.type.kind!==A.type.kind&&"value"!==D.type.kind&&"value"!==A.type.kind)return x.error(`Cannot compare types '${Ln(D.type)}' and '${Ln(A.type)}'.`);h&&("value"===D.type.kind&&"value"!==A.type.kind?D=new Vo(A.type,[D]):"value"!==D.type.kind&&"value"===A.type.kind&&(A=new Vo(D.type,[A])));let P=null;if(4===b.length){if("string"!==D.type.kind&&"string"!==A.type.kind&&"value"!==D.type.kind&&"value"!==A.type.kind)return x.error("Cannot use collator to compare non-string types.");if(P=x.parse(b[3],3,Es),!P)return null}return new z2(D,A,P)}evaluate(b){const x=this.lhs.evaluate(b),C=this.rhs.evaluate(b);if(h&&this.hasUntypedArgument){const D=xi(x),A=xi(C);if(D.kind!==A.kind||"string"!==D.kind&&"number"!==D.kind)throw new hi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${D.kind}, ${A.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const D=xi(x),A=xi(C);if("string"!==D.kind||"string"!==A.kind)return o(b,x,C)}return this.collator?c(b,x,C,this.collator.evaluate(b)):o(b,x,C)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Ng=Et("==",function(l,o,c){return o===c},ro),Bg=Et("!=",function(l,o,c){return o!==c},function(l,o,c,h){return!ro(0,o,c,h)}),zg=Et("<",function(l,o,c){return o<c},function(l,o,c,h){return h.compare(o,c)<0}),et=Et(">",function(l,o,c){return o>c},function(l,o,c,h){return h.compare(o,c)>0}),Vg=Et("<=",function(l,o,c){return o<=c},function(l,o,c,h){return h.compare(o,c)<=0}),pi=Et(">=",function(l,o,c){return o>=c},function(l,o,c,h){return h.compare(o,c)>=0});class wl{constructor(o,c,h,g,b){this.type=Dt,this.number=o,this.locale=c,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(o,c){if(3!==o.length)return c.error("Expected two arguments.");const h=c.parse(o[1],1,Ve);if(!h)return null;const g=o[2];if("object"!=typeof g||Array.isArray(g))return c.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=c.parse(g.locale,1,Dt),!b))return null;let x=null;if(g.currency&&(x=c.parse(g.currency,1,Dt),!x))return null;let C=null;if(g["min-fraction-digits"]&&(C=c.parse(g["min-fraction-digits"],1,Ve),!C))return null;let D=null;return g["max-fraction-digits"]&&(D=c.parse(g["max-fraction-digits"],1,Ve),!D)?null:new wl(h,b,x,C,D)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class iu{constructor(o){this.type=Cs,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const h=o[1];if(!Array.isArray(h)&&"object"==typeof h)return c.error("First argument must be an image or text section.");const g=[];let b=!1;for(let x=1;x<=o.length-1;++x){const C=o[x];if(b&&"object"==typeof C&&!Array.isArray(C)){b=!1;let D=null;if(C["font-scale"]&&(D=c.parse(C["font-scale"],1,Ve),!D))return null;let A=null;if(C["text-font"]&&(A=c.parse(C["text-font"],1,tr(Dt)),!A))return null;let P=null;if(C["text-color"]&&(P=c.parse(C["text-color"],1,Gr),!P))return null;const L=g[g.length-1];L.scale=D,L.font=A,L.textColor=P}else{const D=c.parse(o[x],1,Pt);if(!D)return null;const A=D.type.kind;if("string"!==A&&"value"!==A&&"null"!==A&&"resolvedImage"!==A)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:D,scale:null,font:null,textColor:null})}}return new iu(g)}evaluate(o){return new nr(this.sections.map(c=>{const h=c.content.evaluate(o);return xi(h)===Ss?new za("",h,null,null,null):new za(yl(h),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}}class ru{constructor(o){this.type=Ss,this.input=o}static parse(o,c){if(2!==o.length)return c.error("Expected two arguments.");const h=c.parse(o[1],1,Dt);return h?new ru(h):c.error("No image name provided.")}evaluate(o){const c=this.input.evaluate(o),h=Zr.fromString(c);return h&&o.availableImages&&(h.available=o.availableImages.indexOf(c)>-1),h}eachChild(o){o(this.input)}outputDefined(){return!1}}class ud{constructor(o){this.type=Ve,this.input=o}static parse(o,c){if(2!==o.length)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const h=c.parse(o[1],1);return h?"array"!==h.type.kind&&"string"!==h.type.kind&&"value"!==h.type.kind?c.error(`Expected argument of type string or array, but found ${Ln(h.type)} instead.`):new ud(h):null}evaluate(o){const c=this.input.evaluate(o);if("string"==typeof c||Array.isArray(c))return c.length;throw new hi(`Expected value to be of type string or array, but found ${Ln(xi(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const Is={"==":Ng,"!=":Bg,">":et,"<":zg,">=":pi,"<=":Vg,array:Vo,at:kh,boolean:Vo,case:Rh,coalesce:ss,collator:Ht,format:iu,image:ru,in:tu,"index-of":xl,interpolate:io,"interpolate-hcl":io,"interpolate-lab":io,length:ud,let:cd,literal:Ds,match:ln,number:Vo,"number-format":wl,object:Vo,slice:nu,step:bl,string:Vo,"to-boolean":Hi,"to-color":Hi,"to-number":Hi,"to-string":Hi,var:oc,within:ta};function sc(l,[o,c,h,g]){o=o.evaluate(l),c=c.evaluate(l),h=h.evaluate(l);const b=g?g.evaluate(l):1,x=Va(o,c,h,b);if(x)throw new hi(x);return new xt(o/255,c/255,h/255,b,!1)}function ou(l,o){return l in o}function su(l,o){const c=o[l];return void 0===c?null:c}function ja(l){return{type:l}}function rn(l){return{result:"success",value:l}}function ia(l){return{result:"error",value:l}}function $a(l){return"data-driven"===l["property-type"]||"cross-faded-data-driven"===l["property-type"]}function Nr(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function au(l){return!!l.expression&&l.expression.interpolated}function Cn(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":null===l?"null":typeof l}function Tn(l){return"object"==typeof l&&null!==l&&!Array.isArray(l)}function Ug(l){return l}function pf(l,o){const c="color"===o.type,h=l.stops&&"object"==typeof l.stops[0][0],g=h||!(h||void 0!==l.property),b=l.type||(au(o)?"exponential":"interval");if(c||"padding"===o.type){const P=c?xt.parse:Wr.parse;(l=bo({},l)).stops&&(l.stops=l.stops.map(L=>[L[0],P(L[1])])),l.default=P(l.default?l.default:o.default)}if(l.colorSpace&&"rgb"!==(x=l.colorSpace)&&"hcl"!==x&&"lab"!==x)throw new Error(`Unknown color space: "${l.colorSpace}"`);var x;let C,D,A;if("exponential"===b)C=hd;else if("interval"===b)C=ac;else if("categorical"===b){C=dd,D=Object.create(null);for(const P of l.stops)D[P[0]]=P[1];A=typeof l.stops[0][0]}else{if("identity"!==b)throw new Error(`Unknown function type "${b}"`);C=pd}if(h){const P={},L=[];for(let $=0;$<l.stops.length;$++){const Y=l.stops[$],W=Y[0].zoom;void 0===P[W]&&(P[W]={zoom:W,type:l.type,property:l.property,default:l.default,stops:[]},L.push(W)),P[W].stops.push([Y[0].value,Y[1]])}const z=[];for(const $ of L)z.push([P[$].zoom,pf(P[$],o)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:io.interpolationFactor.bind(void 0,U),zoomStops:z.map($=>$[0]),evaluate:({zoom:$},Y)=>hd({stops:z,base:l.base},o,$).evaluate($,Y)}}if(g){const P="exponential"===b?{name:"exponential",base:void 0!==l.base?l.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:io.interpolationFactor.bind(void 0,P),zoomStops:l.stops.map(L=>L[0]),evaluate:({zoom:L})=>C(l,o,L,D,A)}}return{kind:"source",evaluate(P,L){const z=L&&L.properties?L.properties[l.property]:void 0;return void 0===z?Re(l.default,o.default):C(l,o,z,D,A)}}}function Re(l,o,c){return void 0!==l?l:void 0!==o?o:void 0!==c?c:void 0}function dd(l,o,c,h,g){return Re(typeof c===g?h[c]:void 0,l.default,o.default)}function ac(l,o,c){if("number"!==Cn(c))return Re(l.default,o.default);const h=l.stops.length;if(1===h||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[h-1][0])return l.stops[h-1][1];const g=ld(l.stops.map(b=>b[0]),c);return l.stops[g][1]}function hd(l,o,c){const h=void 0!==l.base?l.base:1;if("number"!==Cn(c))return Re(l.default,o.default);const g=l.stops.length;if(1===g||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[g-1][0])return l.stops[g-1][1];const b=ld(l.stops.map(P=>P[0]),c),x=function(P,L,z,U){const $=U-z,Y=P-z;return 0===$?0:1===L?Y/$:(Math.pow(L,Y)-1)/(Math.pow(L,$)-1)}(c,h,l.stops[b][0],l.stops[b+1][0]),C=l.stops[b][1],D=l.stops[b+1][1],A=xo[o.type]||Ug;return"function"==typeof C.evaluate?{evaluate(...P){const L=C.evaluate.apply(void 0,P),z=D.evaluate.apply(void 0,P);if(void 0!==L&&void 0!==z)return A(L,z,x,l.colorSpace)}}:A(C,D,x,l.colorSpace)}function pd(l,o,c){switch(o.type){case"color":c=xt.parse(c);break;case"formatted":c=nr.fromString(c.toString());break;case"resolvedImage":c=Zr.fromString(c.toString());break;case"padding":c=Wr.parse(c);break;default:Cn(c)===o.type||"enum"===o.type&&o.values[c]||(c=void 0)}return Re(c,l.default,o.default)}be.register(Is,{error:[{kind:"error"},[Dt],(l,[o])=>{throw new hi(o.evaluate(l))}],typeof:[Dt,[Pt],(l,[o])=>Ln(xi(o.evaluate(l)))],"to-rgba":[tr(Ve,4),[Gr],(l,[o])=>{const[c,h,g,b]=o.evaluate(l).rgb;return[255*c,255*h,255*g,b]}],rgb:[Gr,[Ve,Ve,Ve],sc],rgba:[Gr,[Ve,Ve,Ve,Ve],sc],has:{type:Rt,overloads:[[[Dt],(l,[o])=>ou(o.evaluate(l),l.properties())],[[Dt,bi],(l,[o,c])=>ou(o.evaluate(l),c.evaluate(l))]]},get:{type:Pt,overloads:[[[Dt],(l,[o])=>su(o.evaluate(l),l.properties())],[[Dt,bi],(l,[o,c])=>su(o.evaluate(l),c.evaluate(l))]]},"feature-state":[Pt,[Dt],(l,[o])=>su(o.evaluate(l),l.featureState||{})],properties:[bi,[],l=>l.properties()],"geometry-type":[Dt,[],l=>l.geometryType()],id:[Pt,[],l=>l.id()],zoom:[Ve,[],l=>l.globals.zoom],"heatmap-density":[Ve,[],l=>l.globals.heatmapDensity||0],"line-progress":[Ve,[],l=>l.globals.lineProgress||0],accumulated:[Pt,[],l=>void 0===l.globals.accumulated?null:l.globals.accumulated],"+":[Ve,ja(Ve),(l,o)=>{let c=0;for(const h of o)c+=h.evaluate(l);return c}],"*":[Ve,ja(Ve),(l,o)=>{let c=1;for(const h of o)c*=h.evaluate(l);return c}],"-":{type:Ve,overloads:[[[Ve,Ve],(l,[o,c])=>o.evaluate(l)-c.evaluate(l)],[[Ve],(l,[o])=>-o.evaluate(l)]]},"/":[Ve,[Ve,Ve],(l,[o,c])=>o.evaluate(l)/c.evaluate(l)],"%":[Ve,[Ve,Ve],(l,[o,c])=>o.evaluate(l)%c.evaluate(l)],ln2:[Ve,[],()=>Math.LN2],pi:[Ve,[],()=>Math.PI],e:[Ve,[],()=>Math.E],"^":[Ve,[Ve,Ve],(l,[o,c])=>Math.pow(o.evaluate(l),c.evaluate(l))],sqrt:[Ve,[Ve],(l,[o])=>Math.sqrt(o.evaluate(l))],log10:[Ve,[Ve],(l,[o])=>Math.log(o.evaluate(l))/Math.LN10],ln:[Ve,[Ve],(l,[o])=>Math.log(o.evaluate(l))],log2:[Ve,[Ve],(l,[o])=>Math.log(o.evaluate(l))/Math.LN2],sin:[Ve,[Ve],(l,[o])=>Math.sin(o.evaluate(l))],cos:[Ve,[Ve],(l,[o])=>Math.cos(o.evaluate(l))],tan:[Ve,[Ve],(l,[o])=>Math.tan(o.evaluate(l))],asin:[Ve,[Ve],(l,[o])=>Math.asin(o.evaluate(l))],acos:[Ve,[Ve],(l,[o])=>Math.acos(o.evaluate(l))],atan:[Ve,[Ve],(l,[o])=>Math.atan(o.evaluate(l))],min:[Ve,ja(Ve),(l,o)=>Math.min(...o.map(c=>c.evaluate(l)))],max:[Ve,ja(Ve),(l,o)=>Math.max(...o.map(c=>c.evaluate(l)))],abs:[Ve,[Ve],(l,[o])=>Math.abs(o.evaluate(l))],round:[Ve,[Ve],(l,[o])=>{const c=o.evaluate(l);return c<0?-Math.round(-c):Math.round(c)}],floor:[Ve,[Ve],(l,[o])=>Math.floor(o.evaluate(l))],ceil:[Ve,[Ve],(l,[o])=>Math.ceil(o.evaluate(l))],"filter-==":[Rt,[Dt,Pt],(l,[o,c])=>l.properties()[o.value]===c.value],"filter-id-==":[Rt,[Pt],(l,[o])=>l.id()===o.value],"filter-type-==":[Rt,[Dt],(l,[o])=>l.geometryType()===o.value],"filter-<":[Rt,[Dt,Pt],(l,[o,c])=>{const h=l.properties()[o.value],g=c.value;return typeof h==typeof g&&h<g}],"filter-id-<":[Rt,[Pt],(l,[o])=>{const c=l.id(),h=o.value;return typeof c==typeof h&&c<h}],"filter->":[Rt,[Dt,Pt],(l,[o,c])=>{const h=l.properties()[o.value],g=c.value;return typeof h==typeof g&&h>g}],"filter-id->":[Rt,[Pt],(l,[o])=>{const c=l.id(),h=o.value;return typeof c==typeof h&&c>h}],"filter-<=":[Rt,[Dt,Pt],(l,[o,c])=>{const h=l.properties()[o.value],g=c.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[Rt,[Pt],(l,[o])=>{const c=l.id(),h=o.value;return typeof c==typeof h&&c<=h}],"filter->=":[Rt,[Dt,Pt],(l,[o,c])=>{const h=l.properties()[o.value],g=c.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[Rt,[Pt],(l,[o])=>{const c=l.id(),h=o.value;return typeof c==typeof h&&c>=h}],"filter-has":[Rt,[Pt],(l,[o])=>o.value in l.properties()],"filter-has-id":[Rt,[],l=>null!==l.id()&&void 0!==l.id()],"filter-type-in":[Rt,[tr(Dt)],(l,[o])=>o.value.indexOf(l.geometryType())>=0],"filter-id-in":[Rt,[tr(Pt)],(l,[o])=>o.value.indexOf(l.id())>=0],"filter-in-small":[Rt,[Dt,tr(Pt)],(l,[o,c])=>c.value.indexOf(l.properties()[o.value])>=0],"filter-in-large":[Rt,[Dt,tr(Pt)],(l,[o,c])=>function(h,g,b,x){for(;b<=x;){const C=b+x>>1;if(g[C]===h)return!0;g[C]>h?x=C-1:b=C+1}return!1}(l.properties()[o.value],c.value,0,c.value.length-1)],all:{type:Rt,overloads:[[[Rt,Rt],(l,[o,c])=>o.evaluate(l)&&c.evaluate(l)],[ja(Rt),(l,o)=>{for(const c of o)if(!c.evaluate(l))return!1;return!0}]]},any:{type:Rt,overloads:[[[Rt,Rt],(l,[o,c])=>o.evaluate(l)||c.evaluate(l)],[ja(Rt),(l,o)=>{for(const c of o)if(c.evaluate(l))return!0;return!1}]]},"!":[Rt,[Rt],(l,[o])=>!o.evaluate(l)],"is-supported-script":[Rt,[Dt],(l,[o])=>{const c=l.globals&&l.globals.isSupportedScript;return!c||c(o.evaluate(l))}],upcase:[Dt,[Dt],(l,[o])=>o.evaluate(l).toUpperCase()],downcase:[Dt,[Dt],(l,[o])=>o.evaluate(l).toLowerCase()],concat:[Dt,ja(Pt),(l,o)=>o.map(c=>yl(c.evaluate(l))).join("")],"resolved-locale":[Dt,[Es],(l,[o])=>o.evaluate(l).resolvedLocale()]});class fd{constructor(o,c){var h;this.expression=o,this._warningHistory={},this._evaluator=new Zc,this._defaultValue=c?"color"===(h=c).type&&Tn(h.default)?new xt(0,0,0,0):"color"===h.type?xt.parse(h.default)||null:"padding"===h.type?Wr.parse(h.default)||null:void 0===h.default?null:h.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(o,c,h,g,b,x){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(o,c,h,g,b,x){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new hi(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function El(l){return Array.isArray(l)&&l.length>0&&"string"==typeof l[0]&&l[0]in Is}function ti(l,o){const c=new ei(Is,Ua,[],o?function(g){const b={color:Gr,string:Dt,number:Ve,enum:Dt,boolean:Rt,formatted:Cs,padding:zo,resolvedImage:Ss};return"array"===g.type?tr(b[g.value]||Pt,g.length):b[g.type]}(o):void 0),h=c.parse(l,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return h?rn(new fd(h,o)):ia(c.errors)}class Ph{constructor(o,c){this.kind=o,this._styleExpression=c,this.isStateDependent="constant"!==o&&!on(c.expression)}evaluateWithoutErrorHandling(o,c,h,g,b,x){return this._styleExpression.evaluateWithoutErrorHandling(o,c,h,g,b,x)}evaluate(o,c,h,g,b,x){return this._styleExpression.evaluate(o,c,h,g,b,x)}}class Xt{constructor(o,c,h,g){this.kind=o,this.zoomStops=h,this._styleExpression=c,this.isStateDependent="camera"!==o&&!on(c.expression),this.interpolationType=g}evaluateWithoutErrorHandling(o,c,h,g,b,x){return this._styleExpression.evaluateWithoutErrorHandling(o,c,h,g,b,x)}evaluate(o,c,h,g,b,x){return this._styleExpression.evaluate(o,c,h,g,b,x)}interpolationFactor(o,c,h){return this.interpolationType?io.interpolationFactor(this.interpolationType,o,c,h):0}}function md(l,o){const c=ti(l,o);if("error"===c.result)return c;const h=c.value.expression,g=Tt(h);if(!g&&!$a(o))return ia([new er("","data expressions not supported")]);const b=eu(h,["zoom"]);if(!b&&!Nr(o))return ia([new er("","zoom expressions not supported")]);const x=_n(h);return x||b?x instanceof er?ia([x]):x instanceof io&&!au(o)?ia([new er("",'"interpolate" expressions cannot be used with this property')]):rn(x?new Xt(g?"camera":"composite",c.value,x.labels,x instanceof io?x.interpolation:void 0):new Ph(g?"constant":"source",c.value)):ia([new er("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class jn{constructor(o,c){this._parameters=o,this._specification=c,bo(this,pf(this._parameters,this._specification))}static deserialize(o){return new jn(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function _n(l){let o=null;if(l instanceof cd)o=_n(l.result);else if(l instanceof ss){for(const c of l.args)if(o=_n(c),o)break}else(l instanceof bl||l instanceof io)&&l.input instanceof be&&"zoom"===l.input.name&&(o=l);return o instanceof er||l.eachChild(c=>{const h=_n(c);h instanceof er?o=h:!o&&h?o=new er("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&h&&o!==h&&(o=new er("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function ra(l){if(!0===l||!1===l)return!0;if(!Array.isArray(l)||0===l.length)return!1;switch(l[0]){case"has":return l.length>=2&&"$id"!==l[1]&&"$type"!==l[1];case"in":return l.length>=3&&("string"!=typeof l[1]||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==l.length||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const o of l.slice(1))if(!ra(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}const lc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gd(l){if(null==l)return{filter:()=>!0,needGeometry:!1};ra(l)||(l=cc(l));const o=ti(l,lc);if("error"===o.result)throw new Error(o.value.map(c=>`${c.key}: ${c.message}`).join(", "));return{filter:(c,h,g)=>o.value.evaluate(c,h,{},g),needGeometry:Fh(l)}}function ff(l,o){return l<o?-1:l>o?1:0}function Fh(l){if(!Array.isArray(l))return!1;if("within"===l[0])return!0;for(let o=1;o<l.length;o++)if(Fh(l[o]))return!0;return!1}function cc(l){if(!l)return!0;const o=l[0];return l.length<=1?"any"!==o:"=="===o?Ms(l[1],l[2],"=="):"!="===o?uc(Ms(l[1],l[2],"==")):"<"===o||">"===o||"<="===o||">="===o?Ms(l[1],l[2],o):"any"===o?(c=l.slice(1),["any"].concat(c.map(cc))):"all"===o?["all"].concat(l.slice(1).map(cc)):"none"===o?["all"].concat(l.slice(1).map(cc).map(uc)):"in"===o?_d(l[1],l.slice(2)):"!in"===o?uc(_d(l[1],l.slice(2))):"has"===o?as(l[1]):"!has"===o?uc(as(l[1])):"within"!==o||l;var c}function Ms(l,o,c){switch(l){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,l,o]}}function _d(l,o){if(0===o.length)return!1;switch(l){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",l,["literal",o.sort(ff)]]:["filter-in-small",l,["literal",o]]}}function as(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function uc(l){return["!",l]}function Me(l){const o=typeof l;if("number"===o||"boolean"===o||"string"===o||null==l)return JSON.stringify(l);if(Array.isArray(l)){let g="[";for(const b of l)g+=`${Me(b)},`;return`${g}]`}const c=Object.keys(l).sort();let h="{";for(let g=0;g<c.length;g++)h+=`${JSON.stringify(c[g])}:${Me(l[c[g]])},`;return`${h}}`}function Oh(l){let o="";for(const c of Ys)o+=`/${Me(l[c])}`;return o}function Qe(l){const o=l.value;return o?[new je(l.key,o,"constants have been deprecated as of v8")]:[]}function Kn(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Ts(l){if(Array.isArray(l))return l.map(Ts);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const o={};for(const c in l)o[c]=Ts(l[c]);return o}return Kn(l)}function xr(l){const o=l.key,c=l.value,h=l.valueSpec||{},g=l.objectElementValidators||{},b=l.style,x=l.styleSpec,C=l.validateSpec;let D=[];const A=Cn(c);if("object"!==A)return[new je(o,c,`object expected, ${A} found`)];for(const P in c){const L=P.split(".")[0],z=h[L]||h["*"];let U;if(g[L])U=g[L];else if(h[L])U=C;else if(g["*"])U=g["*"];else{if(!h["*"]){D.push(new je(o,c[P],`unknown property "${P}"`));continue}U=C}D=D.concat(U({key:(o&&`${o}.`)+P,value:c[P],valueSpec:z,style:b,styleSpec:x,object:c,objectKey:P,validateSpec:C},c))}for(const P in h)g[P]||h[P].required&&void 0===h[P].default&&void 0===c[P]&&D.push(new je(o,c,`missing required property "${P}"`));return D}function Lh(l){const o=l.value,c=l.valueSpec,h=l.style,g=l.styleSpec,b=l.key,x=l.arrayElementValidator||l.validateSpec;if("array"!==Cn(o))return[new je(b,o,`array expected, ${Cn(o)} found`)];if(c.length&&o.length!==c.length)return[new je(b,o,`array length ${c.length} expected, length ${o.length} found`)];if(c["min-length"]&&o.length<c["min-length"])return[new je(b,o,`array length at least ${c["min-length"]} expected, length ${o.length} found`)];let C={type:c.value,values:c.values};g.$version<7&&(C.function=c.function),"object"===Cn(c.value)&&(C=c.value);let D=[];for(let A=0;A<o.length;A++)D=D.concat(x({array:o,arrayIndex:A,value:o[A],valueSpec:C,validateSpec:l.validateSpec,style:h,styleSpec:g,key:`${b}[${A}]`}));return D}function yd(l){const o=l.key,c=l.value,h=l.valueSpec;let g=Cn(c);return"number"===g&&c!=c&&(g="NaN"),"number"!==g?[new je(o,c,`number expected, ${g} found`)]:"minimum"in h&&c<h.minimum?[new je(o,c,`${c} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&c>h.maximum?[new je(o,c,`${c} is greater than the maximum value ${h.maximum}`)]:[]}function Nh(l){const o=l.valueSpec,c=Kn(l.value.type);let h,g,b,x={};const C="categorical"!==c&&void 0===l.value.property,D=!C,A="array"===Cn(l.value.stops)&&"array"===Cn(l.value.stops[0])&&"object"===Cn(l.value.stops[0][0]),P=xr({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(U){if("identity"===c)return[new je(U.key,U.value,'identity function may not have a "stops" property')];let $=[];const Y=U.value;return $=$.concat(Lh({key:U.key,value:Y,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:L})),"array"===Cn(Y)&&0===Y.length&&$.push(new je(U.key,Y,"array must have at least one stop")),$},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:o,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return"identity"===c&&C&&P.push(new je(l.key,l.value,'missing required property "property"')),"identity"===c||l.value.stops||P.push(new je(l.key,l.value,'missing required property "stops"')),"exponential"===c&&l.valueSpec.expression&&!au(l.valueSpec)&&P.push(new je(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(D&&!$a(l.valueSpec)?P.push(new je(l.key,l.value,"property functions not supported")):C&&!Nr(l.valueSpec)&&P.push(new je(l.key,l.value,"zoom functions not supported"))),"categorical"!==c&&!A||void 0!==l.value.property||P.push(new je(l.key,l.value,'"property" property is required')),P;function L(U){let $=[];const Y=U.value,W=U.key;if("array"!==Cn(Y))return[new je(W,Y,`array expected, ${Cn(Y)} found`)];if(2!==Y.length)return[new je(W,Y,`array length 2 expected, length ${Y.length} found`)];if(A){if("object"!==Cn(Y[0]))return[new je(W,Y,`object expected, ${Cn(Y[0])} found`)];if(void 0===Y[0].zoom)return[new je(W,Y,"object stop key must have zoom")];if(void 0===Y[0].value)return[new je(W,Y,"object stop key must have value")];if(b&&b>Kn(Y[0].zoom))return[new je(W,Y[0].zoom,"stop zoom values must appear in ascending order")];Kn(Y[0].zoom)!==b&&(b=Kn(Y[0].zoom),g=void 0,x={}),$=$.concat(xr({key:`${W}[0]`,value:Y[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:yd,value:z}}))}else $=$.concat(z({key:`${W}[0]`,value:Y[0],valueSpec:{},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},Y));return El(Ts(Y[1]))?$.concat([new je(`${W}[1]`,Y[1],"expressions are not allowed in function stops.")]):$.concat(U.validateSpec({key:`${W}[1]`,value:Y[1],valueSpec:o,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function z(U,$){const Y=Cn(U.value),W=Kn(U.value),se=null!==U.value?U.value:$;if(h){if(Y!==h)return[new je(U.key,se,`${Y} stop domain type must match previous stop domain type ${h}`)]}else h=Y;if("number"!==Y&&"string"!==Y&&"boolean"!==Y)return[new je(U.key,se,"stop domain value must be a number, string, or boolean")];if("number"!==Y&&"categorical"!==c){let ue=`number expected, ${Y} found`;return $a(o)&&void 0===c&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new je(U.key,se,ue)]}return"categorical"!==c||"number"!==Y||isFinite(W)&&Math.floor(W)===W?"categorical"!==c&&"number"===Y&&void 0!==g&&W<g?[new je(U.key,se,"stop domain values must appear in ascending order")]:(g=W,"categorical"===c&&W in x?[new je(U.key,se,"stop domain values must be unique")]:(x[W]=!0,[])):[new je(U.key,se,`integer expected, found ${W}`)]}}function Br(l){const o=("property"===l.expressionContext?md:ti)(Ts(l.value),l.valueSpec);if("error"===o.result)return o.value.map(h=>new je(`${l.key}${h.key}`,l.value,h.message));const c=o.value.expression||o.value._styleExpression.expression;if("property"===l.expressionContext&&"text-font"===l.propertyKey&&!c.outputDefined())return[new je(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===l.expressionContext&&"layout"===l.propertyType&&!on(c))return[new je(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===l.expressionContext&&!on(c))return[new je(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&0===l.expressionContext.indexOf("cluster")){if(!eu(c,["zoom","feature-state"]))return[new je(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===l.expressionContext&&!Tt(c))return[new je(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function oa(l){const o=l.key,c=l.value,h=l.valueSpec,g=[];return Array.isArray(h.values)?-1===h.values.indexOf(Kn(c))&&g.push(new je(o,c,`expected one of [${h.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(h.values).indexOf(Kn(c))&&g.push(new je(o,c,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(c)} found`)),g}function rr(l){return ra(Ts(l.value))?Br(bo({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Uo(l)}function Uo(l){const o=l.value,c=l.key;if("array"!==Cn(o))return[new je(c,o,`array expected, ${Cn(o)} found`)];const h=l.styleSpec;let g,b=[];if(o.length<1)return[new je(c,o,"filter array must have at least 1 element")];switch(b=b.concat(oa({key:`${c}[0]`,value:o[0],valueSpec:h.filter_operator,style:l.style,styleSpec:l.styleSpec})),Kn(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===Kn(o[1])&&b.push(new je(c,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&b.push(new je(c,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(g=Cn(o[1]),"string"!==g&&b.push(new je(`${c}[1]`,o[1],`string expected, ${g} found`)));for(let x=2;x<o.length;x++)g=Cn(o[x]),"$type"===Kn(o[1])?b=b.concat(oa({key:`${c}[${x}]`,value:o[x],valueSpec:h.geometry_type,style:l.style,styleSpec:l.styleSpec})):"string"!==g&&"number"!==g&&"boolean"!==g&&b.push(new je(`${c}[${x}]`,o[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<o.length;x++)b=b.concat(Uo({key:`${c}[${x}]`,value:o[x],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":g=Cn(o[1]),2!==o.length?b.push(new je(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==g&&b.push(new je(`${c}[1]`,o[1],`string expected, ${g} found`));break;case"within":g=Cn(o[1]),2!==o.length?b.push(new je(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==g&&b.push(new je(`${c}[1]`,o[1],`object expected, ${g} found`))}return b}function cn(l,o){const c=l.key,h=l.validateSpec,g=l.style,b=l.styleSpec,x=l.value,C=l.objectKey,D=b[`${o}_${l.layerType}`];if(!D)return[];const A=C.match(/^(.*)-transition$/);if("paint"===o&&A&&D[A[1]]&&D[A[1]].transition)return h({key:c,value:x,valueSpec:b.transition,style:g,styleSpec:b});const P=l.valueSpec||D[C];if(!P)return[new je(c,x,`unknown property "${C}"`)];let L;if("string"===Cn(x)&&$a(P)&&!P.tokens&&(L=/^{([^}]+)}$/.exec(x)))return[new je(c,x,`"${C}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const z=[];return"symbol"===l.layerType&&("text-field"===C&&g&&!g.glyphs&&z.push(new je(c,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===C&&Tn(Ts(x))&&"identity"===Kn(x.type)&&z.push(new je(c,x,'"text-font" does not support identity functions'))),z.concat(h({key:l.key,value:x,valueSpec:P,style:g,styleSpec:b,expressionContext:"property",propertyType:o,propertyKey:C}))}function Cl(l){return cn(l,"paint")}function lu(l){return cn(l,"layout")}function Sl(l){let o=[];const c=l.value,h=l.key,g=l.style,b=l.styleSpec;c.type||c.ref||o.push(new je(h,c,'either "type" or "ref" is required'));let x=Kn(c.type);const C=Kn(c.ref);if(c.id){const D=Kn(c.id);for(let A=0;A<l.arrayIndex;A++){const P=g.layers[A];Kn(P.id)===D&&o.push(new je(h,c.id,`duplicate layer id "${c.id}", previously used at line ${P.id.__line__}`))}}if("ref"in c){let D;["type","source","source-layer","filter","layout"].forEach(A=>{A in c&&o.push(new je(h,c[A],`"${A}" is prohibited for ref layers`))}),g.layers.forEach(A=>{Kn(A.id)===C&&(D=A)}),D?D.ref?o.push(new je(h,c.ref,"ref cannot reference another ref layer")):x=Kn(D.type):o.push(new je(h,c.ref,`ref layer "${C}" not found`))}else if("background"!==x)if(c.source){const D=g.sources&&g.sources[c.source],A=D&&Kn(D.type);D?"vector"===A&&"raster"===x?o.push(new je(h,c.source,`layer "${c.id}" requires a raster source`)):"raster"===A&&"raster"!==x?o.push(new je(h,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==A||c["source-layer"]?"raster-dem"===A&&"hillshade"!==x?o.push(new je(h,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==x||!c.paint||!c.paint["line-gradient"]||"geojson"===A&&D.lineMetrics||o.push(new je(h,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new je(h,c,`layer "${c.id}" must specify a "source-layer"`)):o.push(new je(h,c.source,`source "${c.source}" not found`))}else o.push(new je(h,c,'missing required property "source"'));return o=o.concat(xr({key:h,value:c,valueSpec:b.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${h}.type`,value:c.type,valueSpec:b.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:c,objectKey:"type"}),filter:rr,layout:D=>xr({layer:c,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":A=>lu(bo({layerType:x},A))}}),paint:D=>xr({layer:c,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":A=>Cl(bo({layerType:x},A))}})}})),o}function jo(l){const o=l.value,c=l.key,h=Cn(o);return"string"!==h?[new je(c,o,`string expected, ${h} found`)]:[]}const wo={promoteId:function({key:l,value:o}){if("string"===Cn(o))return jo({key:l,value:o});{const c=[];for(const h in o)c.push(...jo({key:`${l}.${h}`,value:o[h]}));return c}}};function sa(l){const o=l.value,c=l.key,h=l.styleSpec,g=l.style,b=l.validateSpec;if(!o.type)return[new je(c,o,'"type" is required')];const x=Kn(o.type);let C;switch(x){case"vector":case"raster":case"raster-dem":return C=xr({key:c,value:o,valueSpec:h[`source_${x.replace("-","_")}`],style:l.style,styleSpec:h,objectElementValidators:wo,validateSpec:b}),C;case"geojson":if(C=xr({key:c,value:o,valueSpec:h.source_geojson,style:g,styleSpec:h,validateSpec:b,objectElementValidators:wo}),o.cluster)for(const D in o.clusterProperties){const[A,P]=o.clusterProperties[D],L="string"==typeof A?[A,["accumulated"],["get",D]]:A;C.push(...Br({key:`${c}.${D}.map`,value:P,validateSpec:b,expressionContext:"cluster-map"})),C.push(...Br({key:`${c}.${D}.reduce`,value:L,validateSpec:b,expressionContext:"cluster-reduce"}))}return C;case"video":return xr({key:c,value:o,valueSpec:h.source_video,style:g,validateSpec:b,styleSpec:h});case"image":return xr({key:c,value:o,valueSpec:h.source_image,style:g,validateSpec:b,styleSpec:h});case"canvas":return[new je(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return oa({key:`${c}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:b,styleSpec:h})}}function vd(l){const o=l.value,c=l.styleSpec,h=c.light,g=l.style;let b=[];const x=Cn(o);if(void 0===o)return b;if("object"!==x)return b=b.concat([new je("light",o,`object expected, ${x} found`)]),b;for(const C in o){const D=C.match(/^(.*)-transition$/);b=b.concat(D&&h[D[1]]&&h[D[1]].transition?l.validateSpec({key:C,value:o[C],valueSpec:c.transition,validateSpec:l.validateSpec,style:g,styleSpec:c}):h[C]?l.validateSpec({key:C,value:o[C],valueSpec:h[C],validateSpec:l.validateSpec,style:g,styleSpec:c}):[new je(C,o[C],`unknown property "${C}"`)])}return b}function Dl(l){const o=l.value,c=l.styleSpec,h=c.terrain,g=l.style;let b=[];const x=Cn(o);if(void 0===o)return b;if("object"!==x)return b=b.concat([new je("terrain",o,`object expected, ${x} found`)]),b;for(const C in o)b=b.concat(h[C]?l.validateSpec({key:C,value:o[C],valueSpec:h[C],validateSpec:l.validateSpec,style:g,styleSpec:c}):[new je(C,o[C],`unknown property "${C}"`)]);return b}function cu(l){let o=[];const c=l.value,h=l.key;if(Array.isArray(c)){const g=[],b=[];for(const x in c)c[x].id&&g.includes(c[x].id)&&o.push(new je(h,c,`all the sprites' ids must be unique, but ${c[x].id} is duplicated`)),g.push(c[x].id),c[x].url&&b.includes(c[x].url)&&o.push(new je(h,c,`all the sprites' URLs must be unique, but ${c[x].url} is duplicated`)),b.push(c[x].url),o=o.concat(xr({key:`${h}[${x}]`,value:c[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return o}return jo({key:h,value:c})}const bd={"*":()=>[],array:Lh,boolean:function(l){const o=l.value,c=l.key,h=Cn(o);return"boolean"!==h?[new je(c,o,`boolean expected, ${h} found`)]:[]},number:yd,color:function(l){const o=l.key,c=l.value,h=Cn(c);return"string"!==h?[new je(o,c,`color expected, ${h} found`)]:xt.parse(String(c))?[]:[new je(o,c,`color expected, "${c}" found`)]},constants:Qe,enum:oa,filter:rr,function:Nh,layer:Sl,object:xr,source:sa,light:vd,terrain:Dl,string:jo,formatted:function(l){return 0===jo(l).length?[]:Br(l)},resolvedImage:function(l){return 0===jo(l).length?[]:Br(l)},padding:function(l){const o=l.key,c=l.value;if("array"===Cn(c)){if(c.length<1||c.length>4)return[new je(o,c,`padding requires 1 to 4 values; ${c.length} values found`)];const h={type:"number"};let g=[];for(let b=0;b<c.length;b++)g=g.concat(l.validateSpec({key:`${o}[${b}]`,value:c[b],validateSpec:l.validateSpec,valueSpec:h}));return g}return yd({key:o,value:c,valueSpec:{}})},sprite:cu};function Il(l){const o=l.value,c=l.valueSpec,h=l.styleSpec;return l.validateSpec=Il,c.expression&&Tn(Kn(o))?Nh(l):c.expression&&El(Ts(o))?Br(l):c.type&&bd[c.type]?bd[c.type](l):xr(bo({},l,{valueSpec:c.type?h[c.type]:c}))}function Ml(l){const o=l.value,c=l.key,h=jo(l);return h.length||(-1===o.indexOf("{fontstack}")&&h.push(new je(c,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&h.push(new je(c,o,'"glyphs" url must include a "{range}" token'))),h}function $o(l,o=we){let c=[];return c=c.concat(Il({key:"",value:l,valueSpec:o.$root,styleSpec:o,style:l,validateSpec:Il,objectElementValidators:{glyphs:Ml,"*":()=>[]}})),l.constants&&(c=c.concat(Qe({key:"constants",value:l.constants,style:l,styleSpec:o,validateSpec:Il}))),dc(c)}function oo(l){return function(o){return l({...o,validateSpec:Il})}}function dc(l){return[].concat(l).sort((o,c)=>o.line-c.line)}function fi(l){return function(...o){return dc(l.apply(this,o))}}$o.source=fi(oo(sa)),$o.sprite=fi(oo(cu)),$o.glyphs=fi(oo(Ml)),$o.light=fi(oo(vd)),$o.terrain=fi(oo(Dl)),$o.layer=fi(oo(Sl)),$o.filter=fi(oo(rr)),$o.paintProperty=fi(oo(Cl)),$o.layoutProperty=fi(oo(lu));const aa=$o,mf=aa.light,Ho=aa.paintProperty,gf=aa.layoutProperty;function Ha(l,o){let c=!1;if(o&&o.length)for(const h of o)l.fire(new qr(new Error(h.message))),c=!0;return c}class hc{constructor(o,c,h){const g=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const x=new Int32Array(this.arrayBuffer);o=x[0],this.d=(c=x[1])+2*(h=x[2]);for(let D=0;D<this.d*this.d;D++){const A=x[3+D],P=x[3+D+1];g.push(A===P?null:x.subarray(A,P))}const C=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],C),this.bboxes=x.subarray(C),this.insert=this._insertReadonly}else{this.d=c+2*h;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=o,this.padding=h,this.scale=c/o,this.uid=0;const b=h/c*o;this.min=-b,this.max=o+b}insert(o,c,h,g,b){this._forEachCell(c,h,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,c,h,g,b,x){this.cells[b].push(x)}query(o,c,h,g,b){const x=this.min,C=this.max;if(o<=x&&c<=x&&C<=h&&C<=g&&!b)return Array.prototype.slice.call(this.keys);{const D=[];return this._forEachCell(o,c,h,g,this._queryCell,D,{},b),D}}_queryCell(o,c,h,g,b,x,C,D){const A=this.cells[b];if(null!==A){const P=this.keys,L=this.bboxes;for(let z=0;z<A.length;z++){const U=A[z];if(void 0===C[U]){const $=4*U;(D?D(L[$+0],L[$+1],L[$+2],L[$+3]):o<=L[$+2]&&c<=L[$+3]&&h>=L[$+0]&&g>=L[$+1])?(C[U]=!0,x.push(P[U])):C[U]=!1}}}}_forEachCell(o,c,h,g,b,x,C,D){const A=this._convertToCellCoord(o),P=this._convertToCellCoord(c),L=this._convertToCellCoord(h),z=this._convertToCellCoord(g);for(let U=A;U<=L;U++)for(let $=P;$<=z;$++){const Y=this.d*$+U;if((!D||D(this._convertFromCellCoord(U),this._convertFromCellCoord($),this._convertFromCellCoord(U+1),this._convertFromCellCoord($+1)))&&b.call(this,o,c,h,g,Y,x,C,D))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,c=3+this.cells.length+1+1;let h=0;for(let x=0;x<this.cells.length;x++)h+=this.cells[x].length;const g=new Int32Array(c+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=c;for(let x=0;x<o.length;x++){const C=o[x];g[3+x]=b,g.set(C,b),b+=C.length}return g[3+o.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+o.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(o,c){const h=o.toArrayBuffer();return c&&c.push(h),{buffer:h}}static deserialize(o){return new hc(o.buffer)}}const ls={};function tt(l,o,c={}){if(ls[l])throw new Error(`${l} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:l,writeable:!1}),ls[l]={klass:o,omit:c.omit||[],shallow:c.shallow||[]}}tt("Object",Object),tt("TransferableGridIndex",hc),tt("Color",xt),tt("Error",Error),tt("AJAXError",Xs),tt("ResolvedImage",Zr),tt("StylePropertyFunction",jn),tt("StyleExpression",fd,{omit:["_evaluator"]}),tt("ZoomDependentExpression",Xt),tt("ZoomConstantExpression",Ph),tt("CompoundExpression",be,{omit:["_evaluate"]});for(const l in Is)Is[l]._classRegistryKey||tt(`Expression_${l}`,Is[l]);function uu(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&"ArrayBuffer"===l.constructor.name)}function Tl(l,o){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob)return l;if(uu(l)||Bo(l))return o&&o.push(l),l;if(ArrayBuffer.isView(l)){const c=l;return o&&o.push(c.buffer),c}if(l instanceof ImageData)return o&&o.push(l.data.buffer),l;if(Array.isArray(l)){const c=[];for(const h of l)c.push(Tl(h,o));return c}if("object"==typeof l){const c=l.constructor,h=c._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!ls[h])throw new Error(`${h} is not registered.`);const g=c.serialize?c.serialize(l,o):{};if(c.serialize){if(o&&g===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in l){if(!l.hasOwnProperty(b)||ls[h].omit.indexOf(b)>=0)continue;const x=l[b];g[b]=ls[h].shallow.indexOf(b)>=0?x:Tl(x,o)}l instanceof Error&&(g.message=l.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==h&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof l)}function As(l){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||uu(l)||Bo(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(As);if("object"==typeof l){const o=l.$name||"Object";if(!ls[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:c}=ls[o];if(!c)throw new Error(`can't deserialize unregistered class ${o}`);if(c.deserialize)return c.deserialize(l);const h=Object.create(c.prototype);for(const g of Object.keys(l)){if("$name"===g)continue;const b=l[g];h[g]=ls[o].shallow.indexOf(g)>=0?b:As(b)}return h}throw new Error("can't deserialize object of type "+typeof l)}class Bh{constructor(){this.first=!0}update(o,c){const h=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=c),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=h,!0))}}const Ke={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function Ci(l){for(const o of l)if(du(o.charCodeAt(0)))return!0;return!1}function xd(l){for(const o of l)if(!zh(o.charCodeAt(0)))return!1;return!0}function zh(l){return!(Ke.Arabic(l)||Ke["Arabic Supplement"](l)||Ke["Arabic Extended-A"](l)||Ke["Arabic Presentation Forms-A"](l)||Ke["Arabic Presentation Forms-B"](l))}function du(l){return!(746!==l&&747!==l&&(l<4352||!(Ke["Bopomofo Extended"](l)||Ke.Bopomofo(l)||Ke["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Ke["CJK Compatibility Ideographs"](l)||Ke["CJK Compatibility"](l)||Ke["CJK Radicals Supplement"](l)||Ke["CJK Strokes"](l)||!(!Ke["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||12336===l)||Ke["CJK Unified Ideographs Extension A"](l)||Ke["CJK Unified Ideographs"](l)||Ke["Enclosed CJK Letters and Months"](l)||Ke["Hangul Compatibility Jamo"](l)||Ke["Hangul Jamo Extended-A"](l)||Ke["Hangul Jamo Extended-B"](l)||Ke["Hangul Jamo"](l)||Ke["Hangul Syllables"](l)||Ke.Hiragana(l)||Ke["Ideographic Description Characters"](l)||Ke.Kanbun(l)||Ke["Kangxi Radicals"](l)||Ke["Katakana Phonetic Extensions"](l)||Ke.Katakana(l)&&12540!==l||!(!Ke["Halfwidth and Fullwidth Forms"](l)||65288===l||65289===l||65293===l||l>=65306&&l<=65310||65339===l||65341===l||65343===l||l>=65371&&l<=65503||65507===l||l>=65512&&l<=65519)||!(!Ke["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Ke["Unified Canadian Aboriginal Syllabics"](l)||Ke["Unified Canadian Aboriginal Syllabics Extended"](l)||Ke["Vertical Forms"](l)||Ke["Yijing Hexagram Symbols"](l)||Ke["Yi Syllables"](l)||Ke["Yi Radicals"](l))))}function mi(l){return!(du(l)||(o=l,Ke["Latin-1 Supplement"](o)&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||Ke["General Punctuation"](o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||Ke["Letterlike Symbols"](o)||Ke["Number Forms"](o)||Ke["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||Ke["Control Pictures"](o)&&9251!==o||Ke["Optical Character Recognition"](o)||Ke["Enclosed Alphanumerics"](o)||Ke["Geometric Shapes"](o)||Ke["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Ke["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Ke["CJK Symbols and Punctuation"](o)||Ke.Katakana(o)||Ke["Private Use Area"](o)||Ke["CJK Compatibility Forms"](o)||Ke["Small Form Variants"](o)||Ke["Halfwidth and Fullwidth Forms"](o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o}function hu(l){return l>=1424&&l<=2303||Ke["Arabic Presentation Forms-A"](l)||Ke["Arabic Presentation Forms-B"](l)}function pc(l,o){return!(!o&&hu(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Ke.Khmer(l))}function ct(l){for(const o of l)if(hu(o.charCodeAt(0)))return!0;return!1}const wr="deferred",nn="loading",Pi="loaded";let Fi=null,Oi="unavailable",Si=null;const wd=function(l){l&&"string"==typeof l&&l.indexOf("NetworkError")>-1&&(Oi="error"),Fi&&Fi(l)};function pu(){qa.fire(new wt("pluginStateChange",{pluginStatus:Oi,pluginURL:Si}))}const qa=new fl,Ed=function(){return Oi},Vh=function(){if(Oi!==wr||!Si)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Oi=nn,pu(),Si&&Ba({url:Si},l=>{l?wd(l):(Oi=Pi,pu())})},fn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Oi===Pi||null!=fn.applyArabicShaping,isLoading:()=>Oi===nn,setState(l){if(!Zn())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Oi=l.pluginStatus,Si=l.pluginURL},isParsed(){if(!Zn())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=fn.applyArabicShaping&&null!=fn.processBidirectionalText&&null!=fn.processStyledBidirectionalText},getPluginURL(){if(!Zn())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Si}};class Le{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bh,this.transition={})}isSupportedScript(o){return function(c,h){for(const g of c)if(!pc(g.charCodeAt(0),h))return!1;return!0}(o,fn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,c=o-Math.floor(o),h=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*c}}}class Ot{constructor(o,c){this.property=o,this.value=c,this.expression=function(h,g){if(Tn(h))return new jn(h,g);if(El(h)){const b=md(h,g);if("error"===b.result)throw new Error(b.value.map(x=>`${x.key}: ${x.message}`).join(", "));return b.value}{let b=h;return"color"===g.type&&"string"==typeof h?b=xt.parse(h):"padding"!==g.type||"number"!=typeof h&&!Array.isArray(h)||(b=Wr.parse(h)),{kind:"constant",evaluate:()=>b}}}(void 0===c?o.specification.default:c,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,c,h){return this.property.possiblyEvaluate(this,o,c,h)}}class $n{constructor(o){this.property=o,this.value=new Ot(o,void 0)}transitioned(o,c){return new ks(this.property,this.value,c,Ri({},o.transition,this.transition),o.now)}untransitioned(){return new ks(this.property,this.value,null,{},0)}}class Eo{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return We(this._values[o].value.value)}setValue(o,c){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new $n(this._values[o].property)),this._values[o].value=new Ot(this._values[o].property,null===c?void 0:We(c))}getTransition(o){return We(this._values[o].transition)}setTransition(o,c){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new $n(this._values[o].property)),this._values[o].transition=We(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const h=this.getValue(c);void 0!==h&&(o[c]=h);const g=this.getTransition(c);void 0!==g&&(o[`${c}-transition`]=g)}return o}transitioned(o,c){const h=new or(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(o,c._values[g]);return h}untransitioned(){const o=new or(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class ks{constructor(o,c,h,g,b){this.property=o,this.value=c,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,o.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(o,c,h){const g=o.now||0,b=this.value.possiblyEvaluate(o,c,h),x=this.prior;if(x){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return x.possiblyEvaluate(o,c,h);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(o,c,h),b,function(D){if(D<=0)return 0;if(D>=1)return 1;const A=D*D,P=A*D;return 4*(D<.5?P:3*(D-A)+P-.75)}(C))}}return b}}class or{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,h){const g=new qo(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(o,c,h);return g}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class la{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return We(this._values[o].value)}setValue(o,c){this._values[o]=new Ot(this._values[o].property,null===c?void 0:We(c))}serialize(){const o={};for(const c of Object.keys(this._values)){const h=this.getValue(c);void 0!==h&&(o[c]=h)}return o}possiblyEvaluate(o,c,h){const g=new qo(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(o,c,h);return g}}class Sn{constructor(o,c,h){this.property=o,this.value=c,this.parameters=h}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,c,h,g){return this.property.evaluate(this.value,this.parameters,o,c,h,g)}}class qo{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class nt{constructor(o){this.specification=o}possiblyEvaluate(o,c){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(c)}interpolate(o,c,h){const g=xo[this.specification.type];return g?g(o,c,h):o}}class Oe{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,h,g){return new Sn(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(c,null,{},h,g)}:o.expression,c)}interpolate(o,c,h){if("constant"!==o.value.kind||"constant"!==c.value.kind)return o;if(void 0===o.value.value||void 0===c.value.value)return new Sn(this,{kind:"constant",value:void 0},o.parameters);const g=xo[this.specification.type];if(g){const b=g(o.value.value,c.value.value,h);return new Sn(this,{kind:"constant",value:b},o.parameters)}return o}evaluate(o,c,h,g,b,x){return"constant"===o.kind?o.value:o.evaluate(c,h,g,b,x)}}class Rs extends Oe{possiblyEvaluate(o,c,h,g){if(void 0===o.value)return new Sn(this,{kind:"constant",value:void 0},c);if("constant"===o.expression.kind){const b=o.expression.evaluate(c,null,{},h,g),x="resolvedImage"===o.property.specification.type&&"string"!=typeof b?b.name:b,C=this._calculate(x,x,x,c);return new Sn(this,{kind:"constant",value:C},c)}if("camera"===o.expression.kind){const b=this._calculate(o.expression.evaluate({zoom:c.zoom-1}),o.expression.evaluate({zoom:c.zoom}),o.expression.evaluate({zoom:c.zoom+1}),c);return new Sn(this,{kind:"constant",value:b},c)}return new Sn(this,o.expression,c)}evaluate(o,c,h,g,b,x){if("source"===o.kind){const C=o.evaluate(c,h,g,b,x);return this._calculate(C,C,C,c)}return"composite"===o.kind?this._calculate(o.evaluate({zoom:Math.floor(c.zoom)-1},h,g),o.evaluate({zoom:Math.floor(c.zoom)},h,g),o.evaluate({zoom:Math.floor(c.zoom)+1},h,g),c):o.value}_calculate(o,c,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:o,to:c}:{from:h,to:c}}interpolate(o){return o}}class fu{constructor(o){this.specification=o}possiblyEvaluate(o,c,h,g){if(void 0!==o.value){if("constant"===o.expression.kind){const b=o.expression.evaluate(c,null,{},h,g);return this._calculate(b,b,b,c)}return this._calculate(o.expression.evaluate(new Le(Math.floor(c.zoom-1),c)),o.expression.evaluate(new Le(Math.floor(c.zoom),c)),o.expression.evaluate(new Le(Math.floor(c.zoom+1),c)),c)}}_calculate(o,c,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:o,to:c}:{from:h,to:c}}interpolate(o){return o}}class ca{constructor(o){this.specification=o}possiblyEvaluate(o,c,h,g){return!!o.expression.evaluate(c,null,{},h,g)}interpolate(){return!1}}class un{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in o){const h=o[c];h.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new Ot(h,void 0),b=this.defaultTransitionablePropertyValues[c]=new $n(h);this.defaultTransitioningPropertyValues[c]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate({})}}}tt("DataDrivenProperty",Oe),tt("DataConstantProperty",nt),tt("CrossFadedDataDrivenProperty",Rs),tt("CrossFadedProperty",fu),tt("ColorRampProperty",ca);const Al="-transition";class zr extends fl{constructor(o,c){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),c.layout&&(this._unevaluatedLayout=new la(c.layout)),c.paint)){this._transitionablePaint=new Eo(c.paint);for(const h in o.paint)this.setPaintProperty(h,o.paint[h],{validate:!1});for(const h in o.layout)this.setLayoutProperty(h,o.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qo(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c,h={}){null!=c&&this._validate(gf,`layers.${this.id}.layout.${o}`,o,c,h)||("visibility"!==o?this._unevaluatedLayout.setValue(o,c):this.visibility=c)}getPaintProperty(o){return o.endsWith(Al)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c,h={}){if(null!=c&&this._validate(Ho,`layers.${this.id}.paint.${o}`,o,c,h))return!1;if(o.endsWith(Al))return this._transitionablePaint.setTransition(o.slice(0,-11),c||void 0),!1;{const g=this._transitionablePaint._values[o],b="cross-faded-data-driven"===g.property.specification["property-type"],x=g.value.isDataDriven(),C=g.value;this._transitionablePaint.setValue(o,c),this._handleSpecialPaintPropertyUpdate(o);const D=this._transitionablePaint._values[o].value;return D.isDataDriven()||x||b||this._handleOverridablePaintPropertyUpdate(o,C,D)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,c,h){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),ze(o,(c,h)=>!(void 0===c||"layout"===h&&!Object.keys(c).length||"paint"===h&&!Object.keys(c).length))}_validate(o,c,h,g,b={}){return(!b||!1!==b.validate)&&Ha(this,o.call(aa,{key:c,layerType:this.type,objectKey:h,value:g,styleSpec:we,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof Sn&&$a(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}}const cs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class so{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ni{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Nn(l,o=1){let c=0,h=0;return{members:l.map(g=>{const b=cs[g.type].BYTES_PER_ELEMENT,x=c=us(c,Math.max(o,b)),C=g.components||1;return h=Math.max(h,b),c+=b*C,{name:g.name,type:g.type,components:C,offset:x}}),size:us(c,Math.max(h,o)),alignment:o}}function us(l,o){return Math.ceil(l/o)*o}class ds extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const g=2*o;return this.int16[g+0]=c,this.int16[g+1]=h,o}}ds.prototype.bytesPerElement=4,tt("StructArrayLayout2i4",ds);class ua extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const b=3*o;return this.int16[b+0]=c,this.int16[b+1]=h,this.int16[b+2]=g,o}}ua.prototype.bytesPerElement=6,tt("StructArrayLayout3i6",ua);class Zt extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,c,h,g)}emplace(o,c,h,g,b){const x=4*o;return this.int16[x+0]=c,this.int16[x+1]=h,this.int16[x+2]=g,this.int16[x+3]=b,o}}Zt.prototype.bytesPerElement=8,tt("StructArrayLayout4i8",Zt);class Ps extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,c,h,g,b,x)}emplace(o,c,h,g,b,x,C){const D=6*o;return this.int16[D+0]=c,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=b,this.int16[D+4]=x,this.int16[D+5]=C,o}}Ps.prototype.bytesPerElement=12,tt("StructArrayLayout2i4i12",Ps);class kl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,c,h,g,b,x)}emplace(o,c,h,g,b,x,C){const D=4*o,A=8*o;return this.int16[D+0]=c,this.int16[D+1]=h,this.uint8[A+4]=g,this.uint8[A+5]=b,this.uint8[A+6]=x,this.uint8[A+7]=C,o}}kl.prototype.bytesPerElement=8,tt("StructArrayLayout2i4ub8",kl);class da extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const g=2*o;return this.float32[g+0]=c,this.float32[g+1]=h,o}}da.prototype.bytesPerElement=8,tt("StructArrayLayout2f8",da);class ao extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x,C,D,A,P){const L=this.length;return this.resize(L+1),this.emplace(L,o,c,h,g,b,x,C,D,A,P)}emplace(o,c,h,g,b,x,C,D,A,P,L){const z=10*o;return this.uint16[z+0]=c,this.uint16[z+1]=h,this.uint16[z+2]=g,this.uint16[z+3]=b,this.uint16[z+4]=x,this.uint16[z+5]=C,this.uint16[z+6]=D,this.uint16[z+7]=A,this.uint16[z+8]=P,this.uint16[z+9]=L,o}}ao.prototype.bytesPerElement=20,tt("StructArrayLayout10ui20",ao);class ha extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x,C,D,A,P,L,z){const U=this.length;return this.resize(U+1),this.emplace(U,o,c,h,g,b,x,C,D,A,P,L,z)}emplace(o,c,h,g,b,x,C,D,A,P,L,z,U){const $=12*o;return this.int16[$+0]=c,this.int16[$+1]=h,this.int16[$+2]=g,this.int16[$+3]=b,this.uint16[$+4]=x,this.uint16[$+5]=C,this.uint16[$+6]=D,this.uint16[$+7]=A,this.int16[$+8]=P,this.int16[$+9]=L,this.int16[$+10]=z,this.int16[$+11]=U,o}}ha.prototype.bytesPerElement=24,tt("StructArrayLayout4i4ui4i24",ha);class pa extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const b=3*o;return this.float32[b+0]=c,this.float32[b+1]=h,this.float32[b+2]=g,o}}pa.prototype.bytesPerElement=12,tt("StructArrayLayout3f12",pa);class hs extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}hs.prototype.bytesPerElement=4,tt("StructArrayLayout1ul4",hs);class ii extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x,C,D,A){const P=this.length;return this.resize(P+1),this.emplace(P,o,c,h,g,b,x,C,D,A)}emplace(o,c,h,g,b,x,C,D,A,P){const L=10*o,z=5*o;return this.int16[L+0]=c,this.int16[L+1]=h,this.int16[L+2]=g,this.int16[L+3]=b,this.int16[L+4]=x,this.int16[L+5]=C,this.uint32[z+3]=D,this.uint16[L+8]=A,this.uint16[L+9]=P,o}}ii.prototype.bytesPerElement=20,tt("StructArrayLayout6i1ul2ui20",ii);class Uh extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,c,h,g,b,x)}emplace(o,c,h,g,b,x,C){const D=6*o;return this.int16[D+0]=c,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=b,this.int16[D+4]=x,this.int16[D+5]=C,o}}Uh.prototype.bytesPerElement=12,tt("StructArrayLayout2i2i2i12",Uh);class sr extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,o,c,h,g,b)}emplace(o,c,h,g,b,x){const C=4*o,D=8*o;return this.float32[C+0]=c,this.float32[C+1]=h,this.float32[C+2]=g,this.int16[D+6]=b,this.int16[D+7]=x,o}}sr.prototype.bytesPerElement=16,tt("StructArrayLayout2f1f2i16",sr);class gi extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,c,h,g)}emplace(o,c,h,g,b){const x=12*o,C=3*o;return this.uint8[x+0]=c,this.uint8[x+1]=h,this.float32[C+1]=g,this.float32[C+2]=b,o}}gi.prototype.bytesPerElement=12,tt("StructArrayLayout2ub2f12",gi);class Rl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const b=3*o;return this.uint16[b+0]=c,this.uint16[b+1]=h,this.uint16[b+2]=g,o}}Rl.prototype.bytesPerElement=6,tt("StructArrayLayout3ui6",Rl);class Fs extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y,W,se){const ue=this.length;return this.resize(ue+1),this.emplace(ue,o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y,W,se)}emplace(o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y,W,se,ue){const oe=24*o,he=12*o,ge=48*o;return this.int16[oe+0]=c,this.int16[oe+1]=h,this.uint16[oe+2]=g,this.uint16[oe+3]=b,this.uint32[he+2]=x,this.uint32[he+3]=C,this.uint32[he+4]=D,this.uint16[oe+10]=A,this.uint16[oe+11]=P,this.uint16[oe+12]=L,this.float32[he+7]=z,this.float32[he+8]=U,this.uint8[ge+36]=$,this.uint8[ge+37]=Y,this.uint8[ge+38]=W,this.uint32[he+10]=se,this.int16[oe+22]=ue,o}}Fs.prototype.bytesPerElement=48,tt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Fs);class Ga extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y,W,se,ue,oe,he,ge,Ce,Je,rt,Xe,qe,Ue,Ze){const Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y,W,se,ue,oe,he,ge,Ce,Je,rt,Xe,qe,Ue,Ze)}emplace(o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y,W,se,ue,oe,he,ge,Ce,Je,rt,Xe,qe,Ue,Ze,Ge){const Fe=34*o,ft=17*o;return this.int16[Fe+0]=c,this.int16[Fe+1]=h,this.int16[Fe+2]=g,this.int16[Fe+3]=b,this.int16[Fe+4]=x,this.int16[Fe+5]=C,this.int16[Fe+6]=D,this.int16[Fe+7]=A,this.uint16[Fe+8]=P,this.uint16[Fe+9]=L,this.uint16[Fe+10]=z,this.uint16[Fe+11]=U,this.uint16[Fe+12]=$,this.uint16[Fe+13]=Y,this.uint16[Fe+14]=W,this.uint16[Fe+15]=se,this.uint16[Fe+16]=ue,this.uint16[Fe+17]=oe,this.uint16[Fe+18]=he,this.uint16[Fe+19]=ge,this.uint16[Fe+20]=Ce,this.uint16[Fe+21]=Je,this.uint16[Fe+22]=rt,this.uint32[ft+12]=Xe,this.float32[ft+13]=qe,this.float32[ft+14]=Ue,this.float32[ft+15]=Ze,this.float32[ft+16]=Ge,o}}Ga.prototype.bytesPerElement=68,tt("StructArrayLayout8i15ui1ul4f68",Ga);class Kr extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}Kr.prototype.bytesPerElement=4,tt("StructArrayLayout1f4",Kr);class Pl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const b=4*o;return this.uint32[2*o+0]=c,this.uint16[b+2]=h,this.uint16[b+3]=g,o}}Pl.prototype.bytesPerElement=8,tt("StructArrayLayout1ul2ui8",Pl);class m extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const g=2*o;return this.uint16[g+0]=c,this.uint16[g+1]=h,o}}m.prototype.bytesPerElement=4,tt("StructArrayLayout2ui4",m);class s extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}s.prototype.bytesPerElement=2,tt("StructArrayLayout1ui2",s);class d extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,c,h,g)}emplace(o,c,h,g,b){const x=4*o;return this.float32[x+0]=c,this.float32[x+1]=h,this.float32[x+2]=g,this.float32[x+3]=b,o}}d.prototype.bytesPerElement=16,tt("StructArrayLayout4f16",d);class f extends so{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ut(this.anchorPointX,this.anchorPointY)}}f.prototype.size=20;class _ extends ii{get(o){return new f(this,o)}}tt("CollisionBoxArray",_);class w extends so{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class S extends Fs{get(o){return new w(this,o)}}tt("PlacedSymbolArray",S);class T extends so{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}T.prototype.size=68;class M extends Ga{get(o){return new T(this,o)}}tt("SymbolInstanceArray",M);class k extends Kr{getoffsetX(o){return this.float32[1*o+0]}}tt("GlyphOffsetArray",k);class O extends ua{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}tt("SymbolLineVertexArray",O);class F extends so{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}F.prototype.size=8;class j extends Pl{get(o){return new F(this,o)}}tt("FeatureIndexArray",j);class K extends ds{}class G extends ds{}class Z extends ds{}class te extends Ps{}class le extends kl{}class fe extends da{}class J extends ao{}class pe extends ha{}class ve extends pa{}class De extends hs{}class Ae extends Uh{}class Ne extends gi{}class ke extends Rl{}class Be extends m{}const at=Nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:yt}=at;class $e{constructor(o=[]){this.segments=o}prepareSegment(o,c,h,g){let b=this.segments[this.segments.length-1];return o>$e.MAX_VERTEX_ARRAY_LENGTH&&mt(`Max vertices per segment is ${$e.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!b||b.vertexLength+o>$e.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g)&&(b={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},void 0!==g&&(b.sortKey=g),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,h,g){return new $e([{vertexOffset:o,primitiveOffset:c,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function bt(l,o){return 256*(l=qn(Math.floor(l),0,255))+qn(Math.floor(o),0,255)}$e.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,tt("SegmentVector",$e);const Ye=Nn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var sn={exports:{}},Xn=function(l,o){var c,h,g,b,x,C,D,A;for(h=l.length-(c=3&l.length),g=o,x=3432918353,C=461845907,A=0;A<h;)D=255&l.charCodeAt(A)|(255&l.charCodeAt(++A))<<8|(255&l.charCodeAt(++A))<<16|(255&l.charCodeAt(++A))<<24,++A,g=27492+(65535&(b=5*(65535&(g=(g^=D=(65535&(D=(D=(65535&D)*x+(((D>>>16)*x&65535)<<16)&4294967295)<<15|D>>>17))*C+(((D>>>16)*C&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(D=0,c){case 3:D^=(255&l.charCodeAt(A+2))<<16;case 2:D^=(255&l.charCodeAt(A+1))<<8;case 1:g^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(A)))*x+(((D>>>16)*x&65535)<<16)&4294967295)<<15|D>>>17))*C+(((D>>>16)*C&65535)<<16)&4294967295}return g^=l.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0},Er=function(l,o){for(var c,h=l.length,g=o^h,b=0;h>=4;)c=1540483477*(65535&(c=255&l.charCodeAt(b)|(255&l.charCodeAt(++b))<<8|(255&l.charCodeAt(++b))<<16|(255&l.charCodeAt(++b))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:g^=(255&l.charCodeAt(b+2))<<16;case 2:g^=(255&l.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&l.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};sn.exports=Xn,sn.exports.murmur3=Xn,sn.exports.murmur2=Er;var ai=Jt(sn.exports);class Li{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,c,h,g){this.ids.push(Cr(o)),this.positions.push(c,h,g)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Cr(o);let h=0,g=this.ids.length-1;for(;h<g;){const x=h+g>>1;this.ids[x]>=c?g=x:h=x+1}const b=[];for(;this.ids[h]===c;)b.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return b}static serialize(o,c){const h=new Float64Array(o.ids),g=new Uint32Array(o.positions);return Vr(h,g,0,h.length-1),c&&c.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(o){const c=new Li;return c.ids=o.ids,c.positions=o.positions,c.indexed=!0,c}}function Cr(l){const o=+l;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:ai(String(l))}function Vr(l,o,c,h){for(;c<h;){const g=l[c+h>>1];let b=c-1,x=h+1;for(;;){do{b++}while(l[b]<g);do{x--}while(l[x]>g);if(b>=x)break;Sr(l,b,x),Sr(o,3*b,3*x),Sr(o,3*b+1,3*x+1),Sr(o,3*b+2,3*x+2)}x-c<h-x?(Vr(l,o,c,x),c=x+1):(Vr(l,o,x+1,h),h=x)}}function Sr(l,o,c){const h=l[o];l[o]=l[c],l[c]=h}tt("FeaturePositionMap",Li);class Dr{constructor(o,c){this.gl=o.gl,this.location=c}}class Os extends Dr{constructor(o,c){super(o,c),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class mu extends Dr{constructor(o,c){super(o,c),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class Ur extends Dr{constructor(o,c){super(o,c),this.current=xt.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const qi=new Float32Array(16);function mn(l){return[bt(255*l.r,255*l.g),bt(255*l.b,255*l.a)]}class Gi{constructor(o,c,h){this.value=o,this.uniformNames=c.map(g=>`u_${g}`),this.type=h}setUniform(o,c,h){o.set(h.constantOr(this.value))}getBinding(o,c,h){return"color"===this.type?new Ur(o,c):new Os(o,c)}}class Ni{constructor(o,c){this.uniformNames=c.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=o.tlbr}setUniform(o,c,h,g){const b="u_pattern_to"===g?this.patternTo:"u_pattern_from"===g?this.patternFrom:"u_pixel_ratio_to"===g?this.pixelRatioTo:"u_pixel_ratio_from"===g?this.pixelRatioFrom:null;b&&o.set(b)}getBinding(o,c,h){return"u_pattern"===h.substr(0,9)?new mu(o,c):new Os(o,c)}}class dn{constructor(o,c,h,g){this.expression=o,this.type=h,this.maxValue=0,this.paintVertexAttributes=c.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===h?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(o,c,h,g,b){const x=this.paintVertexArray.length,C=this.expression.evaluate(new Le(0),c,{},g,[],b);this.paintVertexArray.resize(o),this._setPaintValue(x,o,C)}updatePaintArray(o,c,h,g){const b=this.expression.evaluate({zoom:0},h,g);this._setPaintValue(o,c,b)}_setPaintValue(o,c,h){if("color"===this.type){const g=mn(h);for(let b=o;b<c;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=o;g<c;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bi{constructor(o,c,h,g,b,x){this.expression=o,this.uniformNames=c.map(C=>`u_${C}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=c.map(C=>({name:`a_${C}`,type:"Float32",components:"color"===h?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(o,c,h,g,b){const x=this.expression.evaluate(new Le(this.zoom),c,{},g,[],b),C=this.expression.evaluate(new Le(this.zoom+1),c,{},g,[],b),D=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(D,o,x,C)}updatePaintArray(o,c,h,g){const b=this.expression.evaluate({zoom:this.zoom},h,g),x=this.expression.evaluate({zoom:this.zoom+1},h,g);this._setPaintValue(o,c,b,x)}_setPaintValue(o,c,h,g){if("color"===this.type){const b=mn(h),x=mn(g);for(let C=o;C<c;C++)this.paintVertexArray.emplace(C,b[0],b[1],x[0],x[1])}else{for(let b=o;b<c;b++)this.paintVertexArray.emplace(b,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c){const h=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,g=qn(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);o.set(g)}getBinding(o,c,h){return new Os(o,c)}}class jr{constructor(o,c,h,g,b,x){this.expression=o,this.type=c,this.useIntegerZoom=h,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(o,c,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(g,o,c.patterns&&c.patterns[this.layerId],h)}updatePaintArray(o,c,h,g,b){this._setPaintValues(o,c,h.patterns&&h.patterns[this.layerId],b)}_setPaintValues(o,c,h,g){if(!g||!h)return;const{min:b,mid:x,max:C}=h,D=g[b],A=g[x],P=g[C];if(D&&A&&P)for(let L=o;L<c;L++)this.zoomInPaintVertexArray.emplace(L,A.tl[0],A.tl[1],A.br[0],A.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],A.pixelRatio,D.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,A.tl[0],A.tl[1],A.br[0],A.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],A.pixelRatio,P.pixelRatio)}upload(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,Ye.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,Ye.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cd{constructor(o,c,h){this.binders={},this._buffers=[];const g=[];for(const b in o.paint._values){if(!h(b))continue;const x=o.paint.get(b);if(!(x instanceof Sn&&$a(x.property.specification)))continue;const C=_f(b,o.type),D=x.value,A=x.property.specification.type,P=x.property.useIntegerZoom,L=x.property.specification["property-type"],z="cross-faded"===L||"cross-faded-data-driven"===L;if("constant"===D.kind)this.binders[b]=z?new Ni(D.value,C):new Gi(D.value,C,A),g.push(`/u_${b}`);else if("source"===D.kind||z){const U=Sd(b,A,"source");this.binders[b]=z?new jr(D,A,P,c,U,o.id):new dn(D,C,A,U),g.push(`/a_${b}`)}else{const U=Sd(b,A,"composite");this.binders[b]=new Bi(D,C,A,P,c,U),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof dn||c instanceof Bi?c.maxValue:0}populatePaintArrays(o,c,h,g,b){for(const x in this.binders){const C=this.binders[x];(C instanceof dn||C instanceof Bi||C instanceof jr)&&C.populatePaintArray(o,c,h,g,b)}}setConstantPatternPositions(o,c){for(const h in this.binders){const g=this.binders[h];g instanceof Ni&&g.setConstantPatternPositions(o,c)}}updatePaintArrays(o,c,h,g,b){let x=!1;for(const C in o){const D=c.getPositions(C);for(const A of D){const P=h.feature(A.index);for(const L in this.binders){const z=this.binders[L];if((z instanceof dn||z instanceof Bi||z instanceof jr)&&!0===z.expression.isStateDependent){const U=g.paint.get(L);z.expression=U.value,z.updatePaintArray(A.start,A.end,P,o[C],b),x=!0}}}}return x}defines(){const o=[];for(const c in this.binders){const h=this.binders[c];(h instanceof Gi||h instanceof Ni)&&o.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof dn||h instanceof Bi)for(let g=0;g<h.paintVertexAttributes.length;g++)o.push(h.paintVertexAttributes[g].name);else if(h instanceof jr)for(let g=0;g<Ye.members.length;g++)o.push(Ye.members[g].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Gi||h instanceof Ni||h instanceof Bi)for(const g of h.uniformNames)o.push(g)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,c){const h=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof Gi||b instanceof Ni||b instanceof Bi)for(const x of b.uniformNames)if(c[x]){const C=b.getBinding(o,c[x],x);h.push({name:x,property:g,binding:C})}}return h}setUniforms(o,c,h,g){for(const{name:b,property:x,binding:C}of c)this.binders[x].setUniform(C,g,h.get(x),b)}updatePaintBuffers(o){this._buffers=[];for(const c in this.binders){const h=this.binders[c];if(o&&h instanceof jr){const g=2===o.fromScale?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof dn||h instanceof Bi)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(o){for(const c in this.binders){const h=this.binders[c];(h instanceof dn||h instanceof Bi||h instanceof jr)&&h.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof dn||c instanceof Bi||c instanceof jr)&&c.destroy()}}}class fa{constructor(o,c,h=(()=>!0)){this.programConfigurations={};for(const g of o)this.programConfigurations[g.id]=new Cd(g,c,h);this.needsUpload=!1,this._featureMap=new Li,this._bufferOffset=0}populatePaintArrays(o,c,h,g,b,x){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(o,c,g,b,x);void 0!==c.id&&this._featureMap.add(c.id,h,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,h,g){for(const b of h)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(o,this._featureMap,c,b,g)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function _f(l,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${o}-`,"").replace(/-/g,"_")]}function Sd(l,o,c){const g={"line-pattern":{source:J,composite:J},"fill-pattern":{source:J,composite:J},"fill-extrusion-pattern":{source:J,composite:J}}[l];return g&&g[c]||{color:{source:da,composite:d},number:{source:Kr,composite:da}}[o][c]}tt("ConstantBinder",Gi),tt("CrossFadedConstantBinder",Ni),tt("SourceExpressionBinder",dn),tt("CrossFadedCompositeBinder",jr),tt("CompositeExpressionBinder",Bi),tt("ProgramConfiguration",Cd,{omit:["_buffers"]}),tt("ProgramConfigurationSet",fa);var Bn=8192;const Dd=Math.pow(2,14)-1,fc=-Dd-1;function Ls(l){const o=Bn/l.extent,c=l.loadGeometry();for(let h=0;h<c.length;h++){const g=c[h];for(let b=0;b<g.length;b++){const x=g[b],C=Math.round(x.x*o),D=Math.round(x.y*o);x.x=qn(C,fc,Dd),x.y=qn(D,fc,Dd),(C<x.x||C>x.x+1||D<x.y||D>x.y+1)&&mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Fl(l,o){return{type:l.type,id:l.id,properties:l.properties,geometry:o?Ls(l):[]}}function jh(l,o,c,h,g){l.emplaceBack(2*o+(h+1)/2,2*c+(g+1)/2)}class $h{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new G,this.indexArray=new ke,this.segments=new $e,this.programConfigurations=new fa(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){const g=this.layers[0],b=[];let x=null,C=!1;"circle"===g.type&&(x=g.layout.get("circle-sort-key"),C=!x.isConstant());for(const{feature:D,id:A,index:P,sourceLayerIndex:L}of o){const z=this.layers[0]._featureFilter.needGeometry,U=Fl(D,z);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),U,h))continue;const $=C?x.evaluate(U,{},h):void 0,Y={id:A,properties:D.properties,type:D.type,sourceLayerIndex:L,index:P,geometry:z?U.geometry:Ls(D),patterns:{},sortKey:$};b.push(Y)}C&&b.sort((D,A)=>D.sortKey-A.sortKey);for(const D of b){const{geometry:A,index:P,sourceLayerIndex:L}=D,z=o[P].feature;this.addFeature(D,A,P,h),c.featureIndex.insert(z,A,P,L,this.index)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,yt),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,h,g){for(const b of c)for(const x of b){const C=x.x,D=x.y;if(C<0||C>=Bn||D<0||D>=Bn)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),P=A.vertexLength;jh(this.layoutVertexArray,C,D,-1,-1),jh(this.layoutVertexArray,C,D,1,-1),jh(this.layoutVertexArray,C,D,1,1),jh(this.layoutVertexArray,C,D,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,{},g)}}function jg(l,o){for(let c=0;c<l.length;c++)if(gu(o,l[c]))return!0;for(let c=0;c<o.length;c++)if(gu(l,o[c]))return!0;return!!Hh(l,o)}function $E(l,o,c){return!!gu(l,o)||!!yf(o,l,c)}function $g(l,o){if(1===l.length)return bf(o,l[0]);for(let c=0;c<o.length;c++){const h=o[c];for(let g=0;g<h.length;g++)if(gu(l,h[g]))return!0}for(let c=0;c<l.length;c++)if(bf(o,l[c]))return!0;for(let c=0;c<o.length;c++)if(Hh(l,o[c]))return!0;return!1}function Go(l,o,c){if(l.length>1){if(Hh(l,o))return!0;for(let h=0;h<o.length;h++)if(yf(o[h],l,c))return!0}for(let h=0;h<l.length;h++)if(yf(l[h],o,c))return!0;return!1}function Hh(l,o){if(0===l.length||0===o.length)return!1;for(let c=0;c<l.length-1;c++){const h=l[c],g=l[c+1];for(let b=0;b<o.length-1;b++)if(db(h,g,o[b],o[b+1]))return!0}return!1}function db(l,o,c,h){return ht(l,c,h)!==ht(o,c,h)&&ht(l,o,c)!==ht(l,o,h)}function yf(l,o,c){const h=c*c;if(1===o.length)return l.distSqr(o[0])<h;for(let g=1;g<o.length;g++)if(vf(l,o[g-1],o[g])<h)return!0;return!1}function vf(l,o,c){const h=o.distSqr(c);if(0===h)return l.distSqr(o);const g=((l.x-o.x)*(c.x-o.x)+(l.y-o.y)*(c.y-o.y))/h;return l.distSqr(g<0?o:g>1?c:c.sub(o)._mult(g)._add(o))}function bf(l,o){let c,h,g,b=!1;for(let x=0;x<l.length;x++){c=l[x];for(let C=0,D=c.length-1;C<c.length;D=C++)h=c[C],g=c[D],h.y>o.y!=g.y>o.y&&o.x<(g.x-h.x)*(o.y-h.y)/(g.y-h.y)+h.x&&(b=!b)}return b}function gu(l,o){let c=!1;for(let h=0,g=l.length-1;h<l.length;g=h++){const b=l[h],x=l[g];b.y>o.y!=x.y>o.y&&o.x<(x.x-b.x)*(o.y-b.y)/(x.y-b.y)+b.x&&(c=!c)}return c}function xf(l,o,c){const h=c[0],g=c[2];if(l.x<h.x&&o.x<h.x||l.x>g.x&&o.x>g.x||l.y<h.y&&o.y<h.y||l.y>g.y&&o.y>g.y)return!1;const b=ht(l,o,c[0]);return b!==ht(l,o,c[1])||b!==ht(l,o,c[2])||b!==ht(l,o,c[3])}function Id(l,o,c){const h=o.paint.get(l).value;return"constant"===h.kind?h.value:c.programConfigurations.get(o.id).getMaxValue(l)}function Wo(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Md(l,o,c,h,g){if(!o[0]&&!o[1])return l;const b=ut.convert(o)._mult(g);"viewport"===c&&b._rotate(-h);const x=[];for(let C=0;C<l.length;C++)x.push(l[C].sub(b));return x}let wf,Gn;tt("CircleBucket",$h,{omit:["layers"]});var Ef={get paint(){return Gn=Gn||new un({"circle-radius":new Oe(we.paint_circle["circle-radius"]),"circle-color":new Oe(we.paint_circle["circle-color"]),"circle-blur":new Oe(we.paint_circle["circle-blur"]),"circle-opacity":new Oe(we.paint_circle["circle-opacity"]),"circle-translate":new nt(we.paint_circle["circle-translate"]),"circle-translate-anchor":new nt(we.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nt(we.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nt(we.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Oe(we.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Oe(we.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Oe(we.paint_circle["circle-stroke-opacity"])})},get layout(){return wf=wf||new un({"circle-sort-key":new Oe(we.layout_circle["circle-sort-key"])})}},ar=1e-6,lr=typeof Float32Array<"u"?Float32Array:Array;function Cf(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Sf(l,o,c){var h=o[0],g=o[1],b=o[2],x=o[3],C=o[4],D=o[5],A=o[6],P=o[7],L=o[8],z=o[9],U=o[10],$=o[11],Y=o[12],W=o[13],se=o[14],ue=o[15],oe=c[0],he=c[1],ge=c[2],Ce=c[3];return l[0]=oe*h+he*C+ge*L+Ce*Y,l[1]=oe*g+he*D+ge*z+Ce*W,l[2]=oe*b+he*A+ge*U+Ce*se,l[3]=oe*x+he*P+ge*$+Ce*ue,l[4]=(oe=c[4])*h+(he=c[5])*C+(ge=c[6])*L+(Ce=c[7])*Y,l[5]=oe*g+he*D+ge*z+Ce*W,l[6]=oe*b+he*A+ge*U+Ce*se,l[7]=oe*x+he*P+ge*$+Ce*ue,l[8]=(oe=c[8])*h+(he=c[9])*C+(ge=c[10])*L+(Ce=c[11])*Y,l[9]=oe*g+he*D+ge*z+Ce*W,l[10]=oe*b+he*A+ge*U+Ce*se,l[11]=oe*x+he*P+ge*$+Ce*ue,l[12]=(oe=c[12])*h+(he=c[13])*C+(ge=c[14])*L+(Ce=c[15])*Y,l[13]=oe*g+he*D+ge*z+Ce*W,l[14]=oe*b+he*A+ge*U+Ce*se,l[15]=oe*x+he*P+ge*$+Ce*ue,l}Math.hypot||(Math.hypot=function(){for(var l=0,o=arguments.length;o--;)l+=arguments[o]*arguments[o];return Math.sqrt(l)});var ma,Zo=Sf;function qh(l,o,c){var h=o[0],g=o[1],b=o[2],x=o[3];return l[0]=c[0]*h+c[4]*g+c[8]*b+c[12]*x,l[1]=c[1]*h+c[5]*g+c[9]*b+c[13]*x,l[2]=c[2]*h+c[6]*g+c[10]*b+c[14]*x,l[3]=c[3]*h+c[7]*g+c[11]*b+c[15]*x,l}function Hg(l,o){const c=qh([],[l.x,l.y,0,1],o);return new ut(c[0]/c[3],c[1]/c[3])}ma=new lr(4),lr!=Float32Array&&(ma[0]=0,ma[1]=0,ma[2]=0,ma[3]=0);class qg extends $h{}let Wa;tt("HeatmapBucket",qg,{omit:["layers"]});var Gg={get paint(){return Wa=Wa||new un({"heatmap-radius":new Oe(we.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Oe(we.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nt(we.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ca(we.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nt(we.paint_heatmap["heatmap-opacity"])})}};function Df(l,{width:o,height:c},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==o*c*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${o*c*h}`)}else g=new Uint8Array(o*c*h);return l.width=o,l.height=c,l.data=g,l}function If(l,{width:o,height:c},h){if(o===l.width&&c===l.height)return;const g=Df({},{width:o,height:c},h);Gh(l,g,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,o),height:Math.min(l.height,c)},h),l.width=o,l.height=c,l.data=g.data}function Gh(l,o,c,h,g,b){if(0===g.width||0===g.height)return o;if(g.width>l.width||g.height>l.height||c.x>l.width-g.width||c.y>l.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>o.width||g.height>o.height||h.x>o.width-g.width||h.y>o.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=l.data,C=o.data;if(x===C)throw new Error("srcData equals dstData, so image is already copied");for(let D=0;D<g.height;D++){const A=((c.y+D)*l.width+c.x)*b,P=((h.y+D)*o.width+h.x)*b;for(let L=0;L<g.width*b;L++)C[P+L]=x[A+L]}return o}class _u{constructor(o,c){Df(this,o,1,c)}resize(o){If(this,o,1)}clone(){return new _u({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,h,g,b){Gh(o,c,h,g,b,1)}}class Ko{constructor(o,c){Df(this,o,4,c)}resize(o){If(this,o,4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ko({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,h,g,b){Gh(o,c,h,g,b,4)}}function Ft(l){const o={},c=l.resolution||256,h=l.clips?l.clips.length:1,g=l.image||new Ko({width:c,height:h});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const b=(x,C,D)=>{o[l.evaluationKey]=D;const A=l.expression.evaluate(o);g.data[x+C+0]=Math.floor(255*A.r/A.a),g.data[x+C+1]=Math.floor(255*A.g/A.a),g.data[x+C+2]=Math.floor(255*A.b/A.a),g.data[x+C+3]=Math.floor(255*A.a)};if(l.clips)for(let x=0,C=0;x<h;++x,C+=4*c)for(let D=0,A=0;D<c;D++,A+=4){const P=D/(c-1),{start:L,end:z}=l.clips[x];b(C,A,L*(1-P)+z*P)}else for(let x=0,C=0;x<c;x++,C+=4)b(0,C,x/(c-1));return g}let Mf;tt("AlphaImage",_u),tt("RGBAImage",Ko);var HE={get paint(){return Mf=Mf||new un({"hillshade-illumination-direction":new nt(we.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new nt(we.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nt(we.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nt(we.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nt(we.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nt(we.paint_hillshade["hillshade-accent-color"])})}};const hb=Nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:pb}=hb;var Tf={exports:{}};function Td(l,o,c){c=c||2;var h,g,b,x,C,D,A,P=o&&o.length,L=P?o[0]*c:l.length,z=mc(l,0,L,c,!0),U=[];if(!z||z.next===z.prev)return U;if(P&&(z=function(Y,W,se,ue){var oe,he,ge,Ce=[];for(oe=0,he=W.length;oe<he;oe++)(ge=mc(Y,W[oe]*ue,oe<he-1?W[oe+1]*ue:Y.length,ue,!1))===ge.next&&(ge.steiner=!0),Ce.push(Wg(ge));for(Ce.sort(yn),oe=0;oe<Ce.length;oe++)se=kd(Ce[oe],se);return se}(l,o,z,c)),l.length>80*c){h=b=l[0],g=x=l[1];for(var $=c;$<L;$+=c)(C=l[$])<h&&(h=C),(D=l[$+1])<g&&(g=D),C>b&&(b=C),D>x&&(x=D);A=0!==(A=Math.max(b-h,x-g))?32767/A:0}return Ad(z,U,c,h,g,A,0),U}function mc(l,o,c,h,g){var b,x;if(g===Rf(l,o,c,h)>0)for(b=o;b<c;b+=h)x=kf(b,l[b],l[b+1],x);else for(b=c-h;b>=o;b-=h)x=kf(b,l[b],l[b+1],x);return x&&yu(x,x.next)&&(va(x),x=x.next),x}function gc(l,o){if(!l)return l;o||(o=l);var c,h=l;do{if(c=!1,h.steiner||!yu(h,h.next)&&0!==oi(h.prev,h,h.next))h=h.next;else{if(va(h),(h=o=h.prev)===h.next)break;c=!0}}while(c||h!==o);return o}function Ad(l,o,c,h,g,b,x){if(l){!x&&b&&function(P,L,z,U){var $=P;do{0===$.z&&($.z=cr($.x,$.y,L,z,U)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next}while($!==P);$.prevZ.nextZ=null,$.prevZ=null,function(Y){var W,se,ue,oe,he,ge,Ce,Je,rt=1;do{for(se=Y,Y=null,he=null,ge=0;se;){for(ge++,ue=se,Ce=0,W=0;W<rt&&(Ce++,ue=ue.nextZ);W++);for(Je=rt;Ce>0||Je>0&&ue;)0!==Ce&&(0===Je||!ue||se.z<=ue.z)?(oe=se,se=se.nextZ,Ce--):(oe=ue,ue=ue.nextZ,Je--),he?he.nextZ=oe:Y=oe,oe.prevZ=he,he=oe;se=ue}he.nextZ=null,rt*=2}while(ge>1)}($)}(l,h,g,b);for(var C,D,A=l;l.prev!==l.next;)if(C=l.prev,D=l.next,b?mb(l,h,g,b):fb(l))o.push(C.i/c|0),o.push(l.i/c|0),o.push(D.i/c|0),va(l),l=D.next,A=D.next;else if((l=D)===A){x?1===x?Ad(l=gb(gc(l),o,c),o,c,h,g,b,2):2===x&&Pe(l,o,c,h,g,b):Ad(gc(l),o,c,h,g,b,1);break}}}function fb(l){var o=l.prev,c=l,h=l.next;if(oi(o,c,h)>=0)return!1;for(var g=o.x,b=c.x,x=h.x,C=o.y,D=c.y,A=h.y,P=g<b?g<x?g:x:b<x?b:x,L=C<D?C<A?C:A:D<A?D:A,z=g>b?g>x?g:x:b>x?b:x,U=C>D?C>A?C:A:D>A?D:A,$=h.next;$!==o;){if($.x>=P&&$.x<=z&&$.y>=L&&$.y<=U&&ga(g,C,b,D,x,A,$.x,$.y)&&oi($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function mb(l,o,c,h){var g=l.prev,b=l,x=l.next;if(oi(g,b,x)>=0)return!1;for(var C=g.x,D=b.x,A=x.x,P=g.y,L=b.y,z=x.y,U=C<D?C<A?C:A:D<A?D:A,$=P<L?P<z?P:z:L<z?L:z,Y=C>D?C>A?C:A:D>A?D:A,W=P>L?P>z?P:z:L>z?L:z,se=cr(U,$,o,c,h),ue=cr(Y,W,o,c,h),oe=l.prevZ,he=l.nextZ;oe&&oe.z>=se&&he&&he.z<=ue;){if(oe.x>=U&&oe.x<=Y&&oe.y>=$&&oe.y<=W&&oe!==g&&oe!==x&&ga(C,P,D,L,A,z,oe.x,oe.y)&&oi(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,he.x>=U&&he.x<=Y&&he.y>=$&&he.y<=W&&he!==g&&he!==x&&ga(C,P,D,L,A,z,he.x,he.y)&&oi(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;oe&&oe.z>=se;){if(oe.x>=U&&oe.x<=Y&&oe.y>=$&&oe.y<=W&&oe!==g&&oe!==x&&ga(C,P,D,L,A,z,oe.x,oe.y)&&oi(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;he&&he.z<=ue;){if(he.x>=U&&he.x<=Y&&he.y>=$&&he.y<=W&&he!==g&&he!==x&&ga(C,P,D,L,A,z,he.x,he.y)&&oi(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function gb(l,o,c){var h=l;do{var g=h.prev,b=h.next.next;!yu(g,b)&&Zg(g,h,h.next,b)&&ur(g,b)&&ur(b,g)&&(o.push(g.i/c|0),o.push(h.i/c|0),o.push(b.i/c|0),va(h),va(h.next),h=l=b),h=h.next}while(h!==l);return gc(h)}function Pe(l,o,c,h,g,b){var x=l;do{for(var C=x.next.next;C!==x.prev;){if(x.i!==C.i&&_a(x,C)){var D=ya(x,C);return x=gc(x,x.next),D=gc(D,D.next),Ad(x,o,c,h,g,b,0),void Ad(D,o,c,h,g,b,0)}C=C.next}x=x.next}while(x!==l)}function yn(l,o){return l.x-o.x}function kd(l,o){var c=function(g,b){var x,C=b,D=g.x,A=g.y,P=-1/0;do{if(A<=C.y&&A>=C.next.y&&C.next.y!==C.y){var L=C.x+(A-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(L<=D&&L>P&&(P=L,x=C.x<C.next.x?C:C.next,L===D))return x}C=C.next}while(C!==b);if(!x)return null;var z,U=x,$=x.x,Y=x.y,W=1/0;C=x;do{D>=C.x&&C.x>=$&&D!==C.x&&ga(A<Y?D:P,A,$,Y,A<Y?P:D,A,C.x,C.y)&&(z=Math.abs(A-C.y)/(D-C.x),ur(C,g)&&(z<W||z===W&&(C.x>x.x||C.x===x.x&&Rd(x,C)))&&(x=C,W=z)),C=C.next}while(C!==U);return x}(l,o);if(!c)return o;var h=ya(c,l);return gc(h,h.next),gc(c,c.next)}function Rd(l,o){return oi(l.prev,l,o.prev)<0&&oi(o.next,l,l.next)<0}function cr(l,o,c,h,g){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-c)*g|0)|l<<8))|l<<4))|l<<2))|l<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-h)*g|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Wg(l){var o=l,c=l;do{(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next}while(o!==l);return c}function ga(l,o,c,h,g,b,x,C){return(g-x)*(o-C)>=(l-x)*(b-C)&&(l-x)*(h-C)>=(c-x)*(o-C)&&(c-x)*(b-C)>=(g-x)*(h-C)}function _a(l,o){return l.next.i!==o.i&&l.prev.i!==o.i&&!function(c,h){var g=c;do{if(g.i!==c.i&&g.next.i!==c.i&&g.i!==h.i&&g.next.i!==h.i&&Zg(g,g.next,c,h))return!0;g=g.next}while(g!==c);return!1}(l,o)&&(ur(l,o)&&ur(o,l)&&function(c,h){var g=c,b=!1,x=(c.x+h.x)/2,C=(c.y+h.y)/2;do{g.y>C!=g.next.y>C&&g.next.y!==g.y&&x<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next}while(g!==c);return b}(l,o)&&(oi(l.prev,l,o.prev)||oi(l,o.prev,o))||yu(l,o)&&oi(l.prev,l,l.next)>0&&oi(o.prev,o,o.next)>0)}function oi(l,o,c){return(o.y-l.y)*(c.x-o.x)-(o.x-l.x)*(c.y-o.y)}function yu(l,o){return l.x===o.x&&l.y===o.y}function Zg(l,o,c,h){var g=Pd(oi(l,o,c)),b=Pd(oi(l,o,h)),x=Pd(oi(c,h,l)),C=Pd(oi(c,h,o));return g!==b&&x!==C||!(0!==g||!Af(l,c,o))||!(0!==b||!Af(l,h,o))||!(0!==x||!Af(c,l,h))||!(0!==C||!Af(c,o,h))}function Af(l,o,c){return o.x<=Math.max(l.x,c.x)&&o.x>=Math.min(l.x,c.x)&&o.y<=Math.max(l.y,c.y)&&o.y>=Math.min(l.y,c.y)}function Pd(l){return l>0?1:l<0?-1:0}function ur(l,o){return oi(l.prev,l,l.next)<0?oi(l,o,l.next)>=0&&oi(l,l.prev,o)>=0:oi(l,o,l.prev)<0||oi(l,l.next,o)<0}function ya(l,o){var c=new Ns(l.i,l.x,l.y),h=new Ns(o.i,o.x,o.y),g=l.next,b=o.prev;return l.next=o,o.prev=l,c.next=g,g.prev=c,h.next=c,c.prev=h,b.next=h,h.prev=b,h}function kf(l,o,c,h){var g=new Ns(l,o,c);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function va(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Ns(l,o,c){this.i=l,this.x=o,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rf(l,o,c,h){for(var g=0,b=o,x=c-h;b<c;b+=h)g+=(l[x]-l[b])*(l[b+1]+l[x+1]),x=b;return g}Tf.exports=Td,Tf.exports.default=Td,Td.deviation=function(l,o,c,h){var g=o&&o.length,b=Math.abs(Rf(l,0,g?o[0]*c:l.length,c));if(g)for(var x=0,C=o.length;x<C;x++)b-=Math.abs(Rf(l,o[x]*c,x<C-1?o[x+1]*c:l.length,c));var D=0;for(x=0;x<h.length;x+=3){var A=h[x]*c,P=h[x+1]*c,L=h[x+2]*c;D+=Math.abs((l[A]-l[L])*(l[P+1]-l[A+1])-(l[A]-l[P])*(l[L+1]-l[A+1]))}return 0===b&&0===D?0:Math.abs((D-b)/b)},Td.flatten=function(l){for(var o=l[0][0].length,c={vertices:[],holes:[],dimensions:o},h=0,g=0;g<l.length;g++){for(var b=0;b<l[g].length;b++)for(var x=0;x<o;x++)c.vertices.push(l[g][b][x]);g>0&&c.holes.push(h+=l[g-1].length)}return c};var Pf=Jt(Tf.exports);function _b(l,o,c,h,g){Kg(l,o,c||0,h||l.length-1,g||Ff)}function Kg(l,o,c,h,g){for(;h>c;){if(h-c>600){var b=h-c+1,x=o-c+1,C=Math.log(b),D=.5*Math.exp(2*C/3),A=.5*Math.sqrt(C*D*(b-D)/b)*(x-b/2<0?-1:1);Kg(l,o,Math.max(c,Math.floor(o-x*D/b+A)),Math.min(h,Math.floor(o+(b-x)*D/b+A)),g)}var P=l[o],L=c,z=h;for(_c(l,c,o),g(l[h],P)>0&&_c(l,c,h);L<z;){for(_c(l,L,z),L++,z--;g(l[L],P)<0;)L++;for(;g(l[z],P)>0;)z--}0===g(l[c],P)?_c(l,c,z):_c(l,++z,h),z<=o&&(c=z+1),o<=z&&(h=z-1)}}function _c(l,o,c){var h=l[o];l[o]=l[c],l[c]=h}function Ff(l,o){return l<o?-1:l>o?1:0}function Wh(l,o){const c=l.length;if(c<=1)return[l];const h=[];let g,b;for(let x=0;x<c;x++){const C=Bt(l[x]);0!==C&&(l[x].area=Math.abs(C),void 0===b&&(b=C<0),b===C<0?(g&&h.push(g),g=[l[x]]):g.push(l[x]))}if(g&&h.push(g),o>1)for(let x=0;x<h.length;x++)h[x].length<=o||(_b(h[x],o,1,h[x].length-1,Of),h[x]=h[x].slice(0,o));return h}function Of(l,o){return o.area-l.area}function Lf(l,o,c){const h=c.patternDependencies;let g=!1;for(const b of o){const x=b.paint.get(`${l}-pattern`);x.isConstant()||(g=!0);const C=x.constantOr(null);C&&(g=!0,h[C.to]=!0,h[C.from]=!0)}return g}function Zh(l,o,c,h,g){const b=g.patternDependencies;for(const x of o){const C=x.paint.get(`${l}-pattern`).value;if("constant"!==C.kind){let D=C.evaluate({zoom:h-1},c,{},g.availableImages),A=C.evaluate({zoom:h},c,{},g.availableImages),P=C.evaluate({zoom:h+1},c,{},g.availableImages);D=D&&D.name?D.name:D,A=A&&A.name?A.name:A,P=P&&P.name?P.name:P,b[D]=!0,b[A]=!0,b[P]=!0,c.patterns[x.id]={min:D,mid:A,max:P}}}return c}class Fd{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Z,this.indexArray=new ke,this.indexArray2=new Be,this.programConfigurations=new fa(o.layers,o.zoom),this.segments=new $e,this.segments2=new $e,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){this.hasPattern=Lf("fill",this.layers,c);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),x=[];for(const{feature:C,id:D,index:A,sourceLayerIndex:P}of o){const L=this.layers[0]._featureFilter.needGeometry,z=Fl(C,L);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),z,h))continue;const U=b?g.evaluate(z,{},h,c.availableImages):void 0,$={id:D,properties:C.properties,type:C.type,sourceLayerIndex:P,index:A,geometry:L?z.geometry:Ls(C),patterns:{},sortKey:U};x.push($)}b&&x.sort((C,D)=>C.sortKey-D.sortKey);for(const C of x){const{geometry:D,index:A,sourceLayerIndex:P}=C;if(this.hasPattern){const L=Zh("fill",this.layers,C,this.zoom,c);this.patternFeatures.push(L)}else this.addFeature(C,D,A,h,{});c.featureIndex.insert(o[A].feature,D,A,P,this.index)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}addFeatures(o,c,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,pb),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,c,h,g,b){for(const x of Wh(c,500)){let C=0;for(const U of x)C+=U.length;const D=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),A=D.vertexLength,P=[],L=[];for(const U of x){if(0===U.length)continue;U!==x[0]&&L.push(P.length/2);const $=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),Y=$.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(Y+U.length-1,Y),P.push(U[0].x),P.push(U[0].y);for(let W=1;W<U.length;W++)this.layoutVertexArray.emplaceBack(U[W].x,U[W].y),this.indexArray2.emplaceBack(Y+W-1,Y+W),P.push(U[W].x),P.push(U[W].y);$.vertexLength+=U.length,$.primitiveLength+=U.length}const z=Pf(P,L);for(let U=0;U<z.length;U+=3)this.indexArray.emplaceBack(A+z[U],A+z[U+1],A+z[U+2]);D.vertexLength+=C,D.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,b,g)}}let Nf,Bf;tt("FillBucket",Fd,{omit:["layers","patternFeatures"]});var Xg={get paint(){return Bf=Bf||new un({"fill-antialias":new nt(we.paint_fill["fill-antialias"]),"fill-opacity":new Oe(we.paint_fill["fill-opacity"]),"fill-color":new Oe(we.paint_fill["fill-color"]),"fill-outline-color":new Oe(we.paint_fill["fill-outline-color"]),"fill-translate":new nt(we.paint_fill["fill-translate"]),"fill-translate-anchor":new nt(we.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rs(we.paint_fill["fill-pattern"])})},get layout(){return Nf=Nf||new un({"fill-sort-key":new Oe(we.layout_fill["fill-sort-key"])})}};const Yg=Nn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),zf=Nn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:yb}=Yg;var Ol={},lo=xe,Ll=Hn;function Hn(l,o,c,h,g){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=h,this._values=g,l.readFields(Vf,this,o)}function Vf(l,o,c){1==l?o.id=c.readVarint():2==l?function(h,g){for(var b=h.readVarint()+h.pos;h.pos<b;){var x=g._keys[h.readVarint()],C=g._values[h.readVarint()];g.properties[x]=C}}(c,o):3==l?o.type=c.readVarint():4==l&&(o._geometry=c.pos)}function vb(l){for(var o,c,h=0,g=0,b=l.length,x=b-1;g<b;x=g++)h+=((c=l[x]).x-(o=l[g]).x)*(o.y+c.y);return h}Hn.types=["Unknown","Point","LineString","Polygon"],Hn.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var o,c=l.readVarint()+l.pos,h=1,g=0,b=0,x=0,C=[];l.pos<c;){if(g<=0){var D=l.readVarint();h=7&D,g=D>>3}if(g--,1===h||2===h)b+=l.readSVarint(),x+=l.readSVarint(),1===h&&(o&&C.push(o),o=[]),o.push(new lo(b,x));else{if(7!==h)throw new Error("unknown command "+h);o&&o.push(o[0].clone())}}return o&&C.push(o),C},Hn.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var o=l.readVarint()+l.pos,c=1,h=0,g=0,b=0,x=1/0,C=-1/0,D=1/0,A=-1/0;l.pos<o;){if(h<=0){var P=l.readVarint();c=7&P,h=P>>3}if(h--,1===c||2===c)(g+=l.readSVarint())<x&&(x=g),g>C&&(C=g),(b+=l.readSVarint())<D&&(D=b),b>A&&(A=b);else if(7!==c)throw new Error("unknown command "+c)}return[x,D,C,A]},Hn.prototype.toGeoJSON=function(l,o,c){var h,g,b=this.extent*Math.pow(2,c),x=this.extent*l,C=this.extent*o,D=this.loadGeometry(),A=Hn.types[this.type];function P(U){for(var $=0;$<U.length;$++){var Y=U[$];U[$]=[360*(Y.x+x)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Y.y+C)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(h=0;h<D.length;h++)L[h]=D[h][0];P(D=L);break;case 2:for(h=0;h<D.length;h++)P(D[h]);break;case 3:for(D=function(U){var $=U.length;if($<=1)return[U];for(var Y,W,se=[],ue=0;ue<$;ue++){var oe=vb(U[ue]);0!==oe&&(void 0===W&&(W=oe<0),W===oe<0?(Y&&se.push(Y),Y=[U[ue]]):Y.push(U[ue]))}return Y&&se.push(Y),se}(D),h=0;h<D.length;h++)for(g=0;g<D[h].length;g++)P(D[h][g])}1===D.length?D=D[0]:A="Multi"+A;var z={type:"Feature",geometry:{type:A,coordinates:D},properties:this.properties};return"id"in this&&(z.id=this.id),z};var bb=Ll,Qg=Uf;function Uf(l,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(Jg,this,o),this.length=this._features.length}function Jg(l,o,c){15===l?o.version=c.readVarint():1===l?o.name=c.readString():5===l?o.extent=c.readVarint():2===l?o._features.push(c.pos):3===l?o._keys.push(c.readString()):4===l&&o._values.push(function(h){for(var g=null,b=h.readVarint()+h.pos;h.pos<b;){var x=h.readVarint()>>3;g=1===x?h.readString():2===x?h.readFloat():3===x?h.readDouble():4===x?h.readVarint64():5===x?h.readVarint():6===x?h.readSVarint():7===x?h.readBoolean():null}return g}(c))}Uf.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var o=this._pbf.readVarint()+this._pbf.pos;return new bb(this._pbf,o,this.extent,this._keys,this._values)};var Kh=Qg;function Nl(l,o,c){if(3===l){var h=new Kh(c,c.readVarint()+c.pos);h.length&&(o[h.name]=h)}}Ol.VectorTile=function(l,o){this.layers=l.readFields(Nl,{},o)},Ol.VectorTileFeature=Ll,Ol.VectorTileLayer=Qg;const xb=Ol.VectorTileFeature.types,vu=Math.pow(2,13);function Bl(l,o,c,h,g,b,x,C){l.emplaceBack(o,c,2*Math.floor(h*vu)+x,g*vu*2,b*vu*2,Math.round(C))}class bu{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new te,this.centroidVertexArray=new K,this.indexArray=new ke,this.programConfigurations=new fa(o.layers,o.zoom),this.segments=new $e,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){this.features=[],this.hasPattern=Lf("fill-extrusion",this.layers,c);for(const{feature:g,id:b,index:x,sourceLayerIndex:C}of o){const D=this.layers[0]._featureFilter.needGeometry,A=Fl(g,D);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),A,h))continue;const P={id:b,sourceLayerIndex:C,index:x,geometry:D?A.geometry:Ls(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Zh("fill-extrusion",this.layers,P,this.zoom,c)):this.addFeature(P,P.geometry,x,h,{}),c.featureIndex.insert(g,P.geometry,x,C,this.index,!0)}}addFeatures(o,c,h){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,c,h)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,yb),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,zf.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,c,h,g,b){const x={x:0,y:0,vertexCount:0};for(const C of Wh(c,500)){let D=0;for(const $ of C)D+=$.length;let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of C){if(0===$.length||((l=$).every(o=>o.x<0)||l.every(o=>o.x>Bn)||l.every(o=>o.y<0)||l.every(o=>o.y>Bn)))continue;let Y=0;for(let W=0;W<$.length;W++){const se=$[W];if(W>=1){const ue=$[W-1];if(!jf(se,ue)){A.vertexLength+4>$e.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const oe=se.sub(ue)._perp()._unit(),he=ue.dist(se);Y+he>32768&&(Y=0),Bl(this.layoutVertexArray,se.x,se.y,oe.x,oe.y,0,0,Y),Bl(this.layoutVertexArray,se.x,se.y,oe.x,oe.y,0,1,Y),x.x+=2*se.x,x.y+=2*se.y,x.vertexCount+=2,Y+=he,Bl(this.layoutVertexArray,ue.x,ue.y,oe.x,oe.y,0,0,Y),Bl(this.layoutVertexArray,ue.x,ue.y,oe.x,oe.y,0,1,Y),x.x+=2*ue.x,x.y+=2*ue.y,x.vertexCount+=2;const ge=A.vertexLength;this.indexArray.emplaceBack(ge,ge+2,ge+1),this.indexArray.emplaceBack(ge+1,ge+2,ge+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+D>$e.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray)),"Polygon"!==xb[o.type])continue;const P=[],L=[],z=A.vertexLength;for(const $ of C)if(0!==$.length){$!==C[0]&&L.push(P.length/2);for(let Y=0;Y<$.length;Y++){const W=$[Y];Bl(this.layoutVertexArray,W.x,W.y,0,0,1,1,0),x.x+=W.x,x.y+=W.y,x.vertexCount+=1,P.push(W.x),P.push(W.y)}}const U=Pf(P,L);for(let $=0;$<U.length;$+=3)this.indexArray.emplaceBack(z+U[$],z+U[$+2],z+U[$+1]);A.primitiveLength+=U.length/3,A.vertexLength+=D}var l;for(let C=0;C<x.vertexCount;C++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,b,g)}}function jf(l,o){return l.x===o.x&&(l.x<0||l.x>Bn)||l.y===o.y&&(l.y<0||l.y>Bn)}let $f;tt("FillExtrusionBucket",bu,{omit:["layers","features"]});var wb={get paint(){return $f=$f||new un({"fill-extrusion-opacity":new nt(we["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Oe(we["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nt(we["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nt(we["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rs(we["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Oe(we["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Oe(we["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nt(we["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function ba(l,o){return l.x*o.x+l.y*o.y}function xu(l,o){if(1===l.length){let c=0;const h=o[c++];let g;for(;!g||h.equals(g);)if(g=o[c++],!g)return 1/0;for(;c<o.length;c++){const b=o[c],x=l[0],C=g.sub(h),D=b.sub(h),A=x.sub(h),P=ba(C,C),L=ba(C,D),z=ba(D,D),U=ba(A,C),$=ba(A,D),Y=P*z-L*L,W=(z*U-L*$)/Y,se=(P*$-L*U)/Y,ue=h.z*(1-W-se)+g.z*W+b.z*se;if(isFinite(ue))return ue}return 1/0}{let c=1/0;for(const h of o)c=Math.min(c,h.z);return c}}const Eb=Nn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:qE}=Eb,Hf=Nn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:GE}=Hf,Cb=Ol.VectorTileFeature.types,Sb=Math.cos(Math.PI/180*37.5),Db=Math.pow(2,14)/.5;class t_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new le,this.layoutVertexArray2=new fe,this.indexArray=new ke,this.programConfigurations=new fa(o.layers,o.zoom),this.segments=new $e,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){this.hasPattern=Lf("line",this.layers,c);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),x=[];for(const{feature:C,id:D,index:A,sourceLayerIndex:P}of o){const L=this.layers[0]._featureFilter.needGeometry,z=Fl(C,L);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),z,h))continue;const U=b?g.evaluate(z,{},h):void 0,$={id:D,properties:C.properties,type:C.type,sourceLayerIndex:P,index:A,geometry:L?z.geometry:Ls(C),patterns:{},sortKey:U};x.push($)}b&&x.sort((C,D)=>C.sortKey-D.sortKey);for(const C of x){const{geometry:D,index:A,sourceLayerIndex:P}=C;if(this.hasPattern){const L=Zh("line",this.layers,C,this.zoom,c);this.patternFeatures.push(L)}else this.addFeature(C,D,A,h,{});c.featureIndex.insert(o[A].feature,D,A,P,this.index)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}addFeatures(o,c,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,GE)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,qE),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,h,g,b){const x=this.layers[0].layout,C=x.get("line-join").evaluate(o,{}),D=x.get("line-cap"),A=x.get("line-miter-limit"),P=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const L of c)this.addLine(L,o,C,D,A,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,b,g)}addLine(o,c,h,g,b,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<o.length-1;se++)this.totalDistance+=o[se].dist(o[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C="Polygon"===Cb[c.type];let D=o.length;for(;D>=2&&o[D-1].equals(o[D-2]);)D--;let A=0;for(;A<D-1&&o[A].equals(o[A+1]);)A++;if(D<(C?3:2))return;"bevel"===h&&(b=1.05);const P=this.overscaling<=16?15*Bn/(512*this.overscaling):0,L=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let z,U,$,Y,W;this.e1=this.e2=-1,C&&(z=o[D-2],W=o[A].sub(z)._unit()._perp());for(let se=A;se<D;se++){if($=se===D-1?C?o[A+1]:void 0:o[se+1],$&&o[se].equals($))continue;W&&(Y=W),z&&(U=z),z=o[se],W=$?$.sub(z)._unit()._perp():Y,Y=Y||W;let ue=Y.add(W);0===ue.x&&0===ue.y||ue._unit();const oe=Y.x*W.x+Y.y*W.y,he=ue.x*W.x+ue.y*W.y,ge=0!==he?1/he:1/0,Ce=2*Math.sqrt(2-2*he),Je=he<Sb&&U&&$,rt=Y.x*W.y-Y.y*W.x>0;if(Je&&se>A){const Ue=z.dist(U);if(Ue>2*P){const Ze=z.sub(z.sub(U)._mult(P/Ue)._round());this.updateDistance(U,Ze),this.addCurrentVertex(Ze,Y,0,0,L),U=Ze}}const Xe=U&&$;let qe=Xe?h:C?"butt":g;if(Xe&&"round"===qe&&(ge<x?qe="miter":ge<=2&&(qe="fakeround")),"miter"===qe&&ge>b&&(qe="bevel"),"bevel"===qe&&(ge>2&&(qe="flipbevel"),ge<b&&(qe="miter")),U&&this.updateDistance(U,z),"miter"===qe)ue._mult(ge),this.addCurrentVertex(z,ue,0,0,L);else if("flipbevel"===qe){if(ge>100)ue=W.mult(-1);else{const Ue=ge*Y.add(W).mag()/Y.sub(W).mag();ue._perp()._mult(Ue*(rt?-1:1))}this.addCurrentVertex(z,ue,0,0,L),this.addCurrentVertex(z,ue.mult(-1),0,0,L)}else if("bevel"===qe||"fakeround"===qe){const Ue=-Math.sqrt(ge*ge-1),Ze=rt?Ue:0,Ge=rt?0:Ue;if(U&&this.addCurrentVertex(z,Y,Ze,Ge,L),"fakeround"===qe){const Fe=Math.round(180*Ce/Math.PI/20);for(let ft=1;ft<Fe;ft++){let st=ft/Fe;if(.5!==st){const zn=st-.5;st+=st*zn*(st-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*zn*zn+(.848013+oe*(.215638*oe-1.06021)))}const Ut=W.sub(Y)._mult(st)._add(Y)._unit()._mult(rt?-1:1);this.addHalfVertex(z,Ut.x,Ut.y,!1,rt,0,L)}}$&&this.addCurrentVertex(z,W,-Ze,-Ge,L)}else if("butt"===qe)this.addCurrentVertex(z,ue,0,0,L);else if("square"===qe){const Ue=U?1:-1;this.addCurrentVertex(z,ue,Ue,Ue,L)}else"round"===qe&&(U&&(this.addCurrentVertex(z,Y,0,0,L),this.addCurrentVertex(z,Y,1,1,L,!0)),$&&(this.addCurrentVertex(z,W,-1,-1,L,!0),this.addCurrentVertex(z,W,0,0,L)));if(Je&&se<D-1){const Ue=z.dist($);if(Ue>2*P){const Ze=z.add($.sub(z)._mult(P/Ue)._round());this.updateDistance(z,Ze),this.addCurrentVertex(Ze,W,0,0,L),z=Ze}}}}addCurrentVertex(o,c,h,g,b,x=!1){const C=c.y*g-c.x,D=-c.y-c.x*g;this.addHalfVertex(o,c.x+c.y*h,c.y-c.x*h,x,!1,h,b),this.addHalfVertex(o,C,D,x,!0,-g,b),this.distance>Db/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(o,c,h,g,b,x))}addHalfVertex({x:o,y:c},h,g,b,x,C,D){const A=.5*(this.lineClips?this.scaledDistance*(Db-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(b?1:0),(c<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(0===C?0:C<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),D.primitiveLength++),x?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,c){this.distance+=o.dist(c),this.updateScaledDistance()}}let Xh,wu;tt("LineBucket",t_,{omit:["layers","patternFeatures"]});var n_={get paint(){return wu=wu||new un({"line-opacity":new Oe(we.paint_line["line-opacity"]),"line-color":new Oe(we.paint_line["line-color"]),"line-translate":new nt(we.paint_line["line-translate"]),"line-translate-anchor":new nt(we.paint_line["line-translate-anchor"]),"line-width":new Oe(we.paint_line["line-width"]),"line-gap-width":new Oe(we.paint_line["line-gap-width"]),"line-offset":new Oe(we.paint_line["line-offset"]),"line-blur":new Oe(we.paint_line["line-blur"]),"line-dasharray":new fu(we.paint_line["line-dasharray"]),"line-pattern":new Rs(we.paint_line["line-pattern"]),"line-gradient":new ca(we.paint_line["line-gradient"])})},get layout(){return Xh=Xh||new un({"line-cap":new nt(we.layout_line["line-cap"]),"line-join":new Oe(we.layout_line["line-join"]),"line-miter-limit":new nt(we.layout_line["line-miter-limit"]),"line-round-limit":new nt(we.layout_line["line-round-limit"]),"line-sort-key":new Oe(we.layout_line["line-sort-key"])})}};class Od extends Oe{possiblyEvaluate(o,c){return c=new Le(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(o,c)}evaluate(o,c,h,g){return c=Ri({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(o,c,h,g)}}let Eu;function Ld(l,o){return o>0?o+2*l:l}const WE=Nn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),i_=Nn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Nn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const r_=Nn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Nn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const o_=Nn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),xa=Nn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ib(l,o,c){return l.sections.forEach(h=>{h.text=function(g,b,x){const C=b.layout.get("text-transform").evaluate(x,{});return"uppercase"===C?g=g.toLocaleUpperCase():"lowercase"===C&&(g=g.toLocaleLowerCase()),fn.applyArabicShaping&&(g=fn.applyArabicShaping(g)),g}(h.text,o,c)}),l}Nn([{name:"triangle",components:3,type:"Uint16"}]),Nn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Nn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Nn([{type:"Float32",name:"offsetX"}]),Nn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const zl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Di=24,qf=An,Nd=function(l,o,c,h,g){var b,x,C=8*g-h-1,D=(1<<C)-1,A=D>>1,P=-7,L=c?g-1:0,z=c?-1:1,U=l[o+L];for(L+=z,b=U&(1<<-P)-1,U>>=-P,P+=C;P>0;b=256*b+l[o+L],L+=z,P-=8);for(x=b&(1<<-P)-1,b>>=-P,P+=h;P>0;x=256*x+l[o+L],L+=z,P-=8);if(0===b)b=1-A;else{if(b===D)return x?NaN:1/0*(U?-1:1);x+=Math.pow(2,h),b-=A}return(U?-1:1)*x*Math.pow(2,b-h)},Yh=function(l,o,c,h,g,b){var x,C,D,A=8*b-g-1,P=(1<<A)-1,L=P>>1,z=23===g?Math.pow(2,-24)-Math.pow(2,-77):0,U=h?0:b-1,$=h?1:-1,Y=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(C=isNaN(o)?1:0,x=P):(x=Math.floor(Math.log(o)/Math.LN2),o*(D=Math.pow(2,-x))<1&&(x--,D*=2),(o+=x+L>=1?z/D:z*Math.pow(2,1-L))*D>=2&&(x++,D/=2),x+L>=P?(C=0,x=P):x+L>=1?(C=(o*D-1)*Math.pow(2,g),x+=L):(C=o*Math.pow(2,L-1)*Math.pow(2,g),x=0));g>=8;l[c+U]=255&C,U+=$,C/=256,g-=8);for(x=x<<g|C,A+=g;A>0;l[c+U]=255&x,U+=$,x/=256,A-=8);l[c+U-$]|=128*Y};function An(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}An.Varint=0,An.Fixed64=1,An.Bytes=2,An.Fixed32=5;var Qh=4294967296,Gf=1/Qh,Wf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function wa(l){return l.type===An.Bytes?l.readVarint()+l.pos:l.pos+1}function Bd(l,o,c){var h=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));c.realloc(h);for(var g=c.pos-1;g>=l;g--)c.buf[g+h]=c.buf[g]}function yc(l,o){for(var c=0;c<l.length;c++)o.writeVarint(l[c])}function Mb(l,o){for(var c=0;c<l.length;c++)o.writeSVarint(l[c])}function s_(l,o){for(var c=0;c<l.length;c++)o.writeFloat(l[c])}function a_(l,o){for(var c=0;c<l.length;c++)o.writeDouble(l[c])}function zd(l,o){for(var c=0;c<l.length;c++)o.writeBoolean(l[c])}function Tb(l,o){for(var c=0;c<l.length;c++)o.writeFixed32(l[c])}function co(l,o){for(var c=0;c<l.length;c++)o.writeSFixed32(l[c])}function Ab(l,o){for(var c=0;c<l.length;c++)o.writeFixed64(l[c])}function Ii(l,o){for(var c=0;c<l.length;c++)o.writeSFixed64(l[c])}function Su(l,o){return(l[o]|l[o+1]<<8|l[o+2]<<16)+16777216*l[o+3]}function Du(l,o,c){l[c]=o,l[c+1]=o>>>8,l[c+2]=o>>>16,l[c+3]=o>>>24}function Zf(l,o){return(l[o]|l[o+1]<<8|l[o+2]<<16)+(l[o+3]<<24)}An.prototype={destroy:function(){this.buf=null},readFields:function(l,o,c){for(c=c||this.length;this.pos<c;){var h=this.readVarint(),g=h>>3,b=this.pos;this.type=7&h,l(g,o,this),this.pos===b&&this.skip(h)}return o},readMessage:function(l,o){return this.readFields(l,o,this.readVarint()+this.pos)},readFixed32:function(){var l=Su(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=Zf(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=Su(this.buf,this.pos)+Su(this.buf,this.pos+4)*Qh;return this.pos+=8,l},readSFixed64:function(){var l=Su(this.buf,this.pos)+Zf(this.buf,this.pos+4)*Qh;return this.pos+=8,l},readFloat:function(){var l=Nd(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=Nd(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var o,c,h=this.buf;return o=127&(c=h[this.pos++]),c<128?o:(o|=(127&(c=h[this.pos++]))<<7,c<128?o:(o|=(127&(c=h[this.pos++]))<<14,c<128?o:(o|=(127&(c=h[this.pos++]))<<21,c<128?o:function(g,b,x){var C,D,A=x.buf;if(C=(112&(D=A[x.pos++]))>>4,D<128||(C|=(127&(D=A[x.pos++]))<<3,D<128)||(C|=(127&(D=A[x.pos++]))<<10,D<128)||(C|=(127&(D=A[x.pos++]))<<17,D<128)||(C|=(127&(D=A[x.pos++]))<<24,D<128)||(C|=(1&(D=A[x.pos++]))<<31,D<128))return function Cu(l,o,c){return c?4294967296*o+(l>>>0):4294967296*(o>>>0)+(l>>>0)}(g,C,b);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(c=h[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,o=this.pos;return this.pos=l,l-o>=12&&Wf?Wf.decode(this.buf.subarray(o,l)):function(c,h,g){for(var b="",x=h;x<g;){var C,D,A,P=c[x],L=null,z=P>239?4:P>223?3:P>191?2:1;if(x+z>g)break;1===z?P<128&&(L=P):2===z?128==(192&(C=c[x+1]))&&(L=(31&P)<<6|63&C)<=127&&(L=null):3===z?(D=c[x+2],128==(192&(C=c[x+1]))&&128==(192&D)&&((L=(15&P)<<12|(63&C)<<6|63&D)<=2047||L>=55296&&L<=57343)&&(L=null)):4===z&&(D=c[x+2],A=c[x+3],128==(192&(C=c[x+1]))&&128==(192&D)&&128==(192&A)&&((L=(15&P)<<18|(63&C)<<12|(63&D)<<6|63&A)<=65535||L>=1114112)&&(L=null)),null===L?(L=65533,z=1):L>65535&&(L-=65536,b+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),b+=String.fromCharCode(L),x+=z}return b}(this.buf,o,l)},readBytes:function(){var l=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,l);return this.pos=l,o},readPackedVarint:function(l,o){if(this.type!==An.Bytes)return l.push(this.readVarint(o));var c=wa(this);for(l=l||[];this.pos<c;)l.push(this.readVarint(o));return l},readPackedSVarint:function(l){if(this.type!==An.Bytes)return l.push(this.readSVarint());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==An.Bytes)return l.push(this.readBoolean());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==An.Bytes)return l.push(this.readFloat());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==An.Bytes)return l.push(this.readDouble());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==An.Bytes)return l.push(this.readFixed32());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==An.Bytes)return l.push(this.readSFixed32());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==An.Bytes)return l.push(this.readFixed64());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==An.Bytes)return l.push(this.readSFixed64());var o=wa(this);for(l=l||[];this.pos<o;)l.push(this.readSFixed64());return l},skip:function(l){var o=7&l;if(o===An.Varint)for(;this.buf[this.pos++]>127;);else if(o===An.Bytes)this.pos=this.readVarint()+this.pos;else if(o===An.Fixed32)this.pos+=4;else{if(o!==An.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(l,o){this.writeVarint(l<<3|o)},realloc:function(l){for(var o=this.length||16;o<this.pos+l;)o*=2;if(o!==this.length){var c=new Uint8Array(o);c.set(this.buf),this.buf=c,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),Du(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),Du(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),Du(this.buf,-1&l,this.pos),Du(this.buf,Math.floor(l*Gf),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),Du(this.buf,-1&l,this.pos),Du(this.buf,Math.floor(l*Gf),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(o,c){var h,g,b,C;if(o>=0?(h=o%4294967296|0,g=o/4294967296|0):(g=~(-o/4294967296),4294967295^(h=~(-o%4294967296))?h=h+1|0:(h=0,g=g+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),b=h,(C=c).buf[C.pos++]=127&b|128,b>>>=7,C.buf[C.pos++]=127&b|128,b>>>=7,C.buf[C.pos++]=127&b|128,b>>>=7,C.buf[C.pos++]=127&b|128,C.buf[C.pos]=127&(b>>>=7),function(b,x){var C=(7&b)<<4;x.buf[x.pos++]|=C|((b>>>=3)?128:0),b&&(x.buf[x.pos++]=127&b|((b>>>=7)?128:0),b&&(x.buf[x.pos++]=127&b|((b>>>=7)?128:0),b&&(x.buf[x.pos++]=127&b|((b>>>=7)?128:0),b&&(x.buf[x.pos++]=127&b|((b>>>=7)?128:0),b&&(x.buf[x.pos++]=127&b)))))}(g,c)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var o=this.pos;this.pos=function(h,g,b){for(var x,C,D=0;D<g.length;D++){if((x=g.charCodeAt(D))>55295&&x<57344){if(!C){x>56319||D+1===g.length?(h[b++]=239,h[b++]=191,h[b++]=189):C=x;continue}if(x<56320){h[b++]=239,h[b++]=191,h[b++]=189,C=x;continue}x=C-55296<<10|x-56320|65536,C=null}else C&&(h[b++]=239,h[b++]=191,h[b++]=189,C=null);x<128?h[b++]=x:(x<2048?h[b++]=x>>6|192:(x<65536?h[b++]=x>>12|224:(h[b++]=x>>18|240,h[b++]=x>>12&63|128),h[b++]=x>>6&63|128),h[b++]=63&x|128)}return b}(this.buf,l,this.pos);var c=this.pos-o;c>=128&&Bd(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeFloat:function(l){this.realloc(4),Yh(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),Yh(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var o=l.length;this.writeVarint(o),this.realloc(o);for(var c=0;c<o;c++)this.buf[this.pos++]=l[c]},writeRawMessage:function(l,o){this.pos++;var c=this.pos;l(o,this);var h=this.pos-c;h>=128&&Bd(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeMessage:function(l,o,c){this.writeTag(l,An.Bytes),this.writeRawMessage(o,c)},writePackedVarint:function(l,o){o.length&&this.writeMessage(l,yc,o)},writePackedSVarint:function(l,o){o.length&&this.writeMessage(l,Mb,o)},writePackedBoolean:function(l,o){o.length&&this.writeMessage(l,zd,o)},writePackedFloat:function(l,o){o.length&&this.writeMessage(l,s_,o)},writePackedDouble:function(l,o){o.length&&this.writeMessage(l,a_,o)},writePackedFixed32:function(l,o){o.length&&this.writeMessage(l,Tb,o)},writePackedSFixed32:function(l,o){o.length&&this.writeMessage(l,co,o)},writePackedFixed64:function(l,o){o.length&&this.writeMessage(l,Ab,o)},writePackedSFixed64:function(l,o){o.length&&this.writeMessage(l,Ii,o)},writeBytesField:function(l,o){this.writeTag(l,An.Bytes),this.writeBytes(o)},writeFixed32Field:function(l,o){this.writeTag(l,An.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(l,o){this.writeTag(l,An.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(l,o){this.writeTag(l,An.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(l,o){this.writeTag(l,An.Fixed64),this.writeSFixed64(o)},writeVarintField:function(l,o){this.writeTag(l,An.Varint),this.writeVarint(o)},writeSVarintField:function(l,o){this.writeTag(l,An.Varint),this.writeSVarint(o)},writeStringField:function(l,o){this.writeTag(l,An.Bytes),this.writeString(o)},writeFloatField:function(l,o){this.writeTag(l,An.Fixed32),this.writeFloat(o)},writeDoubleField:function(l,o){this.writeTag(l,An.Fixed64),this.writeDouble(o)},writeBooleanField:function(l,o){this.writeVarintField(l,!!o)}};var Za=Jt(qf);const Vl=3;function Iu(l,o,c){1===l&&c.readMessage(Mu,o)}function Mu(l,o,c){if(3===l){const{id:h,bitmap:g,width:b,height:x,left:C,top:D,advance:A}=c.readMessage(l_,{});o.push({id:h,bitmap:new _u({width:b+2*Vl,height:x+2*Vl},g),metrics:{width:b,height:x,left:C,top:D,advance:A}})}}function l_(l,o,c){1===l?o.id=c.readVarint():2===l?o.bitmap=c.readBytes():3===l?o.width=c.readVarint():4===l?o.height=c.readVarint():5===l?o.left=c.readSVarint():6===l?o.top=c.readSVarint():7===l&&(o.advance=c.readVarint())}const Jh=Vl;function vc(l){let o=0,c=0;for(const x of l)o+=x.w*x.h,c=Math.max(c,x.w);l.sort((x,C)=>C.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let g=0,b=0;for(const x of l)for(let C=h.length-1;C>=0;C--){const D=h[C];if(!(x.w>D.w||x.h>D.h)){if(x.x=D.x,x.y=D.y,b=Math.max(b,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===D.w&&x.h===D.h){const A=h.pop();C<h.length&&(h[C]=A)}else x.h===D.h?(D.x+=x.w,D.w-=x.w):x.w===D.w?(D.y+=x.h,D.h-=x.h):(h.push({x:D.x+x.w,y:D.y,w:D.w-x.w,h:x.h}),D.y+=x.h,D.h-=x.h);break}}return{w:g,h:b,fill:o/(g*b)||0}}const Co=1;class Kf{constructor(o,{pixelRatio:c,version:h,stretchX:g,stretchY:b,content:x}){this.paddedRect=o,this.pixelRatio=c,this.stretchX=g,this.stretchY=b,this.content=x,this.version=h}get tl(){return[this.paddedRect.x+Co,this.paddedRect.y+Co]}get br(){return[this.paddedRect.x+this.paddedRect.w-Co,this.paddedRect.y+this.paddedRect.h-Co]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Co)/this.pixelRatio,(this.paddedRect.h-2*Co)/this.pixelRatio]}}class kb{constructor(o,c){const h={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(o,h,b),this.addImages(c,g,b);const{w:x,h:C}=vc(b),D=new Ko({width:x||1,height:C||1});for(const A in o){const P=o[A],L=h[A].paddedRect;Ko.copy(P.data,D,{x:0,y:0},{x:L.x+Co,y:L.y+Co},P.data)}for(const A in c){const P=c[A],L=g[A].paddedRect,z=L.x+Co,U=L.y+Co,$=P.data.width,Y=P.data.height;Ko.copy(P.data,D,{x:0,y:0},{x:z,y:U},P.data),Ko.copy(P.data,D,{x:0,y:Y-1},{x:z,y:U-1},{width:$,height:1}),Ko.copy(P.data,D,{x:0,y:0},{x:z,y:U+Y},{width:$,height:1}),Ko.copy(P.data,D,{x:$-1,y:0},{x:z-1,y:U},{width:1,height:Y}),Ko.copy(P.data,D,{x:0,y:0},{x:z+$,y:U},{width:1,height:Y})}this.image=D,this.iconPositions=h,this.patternPositions=g}addImages(o,c,h){for(const g in o){const b=o[g],x={x:0,y:0,w:b.data.width+2*Co,h:b.data.height+2*Co};h.push(x),c[g]=new Kf(x,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(o,c){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in o.updatedImages)this.patchUpdatedImage(this.iconPositions[h],o.getImage(h),c),this.patchUpdatedImage(this.patternPositions[h],o.getImage(h),c)}patchUpdatedImage(o,c,h){if(!o||!c||o.version===c.version)return;o.version=c.version;const[g,b]=o.tl;h.update(c.data,void 0,{x:g,y:b})}}var bc;tt("ImagePosition",Kf),tt("ImageAtlas",kb),v.WritingMode=void 0,(bc=v.WritingMode||(v.WritingMode={}))[bc.none=0]="none",bc[bc.horizontal=1]="horizontal",bc[bc.vertical=2]="vertical",bc[bc.horizontalOnly=3]="horizontalOnly";const ep=-17;class tp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,c){const h=new tp;return h.scale=o||1,h.fontStack=c,h}static forImage(o){const c=new tp;return c.imageName=o,c}}class Vd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c){const h=new Vd;for(let g=0;g<o.sections.length;g++){const b=o.sections[g];b.image?h.addImageSection(b):h.addTextSection(b,c)}return h}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let c="";for(let h=0;h<o.length;h++){const g=o.charCodeAt(h+1)||null,b=o.charCodeAt(h-1)||null;c+=g&&mi(g)&&!zl[o[h+1]]||b&&mi(b)&&!zl[o[h-1]]||!zl[o[h]]?o[h]:zl[o[h]]}return c}(this.text)}trim(){let o=0;for(let h=0;h<this.text.length&&Ka[this.text.charCodeAt(h)];h++)o++;let c=this.text.length;for(let h=this.text.length-1;h>=0&&h>=o&&Ka[this.text.charCodeAt(h)];h--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const h=new Vd;return h.text=this.text.substring(o,c),h.sectionIndex=this.sectionIndex.slice(o,c),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(tp.forText(o.scale,o.fontStack||c));const h=this.sections.length-1;for(let g=0;g<o.text.length;++g)this.sectionIndex.push(h)}addImageSection(o){const c=o.image?o.image.name:"";if(0===c.length)return void mt("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(tp.forImage(c)),this.sectionIndex.push(this.sections.length-1)):mt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Xf(l,o,c,h,g,b,x,C,D,A,P,L,z,U,$,Y){const W=Vd.fromFeature(l,g);let se;L===v.WritingMode.vertical&&W.verticalizePunctuation();const{processBidirectionalText:ue,processStyledBidirectionalText:oe}=fn;if(ue&&1===W.sections.length){se=[];const Ce=ue(W.toString(),So(W,A,b,o,h,U,$));for(const Je of Ce){const rt=new Vd;rt.text=Je,rt.sections=W.sections;for(let Xe=0;Xe<Je.length;Xe++)rt.sectionIndex.push(0);se.push(rt)}}else if(oe){se=[];const Ce=oe(W.text,W.sectionIndex,So(W,A,b,o,h,U,$));for(const Je of Ce){const rt=new Vd;rt.text=Je[0],rt.sectionIndex=Je[1],rt.sections=W.sections,se.push(rt)}}else se=function(Ce,Je){const rt=[],Xe=Ce.text;let qe=0;for(const Ue of Je)rt.push(Ce.substring(qe,Ue)),qe=Ue;return qe<Xe.length&&rt.push(Ce.substring(qe,Xe.length)),rt}(W,So(W,A,b,o,h,U,$));const he=[],ge={positionedLines:he,text:W.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Ce,Je,rt,Xe,qe,Ue,Ze,Ge,Fe,ft,st,Ut){let zn=0,En=ep,Mi=0,Do=0;const Ir="right"===Ge?1:"left"===Ge?0:.5;let zi=0;for(const yi of qe){yi.trim();const Ki=yi.getMaxScale(),Ar=(Ki-1)*Di,dr={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[zi]=dr;const hr=dr.positionedGlyphs;let Qr=0;if(!yi.length()){En+=Ue,++zi;continue}for(let Vi=0;Vi<yi.length();Vi++){const qt=yi.getSection(Vi),Jr=yi.getSectionIndex(Vi),Ti=yi.getCharCode(Vi);let $r=0,Yo=null,Bs=null,zs=null,Qa=Di;const Qo=!(Fe===v.WritingMode.horizontal||!st&&!du(Ti)||st&&(Ka[Ti]||(_i=Ti,Ke.Arabic(_i)||Ke["Arabic Supplement"](_i)||Ke["Arabic Extended-A"](_i)||Ke["Arabic Presentation Forms-A"](_i)||Ke["Arabic Presentation Forms-B"](_i))));if(qt.imageName){const Io=Xe[qt.imageName];if(!Io)continue;zs=qt.imageName,Ce.iconsInText=Ce.iconsInText||!0,Bs=Io.paddedRect;const kr=Io.displaySize;qt.scale=qt.scale*Di/Ut,Yo={width:kr[0],height:kr[1],left:Co,top:-Jh,advance:Qo?kr[1]:kr[0]},$r=Ar+(Di-kr[1]*qt.scale),Qa=Yo.advance;const Vs=Qo?kr[0]*qt.scale-Di*Ki:kr[1]*qt.scale-Di*Ki;Vs>0&&Vs>Qr&&(Qr=Vs)}else{const Io=rt[qt.fontStack],kr=Io&&Io[Ti];if(kr&&kr.rect)Bs=kr.rect,Yo=kr.metrics;else{const Vs=Je[qt.fontStack],Sa=Vs&&Vs[Ti];if(!Sa)continue;Yo=Sa.metrics}$r=(Ki-qt.scale)*Di}Qo?(Ce.verticalizable=!0,hr.push({glyph:Ti,imageName:zs,x:zn,y:En+$r,vertical:Qo,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:Jr,metrics:Yo,rect:Bs}),zn+=Qa*qt.scale+ft):(hr.push({glyph:Ti,imageName:zs,x:zn,y:En+$r,vertical:Qo,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:Jr,metrics:Yo,rect:Bs}),zn+=Yo.advance*qt.scale+ft)}0!==hr.length&&(Mi=Math.max(zn-ft,Mi),d_(hr,0,hr.length-1,Ir,Qr)),zn=0;const Yn=Ue*Ki+Qr;dr.lineOffset=Math.max(Qr,Ar),En+=Yn,Do=Math.max(Yn,Do),++zi}var _i;const Mr=En-ep,{horizontalAlign:Tr,verticalAlign:Yr}=Ul(Ze);(function(yi,Ki,Ar,dr,hr,Qr,Yn,Vi,qt){const Jr=(Ki-Ar)*hr;let Ti=0;Ti=Qr!==Yn?-Vi*dr-ep:(-dr*qt+.5)*Yn;for(const $r of yi)for(const Yo of $r.positionedGlyphs)Yo.x+=Jr,Yo.y+=Ti})(Ce.positionedLines,Ir,Tr,Yr,Mi,Do,Ue,Mr,qe.length),Ce.top+=-Yr*Mr,Ce.bottom=Ce.top+Mr,Ce.left+=-Tr*Mi,Ce.right=Ce.left+Mi}(ge,o,c,h,se,x,C,D,L,A,z,Y),!function(Ce){for(const Je of Ce)if(0!==Je.positionedGlyphs.length)return!1;return!0}(he)&&ge}const Ka={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Rb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function c_(l,o,c,h,g,b){if(o.imageName){const x=h[o.imageName];return x?x.displaySize[0]*o.scale*Di/b+g:0}{const x=c[o.fontStack],C=x&&x[l];return C?C.metrics.advance*o.scale+g:0}}function Wi(l,o,c,h){const g=Math.pow(l-o,2);return h?l<o?g/2:2*g:g+Math.abs(c)*c}function Pb(l,o,c){let h=0;return 10===l&&(h-=1e4),c&&(h+=150),40!==l&&65288!==l||(h+=50),41!==o&&65289!==o||(h+=50),h}function Tu(l,o,c,h,g,b){let x=null,C=Wi(o,c,g,b);for(const D of h){const A=Wi(o-D.x,c,g,b)+D.badness;A<=C&&(x=D,C=A)}return{index:l,x:o,priorBreak:x,badness:C}}function u_(l){return l?u_(l.priorBreak).concat(l.index):[]}function So(l,o,c,h,g,b,x){if("point"!==b)return[];if(!l)return[];const C=[],D=function(z,U,$,Y,W,se){let ue=0;for(let oe=0;oe<z.length();oe++){const he=z.getSection(oe);ue+=c_(z.getCharCode(oe),he,Y,W,U,se)}return ue/Math.max(1,Math.ceil(ue/$))}(l,o,c,h,g,x),A=l.text.indexOf("\u200b")>=0;let P=0;for(let z=0;z<l.length();z++){const U=l.getSection(z),$=l.getCharCode(z);if(Ka[$]||(P+=c_($,U,h,g,o,x)),z<l.length()-1){const Y=!((L=$)<11904||!(Ke["Bopomofo Extended"](L)||Ke.Bopomofo(L)||Ke["CJK Compatibility Forms"](L)||Ke["CJK Compatibility Ideographs"](L)||Ke["CJK Compatibility"](L)||Ke["CJK Radicals Supplement"](L)||Ke["CJK Strokes"](L)||Ke["CJK Symbols and Punctuation"](L)||Ke["CJK Unified Ideographs Extension A"](L)||Ke["CJK Unified Ideographs"](L)||Ke["Enclosed CJK Letters and Months"](L)||Ke["Halfwidth and Fullwidth Forms"](L)||Ke.Hiragana(L)||Ke["Ideographic Description Characters"](L)||Ke["Kangxi Radicals"](L)||Ke["Katakana Phonetic Extensions"](L)||Ke.Katakana(L)||Ke["Vertical Forms"](L)||Ke["Yi Radicals"](L)||Ke["Yi Syllables"](L)));(Rb[$]||Y||U.imageName)&&C.push(Tu(z+1,P,D,C,Pb($,l.getCharCode(z+1),Y&&A),!1))}}var L;return u_(Tu(l.length(),P,D,C,0,!0))}function Ul(l){let o=.5,c=.5;switch(l){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function d_(l,o,c,h,g){if(!h&&!g)return;const b=l[c],x=(l[c].x+b.metrics.advance*b.scale)*h;for(let C=o;C<=c;C++)l[C].x-=x,l[C].y+=g}function np(l,o,c){const{horizontalAlign:h,verticalAlign:g}=Ul(c),b=o[0]-l.displaySize[0]*h,x=o[1]-l.displaySize[1]*g;return{image:l,top:x,bottom:x+l.displaySize[1],left:b,right:b+l.displaySize[0]}}function Au(l,o,c,h,g,b){const x=l.image;let C;if(x.content){const W=x.content,se=x.pixelRatio||1;C=[W[0]/se,W[1]/se,x.displaySize[0]-W[2]/se,x.displaySize[1]-W[3]/se]}const D=o.left*b,A=o.right*b;let P,L,z,U;"width"===c||"both"===c?(U=g[0]+D-h[3],L=g[0]+A+h[1]):(U=g[0]+(D+A-x.displaySize[0])/2,L=U+x.displaySize[0]);const $=o.top*b,Y=o.bottom*b;return"height"===c||"both"===c?(P=g[1]+$-h[0],z=g[1]+Y+h[2]):(P=g[1]+($+Y-x.displaySize[1])/2,z=P+x.displaySize[1]),{image:x,top:P,right:L,bottom:z,left:U,collisionPadding:C}}const Ud=255,Xa=128,jl=Ud*Xa;function Fb(l,o){const{expression:c}=o;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new Le(l+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:h,interpolationType:g}=c;let b=0;for(;b<h.length&&h[b]<=l;)b++;b=Math.max(0,b-1);let x=b;for(;x<h.length&&h[x]<l+1;)x++;x=Math.min(h.length-1,x);const C=h[b],D=h[x];return"composite"===c.kind?{kind:"composite",minZoom:C,maxZoom:D,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:D,minSize:c.evaluate(new Le(C)),maxSize:c.evaluate(new Le(D)),interpolationType:g}}}function uo(l,o,c){let h="never";const g=l.get(o);return g?h=g:l.get(c)&&(h="always"),h}const Yf=Ol.VectorTileFeature.types,ku=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Qf(l,o,c,h,g,b,x,C,D,A,P,L,z){const U=C?Math.min(jl,Math.round(C[0])):0,$=C?Math.min(jl,Math.round(C[1])):0;l.emplaceBack(o,c,Math.round(32*h),Math.round(32*g),b,x,(U<<1)+(D?1:0),$,16*A,16*P,256*L,256*z)}function ip(l,o,c){l.emplaceBack(o.x,o.y,c),l.emplaceBack(o.x,o.y,c),l.emplaceBack(o.x,o.y,c),l.emplaceBack(o.x,o.y,c)}function Ob(l){for(const o of l.sections)if(ct(o.text))return!0;return!1}class Jf{constructor(o){this.layoutVertexArray=new pe,this.indexArray=new ke,this.programConfigurations=o,this.segments=new $e,this.dynamicLayoutVertexArray=new ve,this.opacityVertexArray=new De,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,c,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,WE.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,i_.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,ku,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}tt("SymbolBuffers",Jf);class em{constructor(o,c,h){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new h,this.segments=new $e,this.collisionVertexArray=new Ne}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,r_.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}tt("CollisionBuffers",em);class Ru{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(x=>x.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cf([]),this.placementViewportMatrix=Cf([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fb(this.zoom,c["text-size"]),this.iconSizeData=Fb(this.zoom,c["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),b=h.get("symbol-z-order");this.canOverlap="never"!==uo(h,"text-overlap","text-allow-overlap")||"never"!==uo(h,"icon-overlap","icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==b&&!g.isConstant(),this.sortFeaturesByY=("viewport-y"===b||"auto"===b&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===h.get("symbol-placement")&&(this.writingModes=h.get("text-writing-mode").map(x=>v.WritingMode[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=o.sourceID}createArrays(){this.text=new Jf(new fa(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new Jf(new fa(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new k,this.lineVertexArray=new O,this.symbolInstances=new M}calculateGlyphDependencies(o,c,h,g,b){for(let x=0;x<o.length;x++)if(c[o.charCodeAt(x)]=!0,(h||g)&&b){const C=zl[o.charAt(x)];C&&(c[C.charCodeAt(0)]=!0)}}populate(o,c,h){const g=this.layers[0],b=g.layout,x=b.get("text-font"),C=b.get("text-field"),D=b.get("icon-image"),A=("constant"!==C.value.kind||C.value.value instanceof nr&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),P="constant"!==D.value.kind||!!D.value.value||Object.keys(D.parameters).length>0,L=b.get("symbol-sort-key");if(this.features=[],!A&&!P)return;const z=c.iconDependencies,U=c.glyphDependencies,$=c.availableImages,Y=new Le(this.zoom);for(const{feature:W,id:se,index:ue,sourceLayerIndex:oe}of o){const he=g._featureFilter.needGeometry,ge=Fl(W,he);if(!g._featureFilter.filter(Y,ge,h))continue;let Ce,Je;if(he||(ge.geometry=Ls(W)),A){const Xe=g.getValueAndResolveTokens("text-field",ge,h,$),qe=nr.factory(Xe);Ob(qe)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Ed()||this.hasRTLText&&fn.isParsed())&&(Ce=Ib(qe,g,ge))}if(P){const Xe=g.getValueAndResolveTokens("icon-image",ge,h,$);Je=Xe instanceof Zr?Xe:Zr.fromString(Xe)}if(!Ce&&!Je)continue;const rt=this.sortFeaturesByKey?L.evaluate(ge,{},h):void 0;if(this.features.push({id:se,text:Ce,icon:Je,index:ue,sourceLayerIndex:oe,geometry:ge.geometry,properties:W.properties,type:Yf[W.type],sortKey:rt}),Je&&(z[Je.name]=!0),Ce){const Xe=x.evaluate(ge,{},h).join(","),qe="viewport"!==b.get("text-rotation-alignment")&&"point"!==b.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.WritingMode.vertical)>=0;for(const Ue of Ce.sections)if(Ue.image)z[Ue.image.name]=!0;else{const Ze=Ci(Ce.toString()),Ge=Ue.fontStack||Xe,Fe=U[Ge]=U[Ge]||{};this.calculateGlyphDependencies(Ue.text,Fe,qe,this.allowVerticalPlacement,Ze)}}}"line"===b.get("symbol-placement")&&(this.features=function(W){const se={},ue={},oe=[];let he=0;function ge(Xe){oe.push(W[Xe]),he++}function Ce(Xe,qe,Ue){const Ze=ue[Xe];return delete ue[Xe],ue[qe]=Ze,oe[Ze].geometry[0].pop(),oe[Ze].geometry[0]=oe[Ze].geometry[0].concat(Ue[0]),Ze}function Je(Xe,qe,Ue){const Ze=se[qe];return delete se[qe],se[Xe]=Ze,oe[Ze].geometry[0].shift(),oe[Ze].geometry[0]=Ue[0].concat(oe[Ze].geometry[0]),Ze}function rt(Xe,qe,Ue){const Ze=Ue?qe[0][qe[0].length-1]:qe[0][0];return`${Xe}:${Ze.x}:${Ze.y}`}for(let Xe=0;Xe<W.length;Xe++){const qe=W[Xe],Ue=qe.geometry,Ze=qe.text?qe.text.toString():null;if(!Ze){ge(Xe);continue}const Ge=rt(Ze,Ue),Fe=rt(Ze,Ue,!0);if(Ge in ue&&Fe in se&&ue[Ge]!==se[Fe]){const ft=Je(Ge,Fe,Ue),st=Ce(Ge,Fe,oe[ft].geometry);delete se[Ge],delete ue[Fe],ue[rt(Ze,oe[st].geometry,!0)]=st,oe[ft].geometry=null}else Ge in ue?Ce(Ge,Fe,Ue):Fe in se?Je(Ge,Fe,Ue):(ge(Xe),se[Ge]=he-1,ue[Fe]=he-1)}return oe.filter(Xe=>Xe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,se)=>W.sortKey-se.sortKey)}update(o,c,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,c,this.layers,h),this.icon.programConfigurations.updatePaintArrays(o,c,this.layers,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const h=this.lineVertexArray.length;if(void 0!==o.segment){let g=o.dist(c[o.segment+1]),b=o.dist(c[o.segment]);const x={};for(let C=o.segment+1;C<c.length;C++)x[C]={x:c[C].x,y:c[C].y,tileUnitDistanceFromAnchor:g},C<c.length-1&&(g+=c[C+1].dist(c[C]));for(let C=o.segment||0;C>=0;C--)x[C]={x:c[C].x,y:c[C].y,tileUnitDistanceFromAnchor:b},C>0&&(b+=c[C-1].dist(c[C]));for(let C=0;C<c.length;C++){const D=x[C];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(o,c,h,g,b,x,C,D,A,P,L,z){const U=o.indexArray,$=o.layoutVertexArray,Y=o.segments.prepareSegment(4*c.length,$,U,this.canOverlap?x.sortKey:void 0),W=this.glyphOffsetArray.length,se=Y.vertexLength,ue=this.allowVerticalPlacement&&C===v.WritingMode.vertical?Math.PI/2:0,oe=x.text&&x.text.sections;for(let he=0;he<c.length;he++){const{tl:ge,tr:Ce,bl:Je,br:rt,tex:Xe,pixelOffsetTL:qe,pixelOffsetBR:Ue,minFontScaleX:Ze,minFontScaleY:Ge,glyphOffset:Fe,isSDF:ft,sectionIndex:st}=c[he],Ut=Y.vertexLength,zn=Fe[1];Qf($,D.x,D.y,ge.x,zn+ge.y,Xe.x,Xe.y,h,ft,qe.x,qe.y,Ze,Ge),Qf($,D.x,D.y,Ce.x,zn+Ce.y,Xe.x+Xe.w,Xe.y,h,ft,Ue.x,qe.y,Ze,Ge),Qf($,D.x,D.y,Je.x,zn+Je.y,Xe.x,Xe.y+Xe.h,h,ft,qe.x,Ue.y,Ze,Ge),Qf($,D.x,D.y,rt.x,zn+rt.y,Xe.x+Xe.w,Xe.y+Xe.h,h,ft,Ue.x,Ue.y,Ze,Ge),ip(o.dynamicLayoutVertexArray,D,ue),U.emplaceBack(Ut,Ut+1,Ut+2),U.emplaceBack(Ut+1,Ut+2,Ut+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fe[0]),he!==c.length-1&&st===c[he+1].sectionIndex||o.programConfigurations.populatePaintArrays($.length,x,x.index,{},z,oe&&oe[st])}o.placedSymbolArray.emplaceBack(D.x,D.y,W,this.glyphOffsetArray.length-W,se,A,P,D.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],C,0,!1,0,L)}_addCollisionDebugVertex(o,c,h,g,b,x){return c.emplaceBack(0,0),o.emplaceBack(h.x,h.y,g,b,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(o,c,h,g,b,x,C){const D=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),A=D.vertexLength,P=b.layoutVertexArray,L=b.collisionVertexArray,z=C.anchorX,U=C.anchorY;this._addCollisionDebugVertex(P,L,x,z,U,new ut(o,c)),this._addCollisionDebugVertex(P,L,x,z,U,new ut(h,c)),this._addCollisionDebugVertex(P,L,x,z,U,new ut(h,g)),this._addCollisionDebugVertex(P,L,x,z,U,new ut(o,g)),D.vertexLength+=4;const $=b.indexArray;$.emplaceBack(A,A+1),$.emplaceBack(A+1,A+2),$.emplaceBack(A+2,A+3),$.emplaceBack(A+3,A),D.primitiveLength+=4}addDebugCollisionBoxes(o,c,h,g){for(let b=o;b<c;b++){const x=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new em(Ae,o_.members,Be),this.iconCollisionBox=new em(Ae,o_.members,Be);for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(o,c,h,g,b,x,C,D,A){const P={};for(let L=c;L<h;L++){const z=o.get(L);P.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},P.textFeatureIndex=z.featureIndex;break}for(let L=g;L<b;L++){const z=o.get(L);P.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},P.verticalTextFeatureIndex=z.featureIndex;break}for(let L=x;L<C;L++){const z=o.get(L);P.iconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},P.iconFeatureIndex=z.featureIndex;break}for(let L=D;L<A;L++){const z=o.get(L);P.verticalIconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},P.verticalIconFeatureIndex=z.featureIndex;break}return P}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,c){const h=o.placedSymbolArray.get(c),g=h.vertexStartIndex+4*h.numGlyphs;for(let b=h.vertexStartIndex;b<g;b+=4)o.indexArray.emplaceBack(b,b+1,b+2),o.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(o),h=Math.cos(o),g=[],b=[],x=[];for(let C=0;C<this.symbolInstances.length;++C){x.push(C);const D=this.symbolInstances.get(C);g.push(0|Math.round(c*D.anchorX+h*D.anchorY)),b.push(D.featureIndex)}return x.sort((C,D)=>g[C]-g[D]||b[D]-b[C]),x}addToSortKeyRanges(o,c){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===c?h.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const h=this.symbolInstances.get(c);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,b,x)=>{g>=0&&x.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let h_,p_;tt("SymbolBucket",Ru,{omit:["layers","collisionBoxArray","features","compareText"]}),Ru.MAX_GLYPHS=65535,Ru.addDynamicAttributes=ip;var jd={get paint(){return p_=p_||new un({"icon-opacity":new Oe(we.paint_symbol["icon-opacity"]),"icon-color":new Oe(we.paint_symbol["icon-color"]),"icon-halo-color":new Oe(we.paint_symbol["icon-halo-color"]),"icon-halo-width":new Oe(we.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Oe(we.paint_symbol["icon-halo-blur"]),"icon-translate":new nt(we.paint_symbol["icon-translate"]),"icon-translate-anchor":new nt(we.paint_symbol["icon-translate-anchor"]),"text-opacity":new Oe(we.paint_symbol["text-opacity"]),"text-color":new Oe(we.paint_symbol["text-color"],{runtimeType:Gr,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Oe(we.paint_symbol["text-halo-color"]),"text-halo-width":new Oe(we.paint_symbol["text-halo-width"]),"text-halo-blur":new Oe(we.paint_symbol["text-halo-blur"]),"text-translate":new nt(we.paint_symbol["text-translate"]),"text-translate-anchor":new nt(we.paint_symbol["text-translate-anchor"])})},get layout(){return h_=h_||new un({"symbol-placement":new nt(we.layout_symbol["symbol-placement"]),"symbol-spacing":new nt(we.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nt(we.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Oe(we.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nt(we.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new nt(we.layout_symbol["icon-allow-overlap"]),"icon-overlap":new nt(we.layout_symbol["icon-overlap"]),"icon-ignore-placement":new nt(we.layout_symbol["icon-ignore-placement"]),"icon-optional":new nt(we.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nt(we.layout_symbol["icon-rotation-alignment"]),"icon-size":new Oe(we.layout_symbol["icon-size"]),"icon-text-fit":new nt(we.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nt(we.layout_symbol["icon-text-fit-padding"]),"icon-image":new Oe(we.layout_symbol["icon-image"]),"icon-rotate":new Oe(we.layout_symbol["icon-rotate"]),"icon-padding":new Oe(we.layout_symbol["icon-padding"]),"icon-keep-upright":new nt(we.layout_symbol["icon-keep-upright"]),"icon-offset":new Oe(we.layout_symbol["icon-offset"]),"icon-anchor":new Oe(we.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nt(we.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nt(we.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nt(we.layout_symbol["text-rotation-alignment"]),"text-field":new Oe(we.layout_symbol["text-field"]),"text-font":new Oe(we.layout_symbol["text-font"]),"text-size":new Oe(we.layout_symbol["text-size"]),"text-max-width":new Oe(we.layout_symbol["text-max-width"]),"text-line-height":new nt(we.layout_symbol["text-line-height"]),"text-letter-spacing":new Oe(we.layout_symbol["text-letter-spacing"]),"text-justify":new Oe(we.layout_symbol["text-justify"]),"text-radial-offset":new Oe(we.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nt(we.layout_symbol["text-variable-anchor"]),"text-anchor":new Oe(we.layout_symbol["text-anchor"]),"text-max-angle":new nt(we.layout_symbol["text-max-angle"]),"text-writing-mode":new nt(we.layout_symbol["text-writing-mode"]),"text-rotate":new Oe(we.layout_symbol["text-rotate"]),"text-padding":new nt(we.layout_symbol["text-padding"]),"text-keep-upright":new nt(we.layout_symbol["text-keep-upright"]),"text-transform":new Oe(we.layout_symbol["text-transform"]),"text-offset":new Oe(we.layout_symbol["text-offset"]),"text-allow-overlap":new nt(we.layout_symbol["text-allow-overlap"]),"text-overlap":new nt(we.layout_symbol["text-overlap"]),"text-ignore-placement":new nt(we.layout_symbol["text-ignore-placement"]),"text-optional":new nt(we.layout_symbol["text-optional"])})}};class $d{constructor(o){if(void 0===o.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:Js,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}tt("FormatSectionOverride",$d,{omit:["defaultValue"]});class rp extends zr{constructor(o){super(o,jd)}recalculate(o,c){if(super.recalculate(o,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const b of h)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,c,h,g){const b=this.layout.get(o).evaluate(c,{},h,g),x=this._unevaluatedLayout._values[o];return x.isDataDriven()||El(x.value)||!b?b:(C=c.properties,b.replace(/{([^{}]+)}/g,(A,P)=>P in C?String(C[P]):""));var C}createBucket(o){return new Ru(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of jd.paint.overridableProperties){if(!rp.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),h=new $d(c),g=new fd(h,c.property.specification);let b=null;b="constant"===c.value.kind||"source"===c.value.kind?new Ph("source",g):new Xt("composite",g,c.value.zoomStops),this.paint._values[o]=new Sn(c.property,b,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,h){return!(!this.layout||c.isDataDriven()||h.isDataDriven())&&rp.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const h=o.get("text-field"),g=jd.paint.properties[c];let b=!1;const x=C=>{for(const D of C)if(g.overrides&&g.overrides.hasOverride(D))return void(b=!0)};if("constant"===h.value.kind&&h.value.value instanceof nr)x(h.value.value.sections);else if("source"===h.value.kind){const C=A=>{b||(A instanceof Ds&&xi(A.value)===Cs?x(A.value.sections):A instanceof iu?x(A.sections):A.eachChild(C))},D=h.value;D._styleExpression&&C(D._styleExpression.expression)}return b}}let xc;var Lb={get paint(){return xc=xc||new un({"background-color":new nt(we.paint_background["background-color"]),"background-pattern":new fu(we.paint_background["background-pattern"]),"background-opacity":new nt(we.paint_background["background-opacity"])})}};let Hd;var Nb={get paint(){return Hd=Hd||new un({"raster-opacity":new nt(we.paint_raster["raster-opacity"]),"raster-hue-rotate":new nt(we.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nt(we.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nt(we.paint_raster["raster-brightness-max"]),"raster-saturation":new nt(we.paint_raster["raster-saturation"]),"raster-contrast":new nt(we.paint_raster["raster-contrast"]),"raster-resampling":new nt(we.paint_raster["raster-resampling"]),"raster-fade-duration":new nt(we.paint_raster["raster-fade-duration"])})}};class f_ extends zr{constructor(o){super(o,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const tm={circle:class extends zr{constructor(l){super(l,Ef)}createBucket(l){return new $h(l)}queryRadius(l){const o=l;return Id("circle-radius",this,o)+Id("circle-stroke-width",this,o)+Wo(this.paint.get("circle-translate"))}queryIntersectsFeature(l,o,c,h,g,b,x,C){const D=Md(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,x),A=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c),P="map"===this.paint.get("circle-pitch-alignment"),L=P?D:($=C,D.map(Y=>Hg(Y,$))),z=P?A*x:A;var $;for(const U of h)for(const $ of U){const Y=P?$:Hg($,C);let W=z;const se=qh([],[$.x,$.y,0,1],C);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?W*=se[3]/b.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(W*=b.cameraToCenterDistance/se[3]),$E(L,Y,W))return!0}return!1}},heatmap:class extends zr{createBucket(l){return new qg(l)}constructor(l){super(l,Gg),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){"heatmap-color"===l&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ft({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends zr{constructor(l){super(l,HE)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends zr{constructor(l){super(l,Xg)}recalculate(l,o){super.recalculate(l,o);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new Fd(l)}queryRadius(){return Wo(this.paint.get("fill-translate"))}queryIntersectsFeature(l,o,c,h,g,b,x){return $g(Md(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,x),h)}isTileClipped(){return!0}},"fill-extrusion":class extends zr{constructor(l){super(l,wb)}createBucket(l){return new bu(l)}queryRadius(){return Wo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(l,o,c,h,g,b,x,C){const D=Md(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,x),A=this.paint.get("fill-extrusion-height").evaluate(o,c),P=this.paint.get("fill-extrusion-base").evaluate(o,c),L=function(U,$,Y,W){const se=[];for(const ue of U){const oe=[ue.x,ue.y,0,1];qh(oe,oe,$),se.push(new ut(oe[0]/oe[3],oe[1]/oe[3]))}return se}(D,C),z=function(U,$,Y,W){const se=[],ue=[],oe=W[8]*$,he=W[9]*$,ge=W[10]*$,Ce=W[11]*$,Je=W[8]*Y,rt=W[9]*Y,Xe=W[10]*Y,qe=W[11]*Y;for(const Ue of U){const Ze=[],Ge=[];for(const Fe of Ue){const ft=Fe.x,st=Fe.y,Ut=W[0]*ft+W[4]*st+W[12],zn=W[1]*ft+W[5]*st+W[13],En=W[2]*ft+W[6]*st+W[14],Mi=W[3]*ft+W[7]*st+W[15],Do=En+ge,Ir=Mi+Ce,zi=Ut+Je,_i=zn+rt,Mr=En+Xe,Tr=Mi+qe,Yr=new ut((Ut+oe)/Ir,(zn+he)/Ir);Yr.z=Do/Ir,Ze.push(Yr);const yi=new ut(zi/Tr,_i/Tr);yi.z=Mr/Tr,Ge.push(yi)}se.push(Ze),ue.push(Ge)}return[se,ue]}(h,P,A,C);return function(U,$,Y){let W=1/0;$g(Y,$)&&(W=xu(Y,$[0]));for(let se=0;se<$.length;se++){const ue=$[se],oe=U[se];for(let he=0;he<ue.length-1;he++){const ge=ue[he],Ce=[ge,ue[he+1],oe[he+1],oe[he],ge];jg(Y,Ce)&&(W=Math.min(W,xu(Y,Ce)))}}return W!==1/0&&W}(z[0],z[1],L)}},line:class extends zr{constructor(l){super(l,n_),this.gradientVersion=0,Eu||(Eu=new Od(n_.paint.properties["line-width"].specification),Eu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){"line-gradient"===l&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof bl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,o){super.recalculate(l,o),this.paint._values["line-floorwidth"]=Eu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new t_(l)}queryRadius(l){const o=l,c=Ld(Id("line-width",this,o),Id("line-gap-width",this,o)),h=Id("line-offset",this,o);return c/2+Math.abs(h)+Wo(this.paint.get("line-translate"))}queryIntersectsFeature(l,o,c,h,g,b,x){const C=Md(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,x),D=x/2*Ld(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),A=this.paint.get("line-offset").evaluate(o,c);return A&&(h=function(P,L){const z=[];for(let U=0;U<P.length;U++){const $=P[U],Y=[];for(let W=0;W<$.length;W++){const se=$[W-1],ue=$[W],oe=$[W+1],he=0===W?new ut(0,0):ue.sub(se)._unit()._perp(),ge=W===$.length-1?new ut(0,0):oe.sub(ue)._unit()._perp(),Ce=he._add(ge)._unit(),Je=Ce.x*ge.x+Ce.y*ge.y;0!==Je&&Ce._mult(1/Je),Y.push(Ce._mult(L)._add(ue))}z.push(Y)}return z}(h,A*x)),function(P,L,z){for(let U=0;U<L.length;U++){const $=L[U];if(P.length>=3)for(let Y=0;Y<$.length;Y++)if(gu(P,$[Y]))return!0;if(Go(P,$,z))return!0}return!1}(C,h,D)}isTileClipped(){return!0}},symbol:rp,background:class extends zr{constructor(l){super(l,Lb)}},raster:class extends zr{constructor(l){super(l,Nb)}}};class op{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const sp=6371008.8;class $l{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $l(yo(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,h=this.lat*c,g=o.lat*c,b=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((o.lng-this.lng)*c);return sp*Math.acos(Math.min(b,1))}static convert(o){if(o instanceof $l)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new $l(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new $l(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const m_=2*Math.PI*sp;function wc(l){return m_*Math.cos(l*Math.PI/180)}function Pu(l){return(180+l)/360}function g_(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Bb(l,o){return l/wc(o)}function ap(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}class lp{constructor(o,c,h=0){this.x=+o,this.y=+c,this.z=+h}static fromLngLat(o,c=0){const h=$l.convert(o);return new lp(Pu(h.lng),g_(h.lat),Bb(c,h.lat))}toLngLat(){return new $l(360*this.x-180,ap(this.y))}toAltitude(){return this.z*wc(ap(this.y))}meterInMercatorCoordinateUnits(){return 1/m_*(o=ap(this.y),1/Math.cos(o*Math.PI/180));var o}}function zb(l,o,c){var h=2*Math.PI*6378137/256/Math.pow(2,c);return[l*h-2*Math.PI*6378137/2,o*h-2*Math.PI*6378137/2]}class nm{constructor(o,c,h){if(o<0||o>25||h<0||h>=Math.pow(2,o)||c<0||c>=Math.pow(2,o))throw new Error(`x=${c}, y=${h}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=c,this.y=h,this.key=Hl(0,o,o,c,h)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c,h){const g=(x=this.y,C=this.z,D=zb(256*(b=this.x),256*(x=Math.pow(2,C)-x-1),C),A=zb(256*(b+1),256*(x+1),C),D[0]+","+D[1]+","+A[0]+","+A[1]);var b,x,C,D,A;const P=function(L,z,U){let $,Y="";for(let W=L;W>0;W--)$=1<<W-1,Y+=(z&$?1:0)+(U&$?2:0);return Y}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===h?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,g)}isChildOf(o){const c=this.z-o.z;return c>0&&o.x===this.x>>c&&o.y===this.y>>c}getTilePoint(o){const c=Math.pow(2,this.z);return new ut((o.x*c-this.x)*Bn,(o.y*c-this.y)*Bn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class __{constructor(o,c){this.wrap=o,this.canonical=c,this.key=Hl(o,c.z,c.z,c.x,c.y)}}class Xo{constructor(o,c,h,g,b){if(o<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${h}`);this.overscaledZ=o,this.wrap=c,this.canonical=new nm(h,+g,+b),this.key=Hl(c,o,h,g,b)}clone(){return new Xo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-o;return o>this.canonical.z?new Xo(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xo(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-o;return o>this.canonical.z?Hl(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y):Hl(this.wrap*+c,o,o,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new Xo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new Xo(c,this.wrap,c,h,g),new Xo(c,this.wrap,c,h+1,g),new Xo(c,this.wrap,c,h,g+1),new Xo(c,this.wrap,c,h+1,g+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Xo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Xo(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new __(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new lp(o.x-this.wrap,o.y))}}function Hl(l,o,c,h,g){(l*=2)<0&&(l=-1*l-1);const b=1<<c;return(b*b*l+b*g+h).toString(36)+c.toString(36)+o.toString(36)}tt("CanonicalTileID",nm),tt("OverscaledTileID",Xo,{omit:["posMatrix"]});class im{constructor(o,c,h){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(h&&"mapbox"!==h&&"terrarium"!==h)return void mt(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const g=this.dim=c.height-2;this.data=new Uint32Array(c.data.buffer),this.encoding=h||"mapbox";for(let b=0;b<g;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(g,b)]=this.data[this._idx(g-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,g)]=this.data[this._idx(b,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let b=0;b<g;b++)for(let x=0;x<g;x++){const C=this.get(b,x);C>this.max&&(this.max=C),C<this.min&&(this.min=C)}}get(o,c){const h=new Uint8Array(this.data.buffer),g=4*this._idx(o,c);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(h[g],h[g+1],h[g+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}_unpackMapbox(o,c,h){return(256*o*256+256*c+h)/10-1e4}_unpackTerrarium(o,c,h){return 256*o+c+h/256-32768}getPixels(){return new Ko({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,c,h){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let g=c*this.dim,b=c*this.dim+this.dim,x=h*this.dim,C=h*this.dim+this.dim;switch(c){case-1:g=b-1;break;case 1:b=g+1}switch(h){case-1:x=C-1;break;case 1:C=x+1}const D=-c*this.dim,A=-h*this.dim;for(let P=x;P<C;P++)for(let L=g;L<b;L++)this.data[this._idx(L,P)]=o.data[this._idx(L+D,P+A)]}}tt("DEMData",im);class y_{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const h=o[c];this._stringToNumber[h]=c,this._numberToString[c]=h}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class rm{constructor(o,c,h,g,b){this.type="Feature",this._vectorTileFeature=o,o._z=c,o._x=h,o._y=g,this.properties=o.properties,this.id=b}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const c in this)"_geometry"!==c&&"_vectorTileFeature"!==c&&(o[c]=this[c]);return o}}class Vb{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new hc(Bn,16,0),this.grid3D=new hc(Bn,16,0),this.featureIndexArray=new j,this.promoteId=c}insert(o,c,h,g,b,x){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,b);const D=x?this.grid3D:this.grid;for(let A=0;A<c.length;A++){const P=c[A],L=[1/0,1/0,-1/0,-1/0];for(let z=0;z<P.length;z++){const U=P[z];L[0]=Math.min(L[0],U.x),L[1]=Math.min(L[1],U.y),L[2]=Math.max(L[2],U.x),L[3]=Math.max(L[3],U.y)}L[0]<Bn&&L[1]<Bn&&L[2]>=0&&L[3]>=0&&D.insert(C,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ol.VectorTile(new Za(this.rawTileData)).layers,this.sourceLayerCoder=new y_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,c,h,g){this.loadVTLayers();const b=o.params||{},x=Bn/o.tileSize/o.scale,C=gd(b.filter),D=o.queryGeometry,A=o.queryPadding*x,P=Ub(D),L=this.grid.query(P.minX-A,P.minY-A,P.maxX+A,P.maxY+A),z=Ub(o.cameraQueryGeometry),U=this.grid3D.query(z.minX-A,z.minY-A,z.maxX+A,z.maxY+A,(W,se,ue,oe)=>function(he,ge,Ce,Je,rt){for(const qe of he)if(ge<=qe.x&&Ce<=qe.y&&Je>=qe.x&&rt>=qe.y)return!0;const Xe=[new ut(ge,Ce),new ut(ge,rt),new ut(Je,rt),new ut(Je,Ce)];if(he.length>2)for(const qe of Xe)if(gu(he,qe))return!0;for(let qe=0;qe<he.length-1;qe++)if(xf(he[qe],he[qe+1],Xe))return!0;return!1}(o.cameraQueryGeometry,W-A,se-A,ue+A,oe+A));for(const W of U)L.push(W);L.sort(jb);const $={};let Y;for(let W=0;W<L.length;W++){const se=L[W];if(se===Y)continue;Y=se;const ue=this.featureIndexArray.get(se);let oe=null;this.loadMatchingFeature($,ue.bucketIndex,ue.sourceLayerIndex,ue.featureIndex,C,b.layers,b.availableImages,c,h,g,(he,ge,Ce)=>(oe||(oe=Ls(he)),ge.queryIntersectsFeature(D,he,Ce,oe,this.z,o.transform,x,o.pixelPosMatrix)))}return $}loadMatchingFeature(o,c,h,g,b,x,C,D,A,P,L){const z=this.bucketLayerIDs[c];if(x&&!function(W,se){for(let ue=0;ue<W.length;ue++)if(se.indexOf(W[ue])>=0)return!0;return!1}(x,z))return;const U=this.sourceLayerCoder.decode(h),$=this.vtLayers[U].feature(g);if(b.needGeometry){const W=Fl($,!0);if(!b.filter(new Le(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!b.filter(new Le(this.tileID.overscaledZ),$))return;const Y=this.getId($,U);for(let W=0;W<z.length;W++){const se=z[W];if(x&&x.indexOf(se)<0)continue;const ue=D[se];if(!ue)continue;let oe={};Y&&P&&(oe=P.getState(ue.sourceLayer||"_geojsonTileLayer",Y));const he=Ri({},A[se]);he.paint=om(he.paint,ue.paint,$,oe,C),he.layout=om(he.layout,ue.layout,$,oe,C);const ge=!L||L($,ue,oe);if(!ge)continue;const Ce=new rm($,this.z,this.x,this.y,Y);Ce.layer=he;let Je=o[se];void 0===Je&&(Je=o[se]=[]),Je.push({featureIndex:g,feature:Ce,intersectionZ:ge})}}lookupSymbolFeatures(o,c,h,g,b,x,C,D){const A={};this.loadVTLayers();const P=gd(b);for(const L of o)this.loadMatchingFeature(A,h,g,L,P,x,C,D,c);return A}hasLayer(o){for(const c of this.bucketLayerIDs)for(const h of c)if(o===h)return!0;return!1}getId(o,c){let h=o.id;return this.promoteId&&(h=o.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[c]],"boolean"==typeof h&&(h=Number(h))),h}}function om(l,o,c,h,g){return He(l,(b,x)=>{const C=o instanceof qo?o.get(x):null;return C&&C.evaluate?C.evaluate(c,h,g):C})}function Ub(l){let o=1/0,c=1/0,h=-1/0,g=-1/0;for(const b of l)o=Math.min(o,b.x),c=Math.min(c,b.y),h=Math.max(h,b.x),g=Math.max(g,b.y);return{minX:o,minY:c,maxX:h,maxY:g}}function jb(l,o){return o-l}function v_(l,o,c,h,g){const b=[];for(let x=0;x<l.length;x++){const C=l[x];let D;for(let A=0;A<C.length-1;A++){let P=C[A],L=C[A+1];P.x<o&&L.x<o||(P.x<o?P=new ut(o,P.y+(o-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x<o&&(L=new ut(o,P.y+(o-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y<c&&L.y<c||(P.y<c?P=new ut(P.x+(c-P.y)/(L.y-P.y)*(L.x-P.x),c)._round():L.y<c&&(L=new ut(P.x+(c-P.y)/(L.y-P.y)*(L.x-P.x),c)._round()),P.x>=h&&L.x>=h||(P.x>=h?P=new ut(h,P.y+(h-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x>=h&&(L=new ut(h,P.y+(h-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y>=g&&L.y>=g||(P.y>=g?P=new ut(P.x+(g-P.y)/(L.y-P.y)*(L.x-P.x),g)._round():L.y>=g&&(L=new ut(P.x+(g-P.y)/(L.y-P.y)*(L.x-P.x),g)._round()),D&&P.equals(D[D.length-1])||(D=[P],b.push(D)),D.push(L)))))}}return b}tt("FeatureIndex",Vb,{omit:["rawTileData","sourceLayerCoder"]});class Ea extends ut{constructor(o,c,h,g){super(o,c),this.angle=h,void 0!==g&&(this.segment=g)}clone(){return new Ea(this.x,this.y,this.angle,this.segment)}}function $b(l,o,c,h,g){if(void 0===o.segment)return!0;let b=o,x=o.segment+1,C=0;for(;C>-c/2;){if(x--,x<0)return!1;C-=l[x].dist(b),b=l[x]}C+=l[x].dist(l[x+1]),x++;const D=[];let A=0;for(;C<c/2;){const P=l[x],L=l[x+1];if(!L)return!1;let z=l[x-1].angleTo(P)-P.angleTo(L);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:C,angleDelta:z}),A+=z;C-D[0].distance>h;)A-=D.shift().angleDelta;if(A>g)return!1;x++,C+=P.dist(L)}return!0}function Hb(l){let o=0;for(let c=0;c<l.length-1;c++)o+=l[c].dist(l[c+1]);return o}function cp(l,o,c){return l?.6*o*c:0}function qb(l,o){return Math.max(l?l.right-l.left:0,o?o.right-o.left:0)}function ZE(l,o,c,h,g,b){const x=cp(c,g,b),C=qb(c,h)*b;let D=0;const A=Hb(l)/2;for(let P=0;P<l.length-1;P++){const L=l[P],z=l[P+1],U=L.dist(z);if(D+U>A){const $=(A-D)/U,Y=xo.number(L.x,z.x,$),W=xo.number(L.y,z.y,$),se=new Ea(Y,W,z.angleTo(L),P);return se._round(),!x||$b(l,se,C,x,o)?se:void 0}D+=U}}function KE(l,o,c,h,g,b,x,C,D){const A=cp(h,b,x),P=qb(h,g),L=P*x,z=0===l[0].x||l[0].x===D||0===l[0].y||l[0].y===D;return o-L<o/4&&(o=L+o/4),Gb(l,z?o/2*C%o:(P/2+2*b)*x*C%o,o,A,c,L,z,!1,D)}function Gb(l,o,c,h,g,b,x,C,D){const A=b/2,P=Hb(l);let L=0,z=o-c,U=[];for(let $=0;$<l.length-1;$++){const Y=l[$],W=l[$+1],se=Y.dist(W),ue=W.angleTo(Y);for(;z+c<L+se;){z+=c;const oe=(z-L)/se,he=xo.number(Y.x,W.x,oe),ge=xo.number(Y.y,W.y,oe);if(he>=0&&he<D&&ge>=0&&ge<D&&z-A>=0&&z+A<=P){const Ce=new Ea(he,ge,ue,$);Ce._round(),h&&!$b(l,Ce,b,h,g)||U.push(Ce)}}L+=se}return C||U.length||x||(U=Gb(l,L/2,c,h,g,b,x,!0,D)),U}tt("Anchor",Ea);const qd=Co;function b_(l,o,c,h){const g=[],b=l.image,x=b.pixelRatio,C=b.paddedRect.w-2*qd,D=b.paddedRect.h-2*qd,A=l.right-l.left,P=l.bottom-l.top,L=b.stretchX||[[0,C]],z=b.stretchY||[[0,D]],U=(Ue,Ze)=>Ue+Ze[1]-Ze[0],$=L.reduce(U,0),Y=z.reduce(U,0),W=C-$,se=D-Y;let ue=0,oe=$,he=0,ge=Y,Ce=0,Je=W,rt=0,Xe=se;if(b.content&&h){const Ue=b.content;ue=Ec(L,0,Ue[0]),he=Ec(z,0,Ue[1]),oe=Ec(L,Ue[0],Ue[2]),ge=Ec(z,Ue[1],Ue[3]),Ce=Ue[0]-ue,rt=Ue[1]-he,Je=Ue[2]-Ue[0]-oe,Xe=Ue[3]-Ue[1]-ge}const qe=(Ue,Ze,Ge,Fe)=>{const ft=Wd(Ue.stretch-ue,oe,A,l.left),st=Zd(Ue.fixed-Ce,Je,Ue.stretch,$),Ut=Wd(Ze.stretch-he,ge,P,l.top),zn=Zd(Ze.fixed-rt,Xe,Ze.stretch,Y),En=Wd(Ge.stretch-ue,oe,A,l.left),Mi=Zd(Ge.fixed-Ce,Je,Ge.stretch,$),Do=Wd(Fe.stretch-he,ge,P,l.top),Ir=Zd(Fe.fixed-rt,Xe,Fe.stretch,Y),zi=new ut(ft,Ut),_i=new ut(En,Ut),Mr=new ut(En,Do),Tr=new ut(ft,Do),Yr=new ut(st/x,zn/x),yi=new ut(Mi/x,Ir/x),Ki=o*Math.PI/180;if(Ki){const hr=Math.sin(Ki),Qr=Math.cos(Ki),Yn=[Qr,-hr,hr,Qr];zi._matMult(Yn),_i._matMult(Yn),Tr._matMult(Yn),Mr._matMult(Yn)}const Ar=Ue.stretch+Ue.fixed,dr=Ze.stretch+Ze.fixed;return{tl:zi,tr:_i,bl:Tr,br:Mr,tex:{x:b.paddedRect.x+qd+Ar,y:b.paddedRect.y+qd+dr,w:Ge.stretch+Ge.fixed-Ar,h:Fe.stretch+Fe.fixed-dr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yr,pixelOffsetBR:yi,minFontScaleX:Je/x/A,minFontScaleY:Xe/x/P,isSDF:c}};if(h&&(b.stretchX||b.stretchY)){const Ue=Gd(L,W,$),Ze=Gd(z,se,Y);for(let Ge=0;Ge<Ue.length-1;Ge++){const Fe=Ue[Ge],ft=Ue[Ge+1];for(let st=0;st<Ze.length-1;st++)g.push(qe(Fe,Ze[st],ft,Ze[st+1]))}}else g.push(qe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:D+1}));return g}function Ec(l,o,c){let h=0;for(const g of l)h+=Math.max(o,Math.min(c,g[1]))-Math.max(o,Math.min(c,g[0]));return h}function Gd(l,o,c){const h=[{fixed:-qd,stretch:0}];for(const[g,b]of l){const x=h[h.length-1];h.push({fixed:g-x.stretch,stretch:x.stretch}),h.push({fixed:g-x.stretch,stretch:x.stretch+(b-g)})}return h.push({fixed:o+qd,stretch:c}),h}function Wd(l,o,c,h){return l/o*c+h}function Zd(l,o,c,h){return l-o*c/h}class Kd{constructor(o,c,h,g,b,x,C,D,A,P){if(this.boxStartIndex=o.length,A){let L=x.top,z=x.bottom;const U=x.collisionPadding;U&&(L-=U[1],z+=U[3]);let $=z-L;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{let L=x.top*C-D[0],z=x.bottom*C+D[2],U=x.left*C-D[3],$=x.right*C+D[1];const Y=x.collisionPadding;if(Y&&(U-=Y[0]*C,L-=Y[1]*C,$+=Y[2]*C,z+=Y[3]*C),P){const W=new ut(U,L),se=new ut($,L),ue=new ut(U,z),oe=new ut($,z),he=P*Math.PI/180;W._rotate(he),se._rotate(he),ue._rotate(he),oe._rotate(he),U=Math.min(W.x,se.x,ue.x,oe.x),$=Math.max(W.x,se.x,ue.x,oe.x),L=Math.min(W.y,se.y,ue.y,oe.y),z=Math.max(W.y,se.y,ue.y,oe.y)}o.emplaceBack(c.x,c.y,U,L,$,z,h,g,b)}this.boxEndIndex=o.length}}class Fu{constructor(o=[],c=x_){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:h}=this,g=c[o];for(;o>0;){const b=o-1>>1,x=c[b];if(h(g,x)>=0)break;c[o]=x,o=b}c[o]=g}_down(o){const{data:c,compare:h}=this,g=this.length>>1,b=c[o];for(;o<g;){let x=1+(o<<1),C=c[x];const D=x+1;if(D<this.length&&h(c[D],C)<0&&(x=D,C=c[D]),h(C,b)>=0)break;c[o]=C,o=x}c[o]=b}}function x_(l,o){return l<o?-1:l>o?1:0}function w_(l,o=1,c=!1){let h=1/0,g=1/0,b=-1/0,x=-1/0;const C=l[0];for(let U=0;U<C.length;U++){const $=C[U];(!U||$.x<h)&&(h=$.x),(!U||$.y<g)&&(g=$.y),(!U||$.x>b)&&(b=$.x),(!U||$.y>x)&&(x=$.y)}const D=Math.min(b-h,x-g);let A=D/2;const P=new Fu([],up);if(0===D)return new ut(h,g);for(let U=h;U<b;U+=D)for(let $=g;$<x;$+=D)P.push(new Ya(U+A,$+A,A,l));let L=function(U){let $=0,Y=0,W=0;const se=U[0];for(let ue=0,oe=se.length,he=oe-1;ue<oe;he=ue++){const ge=se[ue],Ce=se[he],Je=ge.x*Ce.y-Ce.x*ge.y;Y+=(ge.x+Ce.x)*Je,W+=(ge.y+Ce.y)*Je,$+=3*Je}return new Ya(Y/$,W/$,0,U)}(l),z=P.length;for(;P.length;){const U=P.pop();(U.d>L.d||!L.d)&&(L=U,c&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,z)),U.max-L.d<=o||(A=U.h/2,P.push(new Ya(U.p.x-A,U.p.y-A,A,l)),P.push(new Ya(U.p.x+A,U.p.y-A,A,l)),P.push(new Ya(U.p.x-A,U.p.y+A,A,l)),P.push(new Ya(U.p.x+A,U.p.y+A,A,l)),z+=4)}return c&&(console.log(`num probes: ${z}`),console.log(`best distance: ${L.d}`)),L.p}function up(l,o){return o.max-l.max}function Ya(l,o,c,h){this.p=new ut(l,o),this.h=c,this.d=function(g,b){let x=!1,C=1/0;for(let D=0;D<b.length;D++){const A=b[D];for(let P=0,L=A.length,z=L-1;P<L;z=P++){const U=A[P],$=A[z];U.y>g.y!=$.y>g.y&&g.x<($.x-U.x)*(g.y-U.y)/($.y-U.y)+U.x&&(x=!x),C=Math.min(C,vf(g,U,$))}}return(x?1:-1)*Math.sqrt(C)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const Ca=Number.POSITIVE_INFINITY;function E_(l,o){return o[1]!==Ca?function(c,h,g){let b=0,x=0;switch(h=Math.abs(h),g=Math.abs(g),c){case"top-right":case"top-left":case"top":x=g-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-g}switch(c){case"top-right":case"bottom-right":case"right":b=-h;break;case"top-left":case"bottom-left":case"left":b=h}return[b,x]}(l,o[0],o[1]):function(c,h){let g=0,b=0;h<0&&(h=0);const x=h/Math.sqrt(2);switch(c){case"top-right":case"top-left":b=x-7;break;case"bottom-right":case"bottom-left":b=7-x;break;case"bottom":b=7-h;break;case"top":b=h-7}switch(c){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=h;break;case"right":g=-h}return[g,b]}(l,o[0])}function sm(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Wb(l,o,c,h,g,b,x,C,D,A,P){let L=b.textMaxSize.evaluate(o,{});void 0===L&&(L=x);const z=l.layers[0].layout,U=z.get("icon-offset").evaluate(o,{},P),$=dp(c.horizontal),Y=x/24,W=l.tilePixelRatio*Y,se=l.tilePixelRatio*L/24,ue=l.tilePixelRatio*C,oe=l.tilePixelRatio*z.get("symbol-spacing"),he=z.get("text-padding")*l.tilePixelRatio,ge=function(Fe,ft,st,Ut=1){const zn=Fe.get("icon-padding").evaluate(ft,{},st),En=zn&&zn.values;return[En[0]*Ut,En[1]*Ut,En[2]*Ut,En[3]*Ut]}(z,o,P,l.tilePixelRatio),Ce=z.get("text-max-angle")/180*Math.PI,Je="viewport"!==z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),rt="map"===z.get("icon-rotation-alignment")&&"point"!==z.get("symbol-placement"),Xe=z.get("symbol-placement"),qe=oe/2,Ue=z.get("icon-text-fit");let Ze;h&&"none"!==Ue&&(l.allowVerticalPlacement&&c.vertical&&(Ze=Au(h,c.vertical,Ue,z.get("icon-text-fit-padding"),U,Y)),$&&(h=Au(h,$,Ue,z.get("icon-text-fit-padding"),U,Y)));const Ge=(Fe,ft)=>{ft.x<0||ft.x>=Bn||ft.y<0||ft.y>=Bn||function(st,Ut,zn,En,Mi,Do,Ir,zi,_i,Mr,Tr,Yr,yi,Ki,Ar,dr,hr,Qr,Yn,Vi,qt,Jr,Ti,$r,Yo){const Bs=st.addToLineVertexArray(Ut,zn);let zs,Qa,Qo,Io,kr=0,Vs=0,Sa=0,D_=0,cm=-1,I_=-1;const Ja={};let _p=ai(""),um=0,ql=0;if(void 0===zi._unevaluatedLayout.getValue("text-radial-offset")?[um,ql]=zi.layout.get("text-offset").evaluate(qt,{},$r).map(li=>li*Di):(um=zi.layout.get("text-radial-offset").evaluate(qt,{},$r)*Di,ql=Ca),st.allowVerticalPlacement&&En.vertical){const li=zi.layout.get("text-rotate").evaluate(qt,{},$r)+90;Qo=new Kd(_i,Ut,Mr,Tr,Yr,En.vertical,yi,Ki,Ar,li),Ir&&(Io=new Kd(_i,Ut,Mr,Tr,Yr,Ir,hr,Qr,Ar,li))}if(Mi){const li=zi.layout.get("icon-rotate").evaluate(qt,{}),Da="none"!==zi.layout.get("icon-text-fit"),Qd=b_(Mi,li,Ti,Da),Jd=Ir?b_(Ir,li,Ti,Da):void 0;Qa=new Kd(_i,Ut,Mr,Tr,Yr,Mi,hr,Qr,!1,li),kr=4*Qd.length;const k_=st.iconSizeData;let Dc=null;"source"===k_.kind?(Dc=[Xa*zi.layout.get("icon-size").evaluate(qt,{})],Dc[0]>jl&&mt(`${st.layerIds[0]}: Value for "icon-size" is >= ${Ud}. Reduce your "icon-size".`)):"composite"===k_.kind&&(Dc=[Xa*Jr.compositeIconSizes[0].evaluate(qt,{},$r),Xa*Jr.compositeIconSizes[1].evaluate(qt,{},$r)],(Dc[0]>jl||Dc[1]>jl)&&mt(`${st.layerIds[0]}: Value for "icon-size" is >= ${Ud}. Reduce your "icon-size".`)),st.addSymbols(st.icon,Qd,Dc,Vi,Yn,qt,v.WritingMode.none,Ut,Bs.lineStartIndex,Bs.lineLength,-1,$r),cm=st.icon.placedSymbolArray.length-1,Jd&&(Vs=4*Jd.length,st.addSymbols(st.icon,Jd,Dc,Vi,Yn,qt,v.WritingMode.vertical,Ut,Bs.lineStartIndex,Bs.lineLength,-1,$r),I_=st.icon.placedSymbolArray.length-1)}const Yd=Object.keys(En.horizontal);for(const li of Yd){const Da=En.horizontal[li];if(!zs){_p=ai(Da.text);const Jd=zi.layout.get("text-rotate").evaluate(qt,{},$r);zs=new Kd(_i,Ut,Mr,Tr,Yr,Da,yi,Ki,Ar,Jd)}const Qd=1===Da.positionedLines.length;if(Sa+=am(st,Ut,Da,Do,zi,Ar,qt,dr,Bs,En.vertical?v.WritingMode.horizontal:v.WritingMode.horizontalOnly,Qd?Yd:[li],Ja,cm,Jr,$r),Qd)break}En.vertical&&(D_+=am(st,Ut,En.vertical,Do,zi,Ar,qt,dr,Bs,v.WritingMode.vertical,["vertical"],Ja,I_,Jr,$r));const dm=zs?zs.boxStartIndex:st.collisionBoxArray.length,M_=zs?zs.boxEndIndex:st.collisionBoxArray.length,T_=Qo?Qo.boxStartIndex:st.collisionBoxArray.length,A_=Qo?Qo.boxEndIndex:st.collisionBoxArray.length,Sc=Qa?Qa.boxStartIndex:st.collisionBoxArray.length,Xb=Qa?Qa.boxEndIndex:st.collisionBoxArray.length,Yb=Io?Io.boxStartIndex:st.collisionBoxArray.length,Qb=Io?Io.boxEndIndex:st.collisionBoxArray.length;let Us=-1;const yp=(li,Da)=>li&&li.circleDiameter?Math.max(li.circleDiameter,Da):Da;Us=yp(zs,Us),Us=yp(Qo,Us),Us=yp(Qa,Us),Us=yp(Io,Us);const Mo=Us>-1?1:0;Mo&&(Us*=Yo/Di),st.glyphOffsetArray.length>=Ru.MAX_GLYPHS&&mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==qt.sortKey&&st.addToSortKeyRanges(st.symbolInstances.length,qt.sortKey),st.symbolInstances.emplaceBack(Ut.x,Ut.y,Ja.right>=0?Ja.right:-1,Ja.center>=0?Ja.center:-1,Ja.left>=0?Ja.left:-1,Ja.vertical||-1,cm,I_,_p,dm,M_,T_,A_,Sc,Xb,Yb,Qb,Mr,Sa,D_,kr,Vs,Mo,0,yi,um,ql,Us)}(l,ft,Fe,c,h,g,Ze,l.layers[0],l.collisionBoxArray,o.index,o.sourceLayerIndex,l.index,W,[he,he,he,he],Je,D,ue,ge,rt,U,o,b,A,P,x)};if("line"===Xe)for(const Fe of v_(o.geometry,0,0,Bn,Bn)){const ft=KE(Fe,oe,Ce,c.vertical||$,h,24,se,l.overscaling,Bn);for(const st of ft)$&&Zb(l,$.text,qe,st)||Ge(Fe,st)}else if("line-center"===Xe){for(const Fe of o.geometry)if(Fe.length>1){const ft=ZE(Fe,Ce,c.vertical||$,h,24,se);ft&&Ge(Fe,ft)}}else if("Polygon"===o.type)for(const Fe of Wh(o.geometry,0)){const ft=w_(Fe,16);Ge(Fe[0],new Ea(ft.x,ft.y,0))}else if("LineString"===o.type)for(const Fe of o.geometry)Ge(Fe,new Ea(Fe[0].x,Fe[0].y,0));else if("Point"===o.type)for(const Fe of o.geometry)for(const ft of Fe)Ge([ft],new Ea(ft.x,ft.y,0))}function am(l,o,c,h,g,b,x,C,D,A,P,L,z,U,$){const Y=function(ue,oe,he,ge,Ce,Je,rt,Xe){const qe=ge.layout.get("text-rotate").evaluate(Je,{})*Math.PI/180,Ue=[];for(const Ze of oe.positionedLines)for(const Ge of Ze.positionedGlyphs){if(!Ge.rect)continue;const Fe=Ge.rect||{};let ft=Jh+1,st=!0,Ut=1,zn=0;const En=(Ce||Xe)&&Ge.vertical,Mi=Ge.metrics.advance*Ge.scale/2;if(Xe&&oe.verticalizable&&(zn=Ze.lineOffset/2-(Ge.imageName?-(Di-Ge.metrics.width*Ge.scale)/2:(Ge.scale-1)*Di)),Ge.imageName){const Yn=rt[Ge.imageName];st=Yn.sdf,Ut=Yn.pixelRatio,ft=Co/Ut}const Do=Ce?[Ge.x+Mi,Ge.y]:[0,0];let Ir=Ce?[0,0]:[Ge.x+Mi+he[0],Ge.y+he[1]-zn],zi=[0,0];En&&(zi=Ir,Ir=[0,0]);const _i=(Ge.metrics.left-ft)*Ge.scale-Mi+Ir[0],Mr=(-Ge.metrics.top-ft)*Ge.scale+Ir[1],Tr=_i+Fe.w*Ge.scale/Ut,Yr=Mr+Fe.h*Ge.scale/Ut,yi=new ut(_i,Mr),Ki=new ut(Tr,Mr),Ar=new ut(_i,Yr),dr=new ut(Tr,Yr);if(En){const Yn=new ut(-Mi,Mi-ep),Vi=-Math.PI/2,qt=Di/2-Mi,Jr=new ut(5-ep-qt,-(Ge.imageName?qt:0)),Ti=new ut(...zi);yi._rotateAround(Vi,Yn)._add(Jr)._add(Ti),Ki._rotateAround(Vi,Yn)._add(Jr)._add(Ti),Ar._rotateAround(Vi,Yn)._add(Jr)._add(Ti),dr._rotateAround(Vi,Yn)._add(Jr)._add(Ti)}if(qe){const Yn=Math.sin(qe),Vi=Math.cos(qe),qt=[Vi,-Yn,Yn,Vi];yi._matMult(qt),Ki._matMult(qt),Ar._matMult(qt),dr._matMult(qt)}const hr=new ut(0,0),Qr=new ut(0,0);Ue.push({tl:yi,tr:Ki,bl:Ar,br:dr,tex:Fe,writingMode:oe.writingMode,glyphOffset:Do,sectionIndex:Ge.sectionIndex,isSDF:st,pixelOffsetTL:hr,pixelOffsetBR:Qr,minFontScaleX:0,minFontScaleY:0})}return Ue}(0,c,C,g,b,x,h,l.allowVerticalPlacement),W=l.textSizeData;let se=null;"source"===W.kind?(se=[Xa*g.layout.get("text-size").evaluate(x,{})],se[0]>jl&&mt(`${l.layerIds[0]}: Value for "text-size" is >= ${Ud}. Reduce your "text-size".`)):"composite"===W.kind&&(se=[Xa*U.compositeTextSizes[0].evaluate(x,{},$),Xa*U.compositeTextSizes[1].evaluate(x,{},$)],(se[0]>jl||se[1]>jl)&&mt(`${l.layerIds[0]}: Value for "text-size" is >= ${Ud}. Reduce your "text-size".`)),l.addSymbols(l.text,Y,se,C,b,x,A,o,D.lineStartIndex,D.lineLength,z,$);for(const ue of P)L[ue]=l.text.placedSymbolArray.length-1;return 4*Y.length}function dp(l){for(const o in l)return l[o];return null}function Zb(l,o,c,h){const g=l.compareText;if(o in g){const b=g[o];for(let x=b.length-1;x>=0;x--)if(h.dist(b[x])<c)return!0}else g[o]=[];return g[o].push(h),!1}const C_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class lm{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,h]=new Uint8Array(o,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(1!==g)throw new Error(`Got v${g} data when expected v1.`);const b=C_[15&h];if(!b)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(o,2,1),[C]=new Uint32Array(o,4,1);return new lm(C,x,b,o)}constructor(o,c=64,h=Float64Array,g){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=h,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const b=C_.indexOf(this.ArrayType),x=2*o*this.ArrayType.BYTES_PER_ELEMENT,C=o*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-C%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+C+D,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+x+C+D),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+C+D,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=o)}add(o,c){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=o,this.coords[this._pos++]=c,h}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return hp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,c,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:x,nodeSize:C}=this,D=[0,b.length-1,0],A=[];for(;D.length;){const P=D.pop()||0,L=D.pop()||0,z=D.pop()||0;if(L-z<=C){for(let W=z;W<=L;W++){const se=x[2*W],ue=x[2*W+1];se>=o&&se<=h&&ue>=c&&ue<=g&&A.push(b[W])}continue}const U=z+L>>1,$=x[2*U],Y=x[2*U+1];$>=o&&$<=h&&Y>=c&&Y<=g&&A.push(b[U]),(0===P?o<=$:c<=Y)&&(D.push(z),D.push(U-1),D.push(1-P)),(0===P?h>=$:g>=Y)&&(D.push(U+1),D.push(L),D.push(1-P))}return A}within(o,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:x}=this,C=[0,g.length-1,0],D=[],A=h*h;for(;C.length;){const P=C.pop()||0,L=C.pop()||0,z=C.pop()||0;if(L-z<=x){for(let W=z;W<=L;W++)pp(b[2*W],b[2*W+1],o,c)<=A&&D.push(g[W]);continue}const U=z+L>>1,$=b[2*U],Y=b[2*U+1];pp($,Y,o,c)<=A&&D.push(g[U]),(0===P?o-h<=$:c-h<=Y)&&(C.push(z),C.push(U-1),C.push(1-P)),(0===P?o+h>=$:c+h>=Y)&&(C.push(U+1),C.push(L),C.push(1-P))}return D}}function hp(l,o,c,h,g,b){if(g-h<=c)return;const x=h+g>>1;S_(l,o,x,h,g,b),hp(l,o,c,h,x-1,1-b),hp(l,o,c,x+1,g,1-b)}function S_(l,o,c,h,g,b){for(;g>h;){if(g-h>600){const A=g-h+1,P=c-h+1,L=Math.log(A),z=.5*Math.exp(2*L/3),U=.5*Math.sqrt(L*z*(A-z)/A)*(P-A/2<0?-1:1);S_(l,o,c,Math.max(h,Math.floor(c-P*z/A+U)),Math.min(g,Math.floor(c+(A-P)*z/A+U)),b)}const x=o[2*c+b];let C=h,D=g;for(Xd(l,o,h,c),o[2*g+b]>x&&Xd(l,o,h,g);C<D;){for(Xd(l,o,C,D),C++,D--;o[2*C+b]<x;)C++;for(;o[2*D+b]>x;)D--}o[2*h+b]===x?Xd(l,o,h,D):(D++,Xd(l,o,D,g)),D<=c&&(h=D+1),c<=D&&(g=D-1)}}function Xd(l,o,c,h){Xr(l,c,h),Xr(o,2*c,2*h),Xr(o,2*c+1,2*h+1)}function Xr(l,o,c){const h=l[o];l[o]=l[c],l[c]=h}function pp(l,o,c,h){const g=l-c,b=o-h;return g*g+b*b}var fp;v.PerformanceMarkers=void 0,(fp=v.PerformanceMarkers||(v.PerformanceMarkers={})).create="create",fp.load="load",fp.fullLoad="fullLoad";let Ou=null,Zi=[];const Cc=1e3/60,mp="loadTime",gp="fullLoadTime",Kb={mark(l){performance.mark(l)},frame(l){const o=l;null!=Ou&&Zi.push(o-Ou),Ou=o},clearMetrics(){Ou=null,Zi=[],performance.clearMeasures(mp),performance.clearMeasures(gp);for(const l in v.PerformanceMarkers)performance.clearMarks(v.PerformanceMarkers[l])},getPerformanceMetrics(){performance.measure(mp,v.PerformanceMarkers.create,v.PerformanceMarkers.load),performance.measure(gp,v.PerformanceMarkers.create,v.PerformanceMarkers.fullLoad);const l=performance.getEntriesByName(mp)[0].duration,o=performance.getEntriesByName(gp)[0].duration,c=Zi.length,h=1/(Zi.reduce((b,x)=>b+x,0)/c/1e3),g=Zi.filter(b=>b>Cc).reduce((b,x)=>b+(x-Cc)/Cc,0);return{loadTime:l,fullLoadTime:o,fps:h,percentDroppedFrames:g/(c+g)*100,totalFrames:c}}};v.AJAXError=Xs,v.ARRAY_TYPE=lr,v.Actor=class{constructor(l,o,c){this.target=l,this.parent=o,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Lo(["receive","process"],this),this.invoker=new op(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zn()?l:window}send(l,o,c,h,g=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[b]=c);const x=No(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:l,hasCallback:!!c,targetMapId:h,mustQueue:g,sourceMapId:this.mapId,data:Tl(o,x)},x),{cancel:()=>{c&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(l){const o=l.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){delete this.tasks[c];const h=this.cancelCallbacks[c];delete this.cancelCallbacks[c],h&&h()}else Zn()||o.mustQueue?(this.tasks[c]=o,this.taskQueue.push(c),this.invoker.trigger()):this.processTask(c,o)}process(){if(!this.taskQueue.length)return;const l=this.taskQueue.shift(),o=this.tasks[l];delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(l,o)}processTask(l,o){if("<response>"===o.type){const c=this.callbacks[l];delete this.callbacks[l],c&&(o.error?c(As(o.error)):c(null,As(o.data)))}else{let c=!1;const h=No(this.globalScope)?void 0:[],g=o.hasCallback?(C,D)=>{c=!0,delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:C?Tl(C):null,data:Tl(D,h)},h)}:C=>{c=!0};let b=null;const x=As(o.data);if(this.parent[o.type])b=this.parent[o.type](o.sourceMapId,x,g);else if(this.parent.getWorkerSource){const C=o.type.split(".");b=this.parent.getWorkerSource(o.sourceMapId,C[0],x.source)[C[1]](x,g)}else g(new Error(`Could not find function ${o.type}`));!c&&b&&b.cancel&&(this.cancelCallbacks[l]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},v.AlphaImage=_u,v.CanonicalTileID=nm,v.CollisionBoxArray=_,v.CollisionCircleLayoutArray=class extends sr{},v.Color=xt,v.DEMData=im,v.DataConstantProperty=nt,v.DictionaryCoder=y_,v.EXTENT=Bn,v.ErrorEvent=qr,v.EvaluationParameters=Le,v.Event=wt,v.Evented=fl,v.FeatureIndex=Vb,v.FillBucket=Fd,v.FillExtrusionBucket=bu,v.GeoJSONFeature=rm,v.ImageAtlas=kb,v.ImagePosition=Kf,v.KDBush=lm,v.LineBucket=t_,v.LineStripIndexArray=class extends s{},v.LngLat=$l,v.MercatorCoordinate=lp,v.ONE_EM=Di,v.OverscaledTileID=Xo,v.PerformanceUtils=Kb,v.Point=ut,v.Pos3dArray=class extends ua{},v.PosArray=K,v.Properties=un,v.Protobuf=Za,v.QuadTriangleArray=class extends Rl{},v.RGBAImage=Ko,v.RasterBoundsArray=class extends Zt{},v.RequestPerformance=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return 0===l.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},v.SegmentVector=$e,v.SymbolBucket=Ru,v.Transitionable=Eo,v.TriangleIndexArray=ke,v.Uniform1f=Os,v.Uniform1i=class extends Dr{constructor(l,o){super(l,o),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},v.Uniform2f=class extends Dr{constructor(l,o){super(l,o),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},v.Uniform3f=class extends Dr{constructor(l,o){super(l,o),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},v.Uniform4f=mu,v.UniformColor=Ur,v.UniformMatrix4f=class extends Dr{constructor(l,o){super(l,o),this.current=qi}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let o=1;o<16;o++)if(l[o]!==this.current[o]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},v.UnwrappedTileID=__,v.ValidationError=je,v.ZoomHistory=Bh,v.addDynamicAttributes=ip,v.arrayBufferToImage=function(l,o){const c=new Image;c.onload=()=>{o(null,c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=vr})},c.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(l)],{type:"image/png"});c.src=l.byteLength?URL.createObjectURL(h):vr},v.arrayBufferToImageBitmap=function(l,o){const c=new Blob([new Uint8Array(l)],{type:"image/png"});createImageBitmap(c).then(h=>{o(null,h)}).catch(h=>{o(new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},v.asyncAll=function(l,o,c){if(!l.length)return c(null,[]);let h=l.length;const g=new Array(l.length);let b=null;l.forEach((x,C)=>{o(x,(D,A)=>{D&&(b=D),g[C]=A,0==--h&&c(b,g)})})},v.bezier=no,v.bindAll=Lo,v.clamp=qn,v.clipLine=v_,v.clone=function(l){var o=new lr(16);return o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3],o[4]=l[4],o[5]=l[5],o[6]=l[6],o[7]=l[7],o[8]=l[8],o[9]=l[9],o[10]=l[10],o[11]=l[11],o[12]=l[12],o[13]=l[13],o[14]=l[14],o[15]=l[15],o},v.clone$1=We,v.collisionCircleLayout=xa,v.config=pl,v.copy=function(l,o){return l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[3],l[4]=o[4],l[5]=o[5],l[6]=o[6],l[7]=o[7],l[8]=o[8],l[9]=o[9],l[10]=o[10],l[11]=o[11],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15],l},v.create=function(){var l=new lr(16);return lr!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},v.createExpression=ti,v.createFilter=gd,v.createLayout=Nn,v.createStyleLayer=function(l){return"custom"===l.type?new f_(l):new tm[l.type](l)},v.deepEqual=function l(o,c){if(Array.isArray(o)){if(!Array.isArray(c)||o.length!==c.length)return!1;for(let h=0;h<o.length;h++)if(!l(o[h],c[h]))return!1;return!0}if("object"==typeof o&&null!==o&&null!==c){if("object"!=typeof c||Object.keys(o).length!==Object.keys(c).length)return!1;for(const h in o)if(!l(o[h],c[h]))return!1;return!0}return o===c},v.derefLayers=function(l){l=l.slice();const o=Object.create(null);for(let c=0;c<l.length;c++)o[l[c].id]=l[c];for(let c=0;c<l.length;c++)"ref"in l[c]&&(l[c]=ic(l[c],o[l[c].ref]));return l},v.diffStyles=function(l,o){if(!l)return[{command:pn.setStyle,args:[o]}];let c=[];try{if(!Fn(l.version,o.version))return[{command:pn.setStyle,args:[o]}];Fn(l.center,o.center)||c.push({command:pn.setCenter,args:[o.center]}),Fn(l.zoom,o.zoom)||c.push({command:pn.setZoom,args:[o.zoom]}),Fn(l.bearing,o.bearing)||c.push({command:pn.setBearing,args:[o.bearing]}),Fn(l.pitch,o.pitch)||c.push({command:pn.setPitch,args:[o.pitch]}),Fn(l.sprite,o.sprite)||c.push({command:pn.setSprite,args:[o.sprite]}),Fn(l.glyphs,o.glyphs)||c.push({command:pn.setGlyphs,args:[o.glyphs]}),Fn(l.transition,o.transition)||c.push({command:pn.setTransition,args:[o.transition]}),Fn(l.light,o.light)||c.push({command:pn.setLight,args:[o.light]});const h={},g=[];!function(x,C,D,A){let P;for(P in C=C||{},x=x||{})Object.prototype.hasOwnProperty.call(x,P)&&(Object.prototype.hasOwnProperty.call(C,P)||Gc(P,D,A));for(P in C)Object.prototype.hasOwnProperty.call(C,P)&&(Object.prototype.hasOwnProperty.call(x,P)?Fn(x[P],C[P])||("geojson"===x[P].type&&"geojson"===C[P].type&&vi(x,C,P)?D.push({command:pn.setGeoJSONSourceData,args:[P,C[P].data]}):rd(P,C,D,A)):ml(P,C,D))}(l.sources,o.sources,g,h);const b=[];l.layers&&l.layers.forEach(x=>{h[x.source]?c.push({command:pn.removeLayer,args:[x.id]}):b.push(x)}),c=c.concat(g),function(x,C,D){C=C||[];const A=(x=x||[]).map(gl),P=C.map(gl),L=x.reduce(ws,{}),z=C.reduce(ws,{}),U=A.slice(),$=Object.create(null);let Y,W,se,ue,oe,he,ge;for(Y=0,W=0;Y<A.length;Y++)se=A[Y],Object.prototype.hasOwnProperty.call(z,se)?W++:(D.push({command:pn.removeLayer,args:[se]}),U.splice(U.indexOf(se,W),1));for(Y=0,W=0;Y<P.length;Y++)se=P[P.length-1-Y],U[U.length-1-Y]!==se&&(Object.prototype.hasOwnProperty.call(L,se)?(D.push({command:pn.removeLayer,args:[se]}),U.splice(U.lastIndexOf(se,U.length-W),1)):W++,he=U[U.length-Y],D.push({command:pn.addLayer,args:[z[se],he]}),U.splice(U.length-Y,0,se),$[se]=!0);for(Y=0;Y<P.length;Y++)if(se=P[Y],ue=L[se],oe=z[se],!$[se]&&!Fn(ue,oe))if(Fn(ue.source,oe.source)&&Fn(ue["source-layer"],oe["source-layer"])&&Fn(ue.type,oe.type)){for(ge in Qs(ue.layout,oe.layout,D,se,null,pn.setLayoutProperty),Qs(ue.paint,oe.paint,D,se,null,pn.setPaintProperty),Fn(ue.filter,oe.filter)||D.push({command:pn.setFilter,args:[se,oe.filter]}),Fn(ue.minzoom,oe.minzoom)&&Fn(ue.maxzoom,oe.maxzoom)||D.push({command:pn.setLayerZoomRange,args:[se,oe.minzoom,oe.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,ge)&&"layout"!==ge&&"paint"!==ge&&"filter"!==ge&&"metadata"!==ge&&"minzoom"!==ge&&"maxzoom"!==ge&&(0===ge.indexOf("paint.")?Qs(ue[ge],oe[ge],D,se,ge.slice(6),pn.setPaintProperty):Fn(ue[ge],oe[ge])||D.push({command:pn.setLayerProperty,args:[se,ge,oe[ge]]}));for(ge in oe)Object.prototype.hasOwnProperty.call(oe,ge)&&!Object.prototype.hasOwnProperty.call(ue,ge)&&"layout"!==ge&&"paint"!==ge&&"filter"!==ge&&"metadata"!==ge&&"minzoom"!==ge&&"maxzoom"!==ge&&(0===ge.indexOf("paint.")?Qs(ue[ge],oe[ge],D,se,ge.slice(6),pn.setPaintProperty):Fn(ue[ge],oe[ge])||D.push({command:pn.setLayerProperty,args:[se,ge,oe[ge]]}))}else D.push({command:pn.removeLayer,args:[se]}),he=U[U.lastIndexOf(se)+1],D.push({command:pn.addLayer,args:[oe,he]})}(b,o.layers,c)}catch(h){console.warn("Unable to compute style diff:",h),c=[{command:pn.setStyle,args:[o]}]}return c},v.dot=function(l,o){return l[0]*o[0]+l[1]*o[1]+l[2]*o[2]+l[3]*o[3]},v.earthRadius=sp,v.ease=rs,v.emitValidationErrors=Ha,v.emptyStyle=function(){const l={},o=we.$version;for(const c in we.$root){const h=we.$root[c];if(h.required){let g=null;g="version"===c?o:"array"===h.type?[]:{},null!=g&&(l[c]=g)}}return l},v.equals=function(l,o){var c=l[0],h=l[1],g=l[2],b=l[3],x=l[4],C=l[5],D=l[6],A=l[7],P=l[8],L=l[9],z=l[10],U=l[11],$=l[12],Y=l[13],W=l[14],se=l[15],ue=o[0],oe=o[1],he=o[2],ge=o[3],Ce=o[4],Je=o[5],rt=o[6],Xe=o[7],qe=o[8],Ue=o[9],Ze=o[10],Ge=o[11],Fe=o[12],ft=o[13],st=o[14],Ut=o[15];return Math.abs(c-ue)<=ar*Math.max(1,Math.abs(c),Math.abs(ue))&&Math.abs(h-oe)<=ar*Math.max(1,Math.abs(h),Math.abs(oe))&&Math.abs(g-he)<=ar*Math.max(1,Math.abs(g),Math.abs(he))&&Math.abs(b-ge)<=ar*Math.max(1,Math.abs(b),Math.abs(ge))&&Math.abs(x-Ce)<=ar*Math.max(1,Math.abs(x),Math.abs(Ce))&&Math.abs(C-Je)<=ar*Math.max(1,Math.abs(C),Math.abs(Je))&&Math.abs(D-rt)<=ar*Math.max(1,Math.abs(D),Math.abs(rt))&&Math.abs(A-Xe)<=ar*Math.max(1,Math.abs(A),Math.abs(Xe))&&Math.abs(P-qe)<=ar*Math.max(1,Math.abs(P),Math.abs(qe))&&Math.abs(L-Ue)<=ar*Math.max(1,Math.abs(L),Math.abs(Ue))&&Math.abs(z-Ze)<=ar*Math.max(1,Math.abs(z),Math.abs(Ze))&&Math.abs(U-Ge)<=ar*Math.max(1,Math.abs(U),Math.abs(Ge))&&Math.abs($-Fe)<=ar*Math.max(1,Math.abs($),Math.abs(Fe))&&Math.abs(Y-ft)<=ar*Math.max(1,Math.abs(Y),Math.abs(ft))&&Math.abs(W-st)<=ar*Math.max(1,Math.abs(W),Math.abs(st))&&Math.abs(se-Ut)<=ar*Math.max(1,Math.abs(se),Math.abs(Ut))},v.evaluateSizeForFeature=function(l,{uSize:o,uSizeT:c},{lowerSize:h,upperSize:g}){return"source"===l.kind?h/Xa:"composite"===l.kind?xo.number(h/Xa,g/Xa,c):o},v.evaluateSizeForZoom=function(l,o){let c=0,h=0;if("constant"===l.kind)h=l.layoutSize;else if("source"!==l.kind){const{interpolationType:g,minZoom:b,maxZoom:x}=l,C=g?qn(io.interpolationFactor(g,o,b,x),0,1):0;"camera"===l.kind?h=xo.number(l.minSize,l.maxSize,C):c=C}return{uSizeT:c,uSize:h}},v.evaluateVariableOffset=E_,v.evented=qa,v.exported=bn,v.extend=Ri,v.filterObject=ze,v.findLineIntersection=function(l,o,c,h){const g=o.y-l.y,b=o.x-l.x,x=h.y-c.y,C=h.x-c.x,D=x*b-C*g;if(0===D)return null;const A=(C*(l.y-c.y)-x*(l.x-c.x))/D;return new ut(l.x+A*b,l.y+A*g)},v.fromScaling=function(l,o){return l[0]=o[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=o[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=o[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},v.getAnchorAlignment=Ul,v.getAnchorJustification=sm,v.getArrayBuffer=Ba,v.getDefaultExportFromCjs=Jt,v.getJSON=function(l,o){return Na(Ri(l,{type:"json"}),o)},v.getOverlapMode=uo,v.getProtocolAction=vo,v.getRTLTextPluginStatus=Ed,v.getReferrer=Lr,v.getVideo=function(l,o){const c=window.document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let h=0;h<l.length;h++){const g=window.document.createElement("source");In(l[h])||(c.crossOrigin="Anonymous"),g.src=l[h],c.appendChild(g)}return{cancel:()=>{}}},v.groupByLayout=function(l,o){const c={};for(let g=0;g<l.length;g++){const b=o&&o[l[g].id]||Oh(l[g]);o&&(o[l[g].id]=b);let x=c[b];x||(x=c[b]=[]),x.push(l[g])}const h=[];for(const g in c)h.push(c[g]);return h},v.identity=Cf,v.interpolate=xo,v.invert=function(l,o){var c=o[0],h=o[1],g=o[2],b=o[3],x=o[4],C=o[5],D=o[6],A=o[7],P=o[8],L=o[9],z=o[10],U=o[11],$=o[12],Y=o[13],W=o[14],se=o[15],ue=c*C-h*x,oe=c*D-g*x,he=c*A-b*x,ge=h*D-g*C,Ce=h*A-b*C,Je=g*A-b*D,rt=P*Y-L*$,Xe=P*W-z*$,qe=P*se-U*$,Ue=L*W-z*Y,Ze=L*se-U*Y,Ge=z*se-U*W,Fe=ue*Ge-oe*Ze+he*Ue+ge*qe-Ce*Xe+Je*rt;return Fe?(l[0]=(C*Ge-D*Ze+A*Ue)*(Fe=1/Fe),l[1]=(g*Ze-h*Ge-b*Ue)*Fe,l[2]=(Y*Je-W*Ce+se*ge)*Fe,l[3]=(z*Ce-L*Je-U*ge)*Fe,l[4]=(D*qe-x*Ge-A*Xe)*Fe,l[5]=(c*Ge-g*qe+b*Xe)*Fe,l[6]=(W*he-$*Je-se*oe)*Fe,l[7]=(P*Je-z*he+U*oe)*Fe,l[8]=(x*Ze-C*qe+A*rt)*Fe,l[9]=(h*qe-c*Ze-b*rt)*Fe,l[10]=($*Ce-Y*he+se*ue)*Fe,l[11]=(L*he-P*Ce-U*ue)*Fe,l[12]=(C*Xe-x*Ue-D*rt)*Fe,l[13]=(c*Ue-h*Xe+g*rt)*Fe,l[14]=(Y*oe-$*ge-W*ue)*Fe,l[15]=(P*ge-L*oe+z*ue)*Fe,l):null},v.isImageBitmap=Bo,v.isSafari=No,v.isWorker=Zn,v.keysDifference=function(l,o){const c=[];for(const h in l)h in o||c.push(h);return c},v.lazyLoadRTLTextPlugin=function(){fn.isLoading()||fn.isLoaded()||"deferred"!==Ed()||Vh()},v.makeRequest=Na,v.mapObject=He,v.mercatorXfromLng=Pu,v.mercatorYfromLat=g_,v.mercatorZfromAltitude=Bb,v.mul=Zo,v.mul$1=function(l,o,c){return l[0]=o[0]*c[0],l[1]=o[1]*c[1],l[2]=o[2]*c[2],l[3]=o[3]*c[3],l},v.multiply=Sf,v.nextPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},v.operations=pn,v.ortho=function(l,o,c,h,g,b,x){var C=1/(o-c),D=1/(h-g),A=1/(b-x);return l[0]=-2*C,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*D,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*A,l[11]=0,l[12]=(o+c)*C,l[13]=(g+h)*D,l[14]=(x+b)*A,l[15]=1,l},v.parseCacheControl=function(l){const o={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,h,g,b)=>{const x=g||b;return o[h]=!x||x.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o},v.parseGlyphPbf=function(l){return new Za(l).readFields(Iu,[])},v.pbf=qf,v.performSymbolLayout=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=Bn/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const o=l.bucket.layers[0].layout,c=l.bucket.layers[0]._unevaluatedLayout._values,h={layoutIconSize:c["icon-size"].possiblyEvaluate(new Le(l.bucket.zoom+1),l.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new Le(l.bucket.zoom+1),l.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new Le(18))};if("composite"===l.bucket.textSizeData.kind){const{minZoom:D,maxZoom:A}=l.bucket.textSizeData;h.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Le(D),l.canonical),c["text-size"].possiblyEvaluate(new Le(A),l.canonical)]}if("composite"===l.bucket.iconSizeData.kind){const{minZoom:D,maxZoom:A}=l.bucket.iconSizeData;h.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Le(D),l.canonical),c["icon-size"].possiblyEvaluate(new Le(A),l.canonical)]}const g=o.get("text-line-height")*Di,b="viewport"!==o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement"),x=o.get("text-keep-upright"),C=o.get("text-size");for(const D of l.bucket.features){const A=o.get("text-font").evaluate(D,{},l.canonical).join(","),P=C.evaluate(D,{},l.canonical),L=h.layoutTextSize.evaluate(D,{},l.canonical),z=h.layoutIconSize.evaluate(D,{},l.canonical),U={horizontal:{},vertical:void 0},$=D.text;let Y,W=[0,0];if($){const oe=$.toString(),he=o.get("text-letter-spacing").evaluate(D,{},l.canonical)*Di,ge=xd(oe)?he:0,Ce=o.get("text-anchor").evaluate(D,{},l.canonical),Je=o.get("text-variable-anchor");if(!Je){const Ze=o.get("text-radial-offset").evaluate(D,{},l.canonical);W=Ze?E_(Ce,[Ze*Di,Ca]):o.get("text-offset").evaluate(D,{},l.canonical).map(Ge=>Ge*Di)}let rt=b?"center":o.get("text-justify").evaluate(D,{},l.canonical);const Xe=o.get("symbol-placement"),qe="point"===Xe?o.get("text-max-width").evaluate(D,{},l.canonical)*Di:0,Ue=()=>{l.bucket.allowVerticalPlacement&&Ci(oe)&&(U.vertical=Xf($,l.glyphMap,l.glyphPositions,l.imagePositions,A,qe,g,Ce,"left",ge,W,v.WritingMode.vertical,!0,Xe,L,P))};if(!b&&Je){const Ze="auto"===rt?Je.map(Fe=>sm(Fe)):[rt];let Ge=!1;for(let Fe=0;Fe<Ze.length;Fe++){const ft=Ze[Fe];if(!U.horizontal[ft])if(Ge)U.horizontal[ft]=U.horizontal[0];else{const st=Xf($,l.glyphMap,l.glyphPositions,l.imagePositions,A,qe,g,"center",ft,ge,W,v.WritingMode.horizontal,!1,Xe,L,P);st&&(U.horizontal[ft]=st,Ge=1===st.positionedLines.length)}}Ue()}else{"auto"===rt&&(rt=sm(Ce));const Ze=Xf($,l.glyphMap,l.glyphPositions,l.imagePositions,A,qe,g,Ce,rt,ge,W,v.WritingMode.horizontal,!1,Xe,L,P);Ze&&(U.horizontal[rt]=Ze),Ue(),Ci(oe)&&b&&x&&(U.vertical=Xf($,l.glyphMap,l.glyphPositions,l.imagePositions,A,qe,g,Ce,rt,ge,W,v.WritingMode.vertical,!1,Xe,L,P))}}let se=!1;if(D.icon&&D.icon.name){const oe=l.imageMap[D.icon.name];oe&&(Y=np(l.imagePositions[D.icon.name],o.get("icon-offset").evaluate(D,{},l.canonical),o.get("icon-anchor").evaluate(D,{},l.canonical)),se=!!oe.sdf,void 0===l.bucket.sdfIcons?l.bucket.sdfIcons=se:l.bucket.sdfIcons!==se&&mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(oe.pixelRatio!==l.bucket.pixelRatio||0!==o.get("icon-rotate").constantOr(1))&&(l.bucket.iconsNeedLinear=!0))}const ue=dp(U.horizontal)||U.vertical;l.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||Y)&&Wb(l.bucket,D,U,Y,l.imageMap,h,L,z,W,se,l.canonical)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},v.perspective=function(l,o,c,h,g){var b,x=1/Math.tan(o/2);return l[0]=x/c,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=x,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,null!=g&&g!==1/0?(l[10]=(g+h)*(b=1/(h-g)),l[14]=2*g*h*b):(l[10]=-1,l[14]=-2*h),l},v.pick=function(l,o){const c={};for(let h=0;h<o.length;h++){const g=o[h];g in l&&(c[g]=l[g])}return c},v.plugin=fn,v.pointGeometry=xe,v.polygonIntersectsPolygon=jg,v.potpack=vc,v.register=tt,v.registerForPluginStateChange=function(l){return l({pluginStatus:Oi,pluginURL:Si}),qa.on("pluginStateChange",l),l},v.renderColorRamp=Ft,v.rotateX=function(l,o,c){var h=Math.sin(c),g=Math.cos(c),b=o[4],x=o[5],C=o[6],D=o[7],A=o[8],P=o[9],L=o[10],z=o[11];return o!==l&&(l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[3],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[4]=b*g+A*h,l[5]=x*g+P*h,l[6]=C*g+L*h,l[7]=D*g+z*h,l[8]=A*g-b*h,l[9]=P*g-x*h,l[10]=L*g-C*h,l[11]=z*g-D*h,l},v.rotateZ=function(l,o,c){var h=Math.sin(c),g=Math.cos(c),b=o[0],x=o[1],C=o[2],D=o[3],A=o[4],P=o[5],L=o[6],z=o[7];return o!==l&&(l[8]=o[8],l[9]=o[9],l[10]=o[10],l[11]=o[11],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[0]=b*g+A*h,l[1]=x*g+P*h,l[2]=C*g+L*h,l[3]=D*g+z*h,l[4]=A*g-b*h,l[5]=P*g-x*h,l[6]=L*g-C*h,l[7]=z*g-D*h,l},v.sameOrigin=In,v.scale=function(l,o,c){var h=c[0],g=c[1],b=c[2];return l[0]=o[0]*h,l[1]=o[1]*h,l[2]=o[2]*h,l[3]=o[3]*h,l[4]=o[4]*g,l[5]=o[5]*g,l[6]=o[6]*g,l[7]=o[7]*g,l[8]=o[8]*b,l[9]=o[9]*b,l[10]=o[10]*b,l[11]=o[11]*b,l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15],l},v.setRTLTextPlugin=function(l,o,c=!1){if(Oi===wr||Oi===nn||Oi===Pi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Si=bn.resolveURL(l),Oi=wr,Fi=o,pu(),c||Vh()},v.sphericalToCartesian=function([l,o,c]){return o+=90,o*=Math.PI/180,c*=Math.PI/180,{x:l*Math.cos(o)*Math.sin(c),y:l*Math.sin(o)*Math.sin(c),z:l*Math.cos(c)}},v.toEvaluationFeature=Fl,v.transformMat4=qh,v.translate=function(l,o,c){var h,g,b,x,C,D,A,P,L,z,U,$,Y=c[0],W=c[1],se=c[2];return o===l?(l[12]=o[0]*Y+o[4]*W+o[8]*se+o[12],l[13]=o[1]*Y+o[5]*W+o[9]*se+o[13],l[14]=o[2]*Y+o[6]*W+o[10]*se+o[14],l[15]=o[3]*Y+o[7]*W+o[11]*se+o[15]):(g=o[1],b=o[2],x=o[3],C=o[4],D=o[5],A=o[6],P=o[7],L=o[8],z=o[9],U=o[10],$=o[11],l[0]=h=o[0],l[1]=g,l[2]=b,l[3]=x,l[4]=C,l[5]=D,l[6]=A,l[7]=P,l[8]=L,l[9]=z,l[10]=U,l[11]=$,l[12]=h*Y+C*W+L*se+o[12],l[13]=g*Y+D*W+z*se+o[13],l[14]=b*Y+A*W+U*se+o[14],l[15]=x*Y+P*W+$*se+o[15]),l},v.triggerPluginCompletionEvent=wd,v.unicodeBlockLookup=Ke,v.uniqueId=function(){return Oo++},v.v8Spec=we,v.validateCustomStyleLayer=function(l){const o=[],c=l.id;return void 0===c&&o.push({message:`layers.${c}: missing required property "id"`}),void 0===l.render&&o.push({message:`layers.${c}: missing required method "render"`}),l.renderingMode&&"2d"!==l.renderingMode&&"3d"!==l.renderingMode&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},v.validateLight=mf,v.validateStyle=aa,v.vectorTile=Ol,v.warnOnce=mt,v.wrap=yo}),nc(0,function(v){class Jt{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,V){for(const ee of N){this._layerConfigs[ee.id]=ee;const ne=this._layers[ee.id]=v.createStyleLayer(ee);ne._featureFilter=v.createFilter(ne.filter),this.keyCache[ee.id]&&delete this.keyCache[ee.id]}for(const ee of V)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const q=v.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ee of q){const ne=ee.map(Te=>this._layers[Te.id]),ce=ne[0];if("none"===ce.visibility)continue;const ae=ce.source||"";let ie=this.familiesBySource[ae];ie||(ie=this.familiesBySource[ae]={});const de=ce.sourceLayer||"_geojsonTileLayer";let Ie=ie[de];Ie||(Ie=ie[de]=[]),Ie.push(ne)}}}class xe{constructor(N){const V={},q=[];for(const ae in N){const ie=N[ae],de=V[ae]={};for(const Ie in ie){const Te=ie[+Ie];if(!Te||0===Te.bitmap.width||0===Te.bitmap.height)continue;const Ee={x:0,y:0,w:Te.bitmap.width+2,h:Te.bitmap.height+2};q.push(Ee),de[Ie]={rect:Ee,metrics:Te.metrics}}}const{w:ee,h:ne}=v.potpack(q),ce=new v.AlphaImage({width:ee||1,height:ne||1});for(const ae in N){const ie=N[ae];for(const de in ie){const Ie=ie[+de];if(!Ie||0===Ie.bitmap.width||0===Ie.bitmap.height)continue;const Te=V[ae][de].rect;v.AlphaImage.copy(Ie.bitmap,ce,{x:0,y:0},{x:Te.x+1,y:Te.y+1},Ie.bitmap)}}this.image=ce,this.positions=V}}v.register("GlyphAtlas",xe);class Qi{constructor(N){this.tileID=new v.OverscaledTileID(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId}parse(N,V,q,ee,ne){this.status="parsing",this.data=N,this.collisionBoxArray=new v.CollisionBoxArray;const ce=new v.DictionaryCoder(Object.keys(N.layers).sort()),ae=new v.FeatureIndex(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const ie={},de={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},Ie=V.familiesBySource[this.source];for(const zt in Ie){const Vt=N.layers[zt];if(!Vt)continue;1===Vt.version&&v.warnOnce(`Vector tile source "${this.source}" layer "${zt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const On=ce.encode(zt),tn=[];for(let xt=0;xt<Vt.length;xt++){const gn=Vt.feature(xt),za=ae.getId(gn,zt);tn.push({feature:gn,id:za,index:xt,sourceLayerIndex:On})}for(const xt of Ie[zt]){const gn=xt[0];gn.source!==this.source&&v.warnOnce(`layer.source = ${gn.source} does not equal this.source = ${this.source}`),gn.minzoom&&this.zoom<Math.floor(gn.minzoom)||gn.maxzoom&&this.zoom>=gn.maxzoom||"none"!==gn.visibility&&(ut(xt,this.zoom,q),(ie[gn.id]=gn.createBucket({index:ae.bucketLayerIDs.length,layers:xt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:On,sourceID:this.source})).populate(tn,de,this.tileID.canonical),ae.bucketLayerIDs.push(xt.map(za=>za.id)))}}let Te,Ee,gt,It;const it=v.mapObject(de.glyphDependencies,zt=>Object.keys(zt).map(Number));Object.keys(it).length?ee.send("getGlyphs",{uid:this.uid,stacks:it,source:this.source,tileID:this.tileID,type:"glyphs"},(zt,Vt)=>{Te||(Te=zt,Ee=Vt,en.call(this))}):Ee={};const pt=Object.keys(de.iconDependencies);pt.length?ee.send("getImages",{icons:pt,source:this.source,tileID:this.tileID,type:"icons"},(zt,Vt)=>{Te||(Te=zt,gt=Vt,en.call(this))}):gt={};const Ct=Object.keys(de.patternDependencies);function en(){if(Te)return ne(Te);if(Ee&&gt&&It){const zt=new xe(Ee),Vt=new v.ImageAtlas(gt,It);for(const On in ie){const tn=ie[On];tn instanceof v.SymbolBucket?(ut(tn.layers,this.zoom,q),v.performSymbolLayout({bucket:tn,glyphMap:Ee,glyphPositions:zt.positions,imageMap:gt,imagePositions:Vt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):tn.hasPattern&&(tn instanceof v.LineBucket||tn instanceof v.FillBucket||tn instanceof v.FillExtrusionBucket)&&(ut(tn.layers,this.zoom,q),tn.addFeatures(de,this.tileID.canonical,Vt.patternPositions))}this.status="done",ne(null,{buckets:Object.values(ie).filter(On=>!On.isEmpty()),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:zt.image,imageAtlas:Vt,glyphMap:this.returnDependencies?Ee:null,iconMap:this.returnDependencies?gt:null,glyphPositions:this.returnDependencies?zt.positions:null})}}Ct.length?ee.send("getImages",{icons:Ct,source:this.source,tileID:this.tileID,type:"patterns"},(zt,Vt)=>{Te||(Te=zt,It=Vt,en.call(this))}):It={},en.call(this)}}function ut(Q,N,V){const q=new v.EvaluationParameters(N);for(const ee of Q)ee.recalculate(q,V)}function yr(Q,N){const V=v.getArrayBuffer(Q.request,(q,ee,ne,ce)=>{q?N(q):ee&&N(null,{vectorTile:new v.vectorTile.VectorTile(new v.Protobuf(ee)),rawData:ee,cacheControl:ne,expires:ce})});return()=>{V.cancel(),N()}}class to{constructor(N,V,q,ee){this.actor=N,this.layerIndex=V,this.availableImages=q,this.loadVectorData=ee||yr,this.loading={},this.loaded={}}loadTile(N,V){const q=N.uid;this.loading||(this.loading={});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new v.RequestPerformance(N.request),ne=this.loading[q]=new Qi(N);ne.abort=this.loadVectorData(N,(ce,ae)=>{if(delete this.loading[q],ce||!ae)return ne.status="done",this.loaded[q]=ne,V(ce);const ie=ae.rawData,de={};ae.expires&&(de.expires=ae.expires),ae.cacheControl&&(de.cacheControl=ae.cacheControl);const Ie={};if(ee){const Te=ee.finish();Te&&(Ie.resourceTiming=JSON.parse(JSON.stringify(Te)))}ne.vectorTile=ae.vectorTile,ne.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,(Te,Ee)=>{if(Te||!Ee)return V(Te);V(null,v.extend({rawTileData:ie.slice(0)},Ee,de,Ie))}),this.loaded=this.loaded||{},this.loaded[q]=ne})}reloadTile(N,V){const q=this.loaded,ee=N.uid,ne=this;if(q&&q[ee]){const ce=q[ee];ce.showCollisionBoxes=N.showCollisionBoxes;const ae=(ie,de)=>{const Ie=ce.reloadCallback;Ie&&(delete ce.reloadCallback,ce.parse(ce.vectorTile,ne.layerIndex,this.availableImages,ne.actor,Ie)),V(ie,de)};"parsing"===ce.status?ce.reloadCallback=ae:"done"===ce.status&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,ae):ae())}}abortTile(N,V){const q=this.loading,ee=N.uid;q&&q[ee]&&q[ee].abort&&(q[ee].abort(),delete q[ee]),V()}removeTile(N,V){const q=this.loaded,ee=N.uid;q&&q[ee]&&delete q[ee],V()}}class bs{constructor(){this.loaded={}}loadTile(N,V){const{uid:q,encoding:ee,rawImageData:ne}=N,ce=v.isImageBitmap(ne)?this.getImageData(ne):ne,ae=new v.DEMData(q,ce,ee);this.loaded=this.loaded||{},this.loaded[q]=ae,V(null,ae)}getImageData(N){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(N.width,N.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=N.width,this.offscreenCanvas.height=N.height,this.offscreenCanvasContext.drawImage(N,0,0,N.width,N.height);const V=this.offscreenCanvasContext.getImageData(-1,-1,N.width+2,N.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new v.RGBAImage({width:V.width,height:V.height},V.data)}removeTile(N){const V=this.loaded,q=N.uid;V&&V[q]&&delete V[q]}}function no(Q,N){if(0!==Q.length){rs(Q[0],N);for(var V=1;V<Q.length;V++)rs(Q[V],!N)}}function rs(Q,N){for(var V=0,q=0,ee=0,ne=Q.length,ce=ne-1;ee<ne;ce=ee++){var ae=(Q[ee][0]-Q[ce][0])*(Q[ce][1]+Q[ee][1]),ie=V+ae;q+=Math.abs(V)>=Math.abs(ae)?V-ie+ae:ae-ie+V,V=ie}V+q>=0!=!!N&&Q.reverse()}var qn=v.getDefaultExportFromCjs(function Q(N,V){var q,ee=N&&N.type;if("FeatureCollection"===ee)for(q=0;q<N.features.length;q++)Q(N.features[q],V);else if("GeometryCollection"===ee)for(q=0;q<N.geometries.length;q++)Q(N.geometries[q],V);else if("Feature"===ee)Q(N.geometry,V);else if("Polygon"===ee)no(N.coordinates,V);else if("MultiPolygon"===ee)for(q=0;q<N.coordinates.length;q++)no(N.coordinates[q],V);return N});const yo=v.vectorTile.VectorTileFeature.prototype.toGeoJSON;var Ri={exports:{}},Oo=v.pointGeometry,Lo=v.vectorTile.VectorTileFeature,He=ze;function ze(Q,N){this.options=N||{},this.features=Q,this.length=Q.length}function We(Q,N){this.id="number"==typeof Q.id?Q.id:void 0,this.type=Q.type,this.rawGeometry=1===Q.type?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=N||4096}ze.prototype.feature=function(Q){return new We(this.features[Q],this.options.extent)},We.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var N=0;N<Q.length;N++){for(var V=Q[N],q=[],ee=0;ee<V.length;ee++)q.push(new Oo(V[ee][0],V[ee][1]));this.geometry.push(q)}return this.geometry},We.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,N=1/0,V=-1/0,q=1/0,ee=-1/0,ne=0;ne<Q.length;ne++)for(var ce=Q[ne],ae=0;ae<ce.length;ae++){var ie=ce[ae];N=Math.min(N,ie.x),V=Math.max(V,ie.x),q=Math.min(q,ie.y),ee=Math.max(ee,ie.y)}return[N,q,V,ee]},We.prototype.toGeoJSON=Lo.prototype.toGeoJSON;var dt=v.pbf,mt=He;function ht(Q){var N=new dt;return function(V,q){for(var ee in V.layers)q.writeMessage(3,Bt,V.layers[ee])}(Q,N),N.finish()}function Bt(Q,N){var V;N.writeVarintField(15,Q.version||1),N.writeStringField(1,Q.name||""),N.writeVarintField(5,Q.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<Q.length;V++)q.feature=Q.feature(V),N.writeMessage(2,Zn,q);var ee=q.keys;for(V=0;V<ee.length;V++)N.writeStringField(3,ee[V]);var ne=q.values;for(V=0;V<ne.length;V++)N.writeMessage(4,hl,ne[V])}function Zn(Q,N){var V=Q.feature;void 0!==V.id&&N.writeVarintField(1,V.id),N.writeMessage(2,Ji,Q),N.writeVarintField(3,V.type),N.writeMessage(4,vr,V)}function Ji(Q,N){var V=Q.feature,q=Q.keys,ee=Q.values,ne=Q.keycache,ce=Q.valuecache;for(var ae in V.properties){var ie=V.properties[ae],de=ne[ae];if(null!==ie){void 0===de&&(q.push(ae),ne[ae]=de=q.length-1),N.writeVarint(de);var Ie=typeof ie;"string"!==Ie&&"boolean"!==Ie&&"number"!==Ie&&(ie=JSON.stringify(ie));var Te=Ie+":"+ie,Ee=ce[Te];void 0===Ee&&(ee.push(ie),ce[Te]=Ee=ee.length-1),N.writeVarint(Ee)}}}function No(Q,N){return(N<<3)+(7&Q)}function Bo(Q){return Q<<1^Q>>31}function vr(Q,N){for(var V=Q.loadGeometry(),q=Q.type,ee=0,ne=0,ce=V.length,ae=0;ae<ce;ae++){var ie=V[ae],de=1;1===q&&(de=ie.length),N.writeVarint(No(1,de));for(var Ie=3===q?ie.length-1:ie.length,Te=0;Te<Ie;Te++){1===Te&&1!==q&&N.writeVarint(No(2,Ie-1));var Ee=ie[Te].x-ee,gt=ie[Te].y-ne;N.writeVarint(Bo(Ee)),N.writeVarint(Bo(gt)),ee+=Ee,ne+=gt}3===q&&N.writeVarint(No(7,1))}}function hl(Q,N){var V=typeof Q;"string"===V?N.writeStringField(1,Q):"boolean"===V?N.writeBooleanField(7,Q):"number"===V&&(Q%1!=0?N.writeDoubleField(3,Q):Q<0?N.writeSVarintField(6,Q):N.writeVarintField(5,Q))}Ri.exports=ht,Ri.exports.fromVectorTileJs=ht,Ri.exports.fromGeojsonVt=function(Q,N){N=N||{};var V={};for(var q in Q)V[q]=new mt(Q[q].features,N),V[q].name=q,V[q].version=N.version,V[q].extent=N.extent;return ht({layers:V})},Ri.exports.GeoJSONWrapper=mt;var Ks=v.getDefaultExportFromCjs(Ri.exports);const bn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Q=>Q},pl=Math.fround||(Xs=new Float32Array(1),Q=>(Xs[0]=+Q,Xs[0]));var Xs;const Lr=3,vo=5,St=6;class Na{constructor(N){this.options=Object.assign(Object.create(bn),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:V,minZoom:q,maxZoom:ee}=this.options;V&&console.time("total time");const ne=`prepare ${N.length} points`;V&&console.time(ne),this.points=N;const ce=[];for(let ie=0;ie<N.length;ie++){const de=N[ie];if(!de.geometry)continue;const[Ie,Te]=de.geometry.coordinates,Ee=pl(xn(Ie)),gt=pl(xs(Te));ce.push(Ee,gt,1/0,ie,-1,1),this.options.reduce&&ce.push(0)}let ae=this.trees[ee+1]=this._createTree(ce);V&&console.timeEnd(ne);for(let ie=ee;ie>=q;ie--){const de=+Date.now();ae=this.trees[ie]=this._createTree(this._cluster(ae,ie)),V&&console.log("z%d: %d clusters in %dms",ie,ae.numItems,+Date.now()-de)}return V&&console.timeEnd("total time"),this}getClusters(N,V){let q=((N[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,N[1]));let ne=180===N[2]?180:((N[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)q=-180,ne=180;else if(q>ne){const Te=this.getClusters([q,ee,180,ce],V),Ee=this.getClusters([-180,ee,ne,ce],V);return Te.concat(Ee)}const ae=this.trees[this._limitZoom(V)],ie=ae.range(xn(q),xs(ce),xn(ne),xs(ee)),de=ae.data,Ie=[];for(const Te of ie){const Ee=this.stride*Te;Ie.push(de[Ee+vo]>1?Ba(de,Ee,this.clusterProps):this.points[de[Ee+Lr]])}return Ie}getChildren(N){const V=this._getOriginId(N),q=this._getOriginZoom(N),ee="No cluster with the specified id.",ne=this.trees[q];if(!ne)throw new Error(ee);const ce=ne.data;if(V*this.stride>=ce.length)throw new Error(ee);const ae=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ie=ne.within(ce[V*this.stride],ce[V*this.stride+1],ae),de=[];for(const Ie of ie){const Te=Ie*this.stride;ce[Te+4]===N&&de.push(ce[Te+vo]>1?Ba(ce,Te,this.clusterProps):this.points[ce[Te+Lr]])}if(0===de.length)throw new Error(ee);return de}getLeaves(N,V,q){const ee=[];return this._appendLeaves(ee,N,V=V||10,q=q||0,0),ee}getTile(N,V,q){const ee=this.trees[this._limitZoom(N)],ne=Math.pow(2,N),{extent:ce,radius:ae}=this.options,ie=ae/ce,de=(q-ie)/ne,Ie=(q+1+ie)/ne,Te={features:[]};return this._addTileFeatures(ee.range((V-ie)/ne,de,(V+1+ie)/ne,Ie),ee.data,V,q,ne,Te),0===V&&this._addTileFeatures(ee.range(1-ie/ne,de,1,Ie),ee.data,ne,q,ne,Te),V===ne-1&&this._addTileFeatures(ee.range(0,de,ie/ne,Ie),ee.data,-1,q,ne,Te),Te.features.length?Te:null}getClusterExpansionZoom(N){let V=this._getOriginZoom(N)-1;for(;V<=this.options.maxZoom;){const q=this.getChildren(N);if(V++,1!==q.length)break;N=q[0].properties.cluster_id}return V}_appendLeaves(N,V,q,ee,ne){const ce=this.getChildren(V);for(const ae of ce){const ie=ae.properties;if(ie&&ie.cluster?ne+ie.point_count<=ee?ne+=ie.point_count:ne=this._appendLeaves(N,ie.cluster_id,q,ee,ne):ne<ee?ne++:N.push(ae),N.length===q)break}return ne}_createTree(N){const V=new v.KDBush(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<N.length;q+=this.stride)V.add(N[q],N[q+1]);return V.finish(),V.data=N,V}_addTileFeatures(N,V,q,ee,ne,ce){for(const ae of N){const ie=ae*this.stride,de=V[ie+vo]>1;let Ie,Te,Ee;if(de)Ie=In(V,ie,this.clusterProps),Te=V[ie],Ee=V[ie+1];else{const it=this.points[V[ie+Lr]];Ie=it.properties;const[pt,Ct]=it.geometry.coordinates;Te=xn(pt),Ee=xs(Ct)}const gt={type:1,geometry:[[Math.round(this.options.extent*(Te*ne-q)),Math.round(this.options.extent*(Ee*ne-ee))]],tags:Ie};let It;It=de||this.options.generateId?V[ie+Lr]:this.points[V[ie+Lr]].id,void 0!==It&&(gt.id=It),ce.features.push(gt)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,V){const{radius:q,extent:ee,reduce:ne,minPoints:ce}=this.options,ae=q/(ee*Math.pow(2,V)),ie=N.data,de=[],Ie=this.stride;for(let Te=0;Te<ie.length;Te+=Ie){if(ie[Te+2]<=V)continue;ie[Te+2]=V;const Ee=ie[Te],gt=ie[Te+1],It=N.within(ie[Te],ie[Te+1],ae),it=ie[Te+vo];let pt=it;for(const Ct of It){const en=Ct*Ie;ie[en+2]>V&&(pt+=ie[en+vo])}if(pt>it&&pt>=ce){let Ct,en=Ee*it,zt=gt*it,Vt=-1;const On=((Te/Ie|0)<<5)+(V+1)+this.points.length;for(const tn of It){const xt=tn*Ie;if(ie[xt+2]<=V)continue;ie[xt+2]=V;const gn=ie[xt+vo];en+=ie[xt]*gn,zt+=ie[xt+1]*gn,ie[xt+4]=On,ne&&(Ct||(Ct=this._map(ie,Te,!0),Vt=this.clusterProps.length,this.clusterProps.push(Ct)),ne(Ct,this._map(ie,xt)))}ie[Te+4]=On,de.push(en/pt,zt/pt,1/0,On,-1,pt),ne&&de.push(Vt)}else{for(let Ct=0;Ct<Ie;Ct++)de.push(ie[Te+Ct]);if(pt>1)for(const Ct of It){const en=Ct*Ie;if(!(ie[en+2]<=V)){ie[en+2]=V;for(let zt=0;zt<Ie;zt++)de.push(ie[en+zt])}}}}return de}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,V,q){if(N[V+vo]>1){const ce=this.clusterProps[N[V+St]];return q?Object.assign({},ce):ce}const ee=this.points[N[V+Lr]].properties,ne=this.options.map(ee);return q&&ne===ee?Object.assign({},ne):ne}}function Ba(Q,N,V){return{type:"Feature",id:Q[N+Lr],properties:In(Q,N,V),geometry:{type:"Point",coordinates:[(q=Q[N],360*(q-.5)),wt(Q[N+1])]}};var q}function In(Q,N,V){const q=Q[N+vo],ee=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,ne=Q[N+St],ce=-1===ne?{}:Object.assign({},V[ne]);return Object.assign(ce,{cluster:!0,cluster_id:Q[N+Lr],point_count:q,point_count_abbreviated:ee})}function xn(Q){return Q/360+.5}function xs(Q){const N=Math.sin(Q*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function wt(Q){const N=(180-360*Q)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function qr(Q,N,V,q){for(var ee,ne=q,ce=V-N>>1,ae=V-N,ie=Q[N],de=Q[N+1],Ie=Q[V],Te=Q[V+1],Ee=N+3;Ee<V;Ee+=3){var gt=fl(Q[Ee],Q[Ee+1],ie,de,Ie,Te);if(gt>ne)ee=Ee,ne=gt;else if(gt===ne){var It=Math.abs(Ee-ce);It<ae&&(ee=Ee,ae=It)}}ne>q&&(ee-N>3&&qr(Q,N,ee,q),Q[ee+2]=ne,V-ee>3&&qr(Q,ee,V,q))}function fl(Q,N,V,q,ee,ne){var ce=ee-V,ae=ne-q;if(0!==ce||0!==ae){var ie=((Q-V)*ce+(N-q)*ae)/(ce*ce+ae*ae);ie>1?(V=ee,q=ne):ie>0&&(V+=ce*ie,q+=ae*ie)}return(ce=Q-V)*ce+(ae=N-q)*ae}function we(Q,N,V,q){var ee={id:void 0===Q?null:Q,type:N,geometry:V,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ne){var ce=ne.geometry,ae=ne.type;if("Point"===ae||"MultiPoint"===ae||"LineString"===ae)Ys(ne,ce);else if("Polygon"===ae||"MultiLineString"===ae)for(var ie=0;ie<ce.length;ie++)Ys(ne,ce[ie]);else if("MultiPolygon"===ae)for(ie=0;ie<ce.length;ie++)for(var de=0;de<ce[ie].length;de++)Ys(ne,ce[ie][de])}(ee),ee}function Ys(Q,N){for(var V=0;V<N.length;V+=3)Q.minX=Math.min(Q.minX,N[V]),Q.minY=Math.min(Q.minY,N[V+1]),Q.maxX=Math.max(Q.maxX,N[V]),Q.maxY=Math.max(Q.maxY,N[V+1])}function ic(Q,N,V,q){if(N.geometry){var ee=N.geometry.coordinates,ne=N.geometry.type,ce=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),ae=[],ie=N.id;if(V.promoteId?ie=N.properties[V.promoteId]:V.generateId&&(ie=q||0),"Point"===ne)Fn(ee,ae);else if("MultiPoint"===ne)for(var de=0;de<ee.length;de++)Fn(ee[de],ae);else if("LineString"===ne)pn(ee,ae,ce,!1);else if("MultiLineString"===ne){if(V.lineMetrics){for(de=0;de<ee.length;de++)pn(ee[de],ae=[],ce,!1),Q.push(we(ie,"LineString",ae,N.properties));return}ml(ee,ae,ce,!1)}else if("Polygon"===ne)ml(ee,ae,ce,!0);else{if("MultiPolygon"!==ne){if("GeometryCollection"===ne){for(de=0;de<N.geometry.geometries.length;de++)ic(Q,{id:ie,geometry:N.geometry.geometries[de],properties:N.properties},V,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(de=0;de<ee.length;de++){var Ie=[];ml(ee[de],Ie,ce,!0),ae.push(Ie)}}Q.push(we(ie,ne,ae,N.properties))}}function Fn(Q,N){N.push(Gc(Q[0])),N.push(rd(Q[1])),N.push(0)}function pn(Q,N,V,q){for(var ee,ne,ce=0,ae=0;ae<Q.length;ae++){var ie=Gc(Q[ae][0]),de=rd(Q[ae][1]);N.push(ie),N.push(de),N.push(0),ae>0&&(ce+=q?(ee*de-ie*ne)/2:Math.sqrt(Math.pow(ie-ee,2)+Math.pow(de-ne,2))),ee=ie,ne=de}var Ie=N.length-3;N[2]=1,qr(N,0,Ie,V),N[Ie+2]=1,N.size=Math.abs(ce),N.start=0,N.end=N.size}function ml(Q,N,V,q){for(var ee=0;ee<Q.length;ee++){var ne=[];pn(Q[ee],ne,V,q),N.push(ne)}}function Gc(Q){return Q/360+.5}function rd(Q){var N=Math.sin(Q*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function vi(Q,N,V,q,ee,ne,ce,ae){if(q/=N,ne>=(V/=N)&&ce<q)return Q;if(ce<V||ne>=q)return null;for(var ie=[],de=0;de<Q.length;de++){var Ie=Q[de],Te=Ie.geometry,Ee=Ie.type,gt=0===ee?Ie.minX:Ie.minY,It=0===ee?Ie.maxX:Ie.maxY;if(gt>=V&&It<q)ie.push(Ie);else if(!(It<V||gt>=q)){var it=[];if("Point"===Ee||"MultiPoint"===Ee)Qs(Te,it,V,q,ee);else if("LineString"===Ee)gl(Te,it,V,q,ee,!1,ae.lineMetrics);else if("MultiLineString"===Ee)je(Te,it,V,q,ee,!1);else if("Polygon"===Ee)je(Te,it,V,q,ee,!0);else if("MultiPolygon"===Ee)for(var pt=0;pt<Te.length;pt++){var Ct=[];je(Te[pt],Ct,V,q,ee,!0),Ct.length&&it.push(Ct)}if(it.length){if(ae.lineMetrics&&"LineString"===Ee){for(pt=0;pt<it.length;pt++)ie.push(we(Ie.id,Ee,it[pt],Ie.tags));continue}"LineString"!==Ee&&"MultiLineString"!==Ee||(1===it.length?(Ee="LineString",it=it[0]):Ee="MultiLineString"),"Point"!==Ee&&"MultiPoint"!==Ee||(Ee=3===it.length?"Point":"MultiPoint"),ie.push(we(Ie.id,Ee,it,Ie.tags))}}}return ie.length?ie:null}function Qs(Q,N,V,q,ee){for(var ne=0;ne<Q.length;ne+=3){var ce=Q[ne+ee];ce>=V&&ce<=q&&(N.push(Q[ne]),N.push(Q[ne+1]),N.push(Q[ne+2]))}}function gl(Q,N,V,q,ee,ne,ce){for(var ae,ie,de=ws(Q),Ie=0===ee?er:_l,Te=Q.start,Ee=0;Ee<Q.length-3;Ee+=3){var gt=Q[Ee],It=Q[Ee+1],it=Q[Ee+2],pt=Q[Ee+3],Ct=Q[Ee+4],en=0===ee?gt:It,zt=0===ee?pt:Ct,Vt=!1;ce&&(ae=Math.sqrt(Math.pow(gt-pt,2)+Math.pow(It-Ct,2))),en<V?zt>V&&(ie=Ie(de,gt,It,pt,Ct,V),ce&&(de.start=Te+ae*ie)):en>q?zt<q&&(ie=Ie(de,gt,It,pt,Ct,q),ce&&(de.start=Te+ae*ie)):bo(de,gt,It,it),zt<V&&en>=V&&(ie=Ie(de,gt,It,pt,Ct,V),Vt=!0),zt>q&&en<=q&&(ie=Ie(de,gt,It,pt,Ct,q),Vt=!0),!ne&&Vt&&(ce&&(de.end=Te+ae*ie),N.push(de),de=ws(Q)),ce&&(Te+=ae)}var On=Q.length-3;gt=Q[On],It=Q[On+1],it=Q[On+2],(en=0===ee?gt:It)>=V&&en<=q&&bo(de,gt,It,it),On=de.length-3,ne&&On>=3&&(de[On]!==de[0]||de[On+1]!==de[1])&&bo(de,de[0],de[1],de[2]),de.length&&N.push(de)}function ws(Q){var N=[];return N.size=Q.size,N.start=Q.start,N.end=Q.end,N}function je(Q,N,V,q,ee,ne){for(var ce=0;ce<Q.length;ce++)gl(Q[ce],N,V,q,ee,ne,!1)}function bo(Q,N,V,q){Q.push(N),Q.push(V),Q.push(q)}function er(Q,N,V,q,ee,ne){var ce=(ne-N)/(q-N);return Q.push(ne),Q.push(V+(ee-V)*ce),Q.push(1),ce}function _l(Q,N,V,q,ee,ne){var ce=(ne-V)/(ee-V);return Q.push(N+(q-N)*ce),Q.push(ne),Q.push(1),ce}function Js(Q,N){for(var V=[],q=0;q<Q.length;q++){var ee,ne=Q[q],ce=ne.type;if("Point"===ce||"MultiPoint"===ce||"LineString"===ce)ee=Ve(ne.geometry,N);else if("MultiLineString"===ce||"Polygon"===ce){ee=[];for(var ae=0;ae<ne.geometry.length;ae++)ee.push(Ve(ne.geometry[ae],N))}else if("MultiPolygon"===ce)for(ee=[],ae=0;ae<ne.geometry.length;ae++){for(var ie=[],de=0;de<ne.geometry[ae].length;de++)ie.push(Ve(ne.geometry[ae][de],N));ee.push(ie)}V.push(we(ne.id,ce,ee,ne.tags))}return V}function Ve(Q,N){var V=[];V.size=Q.size,void 0!==Q.start&&(V.start=Q.start,V.end=Q.end);for(var q=0;q<Q.length;q+=3)V.push(Q[q]+N,Q[q+1],Q[q+2]);return V}function Dt(Q,N){if(Q.transformed)return Q;var V,q,ee,ne=1<<Q.z,ce=Q.x,ae=Q.y;for(V=0;V<Q.features.length;V++){var ie=Q.features[V],de=ie.geometry,Ie=ie.type;if(ie.geometry=[],1===Ie)for(q=0;q<de.length;q+=2)ie.geometry.push(Rt(de[q],de[q+1],N,ne,ce,ae));else for(q=0;q<de.length;q++){var Te=[];for(ee=0;ee<de[q].length;ee+=2)Te.push(Rt(de[q][ee],de[q][ee+1],N,ne,ce,ae));ie.geometry.push(Te)}}return Q.transformed=!0,Q}function Rt(Q,N,V,q,ee,ne){return[Math.round(V*(Q*q-ee)),Math.round(V*(N*q-ne))]}function Gr(Q,N,V,q,ee){for(var ne=N===ee.maxZoom?0:ee.tolerance/((1<<N)*ee.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:q,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ae=0;ae<Q.length;ae++){ce.numFeatures++,bi(ce,Q[ae],ne,ee);var ie=Q[ae].minX,de=Q[ae].minY,Ie=Q[ae].maxX,Te=Q[ae].maxY;ie<ce.minX&&(ce.minX=ie),de<ce.minY&&(ce.minY=de),Ie>ce.maxX&&(ce.maxX=Ie),Te>ce.maxY&&(ce.maxY=Te)}return ce}function bi(Q,N,V,q){var ee=N.geometry,ne=N.type,ce=[];if("Point"===ne||"MultiPoint"===ne)for(var ae=0;ae<ee.length;ae+=3)ce.push(ee[ae]),ce.push(ee[ae+1]),Q.numPoints++,Q.numSimplified++;else if("LineString"===ne)Pt(ce,ee,Q,V,!1,!1);else if("MultiLineString"===ne||"Polygon"===ne)for(ae=0;ae<ee.length;ae++)Pt(ce,ee[ae],Q,V,"Polygon"===ne,0===ae);else if("MultiPolygon"===ne)for(var ie=0;ie<ee.length;ie++){var de=ee[ie];for(ae=0;ae<de.length;ae++)Pt(ce,de[ae],Q,V,!0,0===ae)}if(ce.length){var Ie=N.tags||null;if("LineString"===ne&&q.lineMetrics){for(var Te in Ie={},N.tags)Ie[Te]=N.tags[Te];Ie.mapbox_clip_start=ee.start/ee.size,Ie.mapbox_clip_end=ee.end/ee.size}var Ee={geometry:ce,type:"Polygon"===ne||"MultiPolygon"===ne?3:"LineString"===ne||"MultiLineString"===ne?2:1,tags:Ie};null!==N.id&&(Ee.id=N.id),Q.features.push(Ee)}}function Pt(Q,N,V,q,ee,ne){var ce=q*q;if(q>0&&N.size<(ee?ce:q))V.numPoints+=N.length/3;else{for(var ae=[],ie=0;ie<N.length;ie+=3)(0===q||N[ie+2]>ce)&&(V.numSimplified++,ae.push(N[ie]),ae.push(N[ie+1])),V.numPoints++;ee&&function(de,Ie){for(var Te=0,Ee=0,gt=de.length,It=gt-2;Ee<gt;It=Ee,Ee+=2)Te+=(de[Ee]-de[It])*(de[Ee+1]+de[It+1]);if(Te>0===Ie)for(Ee=0,gt=de.length;Ee<gt/2;Ee+=2){var it=de[Ee],pt=de[Ee+1];de[Ee]=de[gt-2-Ee],de[Ee+1]=de[gt-1-Ee],de[gt-2-Ee]=it,de[gt-1-Ee]=pt}}(ae,ne),Q.push(ae)}}function Es(Q,N){var V=(N=this.options=function(ee,ne){for(var ce in ne)ee[ce]=ne[ce];return ee}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var ee,ne,ce,ae,ie,de,q=function(ee,ne){var ce=[];if("FeatureCollection"===ee.type)for(var ae=0;ae<ee.features.length;ae++)ic(ce,ee.features[ae],ne,ae);else ic(ce,"Feature"===ee.type?ee:{geometry:ee},ne);return ce}(Q,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ae=ee=q,ie=vi(ee,1,-1-(ce=(ne=N).buffer/ne.extent),ce,0,-1,2,ne),de=vi(ee,1,1-ce,2+ce,0,-1,2,ne),(ie||de)&&(ae=vi(ee,1,-ce,1+ce,0,-1,2,ne)||[],ie&&(ae=Js(ie,1).concat(ae)),de&&(ae=ae.concat(Js(de,-1)))),(q=ae).length&&this.splitTile(q,0,0,0),V&&(q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Cs(Q,N,V){return 32*((1<<Q)*V+N)+Q}function zo(Q,N){return N?Q.properties[N]:Q.id}function Ss(Q,N){if(null==Q)return!0;if("Feature"===Q.type)return null!=zo(Q,N);if("FeatureCollection"===Q.type){const V=new Set;for(const q of Q.features){const ee=zo(q,N);if(null==ee||V.has(ee))return!1;V.add(ee)}return!0}return!1}function tr(Q,N){const V=new Map;if(null!=Q)if("Feature"===Q.type)V.set(zo(Q,N),Q);else for(const q of Q.features)V.set(zo(q,N),q);return V}function Ln(Q,N){const V=Q.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);const q=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!q)return N(null,null);const ee=new class{constructor(ce){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.EXTENT,this.length=ce.length,this._features=ce}feature(ce){return new class{constructor(ae){this._feature=ae,this.extent=v.EXTENT,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(1===this._feature.type){const ae=[];for(const ie of this._feature.geometry)ae.push([new v.Point(ie[0],ie[1])]);return ae}{const ae=[];for(const ie of this._feature.geometry){const de=[];for(const Ie of ie)de.push(new v.Point(Ie[0],Ie[1]));ae.push(de)}return ae}}toGeoJSON(ae,ie,de){return yo.call(this,ae,ie,de)}}(this._features[ce])}}(q.features);let ne=Ks(ee);0===ne.byteOffset&&ne.byteLength===ne.buffer.byteLength||(ne=new Uint8Array(ne)),N(null,{vectorTile:ee,rawData:ne.buffer})}Es.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Es.prototype.splitTile=function(Q,N,V,q,ee,ne,ce){for(var ae=[Q,N,V,q],ie=this.options,de=ie.debug;ae.length;){q=ae.pop(),V=ae.pop(),N=ae.pop(),Q=ae.pop();var Ie=1<<N,Te=Cs(N,V,q),Ee=this.tiles[Te];if(!Ee&&(de>1&&console.time("creation"),Ee=this.tiles[Te]=Gr(Q,N,V,q,ie),this.tileCoords.push({z:N,x:V,y:q}),de)){de>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,q,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));var gt="z"+N;this.stats[gt]=(this.stats[gt]||0)+1,this.total++}if(Ee.source=Q,ee){if(N===ie.maxZoom||N===ee)continue;var It=1<<ee-N;if(V!==Math.floor(ne/It)||q!==Math.floor(ce/It))continue}else if(N===ie.indexMaxZoom||Ee.numPoints<=ie.indexMaxPoints)continue;if(Ee.source=null,0!==Q.length){de>1&&console.time("clipping");var it,pt,Ct,en,zt,Vt,On=.5*ie.buffer/ie.extent,tn=.5-On,xt=.5+On,gn=1+On;it=pt=Ct=en=null,zt=vi(Q,Ie,V-On,V+xt,0,Ee.minX,Ee.maxX,ie),Vt=vi(Q,Ie,V+tn,V+gn,0,Ee.minX,Ee.maxX,ie),Q=null,zt&&(it=vi(zt,Ie,q-On,q+xt,1,Ee.minY,Ee.maxY,ie),pt=vi(zt,Ie,q+tn,q+gn,1,Ee.minY,Ee.maxY,ie),zt=null),Vt&&(Ct=vi(Vt,Ie,q-On,q+xt,1,Ee.minY,Ee.maxY,ie),en=vi(Vt,Ie,q+tn,q+gn,1,Ee.minY,Ee.maxY,ie),Vt=null),de>1&&console.timeEnd("clipping"),ae.push(it||[],N+1,2*V,2*q),ae.push(pt||[],N+1,2*V,2*q+1),ae.push(Ct||[],N+1,2*V+1,2*q),ae.push(en||[],N+1,2*V+1,2*q+1)}}},Es.prototype.getTile=function(Q,N,V){var q=this.options,ee=q.extent,ne=q.debug;if(Q<0||Q>24)return null;var ce=1<<Q,ae=Cs(Q,N=(N%ce+ce)%ce,V);if(this.tiles[ae])return Dt(this.tiles[ae],ee);ne>1&&console.log("drilling down to z%d-%d-%d",Q,N,V);for(var ie,de=Q,Ie=N,Te=V;!ie&&de>0;)de--,Ie=Math.floor(Ie/2),Te=Math.floor(Te/2),ie=this.tiles[Cs(de,Ie,Te)];return ie&&ie.source?(ne>1&&console.log("found parent tile z%d-%d-%d",de,Ie,Te),ne>1&&console.time("drilling down"),this.splitTile(ie.source,de,Ie,Te,Q,N,V),ne>1&&console.timeEnd("drilling down"),this.tiles[ae]?Dt(this.tiles[ae],ee):null):null};class rc extends to{constructor(N,V,q,ee){super(N,V,q,Ln),this._dataUpdateable=new Map,this.loadGeoJSON=(ne,ce)=>{const{promoteId:ae}=ne;if(ne.request)return v.getJSON(ne.request,(ie,de,Ie,Te)=>{this._dataUpdateable=Ss(de,ae)?tr(de,ae):void 0,ce(ie,de,Ie,Te)});if("string"==typeof ne.data)try{const ie=JSON.parse(ne.data);this._dataUpdateable=Ss(ie,ae)?tr(ie,ae):void 0,ce(null,ie)}catch{ce(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}else ne.dataDiff?this._dataUpdateable?(function(ie,de,Ie){var Te,Ee,gt,It;if(de.removeAll&&ie.clear(),de.remove)for(const it of de.remove)ie.delete(it);if(de.add)for(const it of de.add){const pt=zo(it,Ie);null!=pt&&ie.set(pt,it)}if(de.update)for(const it of de.update){let pt=ie.get(it.id);if(null==pt)continue;const Ct=!it.removeAllProperties&&((null===(Te=it.removeProperties)||void 0===Te?void 0:Te.length)>0||(null===(Ee=it.addOrUpdateProperties)||void 0===Ee?void 0:Ee.length)>0);if((it.newGeometry||it.removeAllProperties||Ct)&&(pt={...pt},ie.set(it.id,pt),Ct&&(pt.properties={...pt.properties})),it.newGeometry&&(pt.geometry=it.newGeometry),it.removeAllProperties)pt.properties={};else if((null===(gt=it.removeProperties)||void 0===gt?void 0:gt.length)>0)for(const en of it.removeProperties)Object.prototype.hasOwnProperty.call(pt.properties,en)&&delete pt.properties[en];if((null===(It=it.addOrUpdateProperties)||void 0===It?void 0:It.length)>0)for(const{key:en,value:zt}of it.addOrUpdateProperties)pt.properties[en]=zt}}(this._dataUpdateable,ne.dataDiff,ae),ce(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):ce(new Error(`Cannot update existing geojson data in ${ne.source}`)):ce(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ee&&(this.loadGeoJSON=ee)}loadData(N,V){var q;null===(q=this._pendingRequest)||void 0===q||q.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new v.RequestPerformance(N.request);this._pendingCallback=V,this._pendingRequest=this.loadGeoJSON(N,(ne,ce)=>{if(delete this._pendingCallback,delete this._pendingRequest,ne||!ce)return V(ne);if("object"!=typeof ce)return V(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{qn(ce,!0);try{if(N.filter){const ie=v.createExpression(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ie.result)throw new Error(ie.value.map(Ie=>`${Ie.key}: ${Ie.message}`).join(", "));ce={type:"FeatureCollection",features:ce.features.filter(Ie=>ie.value.evaluate({zoom:0},Ie))}}this._geoJSONIndex=N.cluster?new Na(function({superclusterOptions:ie,clusterProperties:de}){if(!de||!ie)return ie;const Ie={},Te={},Ee={accumulated:null,zoom:0},gt={properties:null},It=Object.keys(de);for(const it of It){const[pt,Ct]=de[it],en=v.createExpression(Ct),zt=v.createExpression("string"==typeof pt?[pt,["accumulated"],["get",it]]:pt);Ie[it]=en.value,Te[it]=zt.value}return ie.map=it=>{gt.properties=it;const pt={};for(const Ct of It)pt[Ct]=Ie[Ct].evaluate(Ee,gt);return pt},ie.reduce=(it,pt)=>{gt.properties=pt;for(const Ct of It)Ee.accumulated=it[Ct],it[Ct]=Te[Ct].evaluate(Ee,gt)},ie}(N)).load(ce.features):new Es(ie=ce,N.geojsonVtOptions)}catch(ie){return V(ie)}this.loaded={};const ae={};if(ee){const ie=ee.finish();ie&&(ae.resourceTiming={},ae.resourceTiming[N.source]=JSON.parse(JSON.stringify(ie)))}V(null,ae)}var ie})}reloadTile(N,V){const q=this.loaded;return q&&q[N.uid]?super.reloadTile(N,V):this.loadTile(N,V)}removeSource(N,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),V()}getClusterExpansionZoom(N,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(q){V(q)}}getClusterChildren(N,V){try{V(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(q){V(q)}}getClusterLeaves(N,V){try{V(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(q){V(q)}}}class os{constructor(N){this.self=N,this.actor=new v.Actor(N,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:to,geojson:rc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(V,q)=>{if(this.workerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.workerSourceTypes[V]=q},this.self.registerRTLTextPlugin=V=>{if(v.plugin.isParsed())throw new Error("RTL text plugin already registered.");v.plugin.applyArabicShaping=V.applyArabicShaping,v.plugin.processBidirectionalText=V.processBidirectionalText,v.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}}setReferrer(N,V){this.referrer=V}setImages(N,V,q){this.availableImages[N]=V;for(const ee in this.workerSources[N]){const ne=this.workerSources[N][ee];for(const ce in ne)ne[ce].availableImages=V}q()}setLayers(N,V,q){this.getLayerIndex(N).replace(V),q()}updateLayers(N,V,q){this.getLayerIndex(N).update(V.layers,V.removedIds),q()}loadTile(N,V,q){this.getWorkerSource(N,V.type,V.source).loadTile(V,q)}loadDEMTile(N,V,q){this.getDEMWorkerSource(N,V.source).loadTile(V,q)}reloadTile(N,V,q){this.getWorkerSource(N,V.type,V.source).reloadTile(V,q)}abortTile(N,V,q){this.getWorkerSource(N,V.type,V.source).abortTile(V,q)}removeTile(N,V,q){this.getWorkerSource(N,V.type,V.source).removeTile(V,q)}removeDEMTile(N,V){this.getDEMWorkerSource(N,V.source).removeTile(V)}removeSource(N,V,q){if(!this.workerSources[N]||!this.workerSources[N][V.type]||!this.workerSources[N][V.type][V.source])return;const ee=this.workerSources[N][V.type][V.source];delete this.workerSources[N][V.type][V.source],void 0!==ee.removeSource?ee.removeSource(V,q):q()}loadWorkerSource(N,V,q){try{this.self.importScripts(V.url),q()}catch(ee){q(ee.toString())}}syncRTLPluginState(N,V,q){try{v.plugin.setState(V);const ee=v.plugin.getPluginURL();if(v.plugin.isLoaded()&&!v.plugin.isParsed()&&null!=ee){this.self.importScripts(ee);const ne=v.plugin.isParsed();q(ne?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ee}`),ne)}}catch(ee){q(ee.toString())}}getAvailableImages(N){let V=this.availableImages[N];return V||(V=[]),V}getLayerIndex(N){let V=this.layerIndexes[N];return V||(V=this.layerIndexes[N]=new Jt),V}getWorkerSource(N,V,q){return this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][V]||(this.workerSources[N][V]={}),this.workerSources[N][V][q]||(this.workerSources[N][V][q]=new this.workerSourceTypes[V]({send:(ne,ce,ae)=>{this.actor.send(ne,ce,ae,N)}},this.getLayerIndex(N),this.getAvailableImages(N))),this.workerSources[N][V][q]}getDEMWorkerSource(N,V){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][V]||(this.demWorkerSources[N][V]=new bs),this.demWorkerSources[N][V]}}return v.isWorker()&&(self.worker=new os(self)),os}),nc(0,function(v){class xe{static testProp(s){if(!xe.docStyle)return s[0];for(let d=0;d<s.length;d++)if(s[d]in xe.docStyle)return s[d];return s[0]}static create(s,d,f){const _=window.document.createElement(s);return void 0!==d&&(_.className=d),f&&f.appendChild(_),_}static createNS(s,d){return window.document.createElementNS(s,d)}static disableDrag(){xe.docStyle&&xe.selectProp&&(xe.userSelect=xe.docStyle[xe.selectProp],xe.docStyle[xe.selectProp]="none")}static enableDrag(){xe.docStyle&&xe.selectProp&&(xe.docStyle[xe.selectProp]=xe.userSelect)}static setTransform(s,d){s.style[xe.transformProp]=d}static addEventListener(s,d,f,_={}){s.addEventListener(d,f,"passive"in _?_:_.capture)}static removeEventListener(s,d,f,_={}){s.removeEventListener(d,f,"passive"in _?_:_.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",xe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",xe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",xe.suppressClickInternal,!0)},0)}static mousePos(s,d){const f=s.getBoundingClientRect();return new v.Point(d.clientX-f.left-s.clientLeft,d.clientY-f.top-s.clientTop)}static touchPos(s,d){const f=s.getBoundingClientRect(),_=[];for(let w=0;w<d.length;w++)_.push(new v.Point(d[w].clientX-f.left-s.clientLeft,d[w].clientY-f.top-s.clientTop));return _}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}xe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,xe.selectProp=xe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),xe.transformProp=xe.testProp(["transform","WebkitTransform"]);const Qi={supported:!1,testSupport:function(m){!to&&yr&&(bs?no(m):ut=m)}};let ut,yr,to=!1,bs=!1;function no(m){const s=m.createTexture();m.bindTexture(m.TEXTURE_2D,s);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,yr),m.isContextLost())return;Qi.supported=!0}catch{}m.deleteTexture(s),to=!0}var rs;typeof document<"u"&&(yr=document.createElement("img"),yr.onload=function(){ut&&no(ut),ut=null,bs=!0},yr.onerror=function(){to=!0,ut=null},yr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let s,d,f,_;m.resetRequestQueue=()=>{s=[],d=0,f=0,_={}},m.addThrottleControl=k=>{const O=f++;return _[O]=k,O},m.removeThrottleControl=k=>{delete _[k],T()},m.getImage=(k,O,F=!0)=>{Qi.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*");const j={requestParameters:k,supportImageRefresh:F,callback:O,cancelled:!1,completed:!1,cancel:()=>{j.completed||j.cancelled||(j.cancelled=!0,j.innerRequest&&(j.innerRequest.cancel(),d--),T())}};return s.push(j),T(),j};const w=k=>{const{requestParameters:O,supportImageRefresh:F,callback:j}=k;return v.extend(O,{type:"image"}),(!1!==F||v.isWorker()||v.getProtocolAction(O.url)||O.headers&&!Object.keys(O.headers).reduce((K,G)=>K&&"accept"===G,!0)?v.makeRequest:M)(O,(K,G,Z,te)=>{S(k,j,K,G,Z,te)})},S=(k,O,F,j,K,G)=>{var Z,te;F?O(F):j instanceof HTMLImageElement||j instanceof ImageBitmap?O(null,j):j&&(Z=j,te=(Z,te)=>{null!=Z?O(Z):null!=te&&O(null,te,{cacheControl:K,expires:G})},"function"==typeof createImageBitmap?v.arrayBufferToImageBitmap(Z,te):v.arrayBufferToImage(Z,te)),k.cancelled||(k.completed=!0,d--,T())},T=()=>{const k=(()=>{const O=Object.keys(_);let F=!1;if(O.length>0)for(const j of O)if(F=_[j](),F)break;return F})()?v.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:v.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=d;O<k&&s.length>0;O++){const F=s.shift();if(F.cancelled){O--;continue}const j=w(F);d++,F.innerRequest=j}},M=(k,O)=>{const F=new Image,j=k.url;let K=!1;const G=k.credentials;return G&&"include"===G?F.crossOrigin="use-credentials":(G&&"same-origin"===G||!v.sameOrigin(j))&&(F.crossOrigin="anonymous"),F.fetchPriority="high",F.onload=()=>{O(null,F),F.onerror=F.onload=null},F.onerror=()=>{K||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),F.onerror=F.onload=null},F.src=j,{cancel:()=>{K=!0,F.src=""}}}}(rs||(rs={})),rs.resetRequestQueue();var qn,m,yo=rs;(m=qn||(qn={})).Glyphs="Glyphs",m.Image="Image",m.Source="Source",m.SpriteImage="SpriteImage",m.SpriteJSON="SpriteJSON",m.Style="Style",m.Tile="Tile",m.Unknown="Unknown";class Ri{constructor(s){this._transformRequestFn=s}transformRequest(s,d){return this._transformRequestFn&&this._transformRequestFn(s,d)||{url:s}}normalizeSpriteURL(s,d,f){const _=function(w){const S=w.match(Oo);if(!S)throw new Error(`Unable to parse URL "${w}"`);return{protocol:S[1],authority:S[2],path:S[3]||"/",params:S[4]?S[4].split("&"):[]}}(s);return _.path+=`${d}${f}`,function(w){const S=w.params.length?`?${w.params.join("&")}`:"";return`${w.protocol}://${w.authority}${w.path}${S}`}(_)}setTransformRequest(s){this._transformRequestFn=s}}const Oo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Lo(m){var s=new v.ARRAY_TYPE(3);return s[0]=m[0],s[1]=m[1],s[2]=m[2],s}var He,ze=function(m,s,d){return m[0]=s[0]-d[0],m[1]=s[1]-d[1],m[2]=s[2]-d[2],m};He=new v.ARRAY_TYPE(3),v.ARRAY_TYPE!=Float32Array&&(He[0]=0,He[1]=0,He[2]=0);var We=function(m){var s=m[0],d=m[1];return s*s+d*d};function dt(m){const s=[];if("string"==typeof m)s.push({id:"default",url:m});else if(m&&m.length>0){const d=[];for(const{id:f,url:_}of m){const w=`${f}${_}`;-1===d.indexOf(w)&&(d.push(w),s.push({id:f,url:_}))}}return s}function mt(m,s,d,f,_){if(f)return void m(f);if(_!==Object.values(s).length||_!==Object.values(d).length)return;const w={};for(const S in s){w[S]={};const T=v.exported.getImageCanvasContext(d[S]),M=s[S];for(const k in M){const{width:O,height:F,x:j,y:K,sdf:G,pixelRatio:Z,stretchX:te,stretchY:le,content:fe}=M[k];w[S][k]={data:null,pixelRatio:Z,sdf:G,stretchX:te,stretchY:le,content:fe,spriteData:{width:O,height:F,x:j,y:K,context:T}}}}m(null,w)}!function(){var m=new v.ARRAY_TYPE(2);v.ARRAY_TYPE!=Float32Array&&(m[0]=0,m[1]=0)}();class ht{constructor(s,d,f,_){this.context=s,this.format=f,this.texture=s.gl.createTexture(),this.update(d,_)}update(s,d,f){const{width:_,height:w}=s,S=!(this.size&&this.size[0]===_&&this.size[1]===w||f),{context:T}=this,{gl:M}=T;if(this.useMipmap=!(!d||!d.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!d||!1!==d.premultiply)),S)this.size=[_,w],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||v.isImageBitmap(s)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,s):M.texImage2D(M.TEXTURE_2D,0,this.format,_,w,0,this.format,M.UNSIGNED_BYTE,s.data);else{const{x:k,y:O}=f||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||v.isImageBitmap(s)?M.texSubImage2D(M.TEXTURE_2D,0,k,O,M.RGBA,M.UNSIGNED_BYTE,s):M.texSubImage2D(M.TEXTURE_2D,0,k,O,_,w,M.RGBA,M.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(s,d,f){const{context:_}=this,{gl:w}=_;w.bindTexture(w.TEXTURE_2D,this.texture),f!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=w.LINEAR),s!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,s),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,f||s),this.filter=s),d!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,d),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function Bt(m){const{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class Zn extends v.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new v.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:d,callback:f}of this.requestors)this._notify(d,f);this.requestors=[]}}getImage(s){const d=this.images[s];if(d&&!d.data&&d.spriteData){const f=d.spriteData;d.data=new v.RGBAImage({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),d.spriteData=null}return d}addImage(s,d){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,d)&&(this.images[s]=d)}_validate(s,d){let f=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new v.ErrorEvent(new Error(`Image "${s}" has invalid "stretchX" value`))),f=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new v.ErrorEvent(new Error(`Image "${s}" has invalid "stretchY" value`))),f=!1),this._validateContent(d.content,d)||(this.fire(new v.ErrorEvent(new Error(`Image "${s}" has invalid "content" value`))),f=!1),f}_validateStretch(s,d){if(!s)return!0;let f=0;for(const _ of s){if(_[0]<f||_[1]<_[0]||d<_[1])return!1;f=_[1]}return!0}_validateContent(s,d){if(!s)return!0;if(4!==s.length)return!1;const f=d.spriteData,_=f&&f.width||d.data.width,w=f&&f.height||d.data.height;return!(s[0]<0||_<s[0]||s[1]<0||w<s[1]||s[2]<0||_<s[2]||s[3]<0||w<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,d,f=!0){const _=this.getImage(s);if(f&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[s]=d,this.updatedImages[s]=!0}removeImage(s){const d=this.images[s];delete this.images[s],delete this.patterns[s],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,d){let f=!0;if(!this.isLoaded())for(const _ of s)this.images[_]||(f=!1);this.isLoaded()||f?this._notify(s,d):this.requestors.push({ids:s,callback:d})}_notify(s,d){const f={};for(const _ of s){let w=this.getImage(_);w||(this.fire(new v.Event("styleimagemissing",{id:_})),w=this.getImage(_)),w?f[_]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!(!w.userImage||!w.userImage.render)}:v.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,f)}getPixelSize(){const{width:s,height:d}=this.atlasImage;return{width:s,height:d}}getPattern(s){const d=this.patterns[s],f=this.getImage(s);if(!f)return null;if(d&&d.position.version===f.version)return d.position;if(d)d.position.version=f.version;else{const _={w:f.data.width+2,h:f.data.height+2,x:0,y:0},w=new v.ImagePosition(_,f);this.patterns[s]={bin:_,position:w}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const d=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ht(s,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const w in this.patterns)s.push(this.patterns[w].bin);const{w:d,h:f}=v.potpack(s),_=this.atlasImage;_.resize({width:d||1,height:f||1});for(const w in this.patterns){const{bin:S}=this.patterns[w],T=S.x+1,M=S.y+1,k=this.getImage(w).data,O=k.width,F=k.height;v.RGBAImage.copy(k,_,{x:0,y:0},{x:T,y:M},{width:O,height:F}),v.RGBAImage.copy(k,_,{x:0,y:F-1},{x:T,y:M-1},{width:O,height:1}),v.RGBAImage.copy(k,_,{x:0,y:0},{x:T,y:M+F},{width:O,height:1}),v.RGBAImage.copy(k,_,{x:O-1,y:0},{x:T-1,y:M},{width:1,height:F}),v.RGBAImage.copy(k,_,{x:0,y:0},{x:T+O,y:M},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const d of s){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const f=this.getImage(d);f||v.warnOnce(`Image with ID: "${d}" was not found`),Bt(f)&&this.updateImage(d,f)}}}const Ji=1e20;function No(m,s,d,f,_,w,S,T,M){for(let k=s;k<s+f;k++)Bo(m,d*w+k,w,_,S,T,M);for(let k=d;k<d+_;k++)Bo(m,k*w+s,1,f,S,T,M)}function Bo(m,s,d,f,_,w,S){w[0]=0,S[0]=-Ji,S[1]=Ji,_[0]=m[s];for(let T=1,M=0,k=0;T<f;T++){_[T]=m[s+T*d];const O=T*T;do{const F=w[M];k=(_[T]-_[F]+O-F*F)/(T-F)/2}while(k<=S[M]&&--M>-1);M++,w[M]=T,S[M]=k,S[M+1]=Ji}for(let T=0,M=0;T<f;T++){for(;S[M+1]<T;)M++;const k=w[M],O=T-k;m[s+T*d]=_[k]+O*O}}class vr{constructor(s,d){this.requestManager=s,this.localIdeographFontFamily=d,this.entries={}}setURL(s){this.url=s}getGlyphs(s,d){const f=[];for(const _ in s)for(const w of s[_])f.push({stack:_,id:w});v.asyncAll(f,({stack:_,id:w},S)=>{let T=this.entries[_];T||(T=this.entries[_]={glyphs:{},requests:{},ranges:{}});let M=T.glyphs[w];if(void 0!==M)return void S(null,{stack:_,id:w,glyph:M});if(M=this._tinySDF(T,_,w),M)return T.glyphs[w]=M,void S(null,{stack:_,id:w,glyph:M});const k=Math.floor(w/256);if(256*k>65535)return void S(new Error("glyphs > 65535 not supported"));if(T.ranges[k])return void S(null,{stack:_,id:w,glyph:M});if(!this.url)return void S(new Error("glyphsUrl is not set"));let O=T.requests[k];O||(O=T.requests[k]=[],vr.loadGlyphRange(_,k,this.url,this.requestManager,(F,j)=>{if(j){for(const K in j)this._doesCharSupportLocalGlyph(+K)||(T.glyphs[+K]=j[+K]);T.ranges[k]=!0}for(const K of O)K(F,j);delete T.requests[k]})),O.push((F,j)=>{F?S(F):j&&S(null,{stack:_,id:w,glyph:j[w]||null})})},(_,w)=>{if(_)d(_);else if(w){const S={};for(const{stack:T,id:M,glyph:k}of w)(S[T]||(S[T]={}))[M]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};d(null,S)}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(v.unicodeBlockLookup["CJK Unified Ideographs"](s)||v.unicodeBlockLookup["Hangul Syllables"](s)||v.unicodeBlockLookup.Hiragana(s)||v.unicodeBlockLookup.Katakana(s))}_tinySDF(s,d,f){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(f))return;let w=s.tinySDF;if(!w){let T="400";/bold/i.test(d)?T="900":/medium/i.test(d)?T="500":/light/i.test(d)&&(T="200"),w=s.tinySDF=new vr.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:_,fontWeight:T})}const S=w.draw(String.fromCharCode(f));return{id:f,bitmap:new v.AlphaImage({width:S.width||30,height:S.height||30},S.data),metrics:{width:S.glyphWidth||24,height:S.glyphHeight||24,left:S.glyphLeft||0,top:S.glyphTop-27||-8,advance:S.glyphAdvance||24}}}}vr.loadGlyphRange=function(m,s,d,f,_){const w=256*s,S=w+255,T=f.transformRequest(d.replace("{fontstack}",m).replace("{range}",`${w}-${S}`),qn.Glyphs);v.getArrayBuffer(T,(M,k)=>{if(M)_(M);else if(k){const O={};for(const F of v.parseGlyphPbf(k))O[F.id]=F;_(null,O)}})},vr.TinySDF=class{constructor({fontSize:m=24,buffer:s=3,radius:d=8,cutoff:f=.25,fontFamily:_="sans-serif",fontWeight:w="normal",fontStyle:S="normal"}={}){this.buffer=s,this.cutoff=f,this.radius=d;const T=this.size=m+4*s,M=this._createCanvas(T),k=this.ctx=M.getContext("2d",{willReadFrequently:!0});k.font=`${S} ${w} ${m}px ${_}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(m){const s=document.createElement("canvas");return s.width=s.height=m,s}draw(m){const{width:s,actualBoundingBoxAscent:d,actualBoundingBoxDescent:f,actualBoundingBoxLeft:_,actualBoundingBoxRight:w}=this.ctx.measureText(m),S=Math.ceil(d),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-_))),M=Math.min(this.size-this.buffer,S+Math.ceil(f)),k=T+2*this.buffer,O=M+2*this.buffer,F=Math.max(k*O,0),j=new Uint8ClampedArray(F),K={data:j,width:k,height:O,glyphWidth:T,glyphHeight:M,glyphTop:S,glyphLeft:0,glyphAdvance:s};if(0===T||0===M)return K;const{ctx:G,buffer:Z,gridInner:te,gridOuter:le}=this;G.clearRect(Z,Z,T,M),G.fillText(m,Z,Z+S);const fe=G.getImageData(Z,Z,T,M);le.fill(Ji,0,F),te.fill(0,0,F);for(let J=0;J<M;J++)for(let pe=0;pe<T;pe++){const ve=fe.data[4*(J*T+pe)+3]/255;if(0===ve)continue;const De=(J+Z)*k+pe+Z;if(1===ve)le[De]=0,te[De]=Ji;else{const Ae=.5-ve;le[De]=Ae>0?Ae*Ae:0,te[De]=Ae<0?Ae*Ae:0}}No(le,0,0,k,O,k,this.f,this.v,this.z),No(te,Z,Z,T,M,k,this.f,this.v,this.z);for(let J=0;J<F;J++){const pe=Math.sqrt(le[J])-Math.sqrt(te[J]);j[J]=Math.round(255-255*(pe/this.radius+this.cutoff))}return K}};class hl{constructor(){this.specification=v.v8Spec.light.position}possiblyEvaluate(s,d){return v.sphericalToCartesian(s.expression.evaluate(d))}interpolate(s,d,f){return{x:v.interpolate.number(s.x,d.x,f),y:v.interpolate.number(s.y,d.y,f),z:v.interpolate.number(s.z,d.z,f)}}}let Ks,bn;class pl extends v.Evented{constructor(s){super(),Ks=Ks||new v.Properties({anchor:new v.DataConstantProperty(v.v8Spec.light.anchor),position:new hl,color:new v.DataConstantProperty(v.v8Spec.light.color),intensity:new v.DataConstantProperty(v.v8Spec.light.intensity)}),this._transitionable=new v.Transitionable(Ks),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,d={}){if(!this._validate(v.validateLight,s,d))for(const f in s){const _=s[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),_):this._transitionable.setValue(f,_)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,d,f){return(!f||!1!==f.validate)&&v.emitValidationErrors(this,s.call(v.validateStyle,v.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:v.v8Spec})))}}class Xs{constructor(s,d){this.width=s,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,d){const f=s.join(",")+String(d);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(s,d)),this.dashEntry[f]}getDashRanges(s,d,f){const _=[];let w=s.length%2==1?-s[s.length-1]*f:0,S=s[0]*f,T=!0;_.push({left:w,right:S,isDash:T,zeroLength:0===s[0]});let M=s[0];for(let k=1;k<s.length;k++){T=!T;const O=s[k];w=M*f,M+=O,S=M*f,_.push({left:w,right:S,isDash:T,zeroLength:0===O})}return _}addRoundDash(s,d,f){const _=d/2;for(let w=-f;w<=f;w++){const S=this.width*(this.nextRow+f+w);let T=0,M=s[T];for(let k=0;k<this.width;k++){k/M.right>1&&(M=s[++T]);const O=Math.abs(k-M.left),F=Math.abs(k-M.right),j=Math.min(O,F);let K;const G=w/f*(_+1);if(M.isDash){const Z=_-Math.abs(G);K=Math.sqrt(j*j+Z*Z)}else K=_-Math.sqrt(j*j+G*G);this.data[S+k]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(s){for(let T=s.length-1;T>=0;--T){const M=s[T],k=s[T+1];M.zeroLength?s.splice(T,1):k&&k.isDash===M.isDash&&(k.left=M.left,s.splice(T,1))}const d=s[0],f=s[s.length-1];d.isDash===f.isDash&&(d.left=f.left-this.width,f.right=d.right+this.width);const _=this.width*this.nextRow;let w=0,S=s[w];for(let T=0;T<this.width;T++){T/S.right>1&&(S=s[++w]);const M=Math.abs(T-S.left),k=Math.abs(T-S.right),O=Math.min(M,k);this.data[_+T]=Math.max(0,Math.min(255,(S.isDash?O:-O)+128))}}addDash(s,d){const f=d?7:0,_=2*f+1;if(this.nextRow+_>this.height)return v.warnOnce("LineAtlas out of space"),null;let w=0;for(let T=0;T<s.length;T++)w+=s[T];if(0!==w){const T=this.width/w,M=this.getDashRanges(s,this.width,T);d?this.addRoundDash(M,T,f):this.addRegularDash(M)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:w};return this.nextRow+=_,this.dirty=!0,S}bind(s){const d=s.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class Lr{constructor(s,d,f){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=f;const _=this.workerPool.acquire(f);for(let w=0;w<_.length;w++){const S=new Lr.Actor(_[w],d,f);S.name=`Worker ${w}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,d,f){v.asyncAll(this.actors,(_,w)=>{_.send(s,d,w)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}}function vo(m,s,d){const f=function(_,w){if(_)return d(_);if(w){const S=v.pick(v.extend(w,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(T=>T.id)),d(null,S)}};return m.url?v.getJSON(s.transformRequest(m.url,qn.Source),f):v.exported.frame(()=>f(null,m))}Lr.Actor=v.Actor;class St{constructor(s,d){s&&(d?this.setSouthWest(s).setNorthEast(d):Array.isArray(s)&&(4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof v.LngLat?new v.LngLat(s.lng,s.lat):v.LngLat.convert(s),this}setSouthWest(s){return this._sw=s instanceof v.LngLat?new v.LngLat(s.lng,s.lat):v.LngLat.convert(s),this}extend(s){const d=this._sw,f=this._ne;let _,w;if(s instanceof v.LngLat)_=s,w=s;else{if(!(s instanceof St))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(St.convert(s)):this.extend(v.LngLat.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(v.LngLat.convert(s)):this;if(_=s._sw,w=s._ne,!_||!w)return this}return d||f?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),f.lng=Math.max(w.lng,f.lng),f.lat=Math.max(w.lat,f.lat)):(this._sw=new v.LngLat(_.lng,_.lat),this._ne=new v.LngLat(w.lng,w.lat)),this}getCenter(){return new v.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new v.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new v.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:d,lat:f}=v.LngLat.convert(s);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&_}static convert(s){return s instanceof St?s:s&&new St(s)}static fromLngLat(s,d=0){const f=360*d/40075017,_=f/Math.cos(Math.PI/180*s.lat);return new St(new v.LngLat(s.lng-_,s.lat-f),new v.LngLat(s.lng+_,s.lat+f))}}class Na{constructor(s,d,f){this.bounds=St.convert(this.validateBounds(s)),this.minzoom=d||0,this.maxzoom=f||24}validateBounds(s){return Array.isArray(s)&&4===s.length?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const d=Math.pow(2,s.z),f=Math.floor(v.mercatorXfromLng(this.bounds.getWest())*d),_=Math.floor(v.mercatorYfromLat(this.bounds.getNorth())*d),w=Math.ceil(v.mercatorXfromLng(this.bounds.getEast())*d),S=Math.ceil(v.mercatorYfromLat(this.bounds.getSouth())*d);return s.x>=f&&s.x<w&&s.y>=_&&s.y<S}}class Ba extends v.Evented{constructor(s,d,f,_){if(super(),this.id=s,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.extend(this,v.pick(d,["url","scheme","tileSize","promoteId"])),this._options=v.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vo(this._options,this.map._requestManager,(s,d)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s?this.fire(new v.ErrorEvent(s)):d&&(v.extend(this,d),d.bounds&&(this.tileBounds=new Na(d.bounds,this.minzoom,this.maxzoom)),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.cancel(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return v.extend({},this._options)}loadTile(s,d){const f=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(f,qn.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function w(S,T){return delete s.request,s.aborted?d(null):S&&404!==S.status?d(S):(T&&T.resourceTiming&&(s.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&s.setExpiryData(T),s.loadVectorData(T,this.map.painter),d(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,s.actor&&"expired"!==s.state?"loading"===s.state?s.reloadCallback=d:s.request=s.actor.send("reloadTile",_,w.bind(this)):(s.actor=this.dispatcher.getActor(),s.request=s.actor.send("loadTile",_,w.bind(this)))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id},void 0)}unloadTile(s){s.unloadVectorData(),s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class In extends v.Evented{constructor(s,d,f,_){super(),this.id=s,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=v.extend({type:"raster"},d),v.extend(this,v.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vo(this._options,this.map._requestManager,(s,d)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new v.ErrorEvent(s)):d&&(v.extend(this,d),d.bounds&&(this.tileBounds=new Na(d.bounds,this.minzoom,this.maxzoom)),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return v.extend({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,d){const f=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.request=yo.getImage(this.map._requestManager.transformRequest(f,qn.Tile),(_,w,S)=>{if(delete s.request,s.aborted)s.state="unloaded",d(null);else if(_)s.state="errored",d(_);else if(w){this.map._refreshExpiredTiles&&S&&s.setExpiryData(S);const T=this.map.painter.context,M=T.gl;s.texture=this.map.painter.getTileTexture(w.width),s.texture?s.texture.update(w,{useMipmap:!0}):(s.texture=new ht(T,w,M.RGBA,{useMipmap:!0}),s.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),T.extTextureFilterAnisotropic&&M.texParameterf(M.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax)),s.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(s,d){s.request&&(s.request.cancel(),delete s.request),d()}unloadTile(s,d){s.texture&&this.map.painter.saveTileTexture(s.texture),d()}hasTransition(){return!1}}class xn extends In{constructor(s,d,f,_){super(s,d,f,_),this.type="raster-dem",this.maxzoom=22,this._options=v.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(s,d){const f=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function _(w,S){w&&(s.state="errored",d(w)),S&&(s.dem=S,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded",d(null))}s.request=yo.getImage(this.map._requestManager.transformRequest(f,qn.Tile),function(w,S){if(delete s.request,s.aborted)s.state="unloaded",d(null);else if(w)s.state="errored",d(w);else if(S){this.map._refreshExpiredTiles&&s.setExpiryData(S),delete S.cacheControl,delete S.expires;const T=v.isImageBitmap(S)&&(null==bn&&(bn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),bn)?S:v.exported.getImageData(S,1),M={uid:s.uid,coord:s.tileID,source:this.id,rawImageData:T,encoding:this.encoding};s.actor&&"expired"!==s.state||(s.actor=this.dispatcher.getActor(),s.actor.send("loadDEMTile",M,_.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),s.neighboringTiles=this._getNeighboringTiles(s.tileID)}_getNeighboringTiles(s){const d=s.canonical,f=Math.pow(2,d.z),_=(d.x-1+f)%f,w=0===d.x?s.wrap-1:s.wrap,S=(d.x+1+f)%f,T=d.x+1===f?s.wrap+1:s.wrap,M={};return M[new v.OverscaledTileID(s.overscaledZ,w,d.z,_,d.y).key]={backfilled:!1},M[new v.OverscaledTileID(s.overscaledZ,T,d.z,S,d.y).key]={backfilled:!1},d.y>0&&(M[new v.OverscaledTileID(s.overscaledZ,w,d.z,_,d.y-1).key]={backfilled:!1},M[new v.OverscaledTileID(s.overscaledZ,s.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},M[new v.OverscaledTileID(s.overscaledZ,T,d.z,S,d.y-1).key]={backfilled:!1}),d.y+1<f&&(M[new v.OverscaledTileID(s.overscaledZ,w,d.z,_,d.y+1).key]={backfilled:!1},M[new v.OverscaledTileID(s.overscaledZ,s.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},M[new v.OverscaledTileID(s.overscaledZ,T,d.z,S,d.y+1).key]={backfilled:!1}),M}unloadTile(s){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&s.actor.send("removeDEMTile",{uid:s.uid,source:this.id})}}class xs extends v.Evented{constructor(s,d,f,_){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(_),this._data=d.data,this._options=v.extend({},d),this._collectResourceTiming=d.collectResourceTiming,void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const w=v.EXTENT/this.tileSize;this.workerOptions=v.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*w,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*w,extent:v.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:v.EXTENT,radius:(d.clusterRadius||50)*w,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(void 0!==s.clusterRadius&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),void 0!==s.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:s,source:this.id},d),this}getClusterChildren(s,d){return this.actor.send("geojson.getClusterChildren",{clusterId:s,source:this.id},d),this}getClusterLeaves(s,d,f,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:s,limit:d,offset:f},_),this}_updateWorkerData(s){const d=v.extend({},this.workerOptions);s?d.dataDiff=s:"string"==typeof this._data?(d.request=this.map._requestManager.transformRequest(v.exported.resolveURL(this._data),qn.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new v.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(f,_)=>{if(this._pendingLoads--,this._removed||_&&_.abandoned)return void this.fire(new v.Event("dataabort",{dataType:"source"}));let w=null;if(_&&_.resourceTiming&&_.resourceTiming[this.id]&&(w=_.resourceTiming[this.id].slice(0)),f)return void this.fire(new v.ErrorEvent(f));const S={dataType:"source"};this._collectResourceTiming&&w&&w.length>0&&v.extend(S,{resourceTiming:w}),this.fire(new v.Event("data",{...S,sourceDataType:"metadata"})),this.fire(new v.Event("data",{...S,sourceDataType:"content"}))})}loaded(){return 0===this._pendingLoads}loadTile(s,d){const f=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const _={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.request=this.actor.send(f,_,(w,S)=>(delete s.request,s.unloadVectorData(),s.aborted?d(null):w?d(w):(s.loadVectorData(S,this.map.painter,"reloadTile"===f),d(null))))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.aborted=!0}unloadTile(s){s.unloadVectorData(),this.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return v.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var wt=v.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class qr extends v.Evented{constructor(s,d,f,_){super(),this.id=s,this.dispatcher=f,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(s,d){this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=yo.getImage(this.map._requestManager.transformRequest(this.url,qn.Image),(f,_)=>{this._request=null,this._loaded=!0,f?this.fire(new v.ErrorEvent(f)):_&&(this.image=_,s&&(this.coordinates=s),d&&d(),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=s.url,this.load(s.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(s){this.coordinates=s;const d=s.map(v.MercatorCoordinate.fromLngLat);this.tileID=function(_){let w=1/0,S=1/0,T=-1/0,M=-1/0;for(const j of _)w=Math.min(w,j.x),S=Math.min(S,j.y),T=Math.max(T,j.x),M=Math.max(M,j.y);const k=Math.max(T-w,M-S),O=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),F=Math.pow(2,O);return new v.CanonicalTileID(O,Math.floor((w+T)/2*F),Math.floor((S+M)/2*F))}(d),this.minzoom=this.maxzoom=this.tileID.z;const f=d.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new v.RasterBoundsArray,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,v.EXTENT,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,v.EXTENT),this._boundsArray.emplaceBack(f[2].x,f[2].y,v.EXTENT,v.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const s=this.map.painter.context,d=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ht(s,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const w=this.tiles[_];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new v.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s,d){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},d(null)):(s.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class fl extends qr{constructor(s,d,f,_){super(s,d,f,_),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const s=this.options;this.urls=[];for(const d of s.urls)this.urls.push(this.map._requestManager.transformRequest(d,qn.Source).url);v.getVideo(this.urls,(d,f)=>{this._loaded=!0,d?this.fire(new v.ErrorEvent(d)):f&&(this.video=f,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const d=this.video.seekable;s<d.start(0)||s>d.end(0)?this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const s=this.map.painter.context,d=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new ht(s,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const w=this.tiles[_];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new v.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class we extends qr{constructor(s,d,f,_){super(s,d,f,_),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(S=>"number"!=typeof S))||this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${s}`,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof HTMLCanvasElement||this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.ErrorEvent(new v.ValidationError(`sources.${s}`,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new v.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const d=this.map.painter.context,f=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ht(d,this.canvas,f.RGBA,{premultiply:!0});let _=!1;for(const w in this.tiles){const S=this.tiles[w];"loaded"!==S.state&&(S.state="loaded",S.texture=this.texture,_=!0)}_&&this.fire(new v.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const Ys={vector:Ba,raster:In,"raster-dem":xn,geojson:xs,video:fl,image:qr,canvas:we};function ic(m,s){const d=v.create();return v.translate(d,d,[1,1,0]),v.scale(d,d,[.5*m.width,.5*m.height,1]),v.multiply(d,d,m.calculatePosMatrix(s.toUnwrapped()))}function Fn(m,s,d,f,_,w){const S=function(F,j,K){if(F)for(const G of F){const Z=j[G];if(Z&&Z.source===K&&"fill-extrusion"===Z.type)return!0}else for(const G in j){const Z=j[G];if(Z.source===K&&"fill-extrusion"===Z.type)return!0}return!1}(_&&_.layers,s,m.id),T=w.maxPitchScaleFactor(),M=m.tilesIn(f,T,S);M.sort(pn);const k=[];for(const F of M)k.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(s,d,m._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,_,w,T,ic(m.transform,F.tileID))});const O=function(F){const j={},K={};for(const G of F){const Z=G.queryResults,te=G.wrappedTileID,le=K[te]=K[te]||{};for(const fe in Z){const J=Z[fe],pe=le[fe]=le[fe]||{},ve=j[fe]=j[fe]||[];for(const De of J)pe[De.featureIndex]||(pe[De.featureIndex]=!0,ve.push(De))}}return j}(k);for(const F in O)O[F].forEach(j=>{const K=j.feature,G=m.getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=G});return O}function pn(m,s){const d=m.tileID,f=s.tileID;return d.overscaledZ-f.overscaledZ||d.canonical.y-f.canonical.y||d.wrap-f.wrap||d.canonical.x-f.canonical.x}class ml{constructor(s,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=v.uniqueId(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const d=s+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,d,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(_,w){const S={};if(!w)return S;for(const T of _){const M=T.layerIds.map(k=>w.getLayer(k)).filter(Boolean);if(0!==M.length){T.layers=M,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(k=>M.filter(O=>O.id===k)[0]));for(const k of M)S[k.id]=T}}return S}(s.buckets,d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof v.SymbolBucket){if(this.hasSymbolBuckets=!0,!f)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof v.SymbolBucket&&w.hasRTLText){this.hasRTLText=!0,v.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const _ in this.buckets){const w=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(w))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new v.CollisionBoxArray}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const f in this.buckets){const _=this.buckets[f];_.uploadPending()&&_.upload(s)}const d=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ht(s,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ht(s,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,d,f,_,w,S,T,M,k,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:w,scale:S,tileSize:this.tileSize,pixelPosMatrix:O,transform:M,params:T,queryPadding:this.queryPadding*k},s,d,f):{}}querySourceFeatures(s,d){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const _=f.loadVTLayers(),w=d&&d.sourceLayer?d.sourceLayer:"",S=_._geojsonTileLayer||_[w];if(!S)return;const T=v.createFilter(d&&d.filter),{z:M,x:k,y:O}=this.tileID.canonical,F={z:M,x:k,y:O};for(let j=0;j<S.length;j++){const K=S.feature(j);if(T.needGeometry){const te=v.toEvaluationFeature(K,!0);if(!T.filter(new v.EvaluationParameters(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!T.filter(new v.EvaluationParameters(this.tileID.overscaledZ),K))continue;const G=f.getId(K,w),Z=new v.GeoJSONFeature(K,M,k,O,G);Z.tile=F,s.push(Z)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const d=this.expirationTime;if(s.cacheControl){const f=v.parseCacheControl(s.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const f=Date.now();let _=!1;if(this.expirationTime>f)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const w=this.expirationTime-d;w?this.expirationTime=f+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(s,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(s).length)return;const f=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const w=this.buckets[_],S=w.layers[0].sourceLayer||"_geojsonTileLayer",T=f[S],M=s[S];if(!T||!M||0===Object.keys(M).length)continue;w.update(M,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=d&&d.style&&d.style.getLayer(_);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(w)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<v.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=v.exported.now()+s}setDependencies(s,d){const f={};for(const _ of d)f[_]=!0;this.dependencies[s]=f}hasDependency(s,d){for(const f of s){const _=this.dependencies[f];if(_)for(const w of d)if(_[w])return!0}return!1}}class Gc{constructor(s,d){this.max=s,this.onRemove=d,this.reset()}reset(){for(const s in this.data)for(const d of this.data[s])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(s,d,f){const _=s.wrapped().key;void 0===this.data[_]&&(this.data[_]=[]);const w={value:d,timeout:void 0};if(void 0!==f&&(w.timeout=setTimeout(()=>{this.remove(s,w)},f)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const d=this.data[s].shift();return d.timeout&&clearTimeout(d.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),d.value}getByKey(s){const d=this.data[s];return d?d[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,d){if(!this.has(s))return this;const f=s.wrapped().key,_=void 0===d?0:this.data[f].indexOf(d),w=this.data[f][_];return this.data[f].splice(_,1),w.timeout&&clearTimeout(w.timeout),0===this.data[f].length&&delete this.data[f],this.onRemove(w.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(s){const d=[];for(const f in this.data)for(const _ of this.data[f])s(_.value)||d.push(_);for(const f of d)this.remove(f.value.tileID,f)}}class rd{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,d,f){const _=String(d);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][_]=this.stateChanges[s][_]||{},v.extend(this.stateChanges[s][_],f),null===this.deletedStates[s]){this.deletedStates[s]={};for(const w in this.state[s])w!==_&&(this.deletedStates[s][w]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][_]){this.deletedStates[s][_]={};for(const w in this.state[s][_])f[w]||(this.deletedStates[s][_][w]=null)}else for(const w in f)this.deletedStates[s]&&this.deletedStates[s][_]&&null===this.deletedStates[s][_][w]&&delete this.deletedStates[s][_][w]}removeFeatureState(s,d,f){if(null===this.deletedStates[s])return;const _=String(d);if(this.deletedStates[s]=this.deletedStates[s]||{},f&&void 0!==d)null!==this.deletedStates[s][_]&&(this.deletedStates[s][_]=this.deletedStates[s][_]||{},this.deletedStates[s][_][f]=null);else if(void 0!==d)if(this.stateChanges[s]&&this.stateChanges[s][_])for(f in this.deletedStates[s][_]={},this.stateChanges[s][_])this.deletedStates[s][_][f]=null;else this.deletedStates[s][_]=null;else this.deletedStates[s]=null}getState(s,d){const f=String(d),_=v.extend({},(this.state[s]||{})[f],(this.stateChanges[s]||{})[f]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){const w=this.deletedStates[s][d];if(null===w)return{};for(const S in w)delete _[S]}return _}initializeTileState(s,d){s.setFeatureState(this.state,d)}coalesceChanges(s,d){const f={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const w={};for(const S in this.stateChanges[_])this.state[_][S]||(this.state[_][S]={}),v.extend(this.state[_][S],this.stateChanges[_][S]),w[S]=this.state[_][S];f[_]=w}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const w={};if(null===this.deletedStates[_])for(const S in this.state[_])w[S]={},this.state[_][S]={};else for(const S in this.deletedStates[_]){if(null===this.deletedStates[_][S])this.state[_][S]={};else for(const T of Object.keys(this.deletedStates[_][S]))delete this.state[_][S][T];w[S]=this.state[_][S]}f[_]=f[_]||{},v.extend(f[_],w)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(f).length)for(const _ in s)s[_].setFeatureState(f,d)}}class vi extends v.Evented{constructor(s,d,f){super(),this.id=s,this.dispatcher=f,this.on("data",_=>{"source"===_.dataType&&"metadata"===_.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===_.dataType&&"content"===_.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(_,w,S,T){const M=new Ys[w.type](_,w,S,T);if(M.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${M.id}`);return v.bindAll(["load","abort","unload","serialize","prepare"],M),M}(s,d,f,this),this._tiles={},this._cache=new Gc(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new rd,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const d=this._tiles[s];if("loaded"!==d.state&&"errored"!==d.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,d){return this._source.loadTile(s,d)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){this._source.abortTile&&this._source.abortTile(s,()=>{}),this._source.fire(new v.Event("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const f=this._tiles[d];f.upload(s),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Qs).map(s=>s.key)}getRenderableIds(s){const d=[];for(const f in this._tiles)this._isIdRenderable(f,s)&&d.push(this._tiles[f]);return s?d.sort((f,_)=>{const w=f.tileID,S=_.tileID,T=new v.Point(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),M=new v.Point(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-S.overscaledZ||M.y-T.y||M.x-T.x}).map(f=>f.tileID.key):d.map(f=>f.tileID).sort(Qs).map(f=>f.key)}hasRenderableParent(s){const d=this.findLoadedParent(s,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(s,d){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(d||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(s,"reloading")}}_reloadTile(s,d){const f=this._tiles[s];f&&("loading"!==f.state&&(f.state=d),this._loadTile(f,this._tileLoaded.bind(this,f,s,d)))}_tileLoaded(s,d,f,_){if(_)return s.state="errored",void(404!==_.status?this._source.fire(new v.ErrorEvent(_,{tile:s})):this.update(this.transform,this.terrain));s.timeAdded=v.exported.now(),"expired"===f&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(d,s),"raster-dem"===this.getSource().type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new v.Event("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const w=d[_];if(s.neighboringTiles&&s.neighboringTiles[w]){const S=this.getTileByID(w);f(s,S),f(S,s)}}function f(_,w){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let S=w.tileID.canonical.x-_.tileID.canonical.x;const T=w.tileID.canonical.y-_.tileID.canonical.y,M=Math.pow(2,_.tileID.canonical.z),k=w.tileID.key;0===S&&0===T||Math.abs(T)>1||(Math.abs(S)>1&&(1===Math.abs(S+M)?S+=M:1===Math.abs(S-M)&&(S-=M)),w.dem&&_.dem&&(_.dem.backfillBorder(w.dem,S,T),_.neighboringTiles&&_.neighboringTiles[k]&&(_.neighboringTiles[k].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,d,f,_){for(const w in this._tiles){let S=this._tiles[w];if(_[w]||!S.hasData()||S.tileID.overscaledZ<=d||S.tileID.overscaledZ>f)continue;let T=S.tileID;for(;S&&S.tileID.overscaledZ>d+1;){const k=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[k.key],S&&S.hasData()&&(T=k)}let M=T;for(;M.overscaledZ>d;)if(M=M.scaledTo(M.overscaledZ-1),s[M.key]){_[T.key]=T;break}}}findLoadedParent(s,d){if(s.key in this._loadedParentTiles){const f=this._loadedParentTiles[s.key];return f&&f.tileID.overscaledZ>=d?f:null}for(let f=s.overscaledZ-1;f>=d;f--){const _=s.scaledTo(f),w=this._getLoadedTile(_);if(w)return w}}_getLoadedTile(s){const d=this._tiles[s.key];return d&&d.hasData()?d:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const d=Math.ceil(s.width/this._source.tileSize)+1,f=Math.ceil(s.height/this._source.tileSize)+1,_=Math.floor(d*f*(null===this._maxTileCacheZoomLevels?v.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(s){const d=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,d){const f={};for(const _ in this._tiles){const w=this._tiles[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+d),f[w.tileID.key]=w}this._tiles=f;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(s,d){if(this.transform=s,this.terrain=d,!this._sourceLoaded||this._paused)return;let f;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new v.OverscaledTileID(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(f=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(f=f.filter(O=>this._source.hasTile(O)))):f=[];const _=s.coveringZoomLevel(this._source),w=Math.max(_-vi.maxOverzooming,this._source.minzoom),S=Math.max(_+vi.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const O={};for(const F of f)if(F.canonical.z>this._source.minzoom){const j=F.scaledTo(F.canonical.z-1);O[j.key]=j;const K=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));O[K.key]=K}f=f.concat(Object.values(O))}const T=0===f.length&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new v.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(f,_);if(gl(this._source.type)){const O={},F={},j=Object.keys(M),K=v.exported.now();for(const G of j){const Z=M[G],te=this._tiles[G];if(!te||0!==te.fadeEndTime&&te.fadeEndTime<=K)continue;const le=this.findLoadedParent(Z,w);le&&(this._addTile(le.tileID),O[le.tileID.key]=le.tileID),F[G]=Z}this._retainLoadedChildren(F,_,S,M);for(const G in O)M[G]||(this._coveredTiles[G]=!0,M[G]=O[G]);if(d){const G={},Z={};for(const te of f)this._tiles[te.key].hasData()?G[te.key]=te:Z[te.key]=te;for(const te in Z){const le=Z[te].children(this._source.maxzoom);this._tiles[le[0].key]&&this._tiles[le[1].key]&&this._tiles[le[2].key]&&this._tiles[le[3].key]&&(G[le[0].key]=M[le[0].key]=le[0],G[le[1].key]=M[le[1].key]=le[1],G[le[2].key]=M[le[2].key]=le[2],G[le[3].key]=M[le[3].key]=le[3],delete Z[te])}for(const te in Z){const le=this.findLoadedParent(Z[te],this._source.minzoom);if(le){G[le.tileID.key]=M[le.tileID.key]=le.tileID;for(const fe in G)G[fe].isChildOf(le.tileID)&&delete G[fe]}}for(const te in this._tiles)G[te]||(this._coveredTiles[te]=!0)}}for(const O in M)this._tiles[O].clearFadeHold();const k=v.keysDifference(this._tiles,M);for(const O of k){const F=this._tiles[O];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(O)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,d){const f={},_={},w=Math.max(d-vi.maxOverzooming,this._source.minzoom),S=Math.max(d+vi.maxUnderzooming,this._source.minzoom),T={};for(const M of s){const k=this._addTile(M);f[M.key]=M,k.hasData()||d<this._source.maxzoom&&(T[M.key]=M)}this._retainLoadedChildren(T,d,S,f);for(const M of s){let k=this._tiles[M.key];if(k.hasData())continue;if(d+1>this._source.maxzoom){const F=M.children(this._source.maxzoom)[0],j=this.getTile(F);if(j&&j.hasData()){f[F.key]=F;continue}}else{const F=M.children(this._source.maxzoom);if(f[F[0].key]&&f[F[1].key]&&f[F[2].key]&&f[F[3].key])continue}let O=k.wasRequested();for(let F=M.overscaledZ-1;F>=w;--F){const j=M.scaledTo(F);if(_[j.key])break;if(_[j.key]=!0,k=this.getTile(j),!k&&O&&(k=this._addTile(j)),k){const K=k.hasData();if((O||K)&&(f[j.key]=j),O=k.wasRequested(),K)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const d=[];let f,_=this._tiles[s].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){f=this._loadedParentTiles[_.key];break}d.push(_.key);const w=_.scaledTo(_.overscaledZ-1);if(f=this._getLoadedTile(w),f)break;_=w}for(const w of d)this._loadedParentTiles[w]=f}}_addTile(s){let d=this._tiles[s.key];if(d)return d;d=this._cache.getAndRemove(s),d&&(this._setTileReloadTimer(s.key,d),d.tileID=s,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,d)));const f=d;return d||(d=new ml(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,s.key,d.state))),d.uses++,this._tiles[s.key]=d,f||this._source.fire(new v.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(s,d){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const f=d.getExpiryTimeout();f&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},f))}_removeTile(s){const d=this._tiles[s];d&&(d.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),d.uses>0||(d.hasData()&&"reloading"!==d.state?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,d,f){const _=[],w=this.transform;if(!w)return _;const S=f?w.getCameraQueryGeometry(s):s,T=s.map(G=>w.pointCoordinate(G,this.terrain)),M=S.map(G=>w.pointCoordinate(G,this.terrain)),k=this.getIds();let O=1/0,F=1/0,j=-1/0,K=-1/0;for(const G of M)O=Math.min(O,G.x),F=Math.min(F,G.y),j=Math.max(j,G.x),K=Math.max(K,G.y);for(let G=0;G<k.length;G++){const Z=this._tiles[k[G]];if(Z.holdingForFade())continue;const te=Z.tileID,le=Math.pow(2,w.zoom-Z.tileID.overscaledZ),fe=d*Z.queryPadding*v.EXTENT/Z.tileSize/le,J=[te.getTilePoint(new v.MercatorCoordinate(O,F)),te.getTilePoint(new v.MercatorCoordinate(j,K))];if(J[0].x-fe<v.EXTENT&&J[0].y-fe<v.EXTENT&&J[1].x+fe>=0&&J[1].y+fe>=0){const pe=T.map(De=>te.getTilePoint(De)),ve=M.map(De=>te.getTilePoint(De));_.push({tile:Z,tileID:te,queryGeometry:pe,cameraQueryGeometry:ve,scale:le})}}return _}getVisibleCoordinates(s){const d=this.getRenderableIds(s).map(f=>this._tiles[f].tileID);for(const f of d)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(gl(this._source.type)){const s=v.exported.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=s)return!0}return!1}setFeatureState(s,d,f){this._state.updateState(s=s||"_geojsonTileLayer",d,f)}removeFeatureState(s,d,f){this._state.removeFeatureState(s=s||"_geojsonTileLayer",d,f)}getFeatureState(s,d){return this._state.getState(s=s||"_geojsonTileLayer",d)}setDependencies(s,d,f){const _=this._tiles[s];_&&_.setDependencies(d,f)}reloadTilesForDependencies(s,d){for(const f in this._tiles)this._tiles[f].hasDependency(s,d)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(s,d))}}function Qs(m,s){const d=Math.abs(2*m.wrap)-+(m.wrap<0),f=Math.abs(2*s.wrap)-+(s.wrap<0);return m.overscaledZ-s.overscaledZ||f-d||s.canonical.y-m.canonical.y||s.canonical.x-m.canonical.x}function gl(m){return"raster"===m||"image"===m||"video"===m}vi.maxOverzooming=10,vi.maxUnderzooming=3;const ws="mapboxgl_preloaded_worker_pool";class je{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<je.workerCount;)this.workers.push(new Worker(v.config.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ws]}numActive(){return Object.keys(this.active).length}}const bo=Math.floor(v.exported.hardwareConcurrency/2);let er;function _l(){return er||(er=new je),er}je.workerCount=v.isSafari(globalThis)?Math.max(Math.min(bo,3),1):1;class Js{constructor(s,d){this.reset(s,d)}reset(s,d){this.points=s||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(1===this.points.length)return this.points[0];s=v.clamp(s,0,1);let d=1,f=this._distances[d];const _=s*this.paddedLength+this.padding;for(;f<_&&d<this._distances.length;)f=this._distances[++d];const w=d-1,S=this._distances[w],T=f-S,M=T>0?(_-S)/T:0;return this.points[w].mult(1-M).add(this.points[d].mult(M))}}function Ve(m,s){let d=!0;return"always"===m||"never"!==m&&"never"!==s||(d=!1),d}class Dt{constructor(s,d,f){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(s/f),this.yCellCount=Math.ceil(d/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=d,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,d,f,_,w){this._forEachCell(d,f,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(s,d,f,_){this._forEachCell(d-_,f-_,d+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(d),this.circles.push(f),this.circles.push(_)}_insertBoxCell(s,d,f,_,w,S){this.boxCells[w].push(S)}_insertCircleCell(s,d,f,_,w,S){this.circleCells[w].push(S)}_query(s,d,f,_,w,S,T){if(f<0||s>this.width||_<0||d>this.height)return[];const M=[];if(s<=0&&d<=0&&this.width<=f&&this.height<=_){if(w)return[{key:null,x1:s,y1:d,x2:f,y2:_}];for(let k=0;k<this.boxKeys.length;k++)M.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const O=this.circles[3*k],F=this.circles[3*k+1],j=this.circles[3*k+2];M.push({key:this.circleKeys[k],x1:O-j,y1:F-j,x2:O+j,y2:F+j})}}else this._forEachCell(s,d,f,_,this._queryCell,M,{hitTest:w,overlapMode:S,seenUids:{box:{},circle:{}}},T);return M}query(s,d,f,_){return this._query(s,d,f,_,!1,null)}hitTest(s,d,f,_,w,S){return this._query(s,d,f,_,!0,w,S).length>0}hitTestCircle(s,d,f,_,w){const S=s-f,T=s+f,M=d-f,k=d+f;if(T<0||S>this.width||k<0||M>this.height)return!1;const O=[];return this._forEachCell(S,M,T,k,this._queryCellCircle,O,{hitTest:!0,overlapMode:_,circle:{x:s,y:d,radius:f},seenUids:{box:{},circle:{}}},w),O.length>0}_queryCell(s,d,f,_,w,S,T,M){const{seenUids:k,hitTest:O,overlapMode:F}=T,j=this.boxCells[w];if(null!==j){const G=this.bboxes;for(const Z of j)if(!k.box[Z]){k.box[Z]=!0;const te=4*Z,le=this.boxKeys[Z];if(s<=G[te+2]&&d<=G[te+3]&&f>=G[te+0]&&_>=G[te+1]&&(!M||M(le))&&(!O||!Ve(F,le.overlapMode))&&(S.push({key:le,x1:G[te],y1:G[te+1],x2:G[te+2],y2:G[te+3]}),O))return!0}}const K=this.circleCells[w];if(null!==K){const G=this.circles;for(const Z of K)if(!k.circle[Z]){k.circle[Z]=!0;const te=3*Z,le=this.circleKeys[Z];if(this._circleAndRectCollide(G[te],G[te+1],G[te+2],s,d,f,_)&&(!M||M(le))&&(!O||!Ve(F,le.overlapMode))){const fe=G[te],J=G[te+1],pe=G[te+2];if(S.push({key:le,x1:fe-pe,y1:J-pe,x2:fe+pe,y2:J+pe}),O)return!0}}}return!1}_queryCellCircle(s,d,f,_,w,S,T,M){const{circle:k,seenUids:O,overlapMode:F}=T,j=this.boxCells[w];if(null!==j){const G=this.bboxes;for(const Z of j)if(!O.box[Z]){O.box[Z]=!0;const te=4*Z,le=this.boxKeys[Z];if(this._circleAndRectCollide(k.x,k.y,k.radius,G[te+0],G[te+1],G[te+2],G[te+3])&&(!M||M(le))&&!Ve(F,le.overlapMode))return S.push(!0),!0}}const K=this.circleCells[w];if(null!==K){const G=this.circles;for(const Z of K)if(!O.circle[Z]){O.circle[Z]=!0;const te=3*Z,le=this.circleKeys[Z];if(this._circlesCollide(G[te],G[te+1],G[te+2],k.x,k.y,k.radius)&&(!M||M(le))&&!Ve(F,le.overlapMode))return S.push(!0),!0}}}_forEachCell(s,d,f,_,w,S,T,M){const k=this._convertToXCellCoord(s),O=this._convertToYCellCoord(d),F=this._convertToXCellCoord(f),j=this._convertToYCellCoord(_);for(let K=k;K<=F;K++)for(let G=O;G<=j;G++)if(w.call(this,s,d,f,_,this.xCellCount*G+K,S,T,M))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,d,f,_,w,S){const T=_-s,M=w-d,k=f+S;return k*k>T*T+M*M}_circleAndRectCollide(s,d,f,_,w,S,T){const M=(S-_)/2,k=Math.abs(s-(_+M));if(k>M+f)return!1;const O=(T-w)/2,F=Math.abs(d-(w+O));if(F>O+f)return!1;if(k<=M||F<=O)return!0;const j=k-M,K=F-O;return j*j+K*K<=f*f}}function Rt(m,s,d,f,_){const w=v.create();return s?(v.scale(w,w,[1/_,1/_,1]),d||v.rotateZ(w,w,f.angle)):v.multiply(w,f.labelPlaneMatrix,m),w}function Gr(m,s,d,f,_){if(s){const w=v.clone(m);return v.scale(w,w,[_,_,1]),d||v.rotateZ(w,w,-f.angle),w}return f.glCoordMatrix}function bi(m,s,d){let f;d?(f=[m.x,m.y,d(m.x,m.y),1],v.transformMat4(f,f,s)):(f=[m.x,m.y,0,1],ee(f,f,s));const _=f[3];return{point:new v.Point(f[0]/_,f[1]/_),signedDistanceFromCamera:_}}function Pt(m,s){return.5+m/s*.5}function Es(m,s){const d=m[0]/m[3],f=m[1]/m[3];return d>=-s[0]&&d<=s[0]&&f>=-s[1]&&f<=s[1]}function Cs(m,s,d,f,_,w,S,T,M,k){const O=f?m.textSizeData:m.iconSizeData,F=v.evaluateSizeForZoom(O,d.transform.zoom),j=[256/d.width*2+1,256/d.height*2+1],K=f?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;K.clear();const G=m.lineVertexArray,Z=f?m.text.placedSymbolArray:m.icon.placedSymbolArray,te=d.transform.width/d.transform.height;let le=!1;for(let fe=0;fe<Z.length;fe++){const J=Z.get(fe);if(J.hidden||J.writingMode===v.WritingMode.vertical&&!le){q(J.numGlyphs,K);continue}let pe;if(le=!1,k?(pe=[J.anchorX,J.anchorY,k(J.anchorX,J.anchorY),1],v.transformMat4(pe,pe,s)):(pe=[J.anchorX,J.anchorY,0,1],ee(pe,pe,s)),!Es(pe,j)){q(J.numGlyphs,K);continue}const ve=Pt(d.transform.cameraToCenterDistance,pe[3]),De=v.evaluateSizeForFeature(O,F,J),Ae=S?De/ve:De*ve,Ne=new v.Point(J.anchorX,J.anchorY),ke=bi(Ne,_,k).point,Be={projections:{},offsets:{}},at=tr(J,Ae,!1,T,s,_,w,m.glyphOffsetArray,G,K,ke,Ne,Be,te,M,k);le=at.useVertical,(at.notEnoughRoom||le||at.needsFlipping&&tr(J,Ae,!0,T,s,_,w,m.glyphOffsetArray,G,K,ke,Ne,Be,te,M,k).notEnoughRoom)&&q(J.numGlyphs,K)}f?m.text.dynamicLayoutVertexBuffer.updateData(K):m.icon.dynamicLayoutVertexBuffer.updateData(K)}function zo(m,s,d,f,_,w,S,T,M,k,O,F,j){const K=T.glyphStartIndex+T.numGlyphs,G=T.lineStartIndex,Z=T.lineStartIndex+T.lineLength,te=s.getoffsetX(T.glyphStartIndex),le=s.getoffsetX(K-1),fe=N(m*te,d,f,_,w,S,T.segment,G,Z,M,k,O,F,j);if(!fe)return null;const J=N(m*le,d,f,_,w,S,T.segment,G,Z,M,k,O,F,j);return J?{first:fe,last:J}:null}function Ss(m,s,d,f){return m===v.WritingMode.horizontal&&Math.abs(d.y-s.y)>Math.abs(d.x-s.x)*f?{useVertical:!0}:(m===v.WritingMode.vertical?s.y<d.y:s.x>d.x)?{needsFlipping:!0}:null}function tr(m,s,d,f,_,w,S,T,M,k,O,F,j,K,G,Z){const te=s/24,le=m.lineOffsetX*te,fe=m.lineOffsetY*te;let J;if(m.numGlyphs>1){const pe=m.glyphStartIndex+m.numGlyphs,ve=m.lineStartIndex,De=m.lineStartIndex+m.lineLength,Ae=zo(te,T,le,fe,d,O,F,m,M,w,j,G,Z);if(!Ae)return{notEnoughRoom:!0};const Ne=bi(Ae.first.point,S,Z).point,ke=bi(Ae.last.point,S,Z).point;if(f&&!d){const Be=Ss(m.writingMode,Ne,ke,K);if(Be)return Be}J=[Ae.first];for(let Be=m.glyphStartIndex+1;Be<pe-1;Be++)J.push(N(te*T.getoffsetX(Be),le,fe,d,O,F,m.segment,ve,De,M,w,j,G,Z));J.push(Ae.last)}else{if(f&&!d){const ve=bi(F,_,Z).point,De=m.lineStartIndex+m.segment+1,Ae=new v.Point(M.getx(De),M.gety(De)),Ne=bi(Ae,_,Z),ke=Ne.signedDistanceFromCamera>0?Ne.point:Ln(F,Ae,ve,1,_,Z),Be=Ss(m.writingMode,ve,ke,K);if(Be)return Be}const pe=N(te*T.getoffsetX(m.glyphStartIndex),le,fe,d,O,F,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,M,w,j,G,Z);if(!pe)return{notEnoughRoom:!0};J=[pe]}for(const pe of J)v.addDynamicAttributes(k,pe.point,pe.angle);return{}}function Ln(m,s,d,f,_,w){const S=bi(m.add(m.sub(s)._unit()),_,w).point,T=d.sub(S);return d.add(T._mult(f/T.mag()))}function rc(m,s){const{projectionCache:d,lineVertexArray:f,labelPlaneMatrix:_,tileAnchorPoint:w,distanceFromAnchor:S,getElevation:T,previousVertex:M,direction:k,absOffsetX:O}=s;if(d.projections[m])return d.projections[m];const F=new v.Point(f.getx(m),f.gety(m)),j=bi(F,_,T);if(j.signedDistanceFromCamera>0)return d.projections[m]=j.point,j.point;const K=m-k;return Ln(0===S?w:new v.Point(f.getx(K),f.gety(K)),F,M,O-S+1,_,T)}function os(m,s,d){return m._unit()._perp()._mult(s*d)}function Q(m,s,d,f,_,w,S,T){const{projectionCache:M,direction:k}=T;if(M.offsets[m])return M.offsets[m];const O=d.add(s);if(m+k<f||m+k>=_)return M.offsets[m]=O,O;const F=rc(m+k,T),j=os(F.sub(d),S,k),K=d.add(j),G=F.add(j);return M.offsets[m]=v.findLineIntersection(w,O,K,G)||O,M.offsets[m]}function N(m,s,d,f,_,w,S,T,M,k,O,F,j,K){const G=f?m-s:m+s;let Z=G>0?1:-1,te=0;f&&(Z*=-1,te=Math.PI),Z<0&&(te+=Math.PI);let le,fe,J=Z>0?T+S:T+S+1,pe=_,ve=_,De=0,Ae=0;const Ne=Math.abs(G),ke=[];let Be;for(;De+Ae<=Ne;){if(J+=Z,J<T||J>=M)return null;De+=Ae,ve=pe,fe=le;const $e={projectionCache:F,lineVertexArray:k,labelPlaneMatrix:O,tileAnchorPoint:w,distanceFromAnchor:De,getElevation:K,previousVertex:ve,direction:Z,absOffsetX:Ne};if(pe=rc(J,$e),0===d)ke.push(ve),Be=pe.sub(ve);else{let bt;const Ye=pe.sub(ve);bt=0===Ye.mag()?os(rc(J+Z,$e).sub(pe),d,Z):os(Ye,d,Z),fe||(fe=ve.add(bt)),le=Q(J,bt,pe,T,M,fe,d,$e),ke.push(fe),Be=le.sub(fe)}Ae=Be.mag()}const at=Be._mult((Ne-De)/Ae)._add(fe||ve),yt=te+Math.atan2(pe.y-ve.y,pe.x-ve.x);return ke.push(at),{point:at,angle:j?yt:0,path:ke}}const V=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function q(m,s){for(let d=0;d<m;d++){const f=s.length;s.resize(f+4),s.float32.set(V,3*f)}}function ee(m,s,d){const f=s[0],_=s[1];return m[0]=d[0]*f+d[4]*_+d[12],m[1]=d[1]*f+d[5]*_+d[13],m[3]=d[3]*f+d[7]*_+d[15],m}const ne=100;class ce{constructor(s,d=new Dt(s.width+200,s.height+200,25),f=new Dt(s.width+200,s.height+200,25)){this.transform=s,this.grid=d,this.ignoredGrid=f,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+ne,this.screenBottomBoundary=s.height+ne,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,d,f,_,w,S){const T=this.projectAndGetPerspectiveRatio(_,s.anchorPointX,s.anchorPointY,S),M=f*T.perspectiveRatio,k=s.x1*M+T.point.x,O=s.y1*M+T.point.y,F=s.x2*M+T.point.x,j=s.y2*M+T.point.y;return!this.isInsideGrid(k,O,F,j)||"always"!==d&&this.grid.hitTest(k,O,F,j,d,w)||T.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,O,F,j],offscreen:this.isOffscreen(k,O,F,j)}}placeCollisionCircles(s,d,f,_,w,S,T,M,k,O,F,j,K,G){const Z=[],te=new v.Point(d.anchorX,d.anchorY),le=bi(te,S,G),fe=Pt(this.transform.cameraToCenterDistance,le.signedDistanceFromCamera),J=(O?w/fe:w*fe)/v.ONE_EM,pe=bi(te,T,G).point,ve=zo(J,_,d.lineOffsetX*J,d.lineOffsetY*J,!1,pe,te,d,f,T,{projections:{},offsets:{}},!1,G);let De=!1,Ae=!1,Ne=!0;if(ve){const ke=.5*j*fe+K,Be=new v.Point(-100,-100),at=new v.Point(this.screenRightBoundary,this.screenBottomBoundary),yt=new Js,$e=ve.first,bt=ve.last;let Ye=[];for(let an=$e.path.length-1;an>=1;an--)Ye.push($e.path[an]);for(let an=1;an<bt.path.length;an++)Ye.push(bt.path[an]);const sn=2.5*ke;if(M){const an=Ye.map(At=>bi(At,M,G));Ye=an.some(At=>At.signedDistanceFromCamera<=0)?[]:an.map(At=>At.point)}let ri=[];if(Ye.length>0){const an=Ye[0].clone(),At=Ye[0].clone();for(let Xn=1;Xn<Ye.length;Xn++)an.x=Math.min(an.x,Ye[Xn].x),an.y=Math.min(an.y,Ye[Xn].y),At.x=Math.max(At.x,Ye[Xn].x),At.y=Math.max(At.y,Ye[Xn].y);ri=an.x>=Be.x&&At.x<=at.x&&an.y>=Be.y&&At.y<=at.y?[Ye]:At.x<Be.x||an.x>at.x||At.y<Be.y||an.y>at.y?[]:v.clipLine([Ye],Be.x,Be.y,at.x,at.y)}for(const an of ri){yt.reset(an,.25*ke);let At=0;At=yt.length<=.5*ke?1:Math.ceil(yt.paddedLength/sn)+1;for(let Xn=0;Xn<At;Xn++){const Er=Xn/Math.max(At-1,1),ai=yt.lerp(Er),Li=ai.x+ne,Cr=ai.y+ne;Z.push(Li,Cr,ke,0);const Vr=Li-ke,Sr=Cr-ke,Dr=Li+ke,Os=Cr+ke;if(Ne=Ne&&this.isOffscreen(Vr,Sr,Dr,Os),Ae=Ae||this.isInsideGrid(Vr,Sr,Dr,Os),"always"!==s&&this.grid.hitTestCircle(Li,Cr,ke,s,F)&&(De=!0,!k))return{circles:[],offscreen:!1,collisionDetected:De}}}}return{circles:!k&&De||!Ae||fe<this.perspectiveRatioCutoff?[]:Z,offscreen:Ne,collisionDetected:De}}queryRenderedSymbols(s){if(0===s.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let f=1/0,_=1/0,w=-1/0,S=-1/0;for(const O of s){const F=new v.Point(O.x+ne,O.y+ne);f=Math.min(f,F.x),_=Math.min(_,F.y),w=Math.max(w,F.x),S=Math.max(S,F.y),d.push(F)}const T=this.grid.query(f,_,w,S).concat(this.ignoredGrid.query(f,_,w,S)),M={},k={};for(const O of T){const F=O.key;if(void 0===M[F.bucketInstanceId]&&(M[F.bucketInstanceId]={}),M[F.bucketInstanceId][F.featureIndex])continue;const j=[new v.Point(O.x1,O.y1),new v.Point(O.x2,O.y1),new v.Point(O.x2,O.y2),new v.Point(O.x1,O.y2)];v.polygonIntersectsPolygon(d,j)&&(M[F.bucketInstanceId][F.featureIndex]=!0,void 0===k[F.bucketInstanceId]&&(k[F.bucketInstanceId]=[]),k[F.bucketInstanceId].push(F.featureIndex))}return k}insertCollisionBox(s,d,f,_,w,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:S,overlapMode:d},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,d,f,_,w,S){const T=f?this.ignoredGrid:this.grid,M={bucketInstanceId:_,featureIndex:w,collisionGroupID:S,overlapMode:d};for(let k=0;k<s.length;k+=4)T.insertCircle(M,s[k],s[k+1],s[k+2])}projectAndGetPerspectiveRatio(s,d,f,_){let w;return _?(w=[d,f,_(d,f),1],v.transformMat4(w,w,s)):(w=[d,f,0,1],ee(w,w,s)),{point:new v.Point((w[0]/w[3]+1)/2*this.transform.width+ne,(-w[1]/w[3]+1)/2*this.transform.height+ne),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w[3]*.5}}isOffscreen(s,d,f,_){return f<ne||s>=this.screenRightBoundary||_<ne||d>this.screenBottomBoundary}isInsideGrid(s,d,f,_){return f>=0&&s<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const s=v.identity([]);return v.translate(s,s,[-100,-100,0]),s}}function ae(m,s,d){return s*(v.EXTENT/(m.tileSize*Math.pow(2,d-m.tileID.overscaledZ)))}class ie{constructor(s,d,f,_){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?d:-d))):_&&f?1:0,this.placed=f}isHidden(){return 0===this.opacity&&!this.placed}}class de{constructor(s,d,f,_,w){this.text=new ie(s?s.text:null,d,f,w),this.icon=new ie(s?s.icon:null,d,_,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ie{constructor(s,d,f){this.text=s,this.icon=d,this.skipFade=f}}class Te{constructor(){this.invProjMatrix=v.create(),this.viewportMatrix=v.create(),this.circles=[]}}class Ee{constructor(s,d,f,_,w){this.bucketInstanceId=s,this.featureIndex=d,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=w}}class gt{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const d=++this.maxGroupID;this.collisionGroups[s]={ID:d,predicate:f=>f.collisionGroupID===d}}return this.collisionGroups[s]}}function It(m,s,d,f,_){const{horizontalAlign:w,verticalAlign:S}=v.getAnchorAlignment(m),T=-(w-.5)*s,M=-(S-.5)*d,k=v.evaluateVariableOffset(m,f);return new v.Point(T+k[0]*_,M+k[1]*_)}function it(m,s,d,f,_,w){const{x1:S,x2:T,y1:M,y2:k,anchorPointX:O,anchorPointY:F}=m,j=new v.Point(s,d);return f&&j._rotate(_?w:-w),{x1:S+j.x,y1:M+j.y,x2:T+j.x,y2:k+j.y,anchorPointX:O,anchorPointY:F}}class pt{constructor(s,d,f,_,w){this.transform=s.clone(),this.terrain=d,this.collisionIndex=new ce(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new gt(_),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,d,f,_){const w=f.getBucket(d),S=f.latestFeatureIndex;if(!w||!S||d.id!==w.layerIds[0])return;const T=f.collisionBoxArray,M=w.layers[0].layout,k=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),O=f.tileSize/v.EXTENT,F=this.transform.calculatePosMatrix(f.tileID.toUnwrapped()),j="map"===M.get("text-pitch-alignment"),K="map"===M.get("text-rotation-alignment"),G=ae(f,1,this.transform.zoom),Z=Rt(F,j,K,this.transform,G);let te=null;if(j){const fe=Gr(F,j,K,this.transform,G);te=v.multiply([],this.transform.labelPlaneMatrix,fe)}this.retainedQueryData[w.bucketInstanceId]=new Ee(w.bucketInstanceId,S,w.sourceLayerIndex,w.index,f.tileID);const le={bucket:w,layout:M,posMatrix:F,textLabelPlaneMatrix:Z,labelToScreenMatrix:te,scale:k,textPixelRatio:O,holdingForFade:f.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:v.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(_)for(const fe of w.sortKeyRanges){const{sortKey:J,symbolInstanceStart:pe,symbolInstanceEnd:ve}=fe;s.push({sortKey:J,symbolInstanceStart:pe,symbolInstanceEnd:ve,parameters:le})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:le})}attemptAnchorPlacement(s,d,f,_,w,S,T,M,k,O,F,j,K,G,Z,te){const le=[j.textOffset0,j.textOffset1],fe=It(s,f,_,le,w),J=this.collisionIndex.placeCollisionBox(it(d,fe.x,fe.y,S,T,this.transform.angle),F,M,k,O.predicate,te);if((!Z||0!==this.collisionIndex.placeCollisionBox(it(Z,fe.x,fe.y,S,T,this.transform.angle),F,M,k,O.predicate,te).box.length)&&J.box.length>0){let pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(pe=this.prevPlacement.variableOffsets[j.crossTileID].anchor),0===j.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:le,width:f,height:_,anchor:s,textBoxScale:w,prevAnchor:pe},this.markUsedJustification(K,s,j,G),K.allowVerticalPlacement&&(this.markUsedOrientation(K,G,j),this.placedOrientations[j.crossTileID]=G),{shift:fe,placedGlyphBoxes:J}}}placeLayerBucketPart(s,d,f){const{bucket:_,layout:w,posMatrix:S,textLabelPlaneMatrix:T,labelToScreenMatrix:M,textPixelRatio:k,holdingForFade:O,collisionBoxArray:F,partiallyEvaluatedTextSize:j,collisionGroup:K}=s.parameters,G=w.get("text-optional"),Z=w.get("icon-optional"),te=v.getOverlapMode(w,"text-overlap","text-allow-overlap"),le="always"===te,fe=v.getOverlapMode(w,"icon-overlap","icon-allow-overlap"),J="always"===fe,pe="map"===w.get("text-rotation-alignment"),ve="map"===w.get("text-pitch-alignment"),De="none"!==w.get("icon-text-fit"),Ae="viewport-y"===w.get("symbol-z-order"),Ne=le&&(J||!_.hasIconData()||Z),ke=J&&(le||!_.hasTextData()||G);!_.collisionArrays&&F&&_.deserializeCollisionBoxes(F);const Be=this.retainedQueryData[_.bucketInstanceId].tileID,at=this.terrain?($e,bt)=>this.terrain.getElevation(Be,$e,bt):null,yt=($e,bt)=>{if(d[$e.crossTileID])return;if(O)return void(this.placements[$e.crossTileID]=new Ie(!1,!1,!1));let Ye=!1,sn=!1,ri=!0,an=null,At={box:null,offscreen:null},Xn={box:null,offscreen:null},Er=null,ai=null,Li=null,Cr=0,Vr=0,Sr=0;bt.textFeatureIndex?Cr=bt.textFeatureIndex:$e.useRuntimeCollisionCircles&&(Cr=$e.featureIndex),bt.verticalTextFeatureIndex&&(Vr=bt.verticalTextFeatureIndex);const Dr=bt.textBox;if(Dr){const Ur=mn=>{let Gi=v.WritingMode.horizontal;if(_.allowVerticalPlacement&&!mn&&this.prevPlacement){const Ni=this.prevPlacement.placedOrientations[$e.crossTileID];Ni&&(this.placedOrientations[$e.crossTileID]=Ni,Gi=Ni,this.markUsedOrientation(_,Gi,$e))}return Gi},qi=(mn,Gi)=>{if(_.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&bt.verticalTextBox){for(const Ni of _.writingModes)if(Ni===v.WritingMode.vertical?(At=Gi(),Xn=At):At=mn(),At&&At.box&&At.box.length)break}else At=mn()};if(w.get("text-variable-anchor")){let mn=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[$e.crossTileID]){const dn=this.prevPlacement.variableOffsets[$e.crossTileID];mn.indexOf(dn.anchor)>0&&(mn=mn.filter(Bi=>Bi!==dn.anchor),mn.unshift(dn.anchor))}const Gi=(dn,Bi,jr)=>{const Cd=dn.x2-dn.x1,fa=dn.y2-dn.y1,_f=$e.textBoxScale,Sd=De&&"never"===fe?Bi:null;let Bn={box:[],offscreen:!1};const Dd="never"!==te?2*mn.length:mn.length;for(let fc=0;fc<Dd;++fc){const Ls=this.attemptAnchorPlacement(mn[fc%mn.length],dn,Cd,fa,_f,pe,ve,k,S,K,fc>=mn.length?te:"never",$e,_,jr,Sd,at);if(Ls&&(Bn=Ls.placedGlyphBoxes,Bn&&Bn.box&&Bn.box.length)){Ye=!0,an=Ls.shift;break}}return Bn};qi(()=>Gi(Dr,bt.iconBox,v.WritingMode.horizontal),()=>{const dn=bt.verticalTextBox;return _.allowVerticalPlacement&&!(At&&At.box&&At.box.length)&&$e.numVerticalGlyphVertices>0&&dn?Gi(dn,bt.verticalIconBox,v.WritingMode.vertical):{box:null,offscreen:null}}),At&&(Ye=At.box,ri=At.offscreen);const Ni=Ur(At&&At.box);if(!Ye&&this.prevPlacement){const dn=this.prevPlacement.variableOffsets[$e.crossTileID];dn&&(this.variableOffsets[$e.crossTileID]=dn,this.markUsedJustification(_,dn.anchor,$e,Ni))}}else{const mn=(Gi,Ni)=>{const dn=this.collisionIndex.placeCollisionBox(Gi,te,k,S,K.predicate,at);return dn&&dn.box&&dn.box.length&&(this.markUsedOrientation(_,Ni,$e),this.placedOrientations[$e.crossTileID]=Ni),dn};qi(()=>mn(Dr,v.WritingMode.horizontal),()=>{const Gi=bt.verticalTextBox;return _.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&Gi?mn(Gi,v.WritingMode.vertical):{box:null,offscreen:null}}),Ur(At&&At.box&&At.box.length)}}if(Er=At,Ye=Er&&Er.box&&Er.box.length>0,ri=Er&&Er.offscreen,$e.useRuntimeCollisionCircles){const Ur=_.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex),qi=v.evaluateSizeForFeature(_.textSizeData,j,Ur),mn=w.get("text-padding");ai=this.collisionIndex.placeCollisionCircles(te,Ur,_.lineVertexArray,_.glyphOffsetArray,qi,S,T,M,f,ve,K.predicate,$e.collisionCircleDiameter,mn,at),ai.circles.length&&ai.collisionDetected&&!f&&v.warnOnce("Collisions detected, but collision boxes are not shown"),Ye=le||ai.circles.length>0&&!ai.collisionDetected,ri=ri&&ai.offscreen}if(bt.iconFeatureIndex&&(Sr=bt.iconFeatureIndex),bt.iconBox){const Ur=qi=>{const mn=De&&an?it(qi,an.x,an.y,pe,ve,this.transform.angle):qi;return this.collisionIndex.placeCollisionBox(mn,fe,k,S,K.predicate,at)};Xn&&Xn.box&&Xn.box.length&&bt.verticalIconBox?(Li=Ur(bt.verticalIconBox),sn=Li.box.length>0):(Li=Ur(bt.iconBox),sn=Li.box.length>0),ri=ri&&Li.offscreen}const Os=G||0===$e.numHorizontalGlyphVertices&&0===$e.numVerticalGlyphVertices,mu=Z||0===$e.numIconVertices;if(Os||mu?mu?Os||(sn=sn&&Ye):Ye=sn&&Ye:sn=Ye=sn&&Ye,Ye&&Er&&Er.box&&this.collisionIndex.insertCollisionBox(Er.box,te,w.get("text-ignore-placement"),_.bucketInstanceId,Xn&&Xn.box&&Vr?Vr:Cr,K.ID),sn&&Li&&this.collisionIndex.insertCollisionBox(Li.box,fe,w.get("icon-ignore-placement"),_.bucketInstanceId,Sr,K.ID),ai&&(Ye&&this.collisionIndex.insertCollisionCircles(ai.circles,te,w.get("text-ignore-placement"),_.bucketInstanceId,Cr,K.ID),f)){const Ur=_.bucketInstanceId;let qi=this.collisionCircleArrays[Ur];void 0===qi&&(qi=this.collisionCircleArrays[Ur]=new Te);for(let mn=0;mn<ai.circles.length;mn+=4)qi.circles.push(ai.circles[mn+0]),qi.circles.push(ai.circles[mn+1]),qi.circles.push(ai.circles[mn+2]),qi.circles.push(ai.collisionDetected?1:0)}if(0===$e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===_.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[$e.crossTileID]=new Ie(Ye||Ne,sn||ke,ri||_.justReloaded),d[$e.crossTileID]=!0};if(Ae){if(0!==s.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const $e=_.getSortedSymbolIndexes(this.transform.angle);for(let bt=$e.length-1;bt>=0;--bt){const Ye=$e[bt];yt(_.symbolInstances.get(Ye),_.collisionArrays[Ye])}}else for(let $e=s.symbolInstanceStart;$e<s.symbolInstanceEnd;$e++)yt(_.symbolInstances.get($e),_.collisionArrays[$e]);if(f&&_.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[_.bucketInstanceId];v.invert($e.invProjMatrix,S),$e.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(s,d,f,_){let w;w=_===v.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[v.getAnchorJustification(d)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const T of S)T>=0&&(s.text.placedSymbolArray.get(T).crossTileID=w>=0&&T!==w?0:f.crossTileID)}markUsedOrientation(s,d,f){const _=d===v.WritingMode.horizontal||d===v.WritingMode.horizontalOnly?d:0,w=d===v.WritingMode.vertical?d:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const T of S)s.text.placedSymbolArray.get(T).placedOrientation=_;f.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let f=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(s):1,w=d?d.opacities:{},S=d?d.variableOffsets:{},T=d?d.placedOrientations:{};for(const M in this.placements){const k=this.placements[M],O=w[M];O?(this.opacities[M]=new de(O,_,k.text,k.icon),f=f||k.text!==O.text.placed||k.icon!==O.icon.placed):(this.opacities[M]=new de(null,_,k.text,k.icon,k.skipFade),f=f||k.text||k.icon)}for(const M in w){const k=w[M];if(!this.opacities[M]){const O=new de(k,_,!1,!1);O.isHidden()||(this.opacities[M]=O,f=f||k.text.placed||k.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in T)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=T[M]);if(d&&void 0===d.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=s:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:s)}updateLayerOpacities(s,d){const f={};for(const _ of d){const w=_.getBucket(s);w&&_.latestFeatureIndex&&s.id===w.layerIds[0]&&this.updateBucketOpacities(w,f,_.collisionBoxArray)}}updateBucketOpacities(s,d,f){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const _=s.layers[0].layout,w=new de(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),T=_.get("icon-allow-overlap"),M=_.get("text-variable-anchor"),k="map"===_.get("text-rotation-alignment"),O="map"===_.get("text-pitch-alignment"),F="none"!==_.get("icon-text-fit"),j=new de(null,0,S&&(T||!s.hasIconData()||_.get("icon-optional")),T&&(S||!s.hasTextData()||_.get("text-optional")),!0);!s.collisionArrays&&f&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(f);const K=(G,Z,te)=>{for(let le=0;le<Z/4;le++)G.opacityVertexArray.emplaceBack(te);G.hasVisibleVertices=G.hasVisibleVertices||te!==nr};for(let G=0;G<s.symbolInstances.length;G++){const Z=s.symbolInstances.get(G),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:le,crossTileID:fe}=Z;let J=this.opacities[fe];d[fe]?J=w:J||(J=j,this.opacities[fe]=J),d[fe]=!0;const pe=Z.numIconVertices>0,ve=this.placedOrientations[Z.crossTileID],De=ve===v.WritingMode.vertical,Ae=ve===v.WritingMode.horizontal||ve===v.WritingMode.horizontalOnly;if(te>0||le>0){const Ne=za(J.text);K(s.text,te,De?nr:Ne),K(s.text,le,Ae?nr:Ne);const ke=J.text.isHidden();[Z.rightJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.leftJustifiedTextSymbolIndex].forEach(yt=>{yt>=0&&(s.text.placedSymbolArray.get(yt).hidden=ke||De?1:0)}),Z.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).hidden=ke||Ae?1:0);const Be=this.variableOffsets[Z.crossTileID];Be&&this.markUsedJustification(s,Be.anchor,Z,ve);const at=this.placedOrientations[Z.crossTileID];at&&(this.markUsedJustification(s,"left",Z,at),this.markUsedOrientation(s,at,Z))}if(pe){const Ne=za(J.icon),ke=!(F&&Z.verticalPlacedIconSymbolIndex&&De);Z.placedIconSymbolIndex>=0&&(K(s.icon,Z.numIconVertices,ke?Ne:nr),s.icon.placedSymbolArray.get(Z.placedIconSymbolIndex).hidden=J.icon.isHidden()),Z.verticalPlacedIconSymbolIndex>=0&&(K(s.icon,Z.numVerticalIconVertices,ke?nr:Ne),s.icon.placedSymbolArray.get(Z.verticalPlacedIconSymbolIndex).hidden=J.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Ne=s.collisionArrays[G];if(Ne){let ke=new v.Point(0,0);if(Ne.textBox||Ne.verticalTextBox){let at=!0;if(M){const yt=this.variableOffsets[fe];yt?(ke=It(yt.anchor,yt.width,yt.height,yt.textOffset,yt.textBoxScale),k&&ke._rotate(O?this.transform.angle:-this.transform.angle)):at=!1}Ne.textBox&&Ct(s.textCollisionBox.collisionVertexArray,J.text.placed,!at||De,ke.x,ke.y),Ne.verticalTextBox&&Ct(s.textCollisionBox.collisionVertexArray,J.text.placed,!at||Ae,ke.x,ke.y)}const Be=!(Ae||!Ne.verticalIconBox);Ne.iconBox&&Ct(s.iconCollisionBox.collisionVertexArray,J.icon.placed,Be,F?ke.x:0,F?ke.y:0),Ne.verticalIconBox&&Ct(s.iconCollisionBox.collisionVertexArray,J.icon.placed,!Be,F?ke.x:0,F?ke.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=G.invProjMatrix,s.placementViewportMatrix=G.viewportMatrix,s.collisionCircleArray=G.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return 0===this.fadeDuration?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,d){const f=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*f>s}setStale(){this.stale=!0}}function Ct(m,s,d,f,_){m.emplaceBack(s?1:0,d?1:0,f||0,_||0),m.emplaceBack(s?1:0,d?1:0,f||0,_||0),m.emplaceBack(s?1:0,d?1:0,f||0,_||0),m.emplaceBack(s?1:0,d?1:0,f||0,_||0)}const en=Math.pow(2,25),zt=Math.pow(2,24),Vt=Math.pow(2,17),On=Math.pow(2,16),tn=Math.pow(2,9),xt=Math.pow(2,8),gn=Math.pow(2,1);function za(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const s=m.placed?1:0,d=Math.floor(127*m.opacity);return d*en+s*zt+d*Vt+s*On+d*tn+s*xt+d*gn+s}const nr=0;class Wr{constructor(s){this._sortAcrossTiles="viewport-y"!==s.layout.get("symbol-z-order")&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,d,f,_,w){const S=this._bucketParts;for(;this._currentTileIndex<s.length;)if(d.getBucketParts(S,_,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((T,M)=>T.sortKey-M.sortKey));this._currentPartIndex<S.length;)if(d.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,w())return!0;return!1}}class Zr{constructor(s,d,f,_,w,S,T,M){this.placement=new pt(s,d,S,T,M),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(s,d,f){const _=v.exported.now(),w=()=>!this._forceFullPlacement&&v.exported.now()-_>2;for(;this._currentPlacementIndex>=0;){const S=d[s[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if("symbol"===S.type&&(!S.minzoom||S.minzoom<=T)&&(!S.maxzoom||S.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Wr(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Va=512/v.EXTENT/2;class ea{constructor(s,d,f){this.tileID=s,this.bucketInstanceId=f,this._symbolsByKey={};const _=new Map;for(let w=0;w<d.length;w++){const S=d.get(w),T=S.key,M=_.get(T);M?M.push(S):_.set(T,[S])}for(const[w,S]of _){const T={positions:S.map(M=>({x:Math.floor(M.anchorX*Va),y:Math.floor(M.anchorY*Va)})),crossTileIDs:S.map(M=>M.crossTileID)};if(T.positions.length>128){const M=new v.KDBush(T.positions.length,16,Uint16Array);for(const{x:k,y:O}of T.positions)M.add(k,O);M.finish(),delete T.positions,T.index=M}this._symbolsByKey[w]=T}}getScaledCoordinates(s,d){const{x:f,y:_,z:w}=this.tileID.canonical,{x:S,y:T,z:M}=d.canonical,k=Va/Math.pow(2,M-w),O=(T*v.EXTENT+s.anchorY)*k,F=_*v.EXTENT*Va;return{x:Math.floor((S*v.EXTENT+s.anchorX)*k-f*v.EXTENT*Va),y:Math.floor(O-F)}}findMatches(s,d,f){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let w=0;w<s.length;w++){const S=s.get(w);if(S.crossTileID)continue;const T=this._symbolsByKey[S.key];if(!T)continue;const M=this.getScaledCoordinates(S,d);if(T.index){const k=T.index.range(M.x-_,M.y-_,M.x+_,M.y+_).sort();for(const O of k){const F=T.crossTileIDs[O];if(!f[F]){f[F]=!0,S.crossTileID=F;break}}}else if(T.positions)for(let k=0;k<T.positions.length;k++){const O=T.positions[k],F=T.crossTileIDs[k];if(Math.abs(O.x-M.x)<=_&&Math.abs(O.y-M.y)<=_&&!f[F]){f[F]=!0,S.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class xi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const d=Math.round((s-this.lng)/360);if(0!==d)for(const f in this.indexes){const _=this.indexes[f],w={};for(const S in _){const T=_[S];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+d),w[T.tileID.key]=T}this.indexes[f]=w}this.lng=s}addBucket(s,d,f){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let w=0;w<d.symbolInstances.length;w++)d.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const _=this.usedCrossTileIDs[s.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>s.overscaledZ)for(const T in S){const M=S[T];M.tileID.isChildOf(s)&&M.findMatches(d.symbolInstances,s,_)}else{const T=S[s.scaledTo(Number(w)).key];T&&T.findMatches(d.symbolInstances,s,_)}}for(let w=0;w<d.symbolInstances.length;w++){const S=d.symbolInstances.get(w);S.crossTileID||(S.crossTileID=f.generate(),_[S.crossTileID]=!0)}return void 0===this.indexes[s.overscaledZ]&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new ea(s,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(s,d){for(const f of d.getCrossTileIDsLists())for(const _ of f)delete this.usedCrossTileIDs[s][_]}removeStaleBuckets(s){let d=!1;for(const f in this.indexes){const _=this.indexes[f];for(const w in _)s[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[w]),delete _[w],d=!0)}return d}}class Ds{constructor(){this.layerIndexes={},this.crossTileIDs=new xi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,d,f){let _=this.layerIndexes[s.id];void 0===_&&(_=this.layerIndexes[s.id]=new yl);let w=!1;const S={};_.handleWrapJump(f);for(const T of d){const M=T.getBucket(s);M&&s.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(T.tileID,M,this.crossTileIDs)&&(w=!0),S[M.bucketInstanceId]=!0)}return _.removeStaleBuckets(S)&&(w=!0),w}pruneUnusedLayers(s){const d={};s.forEach(f=>{d[f]=!0});for(const f in this.layerIndexes)d[f]||delete this.layerIndexes[f]}}const hi=(m,s)=>v.emitValidationErrors(m,s&&s.filter(d=>"source.canvas"!==d.identifier)),Wc=v.pick(v.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Vo=v.pick(v.operations,["setCenter","setZoom","setBearing","setPitch"]),Mh=v.emptyStyle();class Hi extends v.Evented{constructor(s,d={}){super(),this.map=s,this.dispatcher=new Lr(_l(),this,s._getMapId()),this.imageManager=new Zn,this.imageManager.setEventedParent(this),this.glyphManager=new vr(s._requestManager,d.localIdeographFontFamily),this.lineAtlas=new Xs(256,512),this.crossTileSymbolIndex=new Ds,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new v.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",v.getReferrer());const f=this;this._rtlTextPluginCallback=Hi.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(w,S)=>{if(v.triggerPluginCompletionEvent(w),S&&S.every(T=>T))for(const T in f.sourceCaches){const M=f.sourceCaches[T].getSource().type;"vector"!==M&&"geojson"!==M||f.sourceCaches[T].reload()}})}),this.on("data",_=>{if("source"!==_.dataType||"metadata"!==_.sourceDataType)return;const w=this.sourceCaches[_.sourceId];if(!w)return;const S=w.getSource();if(S&&S.vectorLayerIds)for(const T in this._layers){const M=this._layers[T];M.source===S.id&&this._validateLayer(M)}})}loadURL(s,d={},f){this.fire(new v.Event("dataloading",{dataType:"style"})),d.validate="boolean"!=typeof d.validate||d.validate;const _=this.map._requestManager.transformRequest(s,qn.Style);this._request=v.getJSON(_,(w,S)=>{this._request=null,w?this.fire(new v.ErrorEvent(w)):S&&this._load(S,d,f)})}loadJSON(s,d={},f){this.fire(new v.Event("dataloading",{dataType:"style"})),this._request=v.exported.frame(()=>{this._request=null,d.validate=!1!==d.validate,this._load(s,d,f)})}loadEmpty(){this.fire(new v.Event("dataloading",{dataType:"style"})),this._load(Mh,{validate:!1})}_load(s,d,f){const _=d.transformStyle?d.transformStyle(f,s):s;if(!d.validate||!hi(this,v.validateStyle(_))){this._loaded=!0,this.stylesheet=_;for(const w in _.sources)this.addSource(w,_.sources[w],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new pl(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new v.Event("data",{dataType:"style"})),this.fire(new v.Event("style.load"))}}_createLayers(){const s=v.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of s){const f=v.createStyleLayer(d);f.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=f}}_loadSprite(s,d=!1,f=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(_,w,S,T){const M=dt(_),k=M.length,O=S>1?"@2x":"",F={},j={},K={};for(const{id:G,url:Z}of M){const te=w.transformRequest(w.normalizeSpriteURL(Z,O,".json"),qn.SpriteJSON),le=`${G}_${te.url}`;F[le]=v.getJSON(te,(pe,ve)=>{delete F[le],j[G]=ve,mt(T,j,K,pe,k)});const fe=w.transformRequest(w.normalizeSpriteURL(Z,O,".png"),qn.SpriteImage),J=`${G}_${fe.url}`;F[J]=yo.getImage(fe,(pe,ve)=>{delete F[J],K[G]=ve,mt(T,j,K,pe,k)})}return{cancel(){for(const G of Object.values(F))G.cancel()}}}(s,this.map._requestManager,this.map.getPixelRatio(),(_,w)=>{if(this._spriteRequest=null,_)this.fire(new v.ErrorEvent(_));else if(w)for(const S in w){this._spritesImagesIds[S]=[];const T=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(M=>!(M in w)):[];for(const M of T)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in w[S]){const k="default"===S?M:`${S}:${M}`;this._spritesImagesIds[S].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,w[S][M],!1):this.imageManager.addImage(k,w[S][M]),d&&(this._changedImages[k]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"})),f&&f(_)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))}_validateLayer(s){const d=this.sourceCaches[s.source];if(!d)return;const f=s.sourceLayer;if(!f)return;const _=d.getSource();("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(f))&&this.fire(new v.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${_.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const d=this._serializedAllLayers();if(!s||0===s.length)return Object.values(d);const f=[];for(const _ of s)d[_]&&f.push(d[_]);return f}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const d=Object.keys(this._layers);for(const f of d){const _=this._layers[f];"custom"!==_.type&&(s[f]=_.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const d=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(_.length||w.length)&&this._updateWorkerLayers(_,w);for(const S in this._updatedSources){const T=this._updatedSources[S];if("reload"===T)this._reloadSource(S);else{if("clear"!==T)throw new Error(`Invalid action ${T}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const f={};for(const _ in this.sourceCaches){const w=this.sourceCaches[_];f[_]=w.used,w.used=!1}for(const _ of this._order){const w=this._layers[_];w.recalculate(s,this._availableImages),!w.isHidden(s.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const _ in f){const w=this.sourceCaches[_];f[_]!==w.used&&w.fire(new v.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(s),this.z=s.zoom,d&&this.fire(new v.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,d={}){this._checkLoaded();const f=this.serialize();if(s=d.transformStyle?d.transformStyle(f,s):s,hi(this,v.validateStyle(s)))return!1;(s=v.clone$1(s)).layers=v.derefLayers(s.layers);const _=v.diffStyles(f,s).filter(S=>!(S.command in Vo));if(0===_.length)return!1;const w=_.filter(S=>!(S.command in Wc));if(w.length>0)throw new Error(`Unimplemented: ${w.map(S=>S.command).join(", ")}.`);for(const S of _)"setTransition"!==S.command&&this[S.command].apply(this,S.args);return this.stylesheet=s,!0}addImage(s,d){if(this.getImage(s))return this.fire(new v.ErrorEvent(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,d),this._afterImageUpdated(s)}updateImage(s,d){this.imageManager.updateImage(s,d)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new v.ErrorEvent(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,d,f={}){if(this._checkLoaded(),void 0!==this.sourceCaches[s])throw new Error(`Source "${s}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(v.validateStyle.source,`sources.${s}`,d,null,f))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[s]=new vi(s,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:s})),_.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),void 0===this.sourceCaches[s])throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===s)return this.fire(new v.ErrorEvent(new Error(`Source "${s}" cannot be removed while layer "${f}" is using it.`)));const d=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],d.fire(new v.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,d){if(this._checkLoaded(),void 0===this.sourceCaches[s])throw new Error(`There is no source with this ID=${s}`);const f=this.sourceCaches[s].getSource();if("geojson"!==f.type)throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(d),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,d,f={}){this._checkLoaded();const _=s.id;if(this.getLayer(_))return void this.fire(new v.ErrorEvent(new Error(`Layer "${_}" already exists on this map.`)));let w;if("custom"===s.type){if(hi(this,v.validateCustomStyleLayer(s)))return;w=v.createStyleLayer(s)}else{if("object"==typeof s.source&&(this.addSource(_,s.source),s=v.clone$1(s),s=v.extend(s,{source:_})),this._validate(v.validateStyle.layer,`layers.${_}`,s,{arrayIndex:-1},f))return;w=v.createStyleLayer(s),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}})}const S=d?this._order.indexOf(d):this._order.length;if(d&&-1===S)this.fire(new v.ErrorEvent(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(S,0,_),this._layerOrderChanged=!0,this._layers[_]=w,this._removedLayers[_]&&w.source&&"custom"!==w.type){const T=this._removedLayers[_];delete this._removedLayers[_],T.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(s,d){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new v.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===d)return;const f=this._order.indexOf(s);this._order.splice(f,1);const _=d?this._order.indexOf(d):this._order.length;d&&-1===_?this.fire(new v.ErrorEvent(new Error(`Cannot move layer "${s}" before non-existing layer "${d}".`))):(this._order.splice(_,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const d=this._layers[s];if(!d)return void this.fire(new v.ErrorEvent(new Error(`Cannot remove non-existing layer "${s}".`)));d.setEventedParent(null);const f=this._order.indexOf(s);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=d,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],d.onRemove&&d.onRemove(this.map)}getLayer(s){return this._layers[s]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,d,f){this._checkLoaded();const _=this.getLayer(s);_?_.minzoom===d&&_.maxzoom===f||(null!=d&&(_.minzoom=d),null!=f&&(_.maxzoom=f),this._updateLayer(_)):this.fire(new v.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,d,f={}){this._checkLoaded();const _=this.getLayer(s);if(_){if(!v.deepEqual(_.filter,d))return null==d?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(v.validateStyle.filter,`layers.${_.id}.filter`,d,null,f)||(_.filter=v.clone$1(d),this._updateLayer(_)))}else this.fire(new v.ErrorEvent(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return v.clone$1(this.getLayer(s).filter)}setLayoutProperty(s,d,f,_={}){this._checkLoaded();const w=this.getLayer(s);w?v.deepEqual(w.getLayoutProperty(d),f)||(w.setLayoutProperty(d,f,_),this._updateLayer(w)):this.fire(new v.ErrorEvent(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,d){const f=this.getLayer(s);if(f)return f.getLayoutProperty(d);this.fire(new v.ErrorEvent(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,d,f,_={}){this._checkLoaded();const w=this.getLayer(s);w?v.deepEqual(w.getPaintProperty(d),f)||(w.setPaintProperty(d,f,_)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new v.ErrorEvent(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,d){return this.getLayer(s).getPaintProperty(d)}setFeatureState(s,d){this._checkLoaded();const f=s.source,_=s.sourceLayer,w=this.sourceCaches[f];if(void 0===w)return void this.fire(new v.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const S=w.getSource().type;"geojson"===S&&_?this.fire(new v.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==S||_?(void 0===s.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),w.setFeatureState(_,s.id,d)):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,d){this._checkLoaded();const f=s.source,_=this.sourceCaches[f];if(void 0===_)return void this.fire(new v.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const w=_.getSource().type,S="vector"===w?s.sourceLayer:void 0;"vector"!==w||S?d&&"string"!=typeof s.id&&"number"!=typeof s.id?this.fire(new v.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(S,s.id,d):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const d=s.source,f=s.sourceLayer,_=this.sourceCaches[d];if(void 0!==_)return"vector"!==_.getSource().type||f?(void 0===s.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(f,s.id)):void this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new v.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return v.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const s=v.mapObject(this.sourceCaches,_=>_.serialize()),d=this._serializeByIds(this._order),f=this.stylesheet;return v.filterObject({version:f.version,name:f.name,metadata:f.metadata,light:f.light,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:s,layers:d},_=>void 0!==_)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&"raster"!==this.sourceCaches[s.source].getSource().type&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const d=S=>"fill-extrusion"===this._layers[S].type,f={},_=[];for(let S=this._order.length-1;S>=0;S--){const T=this._order[S];if(d(T)){f[T]=S;for(const M of s){const k=M[T];if(k)for(const O of k)_.push(O)}}}_.sort((S,T)=>T.intersectionZ-S.intersectionZ);const w=[];for(let S=this._order.length-1;S>=0;S--){const T=this._order[S];if(d(T))for(let M=_.length-1;M>=0;M--){const k=_[M].feature;if(f[k.layer.id]<S)break;w.push(k),_.pop()}else for(const M of s){const k=M[T];if(k)for(const O of k)w.push(O.feature)}}return w}queryRenderedFeatures(s,d,f){d&&d.filter&&this._validate(v.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new v.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const T of d.layers){const M=this._layers[T];if(!M)return this.fire(new v.ErrorEvent(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];_[M.source]=!0}}const w=[];d.availableImages=this._availableImages;const S=this._serializedAllLayers();for(const T in this.sourceCaches)d.layers&&!_[T]||w.push(Fn(this.sourceCaches[T],this._layers,S,s,d,f));return this.placement&&w.push(function(T,M,k,O,F,j,K){const G={},Z=j.queryRenderedSymbols(O),te=[];for(const le of Object.keys(Z).map(Number))te.push(K[le]);te.sort(pn);for(const le of te){const fe=le.featureIndex.lookupSymbolFeatures(Z[le.bucketInstanceId],M,le.bucketIndex,le.sourceLayerIndex,F.filter,F.layers,F.availableImages,T);for(const J in fe){const pe=G[J]=G[J]||[],ve=fe[J];ve.sort((De,Ae)=>{const Ne=le.featureSortOrder;if(Ne){const ke=Ne.indexOf(De.featureIndex);return Ne.indexOf(Ae.featureIndex)-ke}return Ae.featureIndex-De.featureIndex});for(const De of ve)pe.push(De)}}for(const le in G)G[le].forEach(fe=>{const J=fe.feature,pe=k[T[le].source].getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=pe});return G}(this._layers,S,this.sourceCaches,s,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(s,d){d&&d.filter&&this._validate(v.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);const f=this.sourceCaches[s];return f?function(_,w){const S=_.getRenderableIds().map(k=>_.getTileByID(k)),T=[],M={};for(let k=0;k<S.length;k++){const O=S[k],F=O.tileID.canonical.key;M[F]||(M[F]=!0,O.querySourceFeatures(T,w))}return T}(f,d):[]}addSourceType(s,d,f){return Hi.getSourceType(s)?f(new Error(`A source type called "${s}" already exists.`)):(Hi.setSourceType(s,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:d.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(s,d={}){this._checkLoaded();const f=this.light.getLight();let _=!1;for(const S in s)if(!v.deepEqual(s[S],f[S])){_=!0;break}if(!_)return;const w={now:v.exported.now(),transition:v.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,d),this.light.updateTransitions(w)}_validate(s,d,f,_,w={}){return(!w||!1!==w.validate)&&hi(this,s.call(v.validateStyle,v.extend({key:d,style:this.serialize(),value:f,styleSpec:v.v8Spec},_)))}_remove(s=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),v.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const f=this.sourceCaches[d];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const d in this.sourceCaches)this.sourceCaches[d].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,d,f,_,w=!1){let S=!1,T=!1;const M={};for(const k of this._order){const O=this._layers[k];if("symbol"!==O.type)continue;if(!M[O.source]){const j=this.sourceCaches[O.source];M[O.source]=j.getRenderableIds(!0).map(K=>j.getTileByID(K)).sort((K,G)=>G.tileID.overscaledZ-K.tileID.overscaledZ||(K.tileID.isLessThan(G.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(O,M[O.source],s.center.lng);S=S||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||0===f)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.exported.now(),s.zoom))&&(this.pauseablePlacement=new Zr(s,this.map.terrain,this._order,w,d,f,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.exported.now()),T=!0),S&&this.pauseablePlacement.placement.setStale()),T||S)for(const k of this._order){const O=this._layers[k];"symbol"===O.type&&this.placement.updateLayerOpacities(O,M[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.exported.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,d,f){this.imageManager.getImages(d.icons,f),this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];_&&_.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(s,d,f){this.glyphManager.getGlyphs(d.stacks,f);const _=this.sourceCaches[d.source];_&&_.setDependencies(d.tileID.key,d.type,[""])}getResource(s,d,f){return v.makeRequest(d,f)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,d={}){this._checkLoaded(),s&&this._validate(v.validateStyle.glyphs,"glyphs",s,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,d,f={},_){this._checkLoaded();const w=[{id:s,url:d}],S=[...dt(this.stylesheet.sprite),...w];this._validate(v.validateStyle.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(w,!0,_))}removeSprite(s){this._checkLoaded();const d=dt(this.stylesheet.sprite);if(d.find(f=>f.id===s)){if(this._spritesImagesIds[s])for(const f of this._spritesImagesIds[s])this.imageManager.removeImage(f),this._changedImages[f]=!0;d.splice(d.findIndex(f=>f.id===s),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))}else this.fire(new v.ErrorEvent(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return dt(this.stylesheet.sprite)}setSprite(s,d={},f){this._checkLoaded(),s&&this._validate(v.validateStyle.sprite,"sprite",s,null,d)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,f):(this._unloadSprite(),f&&f(null)))}}Hi.getSourceType=function(m){return Ys[m]},Hi.setSourceType=function(m,s){Ys[m]=s},Hi.registerForPluginStateChange=v.registerForPluginStateChange;var od=v.createLayout([{name:"a_pos",type:"Int16",components:2}]),Zc="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ei={prelude:Ht("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:Ht("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ht("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ht("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Ht("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ht("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:Ht("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ht("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ht("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ht("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ht("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:Ht("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:Ht("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:Ht("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Ht("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Ht("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Ht("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ht("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ht("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Ht("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Ht("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Ht("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:Ht("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ht("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:Ht("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Ht("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:Ht("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Zc),terrainDepth:Ht("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Zc),terrainCoords:Ht("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Zc)};function Ht(m,s){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=s.match(/attribute ([\w]+) ([\w]+)/g),_=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(_):_,T={};return{fragmentSource:m=m.replace(d,(M,k,O,F,j)=>(T[j]=!0,"define"===k?`\n#ifndef HAS_UNIFORM_u_${j}\nvarying ${O} ${F} ${j};\n#else\nuniform ${O} ${F} u_${j};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${j}\n    ${O} ${F} ${j} = u_${j};\n#endif\n`)),vertexSource:s=s.replace(d,(M,k,O,F,j)=>{const K="float"===F?"vec2":"vec4",G=j.match(/color/)?"color":K;return T[j]?"define"===k?`\n#ifndef HAS_UNIFORM_u_${j}\nuniform lowp float u_${j}_t;\nattribute ${O} ${K} a_${j};\nvarying ${O} ${F} ${j};\n#else\nuniform ${O} ${F} u_${j};\n#endif\n`:"vec4"===G?`\n#ifndef HAS_UNIFORM_u_${j}\n    ${j} = a_${j};\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${j}\n    ${j} = unpack_mix_${G}(a_${j}, u_${j}_t);\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`:"define"===k?`\n#ifndef HAS_UNIFORM_u_${j}\nuniform lowp float u_${j}_t;\nattribute ${O} ${K} a_${j};\n#else\nuniform ${O} ${F} u_${j};\n#endif\n`:"vec4"===G?`\n#ifndef HAS_UNIFORM_u_${j}\n    ${O} ${F} ${j} = a_${j};\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${j}\n    ${O} ${F} ${j} = unpack_mix_${G}(a_${j}, u_${j}_t);\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`}),staticAttributes:f,staticUniforms:S}}class wi{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,d,f,_,w,S,T,M,k){this.context=s;let O=this.boundPaintVertexBuffers.length!==_.length;for(let F=0;!O&&F<_.length;F++)this.boundPaintVertexBuffers[F]!==_[F]&&(O=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==f||O||this.boundIndexBuffer!==w||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==k?this.freshBind(d,f,_,w,S,T,M,k):(s.bindVertexArray.set(this.vao),T&&T.bind(),w&&w.dynamicDraw&&w.bind(),M&&M.bind(),k&&k.bind())}freshBind(s,d,f,_,w,S,T,M){const k=s.numAttributes,O=this.context,F=O.gl;this.vao&&this.destroy(),this.vao=O.createVertexArray(),O.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=M,d.enableAttributes(F,s);for(const j of f)j.enableAttributes(F,s);S&&S.enableAttributes(F,s),T&&T.enableAttributes(F,s),M&&M.enableAttributes(F,s),d.bind(),d.setVertexAttribPointers(F,s,w);for(const j of f)j.bind(),j.setVertexAttribPointers(F,s,w);S&&(S.bind(),S.setVertexAttribPointers(F,s,w)),_&&_.bind(),T&&(T.bind(),T.setVertexAttribPointers(F,s,w)),M&&(M.bind(),M.setVertexAttribPointers(F,s,w)),O.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function _t(m){const s=[];for(let d=0;d<m.length;d++){if(null===m[d])continue;const f=m[d].split(" ");s.push(f.pop())}return s}class vl{constructor(s,d,f,_,w,S,T){const M=s.gl;this.program=M.createProgram();const k=_t(f.staticAttributes),O=_?_.getBinderAttributes():[],F=k.concat(O),j=ei.prelude.staticUniforms?_t(ei.prelude.staticUniforms):[],K=f.staticUniforms?_t(f.staticUniforms):[],G=_?_.getBinderUniforms():[],Z=j.concat(K).concat(G),te=[];for(const Ae of Z)te.indexOf(Ae)<0&&te.push(Ae);const le=_?_.defines():[];S&&le.push("#define OVERDRAW_INSPECTOR;"),T&&le.push("#define TERRAIN3D;");const fe=le.concat(ei.prelude.fragmentSource,f.fragmentSource).join("\n"),J=le.concat(ei.prelude.vertexSource,f.vertexSource).join("\n"),pe=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(pe,fe),M.compileShader(pe),M.attachShader(this.program,pe);const ve=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(ve,J),M.compileShader(ve),M.attachShader(this.program,ve),this.attributes={};const De={};this.numAttributes=F.length;for(let Ae=0;Ae<this.numAttributes;Ae++)F[Ae]&&(M.bindAttribLocation(this.program,Ae,F[Ae]),this.attributes[F[Ae]]=Ae);M.linkProgram(this.program),M.deleteShader(ve),M.deleteShader(pe);for(let Ae=0;Ae<te.length;Ae++){const Ne=te[Ae];if(Ne&&!De[Ne]){const ke=M.getUniformLocation(this.program,Ne);ke&&(De[Ne]=ke)}}var Ae,Ne;this.fixedUniforms=w(s,De),this.terrainUniforms={u_depth:new v.Uniform1i(Ae=s,(Ne=De).u_depth),u_terrain:new v.Uniform1i(Ae,Ne.u_terrain),u_terrain_dim:new v.Uniform1f(Ae,Ne.u_terrain_dim),u_terrain_matrix:new v.UniformMatrix4f(Ae,Ne.u_terrain_matrix),u_terrain_unpack:new v.Uniform4f(Ae,Ne.u_terrain_unpack),u_terrain_exaggeration:new v.Uniform1f(Ae,Ne.u_terrain_exaggeration)},this.binderUniforms=_?_.getUniforms(s,De):[]}draw(s,d,f,_,w,S,T,M,k,O,F,j,K,G,Z,te,le,fe){const J=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(f),s.setStencilMode(_),s.setColorMode(w),s.setCullFace(S),M){s.activeTexture.set(J.TEXTURE2),J.bindTexture(J.TEXTURE_2D,M.depthTexture),s.activeTexture.set(J.TEXTURE3),J.bindTexture(J.TEXTURE_2D,M.texture);for(const ve in this.terrainUniforms)this.terrainUniforms[ve].set(M[ve])}for(const ve in this.fixedUniforms)this.fixedUniforms[ve].set(T[ve]);Z&&Z.setUniforms(s,this.binderUniforms,K,{zoom:G});let pe=0;switch(d){case J.LINES:pe=2;break;case J.TRIANGLES:pe=3;break;case J.LINE_STRIP:pe=1}for(const ve of j.get()){const De=ve.vaos||(ve.vaos={});(De[k]||(De[k]=new wi)).bind(s,this,O,Z?Z.getPaintVertexBuffers():[],F,ve.vertexOffset,te,le,fe),J.drawElements(d,ve.primitiveLength*pe,J.UNSIGNED_SHORT,ve.primitiveOffset*pe*2)}}}function Kc(m,s,d){const f=1/ae(d,1,s.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),w=d.tileSize*Math.pow(2,s.transform.tileZoom)/_,S=w*(d.tileID.canonical.x+d.tileID.wrap*_),T=w*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[f,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[S>>16,T>>16],u_pixel_coord_lower:[65535&S,65535&T]}}const ir=(m,s,d,f)=>{const _=s.style.light,w=_.properties.get("position"),S=[w.x,w.y,w.z],T=(k=new v.ARRAY_TYPE(9),v.ARRAY_TYPE!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k);var k;"viewport"===_.properties.get("anchor")&&function(k,O){var F=Math.sin(O),j=Math.cos(O);k[0]=j,k[1]=F,k[2]=0,k[3]=-F,k[4]=j,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(T,-s.transform.angle),function(k,O,F){var j=O[0],K=O[1],G=O[2];k[0]=j*F[0]+K*F[3]+G*F[6],k[1]=j*F[1]+K*F[4]+G*F[7],k[2]=j*F[2]+K*F[5]+G*F[8]}(S,S,T);const M=_.properties.get("color");return{u_matrix:m,u_lightpos:S,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+d,u_opacity:f}},Xc=(m,s,d,f,_,w,S)=>v.extend(ir(m,s,d,f),Kc(w,s,S),{u_height_factor:-Math.pow(2,_.overscaledZ)/S.tileSize/8}),Th=m=>({u_matrix:m}),wn=(m,s,d,f)=>v.extend(Th(m),Kc(d,s,f)),Yc=(m,s)=>({u_matrix:m,u_world:s}),Ei=(m,s,d,f,_)=>v.extend(wn(m,s,d,f),{u_world:_}),sd=(m,s,d,f)=>{const _=m.transform;let w,S;if("map"===f.paint.get("circle-pitch-alignment")){const T=ae(d,1,_.zoom);w=!0,S=[T,T]}else w=!1,S=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+("map"===f.paint.get("circle-pitch-scale")),u_matrix:m.translatePosMatrix(s.posMatrix,d,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:S}},ad=(m,s,d)=>{const f=ae(d,1,s.zoom),_=Math.pow(2,s.zoom-d.tileID.overscaledZ),w=d.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:f,u_extrude_scale:[s.pixelsToGLUnits[0]/(f*_),s.pixelsToGLUnits[1]/(f*_)],u_overscale_factor:w}},Mn=(m,s,d=1)=>({u_matrix:m,u_color:s,u_overlay:0,u_overlay_scale:d}),Mt=m=>({u_matrix:m}),Qc=(m,s,d,f)=>({u_matrix:m,u_extrude_scale:ae(s,1,d),u_intensity:f});function Jc(m,s){const d=Math.pow(2,s.canonical.z),f=s.canonical.y;return[new v.MercatorCoordinate(0,f/d).toLngLat().lat,new v.MercatorCoordinate(0,(f+1)/d).toLngLat().lat]}const ta=(m,s,d,f)=>{const _=m.transform;return{u_matrix:on(m,s,d,f),u_ratio:1/ae(s,1,_.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},oc=(m,s,d,f,_)=>v.extend(ta(m,s,d,_),{u_image:0,u_image_height:f}),be=(m,s,d,f,_)=>{const w=m.transform,S=Tt(s,w);return{u_matrix:on(m,s,d,_),u_texsize:s.imageAtlasTexture.size,u_ratio:1/ae(s,1,w.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[S,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Ua=(m,s,d,f,_,w)=>{const S=m.lineAtlas,T=Tt(s,m.transform),M="round"===d.layout.get("line-cap"),k=S.getDash(f.from,M),O=S.getDash(f.to,M),F=k.width*_.fromScale,j=O.width*_.toScale;return v.extend(ta(m,s,d,w),{u_patternscale_a:[T/F,-k.height/2],u_patternscale_b:[T/j,-O.height/2],u_sdfgamma:S.width/(256*Math.min(F,j)*m.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:O.y,u_mix:_.t})};function Tt(m,s){return 1/ae(m,1,s.tileZoom)}function on(m,s,d,f){return m.translatePosMatrix(f?f.posMatrix:s.tileID.posMatrix,s,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const eu=(m,s,d,f,_)=>{return{u_matrix:m,u_tl_parent:s,u_scale_parent:d,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:ld(_.paint.get("raster-hue-rotate"))};var w,S};function ld(m){m*=Math.PI/180;const s=Math.sin(m),d=Math.cos(m);return[(2*d+1)/3,(-Math.sqrt(3)*s-d+1)/3,(Math.sqrt(3)*s-d+1)/3]}const bl=(m,s,d,f,_,w,S,T,M,k)=>{const O=_.transform;return{u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:O.cameraToCenterDistance,u_pitch:O.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:O.width/O.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:T,u_is_text:+M,u_pitch_with_map:+f,u_texsize:k,u_texture:0}},na=(m,s,d,f,_,w,S,T,M,k,O)=>{const F=_.transform;return v.extend(bl(m,s,d,f,_,w,S,T,M,k),{u_gamma_scale:f?Math.cos(F._pitch)*F.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+O})},br=(m,s,d,f,_,w,S,T,M,k)=>v.extend(na(m,s,d,f,_,w,S,T,!0,M,!0),{u_texsize_icon:k,u_texture_icon:1}),xo=(m,s,d)=>({u_matrix:m,u_opacity:s,u_color:d}),io=(m,s,d,f,_,w)=>v.extend(function(S,T,M,k){const O=M.imageManager.getPattern(S.from.toString()),F=M.imageManager.getPattern(S.to.toString()),{width:j,height:K}=M.imageManager.getPixelSize(),G=Math.pow(2,k.tileID.overscaledZ),Z=k.tileSize*Math.pow(2,M.transform.tileZoom)/G,te=Z*(k.tileID.canonical.x+k.tileID.wrap*G),le=Z*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[j,K],u_mix:T.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/ae(k,1,M.transform.tileZoom),u_pixel_coord_upper:[te>>16,le>>16],u_pixel_coord_lower:[65535&te,65535&le]}}(f,w,d,_),{u_matrix:m,u_opacity:s}),Ah={fillExtrusion:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_lightpos:new v.Uniform3f(m,s.u_lightpos),u_lightintensity:new v.Uniform1f(m,s.u_lightintensity),u_lightcolor:new v.Uniform3f(m,s.u_lightcolor),u_vertical_gradient:new v.Uniform1f(m,s.u_vertical_gradient),u_opacity:new v.Uniform1f(m,s.u_opacity)}),fillExtrusionPattern:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_lightpos:new v.Uniform3f(m,s.u_lightpos),u_lightintensity:new v.Uniform1f(m,s.u_lightintensity),u_lightcolor:new v.Uniform3f(m,s.u_lightcolor),u_vertical_gradient:new v.Uniform1f(m,s.u_vertical_gradient),u_height_factor:new v.Uniform1f(m,s.u_height_factor),u_image:new v.Uniform1i(m,s.u_image),u_texsize:new v.Uniform2f(m,s.u_texsize),u_pixel_coord_upper:new v.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(m,s.u_pixel_coord_lower),u_scale:new v.Uniform3f(m,s.u_scale),u_fade:new v.Uniform1f(m,s.u_fade),u_opacity:new v.Uniform1f(m,s.u_opacity)}),fill:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix)}),fillPattern:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_image:new v.Uniform1i(m,s.u_image),u_texsize:new v.Uniform2f(m,s.u_texsize),u_pixel_coord_upper:new v.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(m,s.u_pixel_coord_lower),u_scale:new v.Uniform3f(m,s.u_scale),u_fade:new v.Uniform1f(m,s.u_fade)}),fillOutline:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_world:new v.Uniform2f(m,s.u_world)}),fillOutlinePattern:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_world:new v.Uniform2f(m,s.u_world),u_image:new v.Uniform1i(m,s.u_image),u_texsize:new v.Uniform2f(m,s.u_texsize),u_pixel_coord_upper:new v.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(m,s.u_pixel_coord_lower),u_scale:new v.Uniform3f(m,s.u_scale),u_fade:new v.Uniform1f(m,s.u_fade)}),circle:(m,s)=>({u_camera_to_center_distance:new v.Uniform1f(m,s.u_camera_to_center_distance),u_scale_with_map:new v.Uniform1i(m,s.u_scale_with_map),u_pitch_with_map:new v.Uniform1i(m,s.u_pitch_with_map),u_extrude_scale:new v.Uniform2f(m,s.u_extrude_scale),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_matrix:new v.UniformMatrix4f(m,s.u_matrix)}),collisionBox:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_camera_to_center_distance:new v.Uniform1f(m,s.u_camera_to_center_distance),u_pixels_to_tile_units:new v.Uniform1f(m,s.u_pixels_to_tile_units),u_extrude_scale:new v.Uniform2f(m,s.u_extrude_scale),u_overscale_factor:new v.Uniform1f(m,s.u_overscale_factor)}),collisionCircle:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_inv_matrix:new v.UniformMatrix4f(m,s.u_inv_matrix),u_camera_to_center_distance:new v.Uniform1f(m,s.u_camera_to_center_distance),u_viewport_size:new v.Uniform2f(m,s.u_viewport_size)}),debug:(m,s)=>({u_color:new v.UniformColor(m,s.u_color),u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_overlay:new v.Uniform1i(m,s.u_overlay),u_overlay_scale:new v.Uniform1f(m,s.u_overlay_scale)}),clippingMask:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix)}),heatmap:(m,s)=>({u_extrude_scale:new v.Uniform1f(m,s.u_extrude_scale),u_intensity:new v.Uniform1f(m,s.u_intensity),u_matrix:new v.UniformMatrix4f(m,s.u_matrix)}),heatmapTexture:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_world:new v.Uniform2f(m,s.u_world),u_image:new v.Uniform1i(m,s.u_image),u_color_ramp:new v.Uniform1i(m,s.u_color_ramp),u_opacity:new v.Uniform1f(m,s.u_opacity)}),hillshade:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_image:new v.Uniform1i(m,s.u_image),u_latrange:new v.Uniform2f(m,s.u_latrange),u_light:new v.Uniform2f(m,s.u_light),u_shadow:new v.UniformColor(m,s.u_shadow),u_highlight:new v.UniformColor(m,s.u_highlight),u_accent:new v.UniformColor(m,s.u_accent)}),hillshadePrepare:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_image:new v.Uniform1i(m,s.u_image),u_dimension:new v.Uniform2f(m,s.u_dimension),u_zoom:new v.Uniform1f(m,s.u_zoom),u_unpack:new v.Uniform4f(m,s.u_unpack)}),line:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_ratio:new v.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(m,s.u_units_to_pixels)}),lineGradient:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_ratio:new v.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(m,s.u_units_to_pixels),u_image:new v.Uniform1i(m,s.u_image),u_image_height:new v.Uniform1f(m,s.u_image_height)}),linePattern:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_texsize:new v.Uniform2f(m,s.u_texsize),u_ratio:new v.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_image:new v.Uniform1i(m,s.u_image),u_units_to_pixels:new v.Uniform2f(m,s.u_units_to_pixels),u_scale:new v.Uniform3f(m,s.u_scale),u_fade:new v.Uniform1f(m,s.u_fade)}),lineSDF:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_ratio:new v.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(m,s.u_units_to_pixels),u_patternscale_a:new v.Uniform2f(m,s.u_patternscale_a),u_patternscale_b:new v.Uniform2f(m,s.u_patternscale_b),u_sdfgamma:new v.Uniform1f(m,s.u_sdfgamma),u_image:new v.Uniform1i(m,s.u_image),u_tex_y_a:new v.Uniform1f(m,s.u_tex_y_a),u_tex_y_b:new v.Uniform1f(m,s.u_tex_y_b),u_mix:new v.Uniform1f(m,s.u_mix)}),raster:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_tl_parent:new v.Uniform2f(m,s.u_tl_parent),u_scale_parent:new v.Uniform1f(m,s.u_scale_parent),u_buffer_scale:new v.Uniform1f(m,s.u_buffer_scale),u_fade_t:new v.Uniform1f(m,s.u_fade_t),u_opacity:new v.Uniform1f(m,s.u_opacity),u_image0:new v.Uniform1i(m,s.u_image0),u_image1:new v.Uniform1i(m,s.u_image1),u_brightness_low:new v.Uniform1f(m,s.u_brightness_low),u_brightness_high:new v.Uniform1f(m,s.u_brightness_high),u_saturation_factor:new v.Uniform1f(m,s.u_saturation_factor),u_contrast_factor:new v.Uniform1f(m,s.u_contrast_factor),u_spin_weights:new v.Uniform3f(m,s.u_spin_weights)}),symbolIcon:(m,s)=>({u_is_size_zoom_constant:new v.Uniform1i(m,s.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(m,s.u_is_size_feature_constant),u_size_t:new v.Uniform1f(m,s.u_size_t),u_size:new v.Uniform1f(m,s.u_size),u_camera_to_center_distance:new v.Uniform1f(m,s.u_camera_to_center_distance),u_pitch:new v.Uniform1f(m,s.u_pitch),u_rotate_symbol:new v.Uniform1i(m,s.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(m,s.u_aspect_ratio),u_fade_change:new v.Uniform1f(m,s.u_fade_change),u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(m,s.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(m,s.u_coord_matrix),u_is_text:new v.Uniform1i(m,s.u_is_text),u_pitch_with_map:new v.Uniform1i(m,s.u_pitch_with_map),u_texsize:new v.Uniform2f(m,s.u_texsize),u_texture:new v.Uniform1i(m,s.u_texture)}),symbolSDF:(m,s)=>({u_is_size_zoom_constant:new v.Uniform1i(m,s.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(m,s.u_is_size_feature_constant),u_size_t:new v.Uniform1f(m,s.u_size_t),u_size:new v.Uniform1f(m,s.u_size),u_camera_to_center_distance:new v.Uniform1f(m,s.u_camera_to_center_distance),u_pitch:new v.Uniform1f(m,s.u_pitch),u_rotate_symbol:new v.Uniform1i(m,s.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(m,s.u_aspect_ratio),u_fade_change:new v.Uniform1f(m,s.u_fade_change),u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(m,s.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(m,s.u_coord_matrix),u_is_text:new v.Uniform1i(m,s.u_is_text),u_pitch_with_map:new v.Uniform1i(m,s.u_pitch_with_map),u_texsize:new v.Uniform2f(m,s.u_texsize),u_texture:new v.Uniform1i(m,s.u_texture),u_gamma_scale:new v.Uniform1f(m,s.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(m,s.u_is_halo)}),symbolTextAndIcon:(m,s)=>({u_is_size_zoom_constant:new v.Uniform1i(m,s.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(m,s.u_is_size_feature_constant),u_size_t:new v.Uniform1f(m,s.u_size_t),u_size:new v.Uniform1f(m,s.u_size),u_camera_to_center_distance:new v.Uniform1f(m,s.u_camera_to_center_distance),u_pitch:new v.Uniform1f(m,s.u_pitch),u_rotate_symbol:new v.Uniform1i(m,s.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(m,s.u_aspect_ratio),u_fade_change:new v.Uniform1f(m,s.u_fade_change),u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(m,s.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(m,s.u_coord_matrix),u_is_text:new v.Uniform1i(m,s.u_is_text),u_pitch_with_map:new v.Uniform1i(m,s.u_pitch_with_map),u_texsize:new v.Uniform2f(m,s.u_texsize),u_texsize_icon:new v.Uniform2f(m,s.u_texsize_icon),u_texture:new v.Uniform1i(m,s.u_texture),u_texture_icon:new v.Uniform1i(m,s.u_texture_icon),u_gamma_scale:new v.Uniform1f(m,s.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(m,s.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(m,s.u_is_halo)}),background:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_opacity:new v.Uniform1f(m,s.u_opacity),u_color:new v.UniformColor(m,s.u_color)}),backgroundPattern:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_opacity:new v.Uniform1f(m,s.u_opacity),u_image:new v.Uniform1i(m,s.u_image),u_pattern_tl_a:new v.Uniform2f(m,s.u_pattern_tl_a),u_pattern_br_a:new v.Uniform2f(m,s.u_pattern_br_a),u_pattern_tl_b:new v.Uniform2f(m,s.u_pattern_tl_b),u_pattern_br_b:new v.Uniform2f(m,s.u_pattern_br_b),u_texsize:new v.Uniform2f(m,s.u_texsize),u_mix:new v.Uniform1f(m,s.u_mix),u_pattern_size_a:new v.Uniform2f(m,s.u_pattern_size_a),u_pattern_size_b:new v.Uniform2f(m,s.u_pattern_size_b),u_scale_a:new v.Uniform1f(m,s.u_scale_a),u_scale_b:new v.Uniform1f(m,s.u_scale_b),u_pixel_coord_upper:new v.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(m,s.u_pixel_coord_lower),u_tile_units_to_pixels:new v.Uniform1f(m,s.u_tile_units_to_pixels)}),terrain:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_texture:new v.Uniform1i(m,s.u_texture),u_ele_delta:new v.Uniform1f(m,s.u_ele_delta)}),terrainDepth:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_ele_delta:new v.Uniform1f(m,s.u_ele_delta)}),terrainCoords:(m,s)=>({u_matrix:new v.UniformMatrix4f(m,s.u_matrix),u_texture:new v.Uniform1i(m,s.u_texture),u_terrain_coords_id:new v.Uniform1f(m,s.u_terrain_coords_id),u_ele_delta:new v.Uniform1f(m,s.u_ele_delta)})};class ss{constructor(s,d,f){this.context=s;const _=s.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const cd={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class kh{constructor(s,d,f,_){this.length=d.length,this.attributes=f,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=s;const w=s.gl;this.buffer=w.createBuffer(),s.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,d){for(let f=0;f<this.attributes.length;f++){const _=d.attributes[this.attributes[f].name];void 0!==_&&s.enableVertexAttribArray(_)}}setVertexAttribPointers(s,d,f){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],S=d.attributes[w.name];void 0!==S&&s.vertexAttribPointer(S,w.components,s[cd[w.type]],!1,this.itemSize,w.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const tu=new WeakMap;function xl(m){if(tu.has(m))return tu.get(m);{const s=m.getParameter(m.VERSION).startsWith("WebGL 2.0");return tu.set(m,s),s}}class ln{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Rh extends ln{getDefault(){return v.Color.transparent}set(s){const d=this.current;(s.r!==d.r||s.g!==d.g||s.b!==d.b||s.a!==d.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class nu extends ln{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class hf extends ln{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class ro extends ln{getDefault(){return[!0,!0,!0,!0]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Et extends ln{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Ng extends ln{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Bg extends ln{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const d=this.current;(s.func!==d.func||s.ref!==d.ref||s.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class zg extends ln{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class et extends ln{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=s,this.dirty=!1}}class Vg extends ln{getDefault(){return[0,1]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class pi extends ln{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=s,this.dirty=!1}}class wl extends ln{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class iu extends ln{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.BLEND):d.disable(d.BLEND),this.current=s,this.dirty=!1}}class ru extends ln{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class ud extends ln{getDefault(){return v.Color.transparent}set(s){const d=this.current;(s.r!==d.r||s.g!==d.g||s.b!==d.b||s.a!==d.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Is extends ln{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class sc extends ln{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;s?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=s,this.dirty=!1}}class ou extends ln{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class su extends ln{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class ja extends ln{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class rn extends ln{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class ia extends ln{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class $a extends ln{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Nr extends ln{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class au extends ln{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Cn extends ln{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Tn extends ln{getDefault(){return null}set(s){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Ug extends ln{getDefault(){return null}set(s){var d;if(s===this.current&&!this.dirty)return;const f=this.gl;xl(f)?f.bindVertexArray(s):null===(d=f.getExtension("OES_vertex_array_object"))||void 0===d||d.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class pf extends ln{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Re extends ln{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class dd extends ln{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class ac extends ln{constructor(s,d){super(s),this.context=s,this.parent=d}getDefault(){return null}}class hd extends ac{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class pd extends ac{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class fd extends ac{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class El{constructor(s,d,f,_,w){this.context=s,this.width=d,this.height=f;const S=s.gl,T=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new hd(s,T),_)this.depthAttachment=w?new fd(s,T):new pd(s,T);else if(w)throw new Error("Stencil cannot be setted without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,d=this.colorAttachment.get();if(d&&s.deleteTexture(d),this.depthAttachment){const f=this.depthAttachment.get();f&&s.deleteRenderbuffer(f)}s.deleteFramebuffer(this.framebuffer)}}class ti{constructor(s,d,f){this.blendFunction=s,this.blendColor=d,this.mask=f}}ti.Replace=[1,0],ti.disabled=new ti(ti.Replace,v.Color.transparent,[!1,!1,!1,!1]),ti.unblended=new ti(ti.Replace,v.Color.transparent,[!0,!0,!0,!0]),ti.alphaBlended=new ti([1,771],v.Color.transparent,[!0,!0,!0,!0]);class Ph{constructor(s){var d,f;if(this.gl=s,this.clearColor=new Rh(this),this.clearDepth=new nu(this),this.clearStencil=new hf(this),this.colorMask=new ro(this),this.depthMask=new Et(this),this.stencilMask=new Ng(this),this.stencilFunc=new Bg(this),this.stencilOp=new zg(this),this.stencilTest=new et(this),this.depthRange=new Vg(this),this.depthTest=new pi(this),this.depthFunc=new wl(this),this.blend=new iu(this),this.blendFunc=new ru(this),this.blendColor=new ud(this),this.blendEquation=new Is(this),this.cullFace=new sc(this),this.cullFaceSide=new ou(this),this.frontFace=new su(this),this.program=new ja(this),this.activeTexture=new rn(this),this.viewport=new ia(this),this.bindFramebuffer=new $a(this),this.bindRenderbuffer=new Nr(this),this.bindTexture=new au(this),this.bindVertexBuffer=new Cn(this),this.bindElementBuffer=new Tn(this),this.bindVertexArray=new Ug(this),this.pixelStoreUnpack=new pf(this),this.pixelStoreUnpackPremultiplyAlpha=new Re(this),this.pixelStoreUnpackFlipY=new dd(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),xl(s)){this.HALF_FLOAT=s.HALF_FLOAT;const _=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(d=s.RGBA16F)&&void 0!==d?d:_?.RGBA16F_EXT,this.RGB16F=null!==(f=s.RGB16F)&&void 0!==f?f:_?.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const _=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=_?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,d){return new ss(this,s,d)}createVertexBuffer(s,d,f){return new kh(this,s,d,f)}createRenderbuffer(s,d,f){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,s,d,f),this.bindRenderbuffer.set(null),w}createFramebuffer(s,d,f,_){return new El(this,s,d,f,_)}clear({color:s,depth:d,stencil:f}){const _=this.gl;let w=0;s&&(w|=_.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),void 0!==d&&(w|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==f&&(w|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),_.clear(w)}setCullFace(s){!1===s.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){v.deepEqual(s.blendFunction,ti.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return xl(this.gl)?this.gl.createVertexArray():null===(s=this.gl.getExtension("OES_vertex_array_object"))||void 0===s?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var d;return xl(this.gl)?this.gl.deleteVertexArray(s):null===(d=this.gl.getExtension("OES_vertex_array_object"))||void 0===d?void 0:d.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class Xt{constructor(s,d,f){this.func=s,this.mask=d,this.range=f}}Xt.ReadOnly=!1,Xt.ReadWrite=!0,Xt.disabled=new Xt(519,Xt.ReadOnly,[0,1]);class jn{constructor(s,d,f,_,w,S){this.test=s,this.ref=d,this.mask=f,this.fail=_,this.depthFail=w,this.pass=S}}jn.disabled=new jn({func:519,mask:0},0,0,7680,7680,7680);class _n{constructor(s,d,f){this.enable=s,this.mode=d,this.frontFace=f}}let ra;function lc(m,s,d,f,_,w,S){const T=m.context,M=T.gl,k=m.useProgram("collisionBox"),O=[];let F=0,j=0;for(let J=0;J<f.length;J++){const pe=f[J],ve=s.getTile(pe),De=ve.getBucket(d);if(!De)continue;let Ae=pe.posMatrix;0===_[0]&&0===_[1]||(Ae=m.translatePosMatrix(pe.posMatrix,ve,_,w));const Ne=S?De.textCollisionBox:De.iconCollisionBox,ke=De.collisionCircleArray;if(ke.length>0){const Be=v.create(),at=Ae;v.mul(Be,De.placementInvProjMatrix,m.transform.glCoordMatrix),v.mul(Be,Be,De.placementViewportMatrix),O.push({circleArray:ke,circleOffset:j,transform:at,invTransform:Be,coord:pe}),F+=ke.length/4,j=F}Ne&&k.draw(T,M.LINES,Xt.disabled,jn.disabled,m.colorModeForRenderPass(),_n.disabled,ad(Ae,m.transform,ve),m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),d.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,null,m.transform.zoom,null,null,Ne.collisionVertexBuffer)}if(!S||!O.length)return;const K=m.useProgram("collisionCircle"),G=new v.CollisionCircleLayoutArray;G.resize(4*F),G._trim();let Z=0;for(const J of O)for(let pe=0;pe<J.circleArray.length/4;pe++){const ve=4*pe,De=J.circleArray[ve+0],Ae=J.circleArray[ve+1],Ne=J.circleArray[ve+2],ke=J.circleArray[ve+3];G.emplace(Z++,De,Ae,Ne,ke,0),G.emplace(Z++,De,Ae,Ne,ke,1),G.emplace(Z++,De,Ae,Ne,ke,2),G.emplace(Z++,De,Ae,Ne,ke,3)}(!ra||ra.length<2*F)&&(ra=function(J){const pe=2*J,ve=new v.QuadTriangleArray;ve.resize(pe),ve._trim();for(let De=0;De<pe;De++){const Ae=6*De;ve.uint16[Ae+0]=4*De+0,ve.uint16[Ae+1]=4*De+1,ve.uint16[Ae+2]=4*De+2,ve.uint16[Ae+3]=4*De+2,ve.uint16[Ae+4]=4*De+3,ve.uint16[Ae+5]=4*De+0}return ve}(F));const te=T.createIndexBuffer(ra,!0),le=T.createVertexBuffer(G,v.collisionCircleLayout.members,!0);for(const J of O){const pe={u_matrix:J.transform,u_inv_matrix:J.invTransform,u_camera_to_center_distance:(fe=m.transform).cameraToCenterDistance,u_viewport_size:[fe.width,fe.height]};K.draw(T,M.TRIANGLES,Xt.disabled,jn.disabled,m.colorModeForRenderPass(),_n.disabled,pe,m.style.map.terrain&&m.style.map.terrain.getTerrainData(J.coord),d.id,le,te,v.SegmentVector.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,m.transform.zoom,null,null,null)}var fe;le.destroy(),te.destroy()}_n.disabled=new _n(!1,1029,2305),_n.backCCW=new _n(!0,1029,2305);const gd=v.identity(new Float32Array(16));function ff(m,s,d,f,_,w){const{horizontalAlign:S,verticalAlign:T}=v.getAnchorAlignment(m),M=-(S-.5)*s,k=-(T-.5)*d,O=v.evaluateVariableOffset(m,f);return new v.Point((M/_+O[0])*w,(k/_+O[1])*w)}function Fh(m,s,d,f,_,w,S,T,M,k,O){const F=m.text.placedSymbolArray,j=m.text.dynamicLayoutVertexArray,K=m.icon.dynamicLayoutVertexArray,G={};j.clear();for(let Z=0;Z<F.length;Z++){const te=F.get(Z),le=te.hidden||!te.crossTileID||m.allowVerticalPlacement&&!te.placedOrientation?null:f[te.crossTileID];if(le){const fe=new v.Point(te.anchorX,te.anchorY),J=bi(fe,d?S:w,O),pe=Pt(_.cameraToCenterDistance,J.signedDistanceFromCamera);let ve=v.evaluateSizeForFeature(m.textSizeData,M,te)*pe/v.ONE_EM;d&&(ve*=m.tilePixelRatio/T);const{width:De,height:Ae,anchor:Ne,textOffset:ke,textBoxScale:Be}=le,at=ff(Ne,De,Ae,ke,Be,ve),yt=d?bi(fe.add(at),w,O).point:J.point.add(s?at.rotate(-_.angle):at),$e=m.allowVerticalPlacement&&te.placedOrientation===v.WritingMode.vertical?Math.PI/2:0;for(let bt=0;bt<te.numGlyphs;bt++)v.addDynamicAttributes(j,yt,$e);k&&te.associatedIconIndex>=0&&(G[te.associatedIconIndex]={shiftedAnchor:yt,angle:$e})}else q(te.numGlyphs,j)}if(k){K.clear();const Z=m.icon.placedSymbolArray;for(let te=0;te<Z.length;te++){const le=Z.get(te);if(le.hidden)q(le.numGlyphs,K);else{const fe=G[te];if(fe)for(let J=0;J<le.numGlyphs;J++)v.addDynamicAttributes(K,fe.shiftedAnchor,fe.angle);else q(le.numGlyphs,K)}}m.icon.dynamicLayoutVertexBuffer.updateData(K)}m.text.dynamicLayoutVertexBuffer.updateData(j)}function cc(m,s,d){return d.iconsInText&&s?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Ms(m,s,d,f,_,w,S,T,M,k,O,F){const j=m.context,K=j.gl,G=m.transform,Z="map"===T,te="map"===M,le="viewport"!==T&&"point"!==d.layout.get("symbol-placement"),fe=Z&&!te&&!le,J=!d.layout.get("symbol-sort-key").isConstant();let pe=!1;const ve=m.depthModeForSublayer(0,Xt.ReadOnly),De=d.layout.get("text-variable-anchor"),Ae=[];for(const Ne of f){const ke=s.getTile(Ne),Be=ke.getBucket(d);if(!Be)continue;const at=_?Be.text:Be.icon;if(!at||!at.segments.get().length||!at.hasVisibleVertices)continue;const yt=at.programConfigurations.get(d.id),$e=_||Be.sdfIcons,bt=_?Be.textSizeData:Be.iconSizeData,Ye=te||0!==G.pitch,sn=m.useProgram(cc($e,_,Be),yt),ri=v.evaluateSizeForZoom(bt,G.zoom),an=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Ne);let At,Xn,Er,ai,Li=[0,0],Cr=null;if(_)Xn=ke.glyphAtlasTexture,Er=K.LINEAR,At=ke.glyphAtlasTexture.size,Be.iconsInText&&(Li=ke.imageAtlasTexture.size,Cr=ke.imageAtlasTexture,ai=Ye||m.options.rotating||m.options.zooming||"composite"===bt.kind||"camera"===bt.kind?K.LINEAR:K.NEAREST);else{const Bi=1!==d.layout.get("icon-size").constantOr(0)||Be.iconsNeedLinear;Xn=ke.imageAtlasTexture,Er=$e||m.options.rotating||m.options.zooming||Bi||Ye?K.LINEAR:K.NEAREST,At=ke.imageAtlasTexture.size}const Vr=ae(ke,1,m.transform.zoom),Sr=Rt(Ne.posMatrix,te,Z,m.transform,Vr),Dr=Gr(Ne.posMatrix,te,Z,m.transform,Vr),Os=De&&Be.hasTextData(),mu="none"!==d.layout.get("icon-text-fit")&&Os&&Be.hasIconData();if(le){const Bi=m.style.map.terrain?(Cd,fa)=>m.style.map.terrain.getElevation(Ne,Cd,fa):null,jr="map"===d.layout.get("text-rotation-alignment");Cs(Be,Ne.posMatrix,m,_,Sr,Dr,te,k,jr,Bi)}const Ur=m.translatePosMatrix(Ne.posMatrix,ke,w,S),qi=le||_&&De||mu?gd:Sr,mn=m.translatePosMatrix(Dr,ke,w,S,!0),Gi=$e&&0!==d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1);let Ni;Ni=$e?Be.iconsInText?br(bt.kind,ri,fe,te,m,Ur,qi,mn,At,Li):na(bt.kind,ri,fe,te,m,Ur,qi,mn,_,At,!0):bl(bt.kind,ri,fe,te,m,Ur,qi,mn,_,At);const dn={program:sn,buffers:at,uniformValues:Ni,atlasTexture:Xn,atlasTextureIcon:Cr,atlasInterpolation:Er,atlasInterpolationIcon:ai,isSDF:$e,hasHalo:Gi};if(J&&Be.canOverlap){pe=!0;const Bi=at.segments.get();for(const jr of Bi)Ae.push({segments:new v.SegmentVector([jr]),sortKey:jr.sortKey,state:dn,terrainData:an})}else Ae.push({segments:at.segments,sortKey:0,state:dn,terrainData:an})}pe&&Ae.sort((Ne,ke)=>Ne.sortKey-ke.sortKey);for(const Ne of Ae){const ke=Ne.state;if(j.activeTexture.set(K.TEXTURE0),ke.atlasTexture.bind(ke.atlasInterpolation,K.CLAMP_TO_EDGE),ke.atlasTextureIcon&&(j.activeTexture.set(K.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),ke.isSDF){const Be=ke.uniformValues;ke.hasHalo&&(Be.u_is_halo=1,_d(ke.buffers,Ne.segments,d,m,ke.program,ve,O,F,Be,Ne.terrainData)),Be.u_is_halo=0}_d(ke.buffers,Ne.segments,d,m,ke.program,ve,O,F,ke.uniformValues,Ne.terrainData)}}function _d(m,s,d,f,_,w,S,T,M,k){const O=f.context;_.draw(O,O.gl.TRIANGLES,w,S,T,_n.disabled,M,k,d.id,m.layoutVertexBuffer,m.indexBuffer,s,d.paint,f.transform.zoom,m.programConfigurations.get(d.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function as(m,s,d,f,_){if(!d||!f||!f.imageAtlas)return;const w=f.imageAtlas.patternPositions;let S=w[d.to.toString()],T=w[d.from.toString()];if(!S||!T){const M=_.getPaintProperty(s);S=w[M],T=w[M]}S&&T&&m.setConstantPatternPositions(S,T)}function uc(m,s,d,f,_,w,S){const T=m.context.gl,M="fill-pattern",k=d.paint.get(M),O=k&&k.constantOr(1),F=d.getCrossfadeParameters();let j,K,G,Z,te;S?(K=O&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=T.LINES):(K=O?"fillPattern":"fill",j=T.TRIANGLES);const le=k.constantOr(null);for(const fe of f){const J=s.getTile(fe);if(O&&!J.patternsLoaded())continue;const pe=J.getBucket(d);if(!pe)continue;const ve=pe.programConfigurations.get(d.id),De=m.useProgram(K,ve),Ae=m.style.map.terrain&&m.style.map.terrain.getTerrainData(fe);O&&(m.context.activeTexture.set(T.TEXTURE0),J.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ve.updatePaintBuffers(F)),as(ve,M,le,J,d);const Ne=Ae?fe:null,ke=m.translatePosMatrix(Ne?Ne.posMatrix:fe.posMatrix,J,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(S){Z=pe.indexBuffer2,te=pe.segments2;const Be=[T.drawingBufferWidth,T.drawingBufferHeight];G="fillOutlinePattern"===K&&O?Ei(ke,m,F,J,Be):Yc(ke,Be)}else Z=pe.indexBuffer,te=pe.segments,G=O?wn(ke,m,F,J):Th(ke);De.draw(m.context,j,_,m.stencilModeForClipping(fe),w,_n.disabled,G,Ae,d.id,pe.layoutVertexBuffer,Z,te,d.paint,m.transform.zoom,ve)}}function Me(m,s,d,f,_,w,S){const T=m.context,M=T.gl,k="fill-extrusion-pattern",O=d.paint.get(k),F=O.constantOr(1),j=d.getCrossfadeParameters(),K=d.paint.get("fill-extrusion-opacity"),G=O.constantOr(null);for(const Z of f){const te=s.getTile(Z),le=te.getBucket(d);if(!le)continue;const fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Z),J=le.programConfigurations.get(d.id),pe=m.useProgram(F?"fillExtrusionPattern":"fillExtrusion",J);F&&(m.context.activeTexture.set(M.TEXTURE0),te.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),J.updatePaintBuffers(j)),as(J,k,G,te,d);const ve=m.translatePosMatrix(Z.posMatrix,te,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),De=d.paint.get("fill-extrusion-vertical-gradient"),Ae=F?Xc(ve,m,De,K,Z,j,te):ir(ve,m,De,K);pe.draw(T,T.gl.TRIANGLES,_,w,S,_n.backCCW,Ae,fe,d.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,d.paint,m.transform.zoom,J,m.style.map.terrain&&le.centroidVertexBuffer)}}function Oh(m,s,d,f,_,w,S){const T=m.context,M=T.gl,k=d.fbo;if(!k)return;const O=m.useProgram("hillshade"),F=m.style.map.terrain&&m.style.map.terrain.getTerrainData(s);T.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,k.colorAttachment.get()),O.draw(T,M.TRIANGLES,_,w,S,_n.disabled,((j,K,G,Z)=>{const te=G.paint.get("hillshade-shadow-color"),le=G.paint.get("hillshade-highlight-color"),fe=G.paint.get("hillshade-accent-color");let J=G.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===G.paint.get("hillshade-illumination-anchor")&&(J-=j.transform.angle);const pe=!j.options.moving;return{u_matrix:Z?Z.posMatrix:j.transform.calculatePosMatrix(K.tileID.toUnwrapped(),pe),u_image:0,u_latrange:Jc(0,K.tileID),u_light:[G.paint.get("hillshade-exaggeration"),J],u_shadow:te,u_highlight:le,u_accent:fe}})(m,d,f,F?s:null),F,f.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function Qe(m,s,d,f,_,w){const S=m.context,T=S.gl,M=s.dem;if(M&&M.data){const k=M.dim,O=M.stride,F=M.getPixels();if(S.activeTexture.set(T.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(O),s.demTexture){const K=s.demTexture;K.update(F,{premultiply:!1}),K.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else s.demTexture=new ht(S,F,T.RGBA,{premultiply:!1}),s.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);S.activeTexture.set(T.TEXTURE0);let j=s.fbo;if(!j){const K=new ht(S,{width:k,height:k,data:null},T.RGBA);K.bind(T.LINEAR,T.CLAMP_TO_EDGE),j=s.fbo=S.createFramebuffer(k,k,!0,!1),j.colorAttachment.set(K.texture)}S.bindFramebuffer.set(j.framebuffer),S.viewport.set([0,0,k,k]),m.useProgram("hillshadePrepare").draw(S,T.TRIANGLES,f,_,w,_n.disabled,((K,G)=>{const Z=G.stride,te=v.create();return v.ortho(te,0,v.EXTENT,-v.EXTENT,0,0,1),v.translate(te,te,[0,-v.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[Z,Z],u_zoom:K.overscaledZ,u_unpack:G.getUnpackVector()}})(s.tileID,M),null,d.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Kn(m,s,d,f,_,w){const S=f.paint.get("raster-fade-duration");if(!w&&S>0){const T=v.exported.now(),M=(T-m.timeAdded)/S,k=s?(T-s.timeAdded)/S:-1,O=d.getSource(),F=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),j=!s||Math.abs(s.tileID.overscaledZ-F)>Math.abs(m.tileID.overscaledZ-F),K=j&&m.refreshedUponExpiration?1:v.clamp(j?M:1-k,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}const Ts=new v.Color(1,0,0,1),xr=new v.Color(0,1,0,1),Lh=new v.Color(0,0,1,1),yd=new v.Color(1,0,1,1),Nh=new v.Color(0,1,1,1);function Br(m,s,d,f){rr(m,0,s+d/2,m.transform.width,d,f)}function oa(m,s,d,f){rr(m,s-d/2,0,d,m.transform.height,f)}function rr(m,s,d,f,_,w){const S=m.context,T=S.gl;T.enable(T.SCISSOR_TEST),T.scissor(s*m.pixelRatio,d*m.pixelRatio,f*m.pixelRatio,_*m.pixelRatio),S.clear({color:w}),T.disable(T.SCISSOR_TEST)}function Uo(m,s,d){const f=m.context,_=f.gl,w=d.posMatrix,S=m.useProgram("debug"),T=Xt.disabled,M=jn.disabled,k=m.colorModeForRenderPass(),O="$debug",F=m.style.map.terrain&&m.style.map.terrain.getTerrainData(d);f.activeTexture.set(_.TEXTURE0);const j=s.getTileByID(d.key).latestRawTileData,K=Math.floor((j&&j.byteLength||0)/1024),G=s.getTile(d).tileSize,Z=512/Math.min(G,512)*(d.overscaledZ/m.transform.zoom)*.5;let te=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(te+=` => ${d.overscaledZ}`),function(le,fe){le.initDebugOverlayCanvas();const J=le.debugOverlayCanvas,pe=le.context.gl,ve=le.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,J.width,J.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(fe,5,5),ve.strokeText(fe,5,5),le.debugOverlayTexture.update(J),le.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(m,`${te} ${K}kB`),S.draw(f,_.TRIANGLES,T,M,ti.alphaBlended,_n.disabled,Mn(w,v.Color.transparent,Z),null,O,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),S.draw(f,_.LINE_STRIP,T,M,k,_n.disabled,Mn(w,v.Color.red),F,O,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function cn(m,s,d){const f=m.context,_=f.gl,w=m.colorModeForRenderPass(),S=new Xt(_.LEQUAL,Xt.ReadWrite,m.depthRangeFor3D),T=m.useProgram("terrain"),M=s.getTerrainMesh();f.bindFramebuffer.set(null),f.viewport.set([0,0,m.width,m.height]);for(const k of d){const O=m.renderToTexture.getTexture(k),F=s.getTerrainData(k.tileID);f.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,O.texture);const j={u_matrix:m.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(m.transform.zoom)};T.draw(f,_.TRIANGLES,S,jn.disabled,w,_n.backCCW,j,F,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}}const Cl={symbol:function(m,s,d,f,_){if("translucent"!==m.renderPass)return;const w=jn.disabled,S=m.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(T,M,k,O,F,j,K){const G=M.transform,Z="map"===F,te="map"===j;for(const le of T){const fe=O.getTile(le),J=fe.getBucket(k);if(!J||!J.text||!J.text.segments.get().length)continue;const pe=v.evaluateSizeForZoom(J.textSizeData,G.zoom),ve=ae(fe,1,M.transform.zoom),De=Rt(le.posMatrix,te,Z,M.transform,ve),Ae="none"!==k.layout.get("icon-text-fit")&&J.hasIconData();if(pe){const Ne=Math.pow(2,G.zoom-fe.tileID.overscaledZ);Fh(J,Z,te,K,G,De,le.posMatrix,Ne,pe,Ae,M.style.map.terrain?(ke,Be)=>M.style.map.terrain.getElevation(le,ke,Be):null)}}}(f,m,d,s,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),_),0!==d.paint.get("icon-opacity").constantOr(1)&&Ms(m,s,d,f,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),w,S),0!==d.paint.get("text-opacity").constantOr(1)&&Ms(m,s,d,f,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(lc(m,s,d,f,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),lc(m,s,d,f,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,d,f){if("translucent"!==m.renderPass)return;const _=d.paint.get("circle-opacity"),w=d.paint.get("circle-stroke-width"),S=d.paint.get("circle-stroke-opacity"),T=!d.layout.get("circle-sort-key").isConstant();if(0===_.constantOr(1)&&(0===w.constantOr(1)||0===S.constantOr(1)))return;const M=m.context,k=M.gl,O=m.depthModeForSublayer(0,Xt.ReadOnly),F=jn.disabled,j=m.colorModeForRenderPass(),K=[];for(let G=0;G<f.length;G++){const Z=f[G],te=s.getTile(Z),le=te.getBucket(d);if(!le)continue;const fe=le.programConfigurations.get(d.id),J=m.useProgram("circle",fe),pe=le.layoutVertexBuffer,ve=le.indexBuffer,De=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Z),Ae={programConfiguration:fe,program:J,layoutVertexBuffer:pe,indexBuffer:ve,uniformValues:sd(m,Z,te,d),terrainData:De};if(T){const Ne=le.segments.get();for(const ke of Ne)K.push({segments:new v.SegmentVector([ke]),sortKey:ke.sortKey,state:Ae})}else K.push({segments:le.segments,sortKey:0,state:Ae})}T&&K.sort((G,Z)=>G.sortKey-Z.sortKey);for(const G of K){const{programConfiguration:Z,program:te,layoutVertexBuffer:le,indexBuffer:fe,uniformValues:J,terrainData:pe}=G.state;te.draw(M,k.TRIANGLES,O,F,j,_n.disabled,J,pe,d.id,le,fe,G.segments,d.paint,m.transform.zoom,Z)}},heatmap:function(m,s,d,f){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const _=m.context,w=_.gl,S=jn.disabled,T=new ti([w.ONE,w.ONE],v.Color.transparent,[!0,!0,!0,!0]);(function(M,k,O){const F=M.gl;M.activeTexture.set(F.TEXTURE1),M.viewport.set([0,0,k.width/4,k.height/4]);let j=O.heatmapFbo;if(j)F.bindTexture(F.TEXTURE_2D,j.colorAttachment.get()),M.bindFramebuffer.set(j.framebuffer);else{const K=F.createTexture();F.bindTexture(F.TEXTURE_2D,K),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.LINEAR),j=O.heatmapFbo=M.createFramebuffer(k.width/4,k.height/4,!1,!1),function(G,Z,te,le){var fe,J;const pe=G.gl,ve=null!==(fe=G.HALF_FLOAT)&&void 0!==fe?fe:pe.UNSIGNED_BYTE,De=null!==(J=G.RGBA16F)&&void 0!==J?J:pe.RGBA;pe.texImage2D(pe.TEXTURE_2D,0,De,Z.width/4,Z.height/4,0,pe.RGBA,ve,null),le.colorAttachment.set(te)}(M,k,K,j)}})(_,m,d),_.clear({color:v.Color.transparent});for(let M=0;M<f.length;M++){const k=f[M];if(s.hasRenderableParent(k))continue;const O=s.getTile(k),F=O.getBucket(d);if(!F)continue;const j=F.programConfigurations.get(d.id),K=m.useProgram("heatmap",j),{zoom:G}=m.transform;K.draw(_,w.TRIANGLES,Xt.disabled,S,T,_n.disabled,Qc(k.posMatrix,O,G,d.paint.get("heatmap-intensity")),null,d.id,F.layoutVertexBuffer,F.indexBuffer,F.segments,d.paint,m.transform.zoom,j)}_.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(_,w){const S=_.context,T=S.gl,M=w.heatmapFbo;if(!M)return;S.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,M.colorAttachment.get()),S.activeTexture.set(T.TEXTURE1);let k=w.colorRampTexture;k||(k=w.colorRampTexture=new ht(S,w.colorRamp,T.RGBA)),k.bind(T.LINEAR,T.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(S,T.TRIANGLES,Xt.disabled,jn.disabled,_.colorModeForRenderPass(),_n.disabled,((O,F,j,K)=>{const G=v.create();v.ortho(G,0,O.width,O.height,0,0,1);const Z=O.context.gl;return{u_matrix:G,u_world:[Z.drawingBufferWidth,Z.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:F.paint.get("heatmap-opacity")}})(_,w),null,w.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,w.paint,_.transform.zoom)}(m,d))},line:function(m,s,d,f){if("translucent"!==m.renderPass)return;const _=d.paint.get("line-opacity"),w=d.paint.get("line-width");if(0===_.constantOr(1)||0===w.constantOr(1))return;const S=m.depthModeForSublayer(0,Xt.ReadOnly),T=m.colorModeForRenderPass(),M=d.paint.get("line-dasharray"),k=d.paint.get("line-pattern"),O=k.constantOr(1),F=d.paint.get("line-gradient"),j=d.getCrossfadeParameters(),K=O?"linePattern":M?"lineSDF":F?"lineGradient":"line",G=m.context,Z=G.gl;let te=!0;for(const le of f){const fe=s.getTile(le);if(O&&!fe.patternsLoaded())continue;const J=fe.getBucket(d);if(!J)continue;const pe=J.programConfigurations.get(d.id),ve=m.context.program.get(),De=m.useProgram(K,pe),Ae=te||De.program!==ve,Ne=m.style.map.terrain&&m.style.map.terrain.getTerrainData(le),ke=k.constantOr(null);if(ke&&fe.imageAtlas){const yt=fe.imageAtlas,$e=yt.patternPositions[ke.to.toString()],bt=yt.patternPositions[ke.from.toString()];$e&&bt&&pe.setConstantPatternPositions($e,bt)}const Be=Ne?le:null,at=O?be(m,fe,d,j,Be):M?Ua(m,fe,d,M,j,Be):F?oc(m,fe,d,J.lineClipsArray.length,Be):ta(m,fe,d,Be);if(O)G.activeTexture.set(Z.TEXTURE0),fe.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),pe.updatePaintBuffers(j);else if(M&&(Ae||m.lineAtlas.dirty))G.activeTexture.set(Z.TEXTURE0),m.lineAtlas.bind(G);else if(F){const yt=J.gradients[d.id];let $e=yt.texture;if(d.gradientVersion!==yt.version){let bt=256;if(d.stepInterpolant){const Ye=s.getSource().maxzoom,sn=le.canonical.z===Ye?Math.ceil(1<<m.transform.maxZoom-le.canonical.z):1;bt=v.clamp(v.nextPowerOfTwo(J.maxLineLength/v.EXTENT*1024*sn),256,G.maxTextureSize)}yt.gradient=v.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:bt,image:yt.gradient||void 0,clips:J.lineClipsArray}),yt.texture?yt.texture.update(yt.gradient):yt.texture=new ht(G,yt.gradient,Z.RGBA),yt.version=d.gradientVersion,$e=yt.texture}G.activeTexture.set(Z.TEXTURE0),$e.bind(d.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}De.draw(G,Z.TRIANGLES,S,m.stencilModeForClipping(le),T,_n.disabled,at,Ne,d.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,d.paint,m.transform.zoom,pe,J.layoutVertexBuffer2),te=!1}},fill:function(m,s,d,f){const _=d.paint.get("fill-color"),w=d.paint.get("fill-opacity");if(0===w.constantOr(1))return;const S=m.colorModeForRenderPass(),T=d.paint.get("fill-pattern"),M=m.opaquePassEnabledForLayer()&&!T.constantOr(1)&&1===_.constantOr(v.Color.transparent).a&&1===w.constantOr(0)?"opaque":"translucent";if(m.renderPass===M){const k=m.depthModeForSublayer(1,"opaque"===m.renderPass?Xt.ReadWrite:Xt.ReadOnly);uc(m,s,d,f,k,S,!1)}if("translucent"===m.renderPass&&d.paint.get("fill-antialias")){const k=m.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,Xt.ReadOnly);uc(m,s,d,f,k,S,!0)}},"fill-extrusion":function(m,s,d,f){const _=d.paint.get("fill-extrusion-opacity");if(0!==_&&"translucent"===m.renderPass){const w=new Xt(m.context.gl.LEQUAL,Xt.ReadWrite,m.depthRangeFor3D);if(1!==_||d.paint.get("fill-extrusion-pattern").constantOr(1))Me(m,s,d,f,w,jn.disabled,ti.disabled),Me(m,s,d,f,w,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const S=m.colorModeForRenderPass();Me(m,s,d,f,w,jn.disabled,S)}}},hillshade:function(m,s,d,f){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const _=m.context,w=m.depthModeForSublayer(0,Xt.ReadOnly),S=m.colorModeForRenderPass(),[T,M]="translucent"===m.renderPass?m.stencilConfigForOverlap(f):[{},f];for(const k of M){const O=s.getTile(k);void 0!==O.needsHillshadePrepare&&O.needsHillshadePrepare&&"offscreen"===m.renderPass?Qe(m,O,d,w,jn.disabled,S):"translucent"===m.renderPass&&Oh(m,k,O,d,w,T[k.overscaledZ],S)}_.viewport.set([0,0,m.width,m.height])},raster:function(m,s,d,f){if("translucent"!==m.renderPass||0===d.paint.get("raster-opacity")||!f.length)return;const _=m.context,w=_.gl,S=s.getSource(),T=m.useProgram("raster"),M=m.colorModeForRenderPass(),[k,O]=S instanceof qr?[{},f]:m.stencilConfigForOverlap(f),F=O[O.length-1].overscaledZ,j=!m.options.moving;for(const K of O){const G=m.depthModeForSublayer(K.overscaledZ-F,1===d.paint.get("raster-opacity")?Xt.ReadWrite:Xt.ReadOnly,w.LESS),Z=s.getTile(K);Z.registerFadeDuration(d.paint.get("raster-fade-duration"));const te=s.findLoadedParent(K,0),le=Kn(Z,te,s,d,m.transform,m.style.map.terrain);let fe,J;const pe="nearest"===d.paint.get("raster-resampling")?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),Z.texture.bind(pe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),te?(te.texture.bind(pe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),fe=Math.pow(2,te.tileID.overscaledZ-Z.tileID.overscaledZ),J=[Z.tileID.canonical.x*fe%1,Z.tileID.canonical.y*fe%1]):Z.texture.bind(pe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);const ve=m.style.map.terrain&&m.style.map.terrain.getTerrainData(K),De=ve?K:null,Ae=De?De.posMatrix:m.transform.calculatePosMatrix(K.toUnwrapped(),j),Ne=eu(Ae,J||[0,0],fe||1,le,d);S instanceof qr?T.draw(_,w.TRIANGLES,G,jn.disabled,M,_n.disabled,Ne,ve,d.id,S.boundsBuffer,m.quadTriangleIndexBuffer,S.boundsSegments):T.draw(_,w.TRIANGLES,G,k[K.overscaledZ],M,_n.disabled,Ne,ve,d.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}},background:function(m,s,d,f){const _=d.paint.get("background-color"),w=d.paint.get("background-opacity");if(0===w)return;const S=m.context,T=S.gl,M=m.transform,k=M.tileSize,O=d.paint.get("background-pattern");if(m.isPatternMissing(O))return;const F=!O&&1===_.a&&1===w&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==F)return;const j=jn.disabled,K=m.depthModeForSublayer(0,"opaque"===F?Xt.ReadWrite:Xt.ReadOnly),G=m.colorModeForRenderPass(),Z=m.useProgram(O?"backgroundPattern":"background"),te=f||M.coveringTiles({tileSize:k,terrain:m.style.map.terrain});O&&(S.activeTexture.set(T.TEXTURE0),m.imageManager.bind(m.context));const le=d.getCrossfadeParameters();for(const fe of te){const J=f?fe.posMatrix:m.transform.calculatePosMatrix(fe.toUnwrapped()),pe=O?io(J,w,m,O,{tileID:fe,tileSize:k},le):xo(J,w,_),ve=m.style.map.terrain&&m.style.map.terrain.getTerrainData(fe);Z.draw(S,T.TRIANGLES,K,j,G,_n.disabled,pe,ve,d.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}},debug:function(m,s,d){for(let f=0;f<d.length;f++)Uo(m,s,d[f])},custom:function(m,s,d){const f=m.context,_=d.implementation;if("offscreen"===m.renderPass){const w=_.prerender;w&&(m.setCustomLayerDefaults(),f.setColorMode(m.colorModeForRenderPass()),w.call(_,f.gl,m.transform.customLayerMatrix()),f.setDirty(),m.setBaseState())}else if("translucent"===m.renderPass){m.setCustomLayerDefaults(),f.setColorMode(m.colorModeForRenderPass()),f.setStencilMode(jn.disabled);const w="3d"===_.renderingMode?new Xt(m.context.gl.LEQUAL,Xt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Xt.ReadOnly);f.setDepthMode(w),_.render(f.gl,m.transform.customLayerMatrix()),f.setDirty(),m.setBaseState(),f.bindFramebuffer.set(null)}}};class lu{constructor(s,d){this.context=new Ph(s),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:v.create(),renderTime:0},this.setup(),this.numSublayers=vi.maxUnderzooming+vi.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ds}resize(s,d,f){if(this.width=s*f,this.height=d*f,this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const s=this.context,d=new v.PosArray;d.emplaceBack(0,0),d.emplaceBack(v.EXTENT,0),d.emplaceBack(0,v.EXTENT),d.emplaceBack(v.EXTENT,v.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(d,od.members),this.tileExtentSegments=v.SegmentVector.simpleSegment(0,0,4,2);const f=new v.PosArray;f.emplaceBack(0,0),f.emplaceBack(v.EXTENT,0),f.emplaceBack(0,v.EXTENT),f.emplaceBack(v.EXTENT,v.EXTENT),this.debugBuffer=s.createVertexBuffer(f,od.members),this.debugSegments=v.SegmentVector.simpleSegment(0,0,4,5);const _=new v.RasterBoundsArray;_.emplaceBack(0,0,0,0),_.emplaceBack(v.EXTENT,0,v.EXTENT,0),_.emplaceBack(0,v.EXTENT,0,v.EXTENT),_.emplaceBack(v.EXTENT,v.EXTENT,v.EXTENT,v.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(_,wt.members),this.rasterBoundsSegments=v.SegmentVector.simpleSegment(0,0,4,2);const w=new v.PosArray;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(w,od.members),this.viewportSegments=v.SegmentVector.simpleSegment(0,0,4,2);const S=new v.LineStripIndexArray;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(S);const T=new v.TriangleIndexArray;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(T);const M=this.context.gl;this.stencilClearMode=new jn({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO)}clearStencil(){const s=this.context,d=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=v.create();v.ortho(f,0,this.width,this.height,0,0,1),v.scale(f,f,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,d.TRIANGLES,Xt.disabled,this.stencilClearMode,ti.disabled,_n.disabled,Mt(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,d){if(this.currentStencilSource===s.source||!s.isTileClipped()||!d||!d.length)return;this.currentStencilSource=s.source;const f=this.context,_=f.gl;this.nextStencilID+d.length>256&&this.clearStencil(),f.setColorMode(ti.disabled),f.setDepthMode(Xt.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of d){const T=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S);w.draw(f,_.TRIANGLES,Xt.disabled,new jn({func:_.ALWAYS,mask:0},T,255,_.KEEP,_.KEEP,_.REPLACE),ti.disabled,_n.disabled,Mt(S.posMatrix),M,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,d=this.context.gl;return new jn({func:d.NOTEQUAL,mask:255},s,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(s){const d=this.context.gl;return new jn({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(s){const d=this.context.gl,f=s.sort((S,T)=>T.overscaledZ-S.overscaledZ),_=f[f.length-1].overscaledZ,w=f[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let T=0;T<w;T++)S[T+_]=new jn({func:d.GEQUAL,mask:255},T+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=w,[S,f]}return[{[_]:jn.disabled},f]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new ti([s.CONSTANT_COLOR,s.ONE],new v.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ti.unblended:ti.alphaBlended}depthModeForSublayer(s,d,f){if(!this.opaquePassEnabledForLayer())return Xt.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Xt(f||this.context.gl.LEQUAL,d,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,d){this.style=s,this.options=d,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(v.exported.now()),this.imageManager.beginFrame();const f=this.style._order,_=this.style.sourceCaches,w={},S={},T={};for(const M in _){const k=_[M];k.used&&k.prepare(this.context),w[M]=k.getVisibleCoordinates(),S[M]=w[M].slice().reverse(),T[M]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<f.length;M++)if(this.style._layers[f[M]].is3D()){this.opaquePassCutoff=M;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const M=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!v.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(v.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(k,O){const F=k.context,j=F.gl,K=ti.unblended,G=new Xt(j.LEQUAL,Xt.ReadWrite,[0,1]),Z=O.getTerrainMesh(),te=O.sourceCache.getRenderableTiles(),le=k.useProgram("terrainDepth");F.bindFramebuffer.set(O.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:v.Color.transparent,depth:1});for(const fe of te){const J=O.getTerrainData(fe.tileID),pe={u_matrix:k.transform.calculatePosMatrix(fe.tileID.toUnwrapped()),u_ele_delta:O.getMeshFrameDelta(k.transform.zoom)};le.draw(F,j.TRIANGLES,G,jn.disabled,K,_n.backCCW,pe,J,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain),function(k,O){const F=k.context,j=F.gl,K=ti.unblended,G=new Xt(j.LEQUAL,Xt.ReadWrite,[0,1]),Z=O.getTerrainMesh(),te=O.getCoordsTexture(),le=O.sourceCache.getRenderableTiles(),fe=k.useProgram("terrainCoords");F.bindFramebuffer.set(O.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:v.Color.transparent,depth:1}),O.coordsIndex=[];for(const J of le){const pe=O.getTerrainData(J.tileID);F.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,te.texture);const ve={u_matrix:k.transform.calculatePosMatrix(J.tileID.toUnwrapped()),u_terrain_coords_id:(255-O.coordsIndex.length)/255,u_texture:0,u_ele_delta:O.getMeshFrameDelta(k.transform.zoom)};fe.draw(F,j.TRIANGLES,G,jn.disabled,K,_n.backCCW,ve,pe,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments),O.coordsIndex.push(J.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const M of f){const k=this.style._layers[M];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const O=S[k.source];("custom"===k.type||O.length)&&this.renderLayer(this,_[k.source],k,O)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?v.Color.black:v.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[f[this.currentLayer]],k=_[M.source],O=w[M.source];this._renderTileClippingMasks(M,O),this.renderLayer(this,k,M,O)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const M=this.style._layers[f[this.currentLayer]],k=_[M.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(M))continue;const O=("symbol"===M.type?T:S)[M.source];this._renderTileClippingMasks(M,w[M.source]),this.renderLayer(this,k,M,O)}if(this.options.showTileBoundaries){const M=function(k,O){let F=null;const j=Object.values(k._layers).flatMap(te=>te.source&&!te.isHidden(O)?[k.sourceCaches[te.source]]:[]),K=j.filter(te=>"vector"===te.getSource().type),G=j.filter(te=>"vector"!==te.getSource().type),Z=te=>{(!F||F.getSource().maxzoom<te.getSource().maxzoom)&&(F=te)};return K.forEach(te=>Z(te)),F||G.forEach(te=>Z(te)),F}(this.style,this.transform.zoom);M&&Cl.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const k=M.transform.padding;Br(M,M.transform.height-(k.top||0),3,Ts),Br(M,k.bottom||0,3,xr),oa(M,k.left||0,3,Lh),oa(M,M.transform.width-(k.right||0),3,yd);const O=M.transform.centerPoint;var F,j,K,G;rr(F=M,(j=O.x)-1,(K=M.transform.height-O.y)-10,2,20,G=Nh),rr(F,j-10,K-1,20,2,G)}(this),this.context.setDefault()}renderLayer(s,d,f,_){f.isHidden(this.transform.zoom)||("background"===f.type||"custom"===f.type||(_||[]).length)&&(this.id=f.id,Cl[f.type](s,d,f,_,this.style.placement.variableOffsets))}translatePosMatrix(s,d,f,_,w){if(!f[0]&&!f[1])return s;const S=w?"map"===_?this.transform.angle:0:"viewport"===_?-this.transform.angle:0;if(S){const k=Math.sin(S),O=Math.cos(S);f=[f[0]*O-f[1]*k,f[0]*k+f[1]*O]}const T=[w?f[0]:ae(d,f[0],this.transform.zoom),w?f[1]:ae(d,f[1],this.transform.zoom),0],M=new Float32Array(16);return v.translate(M,s,T),M}saveTileTexture(s){const d=this._tileTextures[s.size[0]];d?d.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const d=this._tileTextures[s];return d&&d.length>0?d.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const d=this.imageManager.getPattern(s.from.toString()),f=this.imageManager.getPattern(s.to.toString());return!d||!f}useProgram(s,d){this.cache=this.cache||{};const f=s+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new vl(this.context,s,ei[s],d,Ah[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ht(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Sl{constructor(s,d){this.points=s,this.planes=d}static fromInvProjectionMatrix(s,d,f){const _=Math.pow(2,f),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const M=1/(T=v.transformMat4([],T,s))[3]/d*_;return v.mul$1(T,T,[M,M,1/T[3],M])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const M=function(j,K){var G=K[0],Z=K[1],te=K[2],le=G*G+Z*Z+te*te;return le>0&&(le=1/Math.sqrt(le)),j[0]=K[0]*le,j[1]=K[1]*le,j[2]=K[2]*le,j}([],(j=[],K=ze([],w[T[0]],w[T[1]]),G=ze([],w[T[2]],w[T[1]]),Z=K[0],fe=G[0],j[0]=(te=K[1])*(pe=G[2])-(le=K[2])*(J=G[1]),j[1]=le*fe-Z*pe,j[2]=Z*J-te*fe,j)),k=-((O=M)[0]*(F=w[T[1]])[0]+O[1]*F[1]+O[2]*F[2]);var j,K,G,Z,te,le,fe,J,pe,O,F;return M.concat(k)});return new Sl(w,S)}}class jo{constructor(s,d){var f,_,w;this.min=s,this.max=d,this.center=function(f,_,w){return f[0]=.5*_[0],f[1]=.5*_[1],f[2]=.5*_[2],f}([],((f=[])[0]=(_=this.min)[0]+(w=this.max)[0],f[1]=_[1]+w[1],f[2]=_[2]+w[2],f))}quadrant(s){const d=[s%2==0,s<2],f=Lo(this.min),_=Lo(this.max);for(let w=0;w<d.length;w++)f[w]=d[w]?this.min[w]:this.center[w],_[w]=d[w]?this.center[w]:this.max[w];return _[2]=this.max[2],new jo(f,_)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let _=0;_<s.planes.length;_++){const w=s.planes[_];let S=0;for(let T=0;T<d.length;T++)v.dot(w,d[T])>=0&&S++;if(0===S)return 0;S!==d.length&&(f=!1)}if(f)return 2;for(let _=0;_<3;_++){let w=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let T=0;T<s.points.length;T++){const M=s.points[T][_]-this.min[_];w=Math.min(w,M),S=Math.max(S,M)}if(S<0||w>this.max[_]-this.min[_])return 0}return 1}}class wo{constructor(s=0,d=0,f=0,_=0){if(isNaN(s)||s<0||isNaN(d)||d<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=d,this.left=f,this.right=_}interpolate(s,d,f){return null!=d.top&&null!=s.top&&(this.top=v.interpolate.number(s.top,d.top,f)),null!=d.bottom&&null!=s.bottom&&(this.bottom=v.interpolate.number(s.bottom,d.bottom,f)),null!=d.left&&null!=s.left&&(this.left=v.interpolate.number(s.left,d.left,f)),null!=d.right&&null!=s.right&&(this.right=v.interpolate.number(s.right,d.right,f)),this}getCenter(s,d){const f=v.clamp((this.left+s-this.right)/2,0,s),_=v.clamp((this.top+d-this.bottom)/2,0,d);return new v.Point(f,_)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new wo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class sa{constructor(s,d,f,_,w){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===w||!!w,this._minZoom=s||0,this._maxZoom=d||22,this._minPitch=f??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new v.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wo,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const s=new sa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){void 0===s?s=!0:null===s&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new v.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const d=-v.wrap(s,-180,180)*Math.PI/180;var f;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(f=new v.ARRAY_TYPE(4),v.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(f,_,w){var S=_[0],T=_[1],M=_[2],k=_[3],O=Math.sin(w),F=Math.cos(w);f[0]=S*F+M*O,f[1]=T*F+k*O,f[2]=S*-O+M*F,f[3]=T*-O+k*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const d=v.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const d=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,d,f){this._unmodified=!1,this._edgeInsets.interpolate(s,d,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const d=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(s){const d=[new v.UnwrappedTileID(0,s)];if(this._renderWorldCopies){const f=this.pointCoordinate(new v.Point(0,0)),_=this.pointCoordinate(new v.Point(this.width,0)),w=this.pointCoordinate(new v.Point(this.width,this.height)),S=this.pointCoordinate(new v.Point(0,this.height)),T=Math.floor(Math.min(f.x,_.x,w.x,S.x)),M=Math.floor(Math.max(f.x,_.x,w.x,S.x)),k=1;for(let O=T-k;O<=M+k;O++)0!==O&&d.push(new v.UnwrappedTileID(O,s))}return d}coveringTiles(s){var d,f;let _=this.coveringZoomLevel(s);const w=_;if(void 0!==s.minzoom&&_<s.minzoom)return[];void 0!==s.maxzoom&&_>s.maxzoom&&(_=s.maxzoom);const S=this.pointCoordinate(this.getCameraPoint()),T=v.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,_),k=[M*S.x,M*S.y,0],O=[M*T.x,M*T.y,0],F=Sl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let j=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(j=_);const K=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,G=J=>({aabb:new jo([J*M,0,0],[(J+1)*M,M,0]),zoom:0,x:0,y:0,wrap:J,fullyVisible:!1}),Z=[],te=[],le=_,fe=s.reparseOverscaled?w:_;if(this._renderWorldCopies)for(let J=1;J<=3;J++)Z.push(G(-J)),Z.push(G(J));for(Z.push(G(0));Z.length>0;){const J=Z.pop(),pe=J.x,ve=J.y;let De=J.fullyVisible;if(!De){const at=J.aabb.intersects(F);if(0===at)continue;De=2===at}const Ae=s.terrain?k:O,Ne=J.aabb.distanceX(Ae),ke=J.aabb.distanceY(Ae),Be=Math.max(Math.abs(Ne),Math.abs(ke));if(J.zoom===le||Be>K+(1<<le-J.zoom)-2&&J.zoom>=j){const at=le-J.zoom,yt=k[0]-.5-(pe<<at),$e=k[1]-.5-(ve<<at);te.push({tileID:new v.OverscaledTileID(J.zoom===le?fe:J.zoom,J.wrap,J.zoom,pe,ve),distanceSq:We([O[0]-.5-pe,O[1]-.5-ve]),tileDistanceToCamera:Math.sqrt(yt*yt+$e*$e)})}else for(let at=0;at<4;at++){const yt=(pe<<1)+at%2,$e=(ve<<1)+(at>>1),bt=J.zoom+1;let Ye=J.aabb.quadrant(at);if(s.terrain){const sn=new v.OverscaledTileID(bt,J.wrap,bt,yt,$e),ri=s.terrain.getMinMaxElevation(sn),an=null!==(d=ri.minElevation)&&void 0!==d?d:this.elevation,At=null!==(f=ri.maxElevation)&&void 0!==f?f:this.elevation;Ye=new jo([Ye.min[0],Ye.min[1],an],[Ye.max[0],Ye.max[1],At])}Z.push({aabb:Ye,zoom:bt,x:yt,y:$e,wrap:J.wrap,fullyVisible:De})}}return te.sort((J,pe)=>J.distanceSq-pe.distanceSq).map(J=>J.tileID)}resize(s,d){this.width=s,this.height=d,this.pixelsToGLUnits=[2/s,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const d=v.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new v.Point(v.mercatorXfromLng(s.lng)*this.worldSize,v.mercatorYfromLat(d)*this.worldSize)}unproject(s){return new v.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(s){this.freezeElevation||(this.elevation=s?this.getElevation(this._center,s):0)}getElevation(s,d){const f=v.MercatorCoordinate.fromLngLat(s.wrap()),_=(1<<this.tileZoom)*v.EXTENT,w=f.x*_,S=f.y*_,T=Math.floor(w/v.EXTENT),M=Math.floor(S/v.EXTENT),k=new v.OverscaledTileID(this.tileZoom,0,this.tileZoom,T,M);return d.getElevation(k,w%v.EXTENT,S%v.EXTENT,v.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const d=this.pointLocation(this.centerPoint,s),f=this.getElevation(d,s);if(!(this.elevation-f))return;const _=this.getCameraPosition(),w=v.MercatorCoordinate.fromLngLat(_.lngLat,_.altitude),S=v.MercatorCoordinate.fromLngLat(d,f),T=w.x-S.x,M=w.y-S.y,k=w.z-S.z,O=Math.sqrt(T*T+M*M+k*k),F=this.scaleZoom(this.cameraToCenterDistance/O/this.tileSize);this._elevation=f,this._center=d,this.zoom=F}setLocationAtPoint(s,d){const f=this.pointCoordinate(d),_=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(s),S=new v.MercatorCoordinate(w.x-(f.x-_.x),w.y-(f.y-_.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,d){return d?this.coordinatePoint(this.locationCoordinate(s),this.getElevation(s,d),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,d){return this.coordinateLocation(this.pointCoordinate(s,d))}locationCoordinate(s){return v.MercatorCoordinate.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,d){if(d){const j=d.pointCoordinate(s);if(null!=j)return j}const f=[s.x,s.y,0,1],_=[s.x,s.y,1,1];v.transformMat4(f,f,this.pixelMatrixInverse),v.transformMat4(_,_,this.pixelMatrixInverse);const w=f[3],S=_[3],T=f[1]/w,M=_[1]/S,k=f[2]/w,O=_[2]/S,F=k===O?0:(0-k)/(O-k);return new v.MercatorCoordinate(v.interpolate.number(f[0]/w,_[0]/S,F)/this.worldSize,v.interpolate.number(T,M,F)/this.worldSize)}coordinatePoint(s,d=0,f=this.pixelMatrix){const _=[s.x*this.worldSize,s.y*this.worldSize,d,1];return v.transformMat4(_,_,f),new v.Point(_[0]/_[3],_[1]/_[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return(new St).extend(this.pointLocation(new v.Point(0,s))).extend(this.pointLocation(new v.Point(this.width,s))).extend(this.pointLocation(new v.Point(this.width,this.height))).extend(this.pointLocation(new v.Point(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new St([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,d=!1){const f=s.key,_=d?this._alignedPosMatrixCache:this._posMatrixCache;if(_[f])return _[f];const w=s.canonical,S=this.worldSize/this.zoomScale(w.z),T=w.x+Math.pow(2,w.z)*s.wrap,M=v.identity(new Float64Array(16));return v.translate(M,M,[T*S,w.y*S,0]),v.scale(M,M,[S/v.EXTENT,S/v.EXTENT,1]),v.multiply(M,d?this.alignedProjMatrix:this.projMatrix,M),_[f]=new Float32Array(M),_[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s,d,f,_,w=-90,S=90,T=-180,M=180;const k=this.size,O=this._unmodified;if(this.latRange){const K=this.latRange;w=v.mercatorYfromLat(K[1])*this.worldSize,S=v.mercatorYfromLat(K[0])*this.worldSize,s=S-w<k.y?k.y/(S-w):0}if(this.lngRange){const K=this.lngRange;T=v.wrap(v.mercatorXfromLng(K[0])*this.worldSize,0,this.worldSize),M=v.wrap(v.mercatorXfromLng(K[1])*this.worldSize,0,this.worldSize),M<T&&(M+=this.worldSize),d=M-T<k.x?k.x/(M-T):0}const F=this.point,j=Math.max(d||0,s||0);if(j)return this.center=this.unproject(new v.Point(d?(M+T)/2:F.x,s?(S+w)/2:F.y)),this.zoom+=this.scaleZoom(j),this._unmodified=O,void(this._constraining=!1);if(this.latRange){const K=F.y,G=k.y/2;K-G<w&&(_=w+G),K+G>S&&(_=S-G)}if(this.lngRange){const K=(T+M)/2,G=v.wrap(F.x,K-this.worldSize/2,K+this.worldSize/2),Z=k.x/2;G-Z<T&&(f=T+Z),G+Z>M&&(f=M-Z)}void 0===f&&void 0===_||(this.center=this.unproject(new v.Point(void 0!==f?f:F.x,void 0!==_?_:F.y)).wrap()),this._unmodified=O,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,d=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=v.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let _=v.identity(new Float64Array(16));v.scale(_,_,[this.width/2,-this.height/2,1]),v.translate(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=v.identity(new Float64Array(16)),v.scale(_,_,[1,-1,1]),v.translate(_,_,[-1,-1,0]),v.scale(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const w=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,S=Math.PI/2+this._pitch,T=this._fov*(.5+s.y/this.height),M=Math.sin(T)*w/Math.sin(v.clamp(Math.PI-S-T,.01,Math.PI-.01)),k=this.getHorizon(),O=2*Math.atan(k/this.cameraToCenterDistance)*(.5+s.y/(2*k)),F=Math.sin(O)*w/Math.sin(v.clamp(Math.PI-S-O,.01,Math.PI-.01)),j=Math.min(M,F),K=1.01*(Math.cos(Math.PI/2-this._pitch)*j+w),G=this.height/50;_=new Float64Array(16),v.perspective(_,this._fov,this.width/this.height,G,K),_[8]=2*-s.x/this.width,_[9]=2*s.y/this.height,v.scale(_,_,[1,-1,1]),v.translate(_,_,[0,0,-this.cameraToCenterDistance]),v.rotateX(_,_,this._pitch),v.rotateZ(_,_,this.angle),v.translate(_,_,[-d,-f,0]),this.mercatorMatrix=v.scale([],_,[this.worldSize,this.worldSize,this.worldSize]),v.scale(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=v.multiply(new Float64Array(16),this.labelPlaneMatrix,_),v.translate(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=v.invert([],_),this.pixelMatrix3D=v.multiply(new Float64Array(16),this.labelPlaneMatrix,_);const Z=this.width%2/2,te=this.height%2/2,le=Math.cos(this.angle),fe=Math.sin(this.angle),J=d-Math.round(d)+le*Z+fe*te,pe=f-Math.round(f)+le*te+fe*Z,ve=new Float64Array(_);if(v.translate(ve,ve,[J>.5?J-1:J,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=ve,_=v.invert(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new v.Point(0,0)),d=[s.x*this.worldSize,s.y*this.worldSize,0,1];return v.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new v.Point(0,s))}getCameraQueryGeometry(s){const d=this.getCameraPoint();if(1===s.length)return[s[0],d];{let f=d.x,_=d.y,w=d.x,S=d.y;for(const T of s)f=Math.min(f,T.x),_=Math.min(_,T.y),w=Math.max(w,T.x),S=Math.max(S,T.y);return[new v.Point(f,_),new v.Point(w,_),new v.Point(w,S),new v.Point(f,S),new v.Point(f,_)]}}}class vd{constructor(s){this._hashName=s&&encodeURIComponent(s),v.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(d,f){let _=!1,w=null;const S=()=>{w=null,_&&(d(),w=setTimeout(S,300),_=!1)};return()=>(_=!0,w||S(),w)}(this._updateHashUnthrottled.bind(this))}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const d=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),S=Math.round(d.lng*w)/w,T=Math.round(d.lat*w)/w,M=this._map.getBearing(),k=this._map.getPitch();let O="";if(O+=s?`/${S}/${T}/${f}`:`${f}/${T}/${S}`,(M||k)&&(O+="/"+Math.round(10*M)/10),k&&(O+=`/${Math.round(k)}`),this._hashName){const F=this._hashName;let j=!1;const K=window.location.hash.slice(1).split("&").map(G=>{const Z=G.split("=")[0];return Z===F?(j=!0,`${Z}=${O}`):G}).filter(G=>G);return j||K.push(`${F}=${O}`),`#${K.join("&")}`}return`#${O}`}_getCurrentHash(){const s=window.location.hash.replace("#","");if(this._hashName){let d;return s.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._getCurrentHash();if(s.length>=3&&!s.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:d,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const s=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,s)}catch{}}}const Dl={linearity:.3,easing:v.bezier(0,0,.3,1)},cu=v.extend({deceleration:2500,maxSpeed:1400},Dl),bd=v.extend({deceleration:20,maxSpeed:1400},Dl),Il=v.extend({deceleration:1e3,maxSpeed:360},Dl),Ml=v.extend({deceleration:1e3,maxSpeed:90},Dl);class $o{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.exported.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,d=v.exported.now();for(;s.length>0&&d-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new v.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)d.zoom+=w.zoomDelta||0,d.bearing+=w.bearingDelta||0,d.pitch+=w.pitchDelta||0,w.panDelta&&d.pan._add(w.panDelta),w.around&&(d.around=w.around),w.pinchAround&&(d.pinchAround=w.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const w=dc(d.pan.mag(),f,v.extend({},cu,s||{}));_.offset=d.pan.mult(w.amount/d.pan.mag()),_.center=this._map.transform.center,oo(_,w)}if(d.zoom){const w=dc(d.zoom,f,bd);_.zoom=this._map.transform.zoom+w.amount,oo(_,w)}if(d.bearing){const w=dc(d.bearing,f,Il);_.bearing=this._map.transform.bearing+v.clamp(w.amount,-179,179),oo(_,w)}if(d.pitch){const w=dc(d.pitch,f,Ml);_.pitch=this._map.transform.pitch+w.amount,oo(_,w)}if(_.zoom||_.bearing){const w=void 0===d.pinchAround?d.around:d.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),v.extend(_,{noMoveStart:!0})}}function oo(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function dc(m,s,d){const{maxSpeed:f,linearity:_,deceleration:w}=d,S=v.clamp(m*_/(s/1e3),-f,f),T=Math.abs(S)/(w*_);return{easing:d.easing,duration:1e3*T,amount:S*(T/2)}}class fi extends v.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,f,_={}){const w=xe.mousePos(d.getCanvasContainer(),f),S=d.unproject(w);super(s,v.extend({point:w,lngLat:S,originalEvent:f},_)),this._defaultPrevented=!1,this.target=d}}class aa extends v.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,f){const _="touchend"===s?f.changedTouches:f.touches,w=xe.touchPos(d.getCanvasContainer(),_),S=w.map(M=>d.unproject(M)),T=w.reduce((M,k,O,F)=>M.add(k.div(F.length)),new v.Point(0,0));super(s,{points:w,point:T,lngLats:S,lngLat:d.unproject(T),originalEvent:f}),this._defaultPrevented=!1}}class mf extends v.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,f){super(s,{originalEvent:f}),this._defaultPrevented=!1}}class Ho{constructor(s,d){this._map=s,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new mf(s.type,this._map,s))}mousedown(s,d){return this._mousedownPos=d,this._firePreventable(new fi(s.type,this._map,s))}mouseup(s){this._map.fire(new fi(s.type,this._map,s))}click(s,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new fi(s.type,this._map,s))}dblclick(s){return this._firePreventable(new fi(s.type,this._map,s))}mouseover(s){this._map.fire(new fi(s.type,this._map,s))}mouseout(s){this._map.fire(new fi(s.type,this._map,s))}touchstart(s){return this._firePreventable(new aa(s.type,this._map,s))}touchmove(s){this._map.fire(new aa(s.type,this._map,s))}touchend(s){this._map.fire(new aa(s.type,this._map,s))}touchcancel(s){this._map.fire(new aa(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gf{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new fi(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new fi(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ha{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(v.Point.convert(s),this._map.terrain)}}class hc{constructor(s,d){this._map=s,this._tr=new Ha(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,d){this.isEnabled()&&s.shiftKey&&0===s.button&&(xe.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(s,d){if(!this._active)return;const f=d;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=f,this._box||(this._box=xe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const w=Math.min(_.x,f.x),S=Math.max(_.x,f.x),T=Math.min(_.y,f.y),M=Math.max(_.y,f.y);xe.setTransform(this._box,`translate(${w}px,${T}px)`),this._box.style.width=S-w+"px",this._box.style.height=M-T+"px"}mouseupWindow(s,d){if(!this._active||0!==s.button)return;const f=this._startPos,_=d;if(this.reset(),xe.suppressClick(),f.x!==_.x||f.y!==_.y)return this._map.fire(new v.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:w=>w.fitScreenCoordinates(f,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&27===s.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(xe.remove(this._box),this._box=null),xe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,d){return this._map.fire(new v.Event(s,{originalEvent:d}))}}function ls(m,s){if(m.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${s.length}`);const d={};for(let f=0;f<m.length;f++)d[m[f].identifier]=s[f];return d}class tt{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,d,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=s.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const w=new v.Point(0,0);for(const S of _)w._add(S);return w.div(_.length)}(d),this.touches=ls(f,d)))}touchmove(s,d,f){if(this.aborted||!this.centroid)return;const _=ls(f,d);for(const w in this.touches){const S=_[w];(!S||S.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(s,d,f){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),0===f.length){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class uu{constructor(s){this.singleTap=new tt(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,d,f){this.singleTap.touchstart(s,d,f)}touchmove(s,d,f){this.singleTap.touchmove(s,d,f)}touchend(s,d,f){const _=this.singleTap.touchend(s,d,f);if(_){const w=s.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(_)<30;if(w&&S||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Tl{constructor(s){this._tr=new Ha(s),this._zoomIn=new uu({numTouches:1,numTaps:2}),this._zoomOut=new uu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,d,f){this._zoomIn.touchstart(s,d,f),this._zoomOut.touchstart(s,d,f)}touchmove(s,d,f){this._zoomIn.touchmove(s,d,f),this._zoomOut.touchmove(s,d,f)}touchend(s,d,f){const _=this._zoomIn.touchend(s,d,f),w=this._zoomOut.touchend(s,d,f),S=this._tr;return _?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(_)},{originalEvent:s})}):w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(w)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class As{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const d=this._moveFunction(...s);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(s,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,d){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const _=d.length?d[0]:d;return!this._moved&&_.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(f,_))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&xe.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Bh={0:1,2:2};class Ke{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const d=xe.mouseButton(s);this._eventButton=d}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(d,f){const _=Bh[f];return void 0===d.buttons||(d.buttons&_)!==_}(s,this._eventButton)}isValidEndEvent(s){return xe.mouseButton(s)===this._eventButton}}class Ci{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return 1===s.targetTouches.length}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const xd=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=function(s){s.preventDefault()}},zh=({enable:m,clickTolerance:s,bearingDegreesPerPixelMoved:d=.8})=>{const f=new Ke({checkCorrectEvent:_=>0===xe.mouseButton(_)&&_.ctrlKey||2===xe.mouseButton(_)});return new As({clickTolerance:s,move:(_,w)=>({bearingDelta:(w.x-_.x)*d}),moveStateManager:f,enable:m,assignEvents:xd})},du=({enable:m,clickTolerance:s,pitchDegreesPerPixelMoved:d=-.5})=>{const f=new Ke({checkCorrectEvent:_=>0===xe.mouseButton(_)&&_.ctrlKey||2===xe.mouseButton(_)});return new As({clickTolerance:s,move:(_,w)=>({pitchDelta:(w.y-_.y)*d}),moveStateManager:f,enable:m,assignEvents:xd})};class mi{constructor(s,d){this._minTouches=s.cooperativeGestures?2:1,this._clickTolerance=s.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new v.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(s,d,f){return this._calculateTransform(s,d,f)}touchmove(s,d,f){if(this._map._cooperativeGestures&&(2===this._minTouches&&f.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(s,!1,f.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(f.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,d,f)}touchend(s,d,f){this._calculateTransform(s,d,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,d,f){f.length>0&&(this._active=!0);const _=ls(f,d),w=new v.Point(0,0),S=new v.Point(0,0);let T=0;for(const k in _){const O=_[k],F=this._touches[k];F&&(w._add(O),S._add(O.sub(F)),T++,_[k]=O)}if(this._touches=_,T<this._minTouches||!S.mag())return;const M=S.div(T);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(T),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(s){}_move(s,d,f){return{}}touchstart(s,d,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([d[0],d[1]]))}touchmove(s,d,f){if(!this._firstTwoTouches)return;s.preventDefault();const[_,w]=this._firstTwoTouches,S=pc(f,d,_),T=pc(f,d,w);if(!S||!T)return;const M=this._aroundCenter?null:S.add(T).div(2);return this._move([S,T],M,s)}touchend(s,d,f){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,S=pc(f,d,_),T=pc(f,d,w);S&&T||(this._active&&xe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&"center"===s.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function pc(m,s,d){for(let f=0;f<m.length;f++)if(m[f].identifier===d)return s[f]}function ct(m,s){return Math.log(m/s)/Math.LN2}class wr extends hu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,d){const f=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(ct(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ct(this._distance,f),pinchAround:d}}}function nn(m,s){return 180*m.angleWith(s)/Math.PI}class Pi extends hu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,d){const f=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:nn(this._vector,f),pinchAround:d}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const d=25/(Math.PI*this._minDiameter)*360,f=nn(s,this._startVector);return Math.abs(f)<d}}function Fi(m){return Math.abs(m.y)>Math.abs(m.x)}class Oi extends hu{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,d,f){super.touchstart(s,d,f),this._currentTouchCount=f.length}_start(s){this._lastPoints=s,Fi(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,d,f){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const _=s[0].sub(this._lastPoints[0]),w=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,w,f.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(_.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(s,d,f){if(void 0!==this._valid)return this._valid;const _=s.mag()>=2,w=d.mag()>=2;if(!_&&!w)return;if(!_||!w)return void 0===this._firstMove&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=s.y>0==d.y>0;return Fi(s)&&Fi(d)&&S}}const Si={panStep:100,bearingStep:15,pitchStep:10};class wd{constructor(s){this._tr=new Ha(s);const d=Si;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let d=0,f=0,_=0,w=0,S=0;switch(s.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:s.shiftKey?f=-1:(s.preventDefault(),w=-1);break;case 39:s.shiftKey?f=1:(s.preventDefault(),w=1);break;case 38:s.shiftKey?_=1:(s.preventDefault(),S=-1);break;case 40:s.shiftKey?_=-1:(s.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:T=>{const M=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:pu,zoom:d?Math.round(M.zoom)+d*(s.shiftKey?2:1):M.zoom,bearing:M.bearing+f*this._bearingStep,pitch:M.pitch+_*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:M.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function pu(m){return m*(2-m)}const qa=4.000244140625;class Ed{constructor(s,d){this._map=s,this._tr=new Ha(s),this._el=s.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,v.bindAll(["_onTimeout"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&"center"===s.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!s[this._map._metaKey])return;s.preventDefault()}let d=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const f=v.exported.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,0!==d&&d%qa==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),s.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=s,this._delta-=d,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=xe.mousePos(this._el,s),f=this._tr;this._around=v.LngLat.convert(this._aroundCenter?f.center:f.unproject(d)),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(0!==this._delta){const T="wheel"===this._type&&Math.abs(this._delta)>qa?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&0!==M&&(M=1/M);const k="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(k*M))),"wheel"===this._type&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d="number"==typeof this._targetZoom?this._targetZoom:s.zoom,f=this._startZoom,_=this._easing;let w,S=!1;if("wheel"===this._type&&f&&_){const T=Math.min((v.exported.now()-this._lastWheelEventTime)/200,1),M=_(T);w=v.interpolate.number(f,d,M),T<1?this._frameId||(this._frameId=!0):S=!0}else w=d,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let d=v.ease;if(this._prevEase){const f=this._prevEase,_=(v.exported.now()-f.start)/f.duration,w=f.easing(_+.01)-f.easing(_),S=.27/Math.sqrt(w*w+1e-4)*.01,T=Math.sqrt(.0729-S*S);d=v.bezier(S,T,.25,1)}return this._prevEase={start:v.exported.now(),duration:s,easing:d},d}reset(){this._active=!1}}class Vh{constructor(s,d){this._clickZoom=s,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fn{constructor(s){this._tr=new Ha(s),this.reset()}reset(){this._active=!1}dblclick(s,d){return s.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Le{constructor(){this._tap=new uu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(s,d,f){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=d[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(s,d,f))}touchmove(s,d,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=d[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,s.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(s,d,f)}touchend(s,d,f){this._tapTime?this._swipePoint&&0===f.length&&this.reset():this._tap.touchend(s,d,f)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ot{constructor(s,d,f){this._el=s,this._mousePan=d,this._touchPan=f}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $n{constructor(s,d,f){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=d,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Eo{constructor(s,d,f,_){this._el=s,this._touchZoom=d,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ks=m=>m.zoom||m.drag||m.pitch||m.rotate;class or extends v.Event{}function la(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Sn{constructor(s,d){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $o(s),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d),v.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,w,S]of this._listeners)xe.addEventListener(_,w,_===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[s,d,f]of this._listeners)xe.removeEventListener(s,d,s===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(s){const d=this._map,f=d.getCanvasContainer();this._add("mapEvent",new Ho(d,s));const _=d.boxZoom=new hc(d,s);this._add("boxZoom",_);const w=new Tl(d),S=new fn(d);d.doubleClickZoom=new Vh(S,w),this._add("tapZoom",w),this._add("clickZoom",S);const T=new Le;this._add("tapDragZoom",T);const M=d.touchPitch=new Oi(d);this._add("touchPitch",M);const k=zh(s),O=du(s);d.dragRotate=new $n(s,k,O),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const F=(({enable:le,clickTolerance:fe})=>{const J=new Ke({checkCorrectEvent:pe=>0===xe.mouseButton(pe)&&!pe.ctrlKey});return new As({clickTolerance:fe,move:(pe,ve)=>({around:ve,panDelta:ve.sub(pe)}),activateOnStart:!0,moveStateManager:J,enable:le,assignEvents:xd})})(s),j=new mi(s,d);d.dragPan=new Ot(f,F,j),this._add("mousePan",F),this._add("touchPan",j,["touchZoom","touchRotate"]);const K=new Pi,G=new wr;d.touchZoomRotate=new Eo(f,G,K,T),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",G,["touchPan","touchRotate"]);const Z=d.scrollZoom=new Ed(d,this);this._add("scrollZoom",Z,["mousePan"]);const te=d.keyboard=new wd(d);this._add("keyboard",te),this._add("blockableMapEvent",new gf(d));for(const le of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[le]&&d[le].enable(s[le])}_add(s,d,f){this._handlers.push({handlerName:s,handler:d,allowed:f}),this._handlersById[s]=d}stop(s){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ks(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,d,f){for(const _ in s)if(_!==f&&(!d||d.indexOf(_)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const d=[];for(const f of s)this._el.contains(f.target)&&d.push(f);return d}handleEvent(s,d){if("blur"===s.type)return void this.stop(!0);this._updatingCamera=!0;const f="renderFrame"===s.type?void 0:s,_={needsRenderFrame:!1},w={},S={},T=s.touches,M=T?this._getMapTouches(T):void 0,k=M?xe.touchPos(this._el,M):xe.mousePos(this._el,s);for(const{handlerName:j,handler:K,allowed:G}of this._handlers){if(!K.isEnabled())continue;let Z;this._blockedByActive(S,G,j)?K.reset():K[d||s.type]&&(Z=K[d||s.type](s,k,M),this.mergeHandlerResult(_,w,Z,j,f),Z&&Z.needsRenderFrame&&this._triggerRenderFrame()),(Z||K.isActive())&&(S[j]=K)}const O={};for(const j in this._previousActiveHandlers)S[j]||(O[j]=f);this._previousActiveHandlers=S,(Object.keys(O).length||la(_))&&(this._changes.push([_,w,O]),this._triggerRenderFrame()),(Object.keys(S).length||la(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:F}=_;F&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],F(this._map))}mergeHandlerResult(s,d,f,_,w){if(!f)return;v.extend(s,f);const S={handlerName:_,originalEvent:f.originalEvent||w};void 0!==f.zoomDelta&&(d.zoom=S),void 0!==f.panDelta&&(d.drag=S),void 0!==f.pitchDelta&&(d.pitch=S),void 0!==f.bearingDelta&&(d.rotate=S)}_applyChanges(){const s={},d={},f={};for(const[_,w,S]of this._changes)_.panDelta&&(s.panDelta=(s.panDelta||new v.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+_.pitchDelta),void 0!==_.around&&(s.around=_.around),void 0!==_.pinchAround&&(s.pinchAround=_.pinchAround),_.noInertia&&(s.noInertia=_.noInertia),v.extend(d,w),v.extend(f,S);this._updateMapTransform(s,d,f),this._changes=[]}_updateMapTransform(s,d,f){const _=this._map,w=_._getTransformForUpdate(),S=_.terrain;if(!(la(s)||S&&this._terrainMovement))return this._fireEvents(d,f,!0);let{panDelta:T,zoomDelta:M,bearingDelta:k,pitchDelta:O,around:F,pinchAround:j}=s;void 0!==j&&(F=j),_._stop(!0),F=F||_.transform.centerPoint;const K=w.pointLocation(T?F.sub(T):F);k&&(w.bearing+=k),O&&(w.pitch+=O),M&&(w.zoom+=M),S?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?w.center=w.pointLocation(w.centerPoint.sub(T)):w.setLocationAtPoint(K,F):(this._terrainMovement=!0,w.freezeElevation=!0,w.setLocationAtPoint(K,F),this._map.once("moveend",()=>{w.freezeElevation=!1,this._terrainMovement=!1,w.recalculateZoom(_.terrain)})):w.setLocationAtPoint(K,F),_._applyUpdatedTransform(w),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(d,f,!0)}_fireEvents(s,d,f){const _=ks(this._eventsInProgress),w=ks(s),S={};for(const O in s){const{originalEvent:F}=s[O];this._eventsInProgress[O]||(S[`${O}start`]=F),this._eventsInProgress[O]=s[O]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const O in S)this._fireEvent(O,S[O]);w&&this._fireEvent("move",w.originalEvent);for(const O in s){const{originalEvent:F}=s[O];this._fireEvent(O,F)}const T={};let M;for(const O in this._eventsInProgress){const{handlerName:F,originalEvent:j}=this._eventsInProgress[O];this._handlersById[F].isActive()||(delete this._eventsInProgress[O],M=d[F]||j,T[`${O}end`]=M)}for(const O in T)this._fireEvent(O,T[O]);const k=ks(this._eventsInProgress);if(f&&(_||w)&&!k){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=j=>0!==j&&-this._bearingSnap<j&&j<this._bearingSnap;O?(F(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:M})):(this._map.fire(new v.Event("moveend",{originalEvent:M})),F(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,d){this._map.fire(new v.Event(s,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new or("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const qo={extend:(m,...s)=>v.extend(m,...s),run(m){m()},logToElement(m,s=!1,d="log"){const f=window.document.getElementById(d);f&&(s&&(f.innerHTML=""),f.innerHTML+=`<br>${m}`)}};class nt extends v.Evented{constructor(s,d){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=d.bearingSnap,v.bindAll(["_renderFrameCallback"],this),this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new v.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(s,d){return this.jumpTo({center:s},d)}panBy(s,d,f){return s=v.Point.convert(s).mult(-1),this.panTo(this.transform.center,v.extend({offset:s},d),f)}panTo(s,d,f){return this.easeTo(v.extend({center:s},d),f)}getZoom(){return this.transform.zoom}setZoom(s,d){return this.jumpTo({zoom:s},d),this}zoomTo(s,d,f){return this.easeTo(v.extend({zoom:s},d),f)}zoomIn(s,d){return this.zoomTo(this.getZoom()+1,s,d),this}zoomOut(s,d){return this.zoomTo(this.getZoom()-1,s,d),this}getBearing(){return this.transform.bearing}setBearing(s,d){return this.jumpTo({bearing:s},d),this}getPadding(){return this.transform.padding}setPadding(s,d){return this.jumpTo({padding:s},d),this}rotateTo(s,d,f){return this.easeTo(v.extend({bearing:s},d),f)}resetNorth(s,d){return this.rotateTo(0,v.extend({duration:1e3},s),d),this}resetNorthPitch(s,d){return this.easeTo(v.extend({bearing:0,pitch:0,duration:1e3},s),d),this}snapToNorth(s,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,d):this}getPitch(){return this.transform.pitch}setPitch(s,d){return this.jumpTo({pitch:s},d),this}cameraForBounds(s,d){s=St.convert(s);const f=d&&d.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),f,d)}_cameraForBoxAndBearing(s,d,f,_){const w={top:0,bottom:0,right:0,left:0};if("number"==typeof(_=v.extend({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding){const ve=_.padding;_.padding={top:ve,bottom:ve,right:ve,left:ve}}_.padding=v.extend(w,_.padding);const S=this.transform,T=S.padding,M=S.project(v.LngLat.convert(s)),k=S.project(v.LngLat.convert(d)),O=M.rotate(-f*Math.PI/180),F=k.rotate(-f*Math.PI/180),j=new v.Point(Math.max(O.x,F.x),Math.max(O.y,F.y)),K=new v.Point(Math.min(O.x,F.x),Math.min(O.y,F.y)),G=j.sub(K),Z=(S.width-(T.left+T.right+_.padding.left+_.padding.right))/G.x,te=(S.height-(T.top+T.bottom+_.padding.top+_.padding.bottom))/G.y;if(te<0||Z<0)return void v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const le=Math.min(S.scaleZoom(S.scale*Math.min(Z,te)),_.maxZoom),fe=v.Point.convert(_.offset),J=new v.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(f*Math.PI/180),pe=fe.add(J).mult(S.scale/S.zoomScale(le));return{center:S.unproject(M.add(k).div(2).sub(pe)),zoom:le,bearing:f}}fitBounds(s,d,f){return this._fitInternal(this.cameraForBounds(s,d),d,f)}fitScreenCoordinates(s,d,f,_,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(v.Point.convert(s)),this.transform.pointLocation(v.Point.convert(d)),f,_),_,w)}_fitInternal(s,d,f){return s?(delete(d=v.extend(s,d)).padding,d.linear?this.easeTo(d,f):this.flyTo(d,f)):this}jumpTo(s,d){this.stop();const f=this._getTransformForUpdate();let _=!1,w=!1,S=!1;return"zoom"in s&&f.zoom!==+s.zoom&&(_=!0,f.zoom=+s.zoom),void 0!==s.center&&(f.center=v.LngLat.convert(s.center)),"bearing"in s&&f.bearing!==+s.bearing&&(w=!0,f.bearing=+s.bearing),"pitch"in s&&f.pitch!==+s.pitch&&(S=!0,f.pitch=+s.pitch),null==s.padding||f.isPaddingEqual(s.padding)||(f.padding=s.padding),this._applyUpdatedTransform(f),this.fire(new v.Event("movestart",d)).fire(new v.Event("move",d)),_&&this.fire(new v.Event("zoomstart",d)).fire(new v.Event("zoom",d)).fire(new v.Event("zoomend",d)),w&&this.fire(new v.Event("rotatestart",d)).fire(new v.Event("rotate",d)).fire(new v.Event("rotateend",d)),S&&this.fire(new v.Event("pitchstart",d)).fire(new v.Event("pitch",d)).fire(new v.Event("pitchend",d)),this.fire(new v.Event("moveend",d))}calculateCameraOptionsFromTo(s,d,f,_=0){const w=v.MercatorCoordinate.fromLngLat(s,d),S=v.MercatorCoordinate.fromLngLat(f,_),T=S.x-w.x,M=S.y-w.y,k=S.z-w.z,O=Math.hypot(T,M,k);if(0===O)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(T,M),j=this.transform.scaleZoom(this.transform.cameraToCenterDistance/O/this.transform.tileSize),K=180*Math.atan2(T,-M)/Math.PI;let G=180*Math.acos(F/O)/Math.PI;return G=k<0?90-G:90+G,{center:S.toLngLat(),zoom:j,pitch:G,bearing:K}}easeTo(s,d){this._stop(!1,s.easeId),(!1===(s=v.extend({offset:[0,0],duration:500,easing:v.ease},s)).animate||!s.essential&&v.exported.prefersReducedMotion)&&(s.duration=0);const f=this._getTransformForUpdate(),_=this.getZoom(),w=this.getBearing(),S=this.getPitch(),T=this.getPadding(),M="zoom"in s?+s.zoom:_,k="bearing"in s?this._normalizeBearing(s.bearing,w):w,O="pitch"in s?+s.pitch:S,F="padding"in s?s.padding:f.padding,j=v.Point.convert(s.offset);let K=f.centerPoint.add(j);const G=f.pointLocation(K),Z=v.LngLat.convert(s.center||G);this._normalizeCenter(Z);const te=f.project(G),le=f.project(Z).sub(te),fe=f.zoomScale(M-_);let J,pe;s.around&&(J=v.LngLat.convert(s.around),pe=f.locationPoint(J));const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||M!==_,this._rotating=this._rotating||w!==k,this._pitching=this._pitching||O!==S,this._padding=!f.isPaddingEqual(F),this._easeId=s.easeId,this._prepareEase(d,s.noMoveStart,ve),this.terrain&&this._prepareElevation(Z),this._ease(De=>{if(this._zooming&&(f.zoom=v.interpolate.number(_,M,De)),this._rotating&&(f.bearing=v.interpolate.number(w,k,De)),this._pitching&&(f.pitch=v.interpolate.number(S,O,De)),this._padding&&(f.interpolatePadding(T,F,De),K=f.centerPoint.add(j)),this.terrain&&!s.freezeElevation&&this._updateElevation(De),J)f.setLocationAtPoint(J,pe);else{const Ae=f.zoomScale(f.zoom-_),Ne=M>_?Math.min(2,fe):Math.max(.5,fe),ke=Math.pow(Ne,1-De),Be=f.unproject(te.add(le.mult(De*ke)).mult(Ae));f.setLocationAtPoint(f.renderWorldCopies?Be.wrap():Be,K)}this._applyUpdatedTransform(f),this._fireMoveEvents(d)},De=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,De)},s),this}_prepareEase(s,d,f={}){this._moving=!0,d||f.moving||this.fire(new v.Event("movestart",s)),this._zooming&&!f.zooming&&this.fire(new v.Event("zoomstart",s)),this._rotating&&!f.rotating&&this.fire(new v.Event("rotatestart",s)),this._pitching&&!f.pitching&&this.fire(new v.Event("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(s,this.terrain),this.transform.freezeElevation=!0}_updateElevation(s){const d=this.transform.getElevation(this._elevationCenter,this.terrain);if(s<1&&d!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(f-(d-(f*s+this._elevationStart))/(1-s)),this._elevationTarget=d}this.transform.elevation=v.interpolate.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const d=s.clone(),{center:f,zoom:_,pitch:w,bearing:S,elevation:T}=this.transformCameraUpdate(d);f&&(d.center=f),void 0!==_&&(d.zoom=_),void 0!==w&&(d.pitch=w),void 0!==S&&(d.bearing=S),void 0!==T&&(d.elevation=T),this.transform.apply(d)}_fireMoveEvents(s){this.fire(new v.Event("move",s)),this._zooming&&this.fire(new v.Event("zoom",s)),this._rotating&&this.fire(new v.Event("rotate",s)),this._pitching&&this.fire(new v.Event("pitch",s))}_afterEase(s,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const f=this._zooming,_=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new v.Event("zoomend",s)),_&&this.fire(new v.Event("rotateend",s)),w&&this.fire(new v.Event("pitchend",s)),this.fire(new v.Event("moveend",s))}flyTo(s,d){if(!s.essential&&v.exported.prefersReducedMotion){const Ye=v.pick(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ye,d)}this.stop(),s=v.extend({offset:[0,0],speed:1.2,curve:1.42,easing:v.ease},s);const f=this._getTransformForUpdate(),_=this.getZoom(),w=this.getBearing(),S=this.getPitch(),T=this.getPadding(),M="zoom"in s?v.clamp(+s.zoom,f.minZoom,f.maxZoom):_,k="bearing"in s?this._normalizeBearing(s.bearing,w):w,O="pitch"in s?+s.pitch:S,F="padding"in s?s.padding:f.padding,j=f.zoomScale(M-_),K=v.Point.convert(s.offset);let G=f.centerPoint.add(K);const Z=f.pointLocation(G),te=v.LngLat.convert(s.center||Z);this._normalizeCenter(te);const le=f.project(Z),fe=f.project(te).sub(le);let J=s.curve;const pe=Math.max(f.width,f.height),ve=pe/j,De=fe.mag();if("minZoom"in s){const Ye=v.clamp(Math.min(s.minZoom,_,M),f.minZoom,f.maxZoom),sn=pe/f.zoomScale(Ye-_);J=Math.sqrt(sn/De*2)}const Ae=J*J;function Ne(Ye){const sn=(ve*ve-pe*pe+(Ye?-1:1)*Ae*Ae*De*De)/(2*(Ye?ve:pe)*Ae*De);return Math.log(Math.sqrt(sn*sn+1)-sn)}function ke(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function Be(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const at=Ne(0);let yt=function(Ye){return Be(at)/Be(at+J*Ye)},$e=function(Ye){return pe*((Be(at)*(ke(sn=at+J*Ye)/Be(sn))-ke(at))/Ae)/De;var sn},bt=(Ne(1)-at)/J;if(Math.abs(De)<1e-6||!isFinite(bt)){if(Math.abs(pe-ve)<1e-6)return this.easeTo(s,d);const Ye=ve<pe?-1:1;bt=Math.abs(Math.log(ve/pe))/J,$e=function(){return 0},yt=function(sn){return Math.exp(Ye*J*sn)}}return s.duration="duration"in s?+s.duration:1e3*bt/("screenSpeed"in s?+s.screenSpeed/J:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=w!==k,this._pitching=O!==S,this._padding=!f.isPaddingEqual(F),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(te),this._ease(Ye=>{const sn=Ye*bt,ri=1/yt(sn);f.zoom=1===Ye?M:_+f.scaleZoom(ri),this._rotating&&(f.bearing=v.interpolate.number(w,k,Ye)),this._pitching&&(f.pitch=v.interpolate.number(S,O,Ye)),this._padding&&(f.interpolatePadding(T,F,Ye),G=f.centerPoint.add(K)),this.terrain&&!s.freezeElevation&&this._updateElevation(Ye);const an=1===Ye?te:f.unproject(le.add(fe.mult($e(sn))).mult(ri));f.setLocationAtPoint(f.renderWorldCopies?an.wrap():an,G),this._applyUpdatedTransform(f),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,d)}if(!s){const f=this.handlers;f&&f.stop(!1)}return this}_ease(s,d,f){!1===f.animate||0===f.duration?(s(1),d()):(this._easeStart=v.exported.now(),this._easeOptions=f,this._onEaseFrame=s,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((v.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,d){s=v.wrap(s,-180,180);const f=Math.abs(s-d);return Math.abs(s-360-d)<f&&(s-=360),Math.abs(s+360-d)<f&&(s+=360),s}_normalizeCenter(s){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const f=s.lng-d.center.lng;s.lng+=f>180?-360:f<-180?360:0}queryTerrainElevation(s){return this.terrain?this.transform.getElevation(v.LngLat.convert(s),this.terrain)-this.transform.elevation:null}}class Oe{constructor(s={}){this.options=s,v.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options&&this.options.compact,this._container=xe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=xe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=xe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){xe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,d){const f=this._map._getUIString(`AttributionControl.${d}`);s.title=f,s.setAttribute("aria-label",f)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(s){!s||"metadata"!==s.sourceDataType&&"visibility"!==s.sourceDataType&&"style"!==s.dataType&&"terrain"!==s.type||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(_=>"string"!=typeof _?"":_)):"string"==typeof this.options.customAttribution&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const w=d[_];if(w.used||w.usedForTerrain){const S=w.getSource();S.attribution&&s.indexOf(S.attribution)<0&&s.push(S.attribution)}}s=s.filter(_=>String(_).trim()),s.sort((_,w)=>_.length-w.length),s=s.filter((_,w)=>{for(let S=w+1;S<s.length;S++)if(s[S].indexOf(_)>=0)return!1;return!0});const f=s.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,s.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class Rs{constructor(s={}){this.options=s,v.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=xe.create("div","maplibregl-ctrl");const d=xe.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){xe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const s=this._container.children;if(s.length){const d=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}}}class fu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const d=++this._id;return this._queue.push({callback:s,id:d,cancelled:!1}),d}remove(s){const d=this._currentlyRunning,f=d?this._queue.concat(d):this._queue;for(const _ of f)if(_.id===s)return void(_.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const f of d)if(!f.cancelled&&(f.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ca={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var un=v.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Al extends v.Evented{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,d){this.sourceCache.update(s,d),this._renderableTilesKeys=[];const f={};for(const _ of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))f[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),v.ortho(_.posMatrix,0,v.EXTENT,0,v.EXTENT,0,1),this._tiles[_.key]=new ml(_,this.tileSize));for(const _ in this._tiles)f[_]||delete this._tiles[_]}freeRtt(s){for(const d in this._tiles){const f=this._tiles[d];(!s||f.tileID.equals(s)||f.tileID.isChildOf(s)||s.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const d={};for(const f of this._renderableTilesKeys){const _=this._tiles[f].tileID;if(_.canonical.equals(s.canonical)){const w=s.clone();w.posMatrix=new Float64Array(16),v.ortho(w.posMatrix,0,v.EXTENT,0,v.EXTENT,0,1),d[f]=w}else if(_.canonical.isChildOf(s.canonical)){const w=s.clone();w.posMatrix=new Float64Array(16);const S=_.canonical.z-s.canonical.z,T=_.canonical.x-(_.canonical.x>>S<<S),M=_.canonical.y-(_.canonical.y>>S<<S),k=v.EXTENT>>S;v.ortho(w.posMatrix,0,k,0,k,0,1),v.translate(w.posMatrix,w.posMatrix,[-T*k,-M*k,0]),d[f]=w}else if(s.canonical.isChildOf(_.canonical)){const w=s.clone();w.posMatrix=new Float64Array(16);const S=s.canonical.z-_.canonical.z,T=s.canonical.x-(s.canonical.x>>S<<S),M=s.canonical.y-(s.canonical.y>>S<<S),k=v.EXTENT>>S;v.ortho(w.posMatrix,0,v.EXTENT,0,v.EXTENT,0,1),v.translate(w.posMatrix,w.posMatrix,[T*k,M*k,0]),v.scale(w.posMatrix,w.posMatrix,[1/2**S,1/2**S,0]),d[f]=w}}return d}getSourceTile(s,d){const f=this.sourceCache._source;let _=s.overscaledZ-this.deltaZoom;if(_>f.maxzoom&&(_=f.maxzoom),_<f.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(_).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!w||!w.dem)&&d)for(;_>=f.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(s.scaledTo(_--).key);return w}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=s)}}class zr{constructor(s,d,f){this.painter=s,this.sourceCache=new Al(d),this.options=f,this.exaggeration="number"==typeof f.exaggeration?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,d,f,_=v.EXTENT){if(!(d>=0&&d<_&&f>=0&&f<_))return 0;let w=0;const S=this.getTerrainData(s);if(S.tile&&S.tile.dem){const T=((G=[])[0]=(te=S.u_terrain_matrix)[0]*(le=(Z=[d/_*v.EXTENT,f/_*v.EXTENT])[0])+te[4]*(fe=Z[1])+te[12],G[1]=te[1]*le+te[5]*fe+te[13],G),M=[T[0]*S.tile.dem.dim,T[1]*S.tile.dem.dim],k=[Math.floor(M[0]),Math.floor(M[1])],O=S.tile.dem.get(k[0],k[1]),F=S.tile.dem.get(k[0],k[1]+1),j=S.tile.dem.get(k[0]+1,k[1]),K=S.tile.dem.get(k[0]+1,k[1]+1);w=v.interpolate.number(v.interpolate.number(O,F,M[0]-k[0]),v.interpolate.number(j,K,M[0]-k[0]),M[1]-k[1])}var G,Z,te,le,fe;return w}getElevation(s,d,f,_=v.EXTENT){return this.getDEMElevation(s,d,f,_)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const _=this.painter.context,w=new v.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ht(_,w,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ht(_,new v.RGBAImage({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=v.identity([])}const d=this.sourceCache.getSourceTile(s,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new ht(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const f=d&&d+d.tileID.key+s.key;if(f&&!this._demMatrixCache[f]){const _=this.sourceCache.sourceCache._source.maxzoom;let w=s.canonical.z-d.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=_?w=s.canonical.z-_:v.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=s.canonical.x-(s.canonical.x>>w<<w),T=s.canonical.y-(s.canonical.y>>w<<w),M=v.fromScaling(new Float64Array(16),[1/(v.EXTENT<<w),1/(v.EXTENT<<w),0]);v.translate(M,M,[S*v.EXTENT,T*v.EXTENT,0]),this._demMatrixCache[s.key]={matrix:M,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(s){const d=this.painter,f=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ht(d.context,{width:f,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ht(d.context,{width:f,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(f,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,f,_))),this._fbo.colorAttachment.set("coords"===s?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,S=0;w<this._coordsTextureSize;w++)for(let T=0;T<this._coordsTextureSize;T++,S+=4)d[S+0]=255&T,d[S+1]=255&w,d[S+2]=T>>8<<4|w>>8,d[S+3]=0;const f=new v.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new ht(s,f,s.gl.RGBA,{premultiply:!1});return _.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(s){const d=new Uint8Array(4),f=this.painter.context,_=f.gl;f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),f.bindFramebuffer.set(null);const w=d[0]+(d[2]>>4<<8),S=d[1]+((15&d[2])<<8),T=this.coordsIndex[255-d[3]],M=T&&this.sourceCache.getTileByID(T);if(!M)return null;const k=this._coordsTextureSize,O=(1<<M.tileID.canonical.z)*k;return new v.MercatorCoordinate((M.tileID.canonical.x*k+w)/O,(M.tileID.canonical.y*k+S)/O,this.getElevation(M.tileID,w,S,k))}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,d=new v.Pos3dArray,f=new v.TriangleIndexArray,_=this.meshSize,w=v.EXTENT/_,S=_*_;for(let F=0;F<=_;F++)for(let j=0;j<=_;j++)d.emplaceBack(j*w,F*w,0);for(let F=0;F<S;F+=_+1)for(let j=0;j<_;j++)f.emplaceBack(j+F,_+j+F+1,_+j+F+2),f.emplaceBack(j+F,_+j+F+2,j+F+1);const T=d.length,M=T+2*(_+1);for(const F of[0,1])for(let j=0;j<=_;j++)for(const K of[0,1])d.emplaceBack(j*w,F*v.EXTENT,K);for(let F=0;F<2*_;F+=2)f.emplaceBack(M+F,M+F+1,M+F+3),f.emplaceBack(M+F,M+F+3,M+F+2),f.emplaceBack(T+F,T+F+3,T+F+1),f.emplaceBack(T+F,T+F+2,T+F+3);const k=d.length,O=k+2*(_+1);for(const F of[0,1])for(let j=0;j<=_;j++)for(const K of[0,1])d.emplaceBack(F*v.EXTENT,j*w,K);for(let F=0;F<2*_;F+=2)f.emplaceBack(k+F,k+F+1,k+F+3),f.emplaceBack(k+F,k+F+3,k+F+2),f.emplaceBack(O+F,O+F+3,O+F+1),f.emplaceBack(O+F,O+F+2,O+F+3);return this._mesh={indexBuffer:s.createIndexBuffer(f),vertexBuffer:s.createVertexBuffer(d,un.members),segments:v.SegmentVector.simpleSegment(0,0,d.length,f.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*v.earthRadius/Math.pow(2,s)/5}getMinMaxElevation(s){const d=this.getTerrainData(s).tile,f={minElevation:null,maxElevation:null};return d&&d.dem&&(f.minElevation=d.dem.min*this.exaggeration,f.maxElevation=d.dem.max*this.exaggeration),f}}class cs{constructor(s,d,f){this._context=s,this._size=d,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new ht(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(f.texture),{id:s,fbo:d,texture:f,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>s.id!==d),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(s=>!s.inUse)}}const so={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ni{constructor(s,d){this.painter=s,this.terrain=d,this.pool=new cs(s.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(f=>!s._layers[f].isHidden(d)),this._coordsDescendingInv={};for(const f in s.sourceCaches){this._coordsDescendingInv[f]={};const _=s.sourceCaches[f].getVisibleCoordinates();for(const w of _){const S=this.terrain.sourceCache.getTerrainCoords(w);for(const T in S)this._coordsDescendingInv[f][T]||(this._coordsDescendingInv[f][T]=[]),this._coordsDescendingInv[f][T].push(S[T])}}this._coordsDescendingInvStr={};for(const f of s._order){const _=s._layers[f],w=_.source;if(so[_.type]&&!this._coordsDescendingInvStr[w]){this._coordsDescendingInvStr[w]={};for(const S in this._coordsDescendingInv[w])this._coordsDescendingInvStr[w][S]=this._coordsDescendingInv[w][S].map(T=>T.key).sort().join()}}for(const f of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const w=this._coordsDescendingInvStr[_][f.tileID.key];w&&w!==f.rttCoords[_]&&(f.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const d=s.type,f=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(so[d]&&(this._prevType&&so[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(s.id),!_))return!0;if(so[this._prevType]||so[d]&&_){this._prevType=d;const w=this._stacks.length-1,S=this._stacks[w]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(cn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[w]){const k=this.pool.getObjectForId(T.rtt[w].id);if(k.stamp===T.rtt[w].stamp){this.pool.useObject(k);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),T.rtt[w]={id:M.id,stamp:M.stamp},f.context.bindFramebuffer.set(M.fbo.framebuffer),f.context.clear({color:v.Color.transparent,stencil:0}),f.currentStencilSource=void 0;for(let k=0;k<S.length;k++){const O=f.style._layers[S[k]],F=O.source?this._coordsDescendingInv[O.source][T.tileID.key]:[T.tileID];f.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),f._renderTileClippingMasks(O,F),f.renderLayer(f,f.style.sourceCaches[O.source],O,F),O.source&&(T.rttCoords[O.source]=this._coordsDescendingInvStr[O.source][T.tileID.key])}}return cn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),so[d]}return!1}}const us={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:v.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},ds=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},ua={showCompass:!0,showZoom:!0,visualizePitch:!1};class Zt{constructor(s,d,f=!1){this._clickTolerance=10;const _=s.dragRotate._mouseRotate.getClickTolerance(),w=s.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=zh({clickTolerance:_,enable:!0}),this.touchRotate=(({enable:S,clickTolerance:T,bearingDegreesPerPixelMoved:M=.8})=>{const k=new Ci;return new As({clickTolerance:T,move:(O,F)=>({bearingDelta:(F.x-O.x)*M}),moveStateManager:k,enable:S,assignEvents:ds})})({clickTolerance:_,enable:!0}),this.map=s,f&&(this.mousePitch=du({clickTolerance:w,enable:!0}),this.touchPitch=(({enable:S,clickTolerance:T,pitchDegreesPerPixelMoved:M=-.5})=>{const k=new Ci;return new As({clickTolerance:T,move:(O,F)=>({pitchDelta:(F.y-O.y)*M}),moveStateManager:k,enable:S,assignEvents:ds})})({clickTolerance:w,enable:!0})),v.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),xe.addEventListener(d,"mousedown",this.mousedown),xe.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),xe.addEventListener(d,"touchcancel",this.reset)}startMouse(s,d){this.mouseRotate.dragStart(s,d),this.mousePitch&&this.mousePitch.dragStart(s,d),xe.disableDrag()}startTouch(s,d){this.touchRotate.dragStart(s,d),this.touchPitch&&this.touchPitch.dragStart(s,d),xe.disableDrag()}moveMouse(s,d){const f=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(s,d)||{};if(_&&f.setBearing(f.getBearing()+_),this.mousePitch){const{pitchDelta:w}=this.mousePitch.dragMove(s,d)||{};w&&f.setPitch(f.getPitch()+w)}}moveTouch(s,d){const f=this.map,{bearingDelta:_}=this.touchRotate.dragMove(s,d)||{};if(_&&f.setBearing(f.getBearing()+_),this.touchPitch){const{pitchDelta:w}=this.touchPitch.dragMove(s,d)||{};w&&f.setPitch(f.getPitch()+w)}}off(){const s=this.element;xe.removeEventListener(s,"mousedown",this.mousedown),xe.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),xe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.removeEventListener(window,"touchend",this.touchend),xe.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){xe.enableDrag(),xe.removeEventListener(window,"mousemove",this.mousemove),xe.removeEventListener(window,"mouseup",this.mouseup),xe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.removeEventListener(window,"touchend",this.touchend)}mousedown(s){this.startMouse(v.extend({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),xe.mousePos(this.element,s)),xe.addEventListener(window,"mousemove",this.mousemove),xe.addEventListener(window,"mouseup",this.mouseup)}mousemove(s){this.moveMouse(s,xe.mousePos(this.element,s))}mouseup(s){this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()}touchstart(s){1!==s.targetTouches.length?this.reset():(this._startPos=this._lastPos=xe.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),xe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.addEventListener(window,"touchend",this.touchend))}touchmove(s){1!==s.targetTouches.length?this.reset():(this._lastPos=xe.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))}touchend(s){0===s.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let Ps;function kl(m,s,d){if(m=new v.LngLat(m.lng,m.lat),s){const f=new v.LngLat(m.lng-360,m.lat),_=new v.LngLat(m.lng+360,m.lat),w=d.locationPoint(m).distSqr(s);d.locationPoint(f).distSqr(s)<w?m=f:d.locationPoint(_).distSqr(s)<w&&(m=_)}for(;Math.abs(m.lng-d.center.lng)>180;){const f=d.locationPoint(m);if(f.x>=0&&f.y>=0&&f.x<=d.width&&f.y<=d.height)break;m.lng>d.center.lng?m.lng-=360:m.lng+=360}return m}const da={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ao(m,s,d){const f=m.classList;for(const _ in da)f.remove(`maplibregl-${d}-anchor-${_}`);f.add(`maplibregl-${d}-anchor-${s}`)}class ha extends v.Evented{constructor(s,d){if(super(),(s instanceof HTMLElement||d)&&(s=v.extend({element:s},d)),v.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&"auto"!==s.pitchAlignment?s.pitchAlignment:this._rotationAlignment,s&&s.element)this._element=s.element,this._offset=v.Point.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=xe.create("div"),this._element.setAttribute("aria-label","Map marker");const f=xe.createNS("http://www.w3.org/2000/svg","svg"),_=41,w=27;f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height",`${_}px`),f.setAttributeNS(null,"width",`${w}px`),f.setAttributeNS(null,"viewBox",`0 0 ${w} ${_}`);const S=xe.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const T=xe.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const M=xe.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of k){const J=xe.createNS("http://www.w3.org/2000/svg","ellipse");J.setAttributeNS(null,"opacity","0.04"),J.setAttributeNS(null,"cx","10.5"),J.setAttributeNS(null,"cy","5.80029008"),J.setAttributeNS(null,"rx",fe.rx),J.setAttributeNS(null,"ry",fe.ry),M.appendChild(J)}const O=xe.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const F=xe.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(F);const j=xe.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const K=xe.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(K);const G=xe.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const Z=xe.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=xe.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const le=xe.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#FFFFFF"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962"),Z.appendChild(te),Z.appendChild(le),T.appendChild(M),T.appendChild(O),T.appendChild(j),T.appendChild(G),T.appendChild(Z),f.appendChild(T),f.setAttributeNS(null,"height",_*this._scale+"px"),f.setAttributeNS(null,"width",w*this._scale+"px"),this._element.appendChild(f),this._offset=v.Point.convert(s&&s.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()}),ao(this._element,this._anchor,"marker"),this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),xe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=v.LngLat.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(24.6+_)],"bottom-right":[-_,-1*(24.6+_)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=s,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(s){const d=s.code,f=s.charCode||s.keyCode;"Space"!==d&&"Enter"!==d&&32!==f&&13!==f||this.togglePopup()}_onMapClick(s){const d=s.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():s.addTo(this._map),this):this}_update(s){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=kl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let d="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?d=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?f="rotateX(0deg)":"map"===this._pitchAlignment&&(f=`rotateX(${this._map.getPitch()}deg)`),s&&"moveend"!==s.type||(this._pos=this._pos.round()),xe.setTransform(this._element,`${da[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${d}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const _=this._map.unproject(this._pos),w=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=_.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(s){return this._offset=v.Point.convert(s),this._update(),this}_onMove(s){if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.Event("dragstart"))),this.fire(new v.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new v.Event("dragend")),this._state="inactive"}_addDragHandler(s){this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&"auto"!==s?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const pa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let hs=0,ii=!1;const Uh={maxWidth:100,unit:"metric"};function sr(m,s,d){const f=d&&d.maxWidth||100,_=m._container.clientHeight/2,w=m.unproject([0,_]),S=m.unproject([f,_]),T=w.distanceTo(S);if(d&&"imperial"===d.unit){const M=3.2808*T;M>5280?gi(s,f,M/5280,m._getUIString("ScaleControl.Miles")):gi(s,f,M,m._getUIString("ScaleControl.Feet"))}else d&&"nautical"===d.unit?gi(s,f,T/1852,m._getUIString("ScaleControl.NauticalMiles")):T>=1e3?gi(s,f,T/1e3,m._getUIString("ScaleControl.Kilometers")):gi(s,f,T,m._getUIString("ScaleControl.Meters"))}function gi(m,s,d,f){const _=function(w){const S=Math.pow(10,`${Math.floor(w)}`.length-1);let T=w/S;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(M){const k=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*k)/k}(T),S*T}(d);m.style.width=s*(_/d)+"px",m.innerHTML=`${_}&nbsp;${f}`}const Rl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Fs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ga(m){if(m){if("number"==typeof m){const s=Math.round(Math.sqrt(.5*Math.pow(m,2)));return{center:new v.Point(0,0),top:new v.Point(0,m),"top-left":new v.Point(s,s),"top-right":new v.Point(-s,s),bottom:new v.Point(0,-m),"bottom-left":new v.Point(s,-s),"bottom-right":new v.Point(-s,-s),left:new v.Point(m,0),right:new v.Point(-m,0)}}if(m instanceof v.Point||Array.isArray(m)){const s=v.Point.convert(m);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:v.Point.convert(m.center||[0,0]),top:v.Point.convert(m.top||[0,0]),"top-left":v.Point.convert(m["top-left"]||[0,0]),"top-right":v.Point.convert(m["top-right"]||[0,0]),bottom:v.Point.convert(m.bottom||[0,0]),"bottom-left":v.Point.convert(m["bottom-left"]||[0,0]),"bottom-right":v.Point.convert(m["bottom-right"]||[0,0]),left:v.Point.convert(m.left||[0,0]),right:v.Point.convert(m.right||[0,0])}}return Ga(new v.Point(0,0))}const Pl={setRTLTextPlugin:v.setRTLTextPlugin,getRTLTextPluginStatus:v.getRTLTextPluginStatus,Map:class extends nt{constructor(m){var s;if(v.PerformanceUtils.mark(v.PerformanceMarkers.create),null!=(m=v.extend({},us,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new sa(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new fu,this._controls=[],this._mapId=v.uniqueId(),this._locale=v.extend({},ca,m.locale),this._clickTolerance=m.clickTolerance,this._pixelRatio=null!==(s=m.pixelRatio)&&void 0!==s?s:devicePixelRatio,this.transformCameraUpdate=m.transformCameraUpdate,this._imageQueueHandle=yo.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ri(m.transformRequest),"string"==typeof m.container){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),v.bindAll(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let d=!1;this._resizeObserver=new ResizeObserver(f=>{d?this._trackResize&&this.resize(f)._update():d=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Sn(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new vd("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,v.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Oe({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new Rs,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update("style"===d.dataType),this.fire(new v.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new v.Event(`${d.dataType}dataloading`,d))}),this.on("dataabort",d=>{this.fire(new v.Event("sourcedataabort",d))})}_getMapId(){return this._mapId}addControl(m,s){if(void 0===s&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=m.onAdd(this);this._controls.push(m);const f=this._controlPositions[s];return-1!==s.indexOf("bottom")?f.insertBefore(d,f.firstChild):f.appendChild(d),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,s,d,f){return null==f&&this.terrain&&(f=this.transform.getElevation(d,this.terrain)),super.calculateCameraOptionsFromTo(m,s,d,f)}resize(m){var s;const d=this._containerDimensions(),f=d[0],_=d[1];this._resizeCanvas(f,_,this.getPixelRatio()),this.transform.resize(f,_),null===(s=this._requestedCameraState)||void 0===s||s.resize(f,_),this.painter.resize(f,_,this.getPixelRatio());const w=!this._moving;return w&&(this.stop(),this.fire(new v.Event("movestart",m)).fire(new v.Event("move",m))),this.fire(new v.Event("resize",m)),w&&this.fire(new v.Event("moveend",m)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(m){const[s,d]=this._containerDimensions();this._pixelRatio=m,this._resizeCanvas(s,d,m),this.painter.resize(s,d,m)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(St.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(m){return this.transform.locationPoint(v.LngLat.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(v.Point.convert(m),this.terrain)}isMoving(){var m;return this._moving||(null===(m=this.handlers)||void 0===m?void 0:m.isMoving())}isZooming(){var m;return this._zooming||(null===(m=this.handlers)||void 0===m?void 0:m.isZooming())}isRotating(){var m;return this._rotating||(null===(m=this.handlers)||void 0===m?void 0:m.isRotating())}_createDelegatedListener(m,s,d){if("mouseenter"===m||"mouseover"===m){let f=!1;return{layer:s,listener:d,delegates:{mousemove:w=>{const S=this.getLayer(s)?this.queryRenderedFeatures(w.point,{layers:[s]}):[];S.length?f||(f=!0,d.call(this,new fi(m,this,w.originalEvent,{features:S}))):f=!1},mouseout:()=>{f=!1}}}}if("mouseleave"===m||"mouseout"===m){let f=!1;return{layer:s,listener:d,delegates:{mousemove:S=>{(this.getLayer(s)?this.queryRenderedFeatures(S.point,{layers:[s]}):[]).length?f=!0:f&&(f=!1,d.call(this,new fi(m,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,d.call(this,new fi(m,this,S.originalEvent)))}}}}{const f=_=>{const w=this.getLayer(s)?this.queryRenderedFeatures(_.point,{layers:[s]}):[];w.length&&(_.features=w,d.call(this,_),delete _.features)};return{layer:s,listener:d,delegates:{[m]:f}}}}on(m,s,d){if(void 0===d)return super.on(m,s);const f=this._createDelegatedListener(m,s,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return this}once(m,s,d){if(void 0===d)return super.once(m,s);const f=this._createDelegatedListener(m,s,d);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(m,s,d){return void 0===d?super.off(m,s):(this._delegatedListeners&&this._delegatedListeners[m]&&(f=>{const _=this._delegatedListeners[m];for(let w=0;w<_.length;w++){const S=_[w];if(S.layer===s&&S.listener===d){for(const T in S.delegates)this.off(T,S.delegates[T]);return _.splice(w,1),this}}})(),this)}queryRenderedFeatures(m,s){if(!this.style)return[];let d;const f=m instanceof v.Point||Array.isArray(m),_=f?m:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(f?{}:m)||{},_ instanceof v.Point||"number"==typeof _[0])d=[v.Point.convert(_)];else{const w=v.Point.convert(_[0]),S=v.Point.convert(_[1]);d=[w,new v.Point(S.x,w.y),S,new v.Point(w.x,S.y),w]}return this.style.queryRenderedFeatures(d,s,this.transform)}querySourceFeatures(m,s){return this.style.querySourceFeatures(m,s)}setStyle(m,s){return!1!==(s=v.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(m,s))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const s=this._locale[m];if(null==s)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,s));const d=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Hi(this,s||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m,s,d):this.style.loadJSON(m,s,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Hi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,s){if("string"==typeof m){const d=this._requestManager.transformRequest(m,qn.Style);v.getJSON(d,(f,_)=>{f?this.fire(new v.ErrorEvent(f)):_&&this._updateDiff(_,s)})}else"object"==typeof m&&this._updateDiff(m,s)}_updateDiff(m,s){try{this.style.setState(m,s)&&this._update(!0)}catch(d){v.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(m,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():v.warnOnce("There is no style added to the map.")}addSource(m,s){return this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)}isSourceLoaded(m){const s=this.style&&this.style.sourceCaches[m];if(void 0!==s)return s.loaded();this.fire(new v.ErrorEvent(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const s=this.style.sourceCaches[m.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);for(const d in this.style._layers){const f=this.style._layers[d];"hillshade"===f.type&&f.source===m.source&&v.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new zr(this.painter,s,m),this.painter.renderToTexture=new ni(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=d=>{"style"===d.dataType?this.terrain.sourceCache.freeRtt():"source"===d.dataType&&d.tile&&(d.sourceId===m.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new v.Event("terrain",{terrain:m})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const s in m){const d=m[s]._tiles;for(const f in d){const _=d[f];if("loaded"!==_.state&&"errored"!==_.state)return!1}}return!0}addSourceType(m,s,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,d)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,s,{pixelRatio:d=1,sdf:f=!1,stretchX:_,stretchY:w,content:S}={}){if(this._lazyInitEmptyStyle(),s instanceof HTMLImageElement||v.isImageBitmap(s)){const{width:T,height:M,data:k}=v.exported.getImageData(s);this.style.addImage(m,{data:new v.RGBAImage({width:T,height:M},k),pixelRatio:d,stretchX:_,stretchY:w,content:S,sdf:f,version:0})}else{if(void 0===s.width||void 0===s.height)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:M,data:k}=s,O=s;this.style.addImage(m,{data:new v.RGBAImage({width:T,height:M},new Uint8Array(k)),pixelRatio:d,stretchX:_,stretchY:w,content:S,sdf:f,version:0,userImage:O}),O.onAdd&&O.onAdd(this,m)}}}updateImage(m,s){const d=this.style.getImage(m);if(!d)return this.fire(new v.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=s instanceof HTMLImageElement||v.isImageBitmap(s)?v.exported.getImageData(s):s,{width:_,height:w,data:S}=f;if(void 0===_||void 0===w)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||w!==d.data.height)return this.fire(new v.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(s instanceof HTMLImageElement||v.isImageBitmap(s));d.data.replace(S,T),this.style.updateImage(m,d)}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new v.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,s){yo.getImage(this._requestManager.transformRequest(m,qn.Image),s)}listImages(){return this.style.listImages()}addLayer(m,s){return this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)}moveLayer(m,s){return this.style.moveLayer(m,s),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,s,d){return this.style.setLayerZoomRange(m,s,d),this._update(!0)}setFilter(m,s,d={}){return this.style.setFilter(m,s,d),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,s,d,f={}){return this.style.setPaintProperty(m,s,d,f),this._update(!0)}getPaintProperty(m,s){return this.style.getPaintProperty(m,s)}setLayoutProperty(m,s,d,f={}){return this.style.setLayoutProperty(m,s,d,f),this._update(!0)}getLayoutProperty(m,s){return this.style.getLayoutProperty(m,s)}setGlyphs(m,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,s,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,s,d,f=>{f||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,s,d=>{d||this._update(!0)}),this}setLight(m,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,s){return this.style.setFeatureState(m,s),this._update()}removeFeatureState(m,s){return this.style.removeFeatureState(m,s),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,s=0;return this._container&&(m=this._container.clientWidth||400,s=this._container.clientHeight||300),[m,s]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const s=this._canvasContainer=xe.create("div","maplibregl-canvas-container",m);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=xe.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions();this._resizeCanvas(d[0],d[1],this.getPixelRatio());const f=this._controlContainer=xe.create("div","maplibregl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{_[w]=xe.create("div",`maplibregl-ctrl-${w} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(m){this._onCooperativeGesture(m,m[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=xe.create("div","maplibregl-cooperative-gesture-screen",this._container);let m="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(m="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${m}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){xe.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(m,s,d){this._canvas.width=d*m,this._canvas.height=d*s,this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{s={requestedAttributes:m},f&&(s.statusMessage=f.statusMessage,s.type=f.type)},{once:!0});const d=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!d){const f="Failed to initialize WebGL";throw s?(s.message=f,new Error(JSON.stringify(s))):new Error(f)}this.painter=new lu(d,this.transform),Qi.testSupport(d)}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new v.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new v.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(m,s,d){return!s&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,w=v.exported.now();this.style.zoomHistory.update(_,w);const S=new v.EvaluationParameters(_,{now:w,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=S.crossFadingFactor();1===T&&T===this._crossFadingFactor||(d=!0,this._crossFadingFactor=T),this.style.update(S)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new v.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,v.PerformanceUtils.mark(v.PerformanceMarkers.load),this.fire(new v.Event("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const f=this._sourcesDirty||this._styleDirty||this._placementDirty;return f||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new v.Event("idle")),!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,v.PerformanceUtils.mark(v.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),yo.removeThrottleControl(this._imageQueueHandle),null===(m=this._resizeObserver)||void 0===m||m.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),xe.remove(this._canvasContainer),xe.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),v.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new v.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=v.exported.frame(m=>{v.PerformanceUtils.frame(m),this._frame=null,this._render(m)}))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return"3.1.0"}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(m){this.options=v.extend({},ua,m),this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(v.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),xe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),xe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(v.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=xe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map.getZoom(),s=m===this._map.getMaxZoom(),d=m===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())}_rotateCompassArrow(){const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=m}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zt(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){xe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,s){const d=xe.create("button",m,this._container);return d.type="button",d.addEventListener("click",s),d}_setButtonTitle(m,s){const d=this._map._getUIString(`NavigationControl.${s}`);m.title=d,m.setAttribute("aria-label",d)}},GeolocateControl:class extends v.Evented{constructor(m){super(),this.options=v.extend({},pa,m),v.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s,d=!1){void 0===Ps||d?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(f=>{Ps="denied"!==f.state,s(Ps)}).catch(()=>{Ps=!!window.navigator.geolocation,s(Ps)}):(Ps=!!window.navigator.geolocation,s(Ps)):s(Ps)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),xe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,hs=0,ii=!1}_isOutOfMapMaxBounds(m){const s=this._map.getMaxBounds(),d=m.coords;return s&&(d.longitude<s.getWest()||d.longitude>s.getEast()||d.latitude<s.getSouth()||d.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new v.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new v.Event("geolocate",m)),this._finish()}}_updateCamera(m){const s=new v.LngLat(m.coords.longitude,m.coords.latitude),d=m.coords.accuracy,f=this._map.getBearing(),_=v.extend({bearing:f},this.options.fitBoundsOptions),w=St.fromLngLat(s,d);this._map.fitBounds(w,_,{geolocateSource:!0})}_updateMarker(m){if(m){const s=new v.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.getBounds(),s=m.getSouthEast(),d=m.getNorthEast(),f=s.distanceTo(d),_=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&ii)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new v.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=xe.create("button","maplibregl-ctrl-geolocate",this._container),xe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){v.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=xe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ha(this._dotElement),this._circleElement=xe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ha({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||"ACTIVE_LOCK"!==this._watchState||s.originalEvent&&"resize"===s.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new v.Event("trackuserlocationend")))})}}trigger(){if(!this._setup)return v.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new v.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":hs--,ii=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new v.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new v.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),hs++,hs>1?(m={maximumAge:6e5,timeout:0},ii=!0):(m=this.options.positionOptions,ii=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Oe,LogoControl:Rs,ScaleControl:class{constructor(m){this.options=v.extend({},Uh,m),v.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){sr(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){xe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,sr(this._map,this._container,this.options)}},FullscreenControl:class extends v.Evented{constructor(m={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:v.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){xe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=xe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);xe.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new v.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new v.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(m){this.options=m,v.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=xe.create("button","maplibregl-ctrl-terrain",this._container),xe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){xe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends v.Evented{constructor(m){super(),this.options=v.extend(Object.create(Rl),m),v.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new v.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&xe.remove(this._content),this._container&&(xe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new v.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=v.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const s=document.createDocumentFragment(),d=document.createElement("body");let f;for(d.innerHTML=m;f=d.firstChild,f;)s.appendChild(f);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=xe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=xe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(m){this._update(m.point)}_onMouseMove(m){this._update(m.point)}_onDrag(m){this._update(m.point)}_update(m){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=xe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=xe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(w=>this._container.classList.add(w)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=kl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!m))return;const s=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat);let d=this.options.anchor;const f=Ga(this.options.offset);if(!d){const w=this._container.offsetWidth,S=this._container.offsetHeight;let T;T=s.y+f.bottom.y<S?["top"]:s.y>this._map.transform.height-S?["bottom"]:[],s.x<w/2?T.push("left"):s.x>this._map.transform.width-w/2&&T.push("right"),d=0===T.length?"bottom":T.join("-")}const _=s.add(f[d]).round();xe.setTransform(this._container,`${da[d]} translate(${_.x}px,${_.y}px)`),ao(this._container,d,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Fs);m&&m.focus()}_onClose(){this.remove()}},Marker:ha,Style:Hi,LngLat:v.LngLat,LngLatBounds:St,Point:v.Point,MercatorCoordinate:v.MercatorCoordinate,Evented:v.Evented,AJAXError:v.AJAXError,config:v.config,CanvasSource:we,GeoJSONSource:xs,ImageSource:qr,RasterDEMTileSource:xn,RasterTileSource:In,VectorTileSource:Ba,VideoSource:fl,prewarm:function(){_l().acquire(ws)},clearPrewarmedResources:function(){const m=er;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(ws),er=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"3.1.0"},get workerCount(){return je.workerCount},set workerCount(m){je.workerCount=m},get maxParallelImageRequests(){return v.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){v.config.MAX_PARALLEL_IMAGE_REQUESTS=m},get workerUrl(){return v.config.WORKER_URL},set workerUrl(m){v.config.WORKER_URL=m},addProtocol(m,s){v.config.REGISTERED_PROTOCOLS[m]=s},removeProtocol(m){delete v.config.REGISTERED_PROTOCOLS[m]}};return qo.extend(Pl,{isSafari:v.isSafari,getPerformanceMetrics:v.PerformanceUtils.getPerformanceMetrics}),Pl}),$t}()}},Hc=>{Hc(Hc.s=451)}]);