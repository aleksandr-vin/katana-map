(self.webpackChunkkatana_map=self.webpackChunkkatana_map||[]).push([[179],{780:(Pc,So,ps)=>{"use strict";function $t(e){return"function"==typeof e}function Rc(e){const t=e(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Fc=Rc(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function y(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class Qt{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const l of t)l.remove(this);else t.remove(this);const{initialTeardown:i}=this;if($t(i))try{i()}catch(l){n=l instanceof Fc?l.errors:[l]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const l of r)try{lt(l)}catch(d){n=n??[],d instanceof Fc?n=[...n,...d.errors]:n.push(d)}}if(n)throw new Fc(n)}}add(n){var t;if(n&&n!==this)if(this.closed)lt(n);else{if(n instanceof Qt){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&y(t,n)}remove(n){const{_finalizers:t}=this;t&&y(t,n),n instanceof Qt&&n._removeParent(this)}}Qt.EMPTY=(()=>{const e=new Qt;return e.closed=!0,e})();const be=Qt.EMPTY;function Wi(e){return e instanceof Qt||e&&"closed"in e&&$t(e.remove)&&$t(e.add)&&$t(e.unsubscribe)}function lt(e){$t(e)?e():e.unsubscribe()}const cr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Wr={setTimeout(e,n,...t){const{delegate:i}=Wr;return i?.setTimeout?i.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=Wr;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function fs(e){Wr.setTimeout(()=>{const{onUnhandledError:n}=cr;if(!n)throw e;n(e)})}function Zr(){}const Yo=Ci("C",void 0,void 0);function Ci(e,n,t){return{kind:e,value:n,error:t}}let Io=null;function Mo(e){if(cr.useDeprecatedSynchronousErrorHandling){const n=!Io;if(n&&(Io={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:i}=Io;if(Io=null,t)throw i}}else e()}class ze extends Qt{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Wi(n)&&n.add(this)):this.destination=To}static create(n,t,i){return new ut(n,t,i)}next(n){this.isStopped?Zi(function co(e){return Ci("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Zi(function zn(e){return Ci("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Zi(Yo,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const We=Function.prototype.bind;function ct(e,n){return We.call(e,n)}class pt{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(i){Lt(i)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(i){Lt(i)}else Lt(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){Lt(t)}}}class ut extends ze{constructor(n,t,i){let r;if(super(),$t(n)||!n)r={next:n??void 0,error:t??void 0,complete:i??void 0};else{let l;this&&cr.useDeprecatedNextContext?(l=Object.create(n),l.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&ct(n.next,l),error:n.error&&ct(n.error,l),complete:n.complete&&ct(n.complete,l)}):r=n}this.destination=new pt(r)}}function Lt(e){cr.useDeprecatedSynchronousErrorHandling?function $e(e){cr.useDeprecatedSynchronousErrorHandling&&Io&&(Io.errorThrown=!0,Io.error=e)}(e):fs(e)}function Zi(e,n){const{onStoppedNotification:t}=cr;t&&Wr.setTimeout(()=>t(e,n))}const To={closed:!0,next:Zr,error:function Gn(e){throw e},complete:Zr},Ao="function"==typeof Symbol&&Symbol.observable||"@@observable";function Lr(e){return e}let _n=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(t,i,r){const l=function Dr(e){return e&&e instanceof ze||function qs(e){return e&&$t(e.next)&&$t(e.error)&&$t(e.complete)}(e)&&Wi(e)}(t)?t:new ut(t,i,r);return Mo(()=>{const{operator:d,source:f}=this;l.add(d?d.call(l,f):f?this._subscribe(l):this._trySubscribe(l))}),l}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=rl(i))((r,l)=>{const d=new ut({next:f=>{try{t(f)}catch(b){l(b),d.unsubscribe()}},error:l,complete:r});this.subscribe(d)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Ao](){return this}pipe(...t){return function Gs(e){return 0===e.length?Lr:1===e.length?e[0]:function(t){return e.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=rl(t))((i,r)=>{let l;this.subscribe(d=>l=d,d=>r(d),()=>i(l))})}}return e.create=n=>new e(n),e})();function rl(e){var n;return null!==(n=e??cr.Promise)&&void 0!==n?n:Promise}const uo=Rc(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ft=(()=>{class e extends _n{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Pa(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new uo}next(t){Mo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Mo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Mo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:l}=this;return i||r?be:(this.currentObservers=null,l.push(t),new Qt(()=>{this.currentObservers=null,y(l,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:l}=this;i?t.error(r):l&&t.complete()}asObservable(){const t=new _n;return t.source=this,t}}return e.create=(n,t)=>new Pa(n,t),e})();class Pa extends Ft{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,n)}error(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==i?i:be}}function Ra(e){return $t(e?.lift)}function Vn(e){return n=>{if(Ra(n))return n.lift(function(t){try{return e(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mn(e,n,t,i,r){return new ms(e,n,t,i,r)}class ms extends ze{constructor(n,t,i,r,l,d){super(n),this.onFinalize=l,this.shouldUnsubscribe=d,this._next=t?function(f){try{t(f)}catch(b){n.error(b)}}:super._next,this._error=r?function(f){try{r(f)}catch(b){n.error(b)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(f){n.error(f)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function fn(e,n){return Vn((t,i)=>{let r=0;t.subscribe(Mn(i,l=>{i.next(e.call(n,l,r++))}))})}function wt(e){return this instanceof wt?(this.v=e,this):new wt(e)}function gi(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function ho(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=e[l]&&function(d){return new Promise(function(f,b){!function r(l,d,f,b){Promise.resolve(b).then(function(E){l({value:E,done:f})},d)}(f,b,(d=e[l](d)).done,d.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const z=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function G(e){return $t(e?.then)}function ee(e){return $t(e[Ao])}function ne(e){return Symbol.asyncIterator&&$t(e?.[Symbol.asyncIterator])}function ce(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ie=function ae(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function de(e){return $t(e?.[ie])}function Se(e){return function Tt(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),l=[];return r={},d("next"),d("throw"),d("return"),r[Symbol.asyncIterator]=function(){return this},r;function d(U){i[U]&&(r[U]=function($){return new Promise(function(Q,oe){l.push([U,$,Q,oe])>1||f(U,$)})})}function f(U,$){try{!function b(U){U.value instanceof wt?Promise.resolve(U.value.v).then(E,T):P(l[0][2],U)}(i[U]($))}catch(Q){P(l[0][3],Q)}}function E(U){f("next",U)}function T(U){f("throw",U)}function P(U,$){U($),l.shift(),l.length&&f(l[0][0],l[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:i,done:r}=yield wt(t.read());if(r)return yield wt(void 0);yield yield wt(i)}}finally{t.releaseLock()}})}function Ie(e){return $t(e?.getReader)}function we(e){if(e instanceof _n)return e;if(null!=e){if(ee(e))return function ft(e){return new _n(n=>{const t=e[Ao]();if($t(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(z(e))return function Et(e){return new _n(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(G(e))return function tt(e){return new _n(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,fs)})}(e);if(ne(e))return xt(e);if(de(e))return function dt(e){return new _n(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(Ie(e))return function Xt(e){return xt(Se(e))}(e)}throw ce(e)}function xt(e){return new _n(n=>{(function Nt(e,n){var t,i,r,l;return function Zs(e,n,t,i){return new(t||(t=Promise))(function(l,d){function f(T){try{E(i.next(T))}catch(P){d(P)}}function b(T){try{E(i.throw(T))}catch(P){d(P)}}function E(T){T.done?l(T.value):function r(l){return l instanceof t?l:new t(function(d){d(l)})}(T.value).then(f,b)}E((i=i.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=gi(e);!(i=yield t.next()).done;)if(n.next(i.value),n.closed)return}catch(d){r={error:d}}finally{try{i&&!i.done&&(l=t.return)&&(yield l.call(t))}finally{if(r)throw r.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Bt(e,n,t,i=0,r=!1){const l=n.schedule(function(){t(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(l),!r)return l}function Un(e,n,t=1/0){return $t(n)?Un((i,r)=>fn((l,d)=>n(i,l,r,d))(we(e(i,r))),t):("number"==typeof n&&(t=n),Vn((i,r)=>function In(e,n,t,i,r,l,d,f){const b=[];let E=0,T=0,P=!1;const U=()=>{P&&!b.length&&!E&&n.complete()},$=oe=>E<i?Q(oe):b.push(oe),Q=oe=>{l&&n.next(oe),E++;let _e=!1;we(t(oe,T++)).subscribe(Mn(n,Me=>{r?.(Me),l?$(Me):n.next(Me)},()=>{_e=!0},void 0,()=>{if(_e)try{for(E--;b.length&&E<i;){const Me=b.shift();d?Bt(n,d,()=>Q(Me)):Q(Me)}U()}catch(Me){n.error(Me)}}))};return e.subscribe(Mn(n,$,()=>{P=!0,U()})),()=>{f?.()}}(i,r,e,t)))}function vt(e=1/0){return Un(Lr,e)}const jn=new _n(e=>e.complete());function zr(e){return e&&$t(e.schedule)}function Vr(e){return e[e.length-1]}function Oa(e){return $t(Vr(e))?e.pop():void 0}function Ks(e){return zr(Vr(e))?e.pop():void 0}function cl(e,n=0){return Vn((t,i)=>{t.subscribe(Mn(i,r=>Bt(i,e,()=>i.next(r),n),()=>Bt(i,e,()=>i.complete(),n),r=>Bt(i,e,()=>i.error(r),n)))})}function bs(e,n=0){return Vn((t,i)=>{i.add(e.schedule(()=>t.subscribe(i),n))})}function Li(e,n){if(!e)throw new Error("Iterable cannot be null");return new _n(t=>{Bt(t,n,()=>{const i=e[Symbol.asyncIterator]();Bt(t,n,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Xr(e,n){return n?function Nc(e,n){if(null!=e){if(ee(e))return function li(e,n){return we(e).pipe(bs(n),cl(n))}(e,n);if(z(e))return function Po(e,n){return new _n(t=>{let i=0;return n.schedule(function(){i===e.length?t.complete():(t.next(e[i++]),t.closed||this.schedule())})})}(e,n);if(G(e))return function Lc(e,n){return we(e).pipe(bs(n),cl(n))}(e,n);if(ne(e))return Li(e,n);if(de(e))return function hh(e,n){return new _n(t=>{let i;return Bt(t,n,()=>{i=e[ie](),Bt(t,n,()=>{let r,l;try{({value:r,done:l}=i.next())}catch(d){return void t.error(d)}l?t.complete():t.next(r)},0,!0)}),()=>$t(i?.return)&&i.return()})}(e,n);if(Ie(e))return function qu(e,n){return Li(Se(e),n)}(e,n)}throw ce(e)}(e,n):we(e)}function Vt(...e){const n=Ks(e),t=function _i(e,n){return"number"==typeof Vr(e)?e.pop():n}(e,1/0),i=e;return i.length?1===i.length?we(i[0]):vt(t)(Xr(i,n)):jn}class xs extends Ft{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:i}=this;if(n)throw t;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Ni(...e){return Xr(e,Ks(e))}function ul(e={}){const{connector:n=(()=>new Ft),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return l=>{let d,f,b,E=0,T=!1,P=!1;const U=()=>{f?.unsubscribe(),f=void 0},$=()=>{U(),d=b=void 0,T=P=!1},Q=()=>{const oe=d;$(),oe?.unsubscribe()};return Vn((oe,_e)=>{E++,!P&&!T&&U();const Me=b=b??n();_e.add(()=>{E--,0===E&&!P&&!T&&(f=Bc(Q,r))}),Me.subscribe(_e),!d&&E>0&&(d=new ut({next:ve=>Me.next(ve),error:ve=>{P=!0,U(),f=Bc($,t,ve),Me.error(ve)},complete:()=>{T=!0,U(),f=Bc($,i),Me.complete()}}),we(oe).subscribe(d))})(l)}}function Bc(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new ut({next:()=>{i.unsubscribe(),e()}});return we(n(...t)).subscribe(i)}function ws(e,n){return Vn((t,i)=>{let r=null,l=0,d=!1;const f=()=>d&&!r&&i.complete();t.subscribe(Mn(i,b=>{r?.unsubscribe();let E=0;const T=l++;we(e(b,T)).subscribe(r=Mn(i,P=>i.next(n?n(b,P,T,E++):P),()=>{r=null,f()}))},()=>{d=!0,f()}))})}function zc(e,n=Lr){return e=e??ph,Vn((t,i)=>{let r,l=!0;t.subscribe(Mn(i,d=>{const f=n(d);(l||!e(r,f))&&(l=!1,r=f,i.next(d))}))})}function ph(e,n){return e===n}function mn(e){for(let n in e)if(e[n]===mn)return n;throw Error("Could not find renamed property on target object.")}function Vc(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function yi(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(yi).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function Wu(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const Zu=mn({__forward_ref__:mn});function xn(e){return e.__forward_ref__=xn,e.toString=function(){return yi(this())},e}function Ct(e){return Uc(e)?e():e}function Uc(e){return"function"==typeof e&&e.hasOwnProperty(Zu)&&e.__forward_ref__===xn}function jc(e){return e&&!!e.\u0275providers}const Kl="https://g.co/ng/security#xss";class Ee extends Error{constructor(n,t){super(function La(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function Dt(e){return"string"==typeof e?e:null==e?"":String(e)}function Qs(e,n){throw new Ee(-201,!1)}function Yr(e,n){null==e&&function bt(e,n,t,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${t} ${i} ${n} <=Actual]`))}(n,e,null,"!=")}function at(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ci(e){return{providers:e.providers||[],imports:e.imports||[]}}function pl(e){return qc(e,Yl)||qc(e,Zc)}function qc(e,n){return e.hasOwnProperty(n)?e[n]:null}function Es(e){return e&&(e.hasOwnProperty(Wc)||e.hasOwnProperty(Na))?e[Wc]:null}const Yl=mn({\u0275prov:mn}),Wc=mn({\u0275inj:mn}),Zc=mn({ngInjectableDef:mn}),Na=mn({ngInjectorDef:mn});var Jt=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Jt||{});let Js;function Sr(e){const n=Js;return Js=e,n}function Xc(e,n,t){const i=pl(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Jt.Optional?null:void 0!==n?n:void Qs(yi(e))}const wn=globalThis;class Oe{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=at({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const dn={},ea="__NG_DI_FLAG__",Jl="ngTempTokenPath",Up=/\n/gm,ec="__source";let Cs;function es(e){const n=Cs;return Cs=e,n}function tc(e,n=Jt.Default){if(void 0===Cs)throw new Ee(-203,!1);return null===Cs?Xc(e,void 0,n):Cs.get(e,n&Jt.Optional?null:void 0,n)}function Te(e,n=Jt.Default){return(function Ba(){return Js}()||tc)(Ct(e),n)}function St(e,n=Jt.Default){return Te(e,qn(n))}function qn(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Ds(e){const n=[];for(let t=0;t<e.length;t++){const i=Ct(e[t]);if(Array.isArray(i)){if(0===i.length)throw new Ee(900,!1);let r,l=Jt.Default;for(let d=0;d<i.length;d++){const f=i[d],b=bh(f);"number"==typeof b?-1===b?r=f.token:l|=b:r=f}n.push(Te(r,l))}else n.push(Te(i))}return n}function dr(e,n){return e[ea]=n,e.prototype[ea]=n,e}function bh(e){return e[ea]}function Ir(e){return{toString:e}.toString()}var ta=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(ta||{}),Qi=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Qi||{});const Ro={},on=[],ml=mn({\u0275cmp:mn}),Kc=mn({\u0275dir:mn}),gl=mn({\u0275pipe:mn}),Fo=mn({\u0275mod:mn}),fo=mn({\u0275fac:mn}),na=mn({__NG_ELEMENT_ID__:mn}),ad=mn({__NG_ENV_ID__:mn});function _l(e,n,t){let i=e.length;for(;;){const r=e.indexOf(n,t);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const l=n.length;if(r+l===i||e.charCodeAt(r+l)<=32)return r}t=r+1}}function Yc(e,n,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const l=t[i++],d=t[i++],f=t[i++];e.setAttribute(n,d,f,l)}else{const l=r,d=t[++i];yl(l)?e.setProperty(n,l,d):e.setAttribute(n,l,d),i++}}return i}function ld(e){return 3===e||4===e||6===e}function yl(e){return 64===e.charCodeAt(0)}function vl(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?t=r:0===t||Oo(e,t,r,null,-1===t||2===t?n[++i]:null)}}return e}function Oo(e,n,t,i,r){let l=0,d=e.length;if(-1===n)d=-1;else for(;l<e.length;){const f=e[l++];if("number"==typeof f){if(f===n){d=-1;break}if(f>n){d=l-1;break}}}for(;l<e.length;){const f=e[l];if("number"==typeof f)break;if(f===t){if(null===i)return void(null!==r&&(e[l+1]=r));if(i===e[l+1])return void(e[l+2]=r)}l++,null!==i&&l++,null!==r&&l++}-1!==d&&(e.splice(d,0,n),l=d+1),e.splice(l++,0,t),null!==i&&e.splice(l++,0,i),null!==r&&e.splice(l++,0,r)}const Qr="ng-template";function nc(e,n,t){let i=0,r=!0;for(;i<e.length;){let l=e[i++];if("string"==typeof l&&r){const d=e[i++];if(t&&"class"===l&&-1!==_l(d.toLowerCase(),n,0))return!0}else{if(1===l){for(;i<e.length&&"string"==typeof(l=e[i++]);)if(l.toLowerCase()===n)return!0;return!1}"number"==typeof l&&(r=!1)}}return!1}function ui(e){return 4===e.type&&e.value!==Qr}function ia(e,n,t){return n===(4!==e.type||t?e.value:Qr)}function jp(e,n,t){let i=4;const r=e.attrs||[],l=function ts(e){for(let n=0;n<e.length;n++)if(ld(e[n]))return n;return e.length}(r);let d=!1;for(let f=0;f<n.length;f++){const b=n[f];if("number"!=typeof b){if(!d)if(4&i){if(i=2|1&i,""!==b&&!ia(e,b,t)||""===b&&1===n.length){if(Lo(i))return!1;d=!0}}else{const E=8&i?b:n[++f];if(8&i&&null!==e.attrs){if(!nc(e.attrs,E,t)){if(Lo(i))return!1;d=!0}continue}const P=Hp(8&i?"class":b,r,ui(e),t);if(-1===P){if(Lo(i))return!1;d=!0;continue}if(""!==E){let U;U=P>l?"":r[P+1].toLowerCase();const $=8&i?U:null;if($&&-1!==_l($,E,0)||2&i&&E!==U){if(Lo(i))return!1;d=!0}}}}else{if(!d&&!Lo(i)&&!Lo(b))return!1;if(d&&Lo(b))continue;d=!1,i=b|1&i}}return Lo(i)||d}function Lo(e){return 0==(1&e)}function Hp(e,n,t,i){if(null===n)return-1;let r=0;if(i||!t){let l=!1;for(;r<n.length;){const d=n[r];if(d===e)return r;if(3===d||6===d)l=!0;else{if(1===d||2===d){let f=n[++r];for(;"string"==typeof f;)f=n[++r];continue}if(4===d)break;if(0===d){r+=4;continue}}r+=l?1:2}return-1}return function Je(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const i=e[t];if("number"==typeof i)return-1;if(i===n)return t;t++}return-1}(n,e)}function za(e,n,t=!1){for(let i=0;i<n.length;i++)if(jp(e,n[i],t))return!0;return!1}function Qc(e,n){e:for(let t=0;t<n.length;t++){const i=n[t];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function bl(e,n){return e?":not("+n.trim()+")":n}function Ss(e){let n=e[0],t=1,i=2,r="",l=!1;for(;t<e.length;){let d=e[t];if("string"==typeof d)if(2&i){const f=e[++t];r+="["+d+(f.length>0?'="'+f+'"':"")+"]"}else 8&i?r+="."+d:4&i&&(r+=" "+d);else""!==r&&!Lo(d)&&(n+=bl(l,r),r=""),i=d,l=l||!Lo(i);t++}return""!==r&&(n+=bl(l,r)),n}function Di(e){return Ir(()=>{const n=ud(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===ta.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Qi.Emulated,styles:e.styles||on,_:null,schemas:e.schemas||null,tView:null,id:""};tu(t);const i=e.dependencies;return t.directiveDefs=Va(i,!1),t.pipeDefs=Va(i,!0),t.id=function Ch(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of t)n=Math.imul(31,n)+r.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function Eh(e){return Kt(e)||Si(e)}function Jc(e){return null!==e}function di(e){return Ir(()=>({type:e.type,bootstrap:e.bootstrap||on,declarations:e.declarations||on,imports:e.imports||on,exports:e.exports||on,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function rc(e,n){if(null==e)return Ro;const t={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],l=r;Array.isArray(r)&&(l=r[1],r=r[0]),t[r]=i,n&&(n[r]=l)}return t}function mt(e){return Ir(()=>{const n=ud(e);return tu(n),n})}function Kt(e){return e[ml]||null}function Si(e){return e[Kc]||null}function Ii(e){return e[gl]||null}function ud(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Ro,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||on,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:rc(e.inputs,n),outputs:rc(e.outputs)}}function tu(e){e.features?.forEach(n=>n(e))}function Va(e,n){if(!e)return null;const t=n?Ii:Eh;return()=>("function"==typeof e?e():e).map(i=>t(i)).filter(Jc)}const cn=0,Le=1,Pt=2,Nn=3,mo=4,Is=5,Ji=6,ra=7,vn=8,No=9,et=10,Fe=11,Ms=12,nu=13,oa=14,sn=15,xl=16,Mr=17,ns=18,Jr=19,Yn=20,An=21,is=22,rs=23,sa=24,Gt=25,wl=1,aa=2,eo=7,ca=9,Qn=11;function er(e){return Array.isArray(e)&&"object"==typeof e[wl]}function hi(e){return Array.isArray(e)&&!0===e[wl]}function El(e){return 0!=(4&e.flags)}function As(e){return e.componentOffset>-1}function Ua(e){return 1==(1&e.flags)}function Ur(e){return!!e.template}function Cl(e){return 0!=(512&e[Pt])}function De(e,n){return e.hasOwnProperty(fo)?e[fo]:null}let Be=null,ot=!1;function gt(e){const n=Be;return Be=e,n}const He={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Ye(e){if(!Tr(e)||e.dirty){if(!e.producerMustRecompute(e)&&!pr(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function nn(e){e.dirty=!0,function tn(e){if(void 0===e.liveConsumerNode)return;const n=ot;ot=!0;try{for(const t of e.liveConsumerNode)t.dirty||nn(t)}finally{ot=n}}(e),e.consumerMarkedDirty?.(e)}function It(e){return e&&(e.nextProducerIndex=0),gt(e)}function Wn(e,n){if(gt(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Tr(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)fr(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function pr(e){mr(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],i=e.producerLastReadVersion[n];if(i!==t.version||(Ye(t),i!==t.version))return!0}return!1}function ii(e){if(mr(e),Tr(e))for(let n=0;n<e.producerNode.length;n++)fr(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function fr(e,n){if(function gr(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),mr(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)fr(e.producerNode[i],e.producerIndexOfThis[i]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[n],r=e.liveConsumerNode[n];mr(r),r.producerIndexOfThis[i]=n}}function Tr(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function mr(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let Ti=null;const Ih=()=>{},eg=(()=>({...He,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:Ih}))();class tg{constructor(n,t,i){this.previousValue=n,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Mh(e){return e.type.prototype.ngOnChanges&&(e.setInput=Gp),iv}function iv(){const e=Wp(this),n=e?.current;if(n){const t=e.previous;if(t===Ro)e.previous=n;else for(let i in n)t[i]=n[i];e.current=null,this.ngOnChanges(n)}}function Gp(e,n,t,i){const r=this.declaredInputs[t],l=Wp(e)||function ru(e,n){return e[qp]=n}(e,{previous:Ro,current:null}),d=l.current||(l.current={}),f=l.previous,b=f[r];d[r]=new tg(b&&b.currentValue,n,f===Ro),e[i]=n}const qp="__ngSimpleChanges__";function Wp(e){return e[qp]||null}const Bo=function(e,n,t){},gd="svg";function Hn(e){for(;Array.isArray(e);)e=e[cn];return e}function tr(e,n){return Hn(n[e])}function nr(e,n){return Hn(n[e.index])}function Qp(e,n){return e.data[n]}function zo(e,n){const t=n[e];return er(t)?t:t[cn]}function ja(e,n){return null==n?null:e[n]}function rg(e){e[Mr]=0}function Jp(e){1024&e[Pt]||(e[Pt]|=1024,Ah(e,1))}function ef(e){1024&e[Pt]&&(e[Pt]&=-1025,Ah(e,-1))}function Ah(e,n){let t=e[Nn];if(null===t)return;t[Is]+=n;let i=t;for(t=t[Nn];null!==t&&(1===n&&1===i[Is]||-1===n&&0===i[Is]);)t[Is]+=n,i=t,t=t[Nn]}const kt={lFrame:pf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function _d(){return kt.bindingsEnabled}function sc(){return null!==kt.skipHydrationRootTNode}function Pe(){return kt.lFrame.lView}function hn(){return kt.lFrame.tView}function vd(e){return kt.lFrame.contextLView=e,e[vn]}function bd(e){return kt.lFrame.contextLView=null,e}function ir(){let e=og();for(;null!==e&&64===e.type;)e=e.parent;return e}function og(){return kt.lFrame.currentTNode}function fa(e,n){const t=kt.lFrame;t.currentTNode=e,t.isParent=n}function ei(){return kt.lFrame.isParent}function su(){kt.lFrame.isParent=!1}function ga(){return kt.lFrame.bindingIndex++}function cv(e,n){const t=kt.lFrame;t.bindingIndex=t.bindingRootIndex=e,lc(n)}function lc(e){kt.lFrame.currentDirectiveIndex=e}function kh(){return kt.lFrame.currentQueryIndex}function uf(e){kt.lFrame.currentQueryIndex=e}function df(e){const n=e[Le];return 2===n.type?n.declTNode:1===n.type?e[Ji]:null}function Ph(e,n,t){if(t&Jt.SkipSelf){let r=n,l=e;for(;!(r=r.parent,null!==r||t&Jt.Host||(r=df(l),null===r||(l=l[oa],10&r.type))););if(null===r)return!1;n=r,e=l}const i=kt.lFrame=hf();return i.currentTNode=n,i.lView=e,!0}function wd(e){const n=hf(),t=e[Le];kt.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function hf(){const e=kt.lFrame,n=null===e?null:e.child;return null===n?pf(e):n}function pf(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function lg(){const e=kt.lFrame;return kt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const cg=lg;function ff(){const e=lg();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function to(){return kt.lFrame.selectedIndex}function Il(e){kt.lFrame.selectedIndex=e}function Bn(){const e=kt.lFrame;return Qp(e.tView,e.selectedIndex)}function mf(){kt.lFrame.currentNamespace=gd}let dg=!0;function Rh(){return dg}function Ml(e){dg=e}function au(e,n){for(let t=n.directiveStart,i=n.directiveEnd;t<i;t++){const l=e.data[t].type.prototype,{ngAfterContentInit:d,ngAfterContentChecked:f,ngAfterViewInit:b,ngAfterViewChecked:E,ngOnDestroy:T}=l;d&&(e.contentHooks??=[]).push(-t,d),f&&((e.contentHooks??=[]).push(t,f),(e.contentCheckHooks??=[]).push(t,f)),b&&(e.viewHooks??=[]).push(-t,b),E&&((e.viewHooks??=[]).push(t,E),(e.viewCheckHooks??=[]).push(t,E)),null!=T&&(e.destroyHooks??=[]).push(t,T)}}function Tl(e,n,t){hg(e,n,3,t)}function lu(e,n,t,i){(3&e[Pt])===t&&hg(e,n,t,i)}function _f(e,n){let t=e[Pt];(3&t)===n&&(t&=8191,t+=1,e[Pt]=t)}function hg(e,n,t,i){const l=i??-1,d=n.length-1;let f=0;for(let b=void 0!==i?65535&e[Mr]:0;b<d;b++)if("number"==typeof n[b+1]){if(f=n[b],null!=i&&f>=i)break}else n[b]<0&&(e[Mr]+=65536),(f<l||-1==l)&&(fv(e,t,n,b),e[Mr]=(4294901760&e[Mr])+b+2),b++}function yf(e,n){Bo(4,e,n);const t=gt(null);try{n.call(e)}finally{gt(t),Bo(5,e,n)}}function fv(e,n,t,i){const r=t[i]<0,l=t[i+1],f=e[r?-t[i]:t[i]];r?e[Pt]>>13<e[Mr]>>16&&(3&e[Pt])===n&&(e[Pt]+=8192,yf(f,l)):yf(f,l)}const _a=-1;class cu{constructor(n,t,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Fh(e){return e!==_a}function uu(e){return 32767&e}function Ed(e,n){let t=function fg(e){return e>>16}(e),i=n;for(;t>0;)i=i[oa],t--;return i}let du=!0;function Cd(e){const n=du;return du=e,n}const mg=255,gg=5;let _g=0;const ya={};function Al(e,n){const t=bf(e,n);if(-1!==t)return t;const i=n[Le];i.firstCreatePass&&(e.injectorIndex=n.length,bi(i.data,e),bi(n,null),bi(i.blueprint,null));const r=Dd(e,n),l=e.injectorIndex;if(Fh(r)){const d=uu(r),f=Ed(r,n),b=f[Le].data;for(let E=0;E<8;E++)n[l+E]=f[d+E]|b[d+E]}return n[l+8]=r,l}function bi(e,n){e.push(0,0,0,0,0,0,0,0,n)}function bf(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function Dd(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,i=null,r=n;for(;null!==r;){if(i=Ef(r),null===i)return _a;if(t++,r=r[oa],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return _a}function Oh(e,n,t){!function vv(e,n,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(na)&&(i=t[na]),null==i&&(i=t[na]=_g++);const r=i&mg;n.data[e+(r>>gg)]|=1<<r}(e,n,t)}function Lh(e,n,t){if(t&Jt.Optional||void 0!==e)return e;Qs()}function xf(e,n,t,i){if(t&Jt.Optional&&void 0===i&&(i=null),!(t&(Jt.Self|Jt.Host))){const r=e[No],l=Sr(void 0);try{return r?r.get(n,i,t&Jt.Optional):Xc(n,i,t&Jt.Optional)}finally{Sr(l)}}return Lh(i,0,t)}function wf(e,n,t,i=Jt.Default,r){if(null!==e){if(2048&n[Pt]&&!(i&Jt.Self)){const d=function fu(e,n,t,i,r){let l=e,d=n;for(;null!==l&&null!==d&&2048&d[Pt]&&!(512&d[Pt]);){const f=va(l,d,t,i|Jt.Self,ya);if(f!==ya)return f;let b=l.parent;if(!b){const E=d[Yn];if(E){const T=E.get(t,ya,i);if(T!==ya)return T}b=Ef(d),d=d[oa]}l=b}return r}(e,n,t,i,ya);if(d!==ya)return d}const l=va(e,n,t,i,ya);if(l!==ya)return l}return xf(n,t,i,r)}function va(e,n,t,i,r){const l=function bv(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(na)?e[na]:void 0;return"number"==typeof n?n>=0?n&mg:wv:n}(t);if("function"==typeof l){if(!Ph(n,e,i))return i&Jt.Host?Lh(r,0,i):xf(n,t,i,r);try{let d;if(d=l(i),null!=d||i&Jt.Optional)return d;Qs()}finally{cg()}}else if("number"==typeof l){let d=null,f=bf(e,n),b=_a,E=i&Jt.Host?n[sn][Ji]:null;for((-1===f||i&Jt.SkipSelf)&&(b=-1===f?Dd(e,n):n[f+8],b!==_a&&vg(i,!1)?(d=n[Le],f=uu(b),n=Ed(b,n)):f=-1);-1!==f;){const T=n[Le];if(yg(l,f,T.data)){const P=hu(f,n,t,d,i,E);if(P!==ya)return P}b=n[f+8],b!==_a&&vg(i,n[Le].data[f+8]===E)&&yg(l,f,n)?(d=T,f=uu(b),n=Ed(b,n)):f=-1}}return r}function hu(e,n,t,i,r,l){const d=n[Le],f=d.data[e+8],T=Sd(f,d,t,null==i?As(f)&&du:i!=d&&0!=(3&f.type),r&Jt.Host&&l===f);return null!==T?cc(n,d,T,f):ya}function Sd(e,n,t,i,r){const l=e.providerIndexes,d=n.data,f=1048575&l,b=e.directiveStart,T=l>>20,U=r?f+T:e.directiveEnd;for(let $=i?f:f+T;$<U;$++){const Q=d[$];if($<b&&t===Q||$>=b&&Q.type===t)return $}if(r){const $=d[b];if($&&Ur($)&&$.type===t)return b}return null}function cc(e,n,t,i){let r=e[t];const l=n.data;if(function mv(e){return e instanceof cu}(r)){const d=r;d.resolving&&function Hc(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new Ee(-200,`Circular dependency in DI detected for ${e}${t}`)}(function en(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Dt(e)}(l[t]));const f=Cd(d.canSeeViewProviders);d.resolving=!0;const E=d.injectImpl?Sr(d.injectImpl):null;Ph(e,i,Jt.Default);try{r=e[t]=d.factory(void 0,l,e,i),n.firstCreatePass&&t>=i.directiveStart&&function pv(e,n,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:l}=n.type.prototype;if(i){const d=Mh(n);(t.preOrderHooks??=[]).push(e,d),(t.preOrderCheckHooks??=[]).push(e,d)}r&&(t.preOrderHooks??=[]).push(0-e,r),l&&((t.preOrderHooks??=[]).push(e,l),(t.preOrderCheckHooks??=[]).push(e,l))}(t,l[t],n)}finally{null!==E&&Sr(E),Cd(f),d.resolving=!1,cg()}}return r}function yg(e,n,t){return!!(t[n+(e>>gg)]&1<<e)}function vg(e,n){return!(e&Jt.Self||e&Jt.Host&&n)}class no{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,i){return wf(this._tNode,this._lView,n,qn(i),t)}}function wv(){return new no(ir(),Pe())}function ki(e){return Ir(()=>{const n=e.prototype.constructor,t=n[fo]||pu(n),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const l=r[fo]||pu(r);if(l&&l!==t)return l;r=Object.getPrototypeOf(r)}return l=>new l})}function pu(e){return Uc(e)?()=>{const n=pu(Ct(e));return n&&n()}:De(e)}function Ef(e){const n=e[Le],t=n.type;return 2===t?n.declTNode:1===t?e[Ji]:null}function kl(e){return function En(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const l=t[r];if(ld(l))break;if(0===l)r+=2;else if("number"==typeof l)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(l===n)return t[r+1];r+=2}}}return null}(ir(),e)}const mu="__parameters__";function uc(e,n,t){return Ir(()=>{const i=function Nh(e){return function(...t){if(e){const i=e(...t);for(const r in i)this[r]=i[r]}}}(n);function r(...l){if(this instanceof r)return i.apply(this,l),this;const d=new r(...l);return f.annotation=d,f;function f(b,E,T){const P=b.hasOwnProperty(mu)?b[mu]:Object.defineProperty(b,mu,{value:[]})[mu];for(;P.length<=T;)P.push(null);return(P[T]=P[T]||[]).push(d),b}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function Rl(e,n){e.forEach(t=>Array.isArray(t)?Rl(t,n):n(t))}function Eg(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Vh(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function yu(e,n){const t=[];for(let i=0;i<e;i++)t.push(n);return t}function io(e,n,t){let i=vu(e,n);return i>=0?e[1|i]=t:(i=~i,function Fl(e,n,t,i){let r=e.length;if(r==n)e.push(t,i);else if(1===r)e.push(i,e[0]),e[0]=t;else{for(r--,e.push(e[r-1],e[r]);r>n;)e[r]=e[r-2],r--;e[n]=t,e[n+1]=i}}(e,i,n,t)),i}function Sf(e,n){const t=vu(e,n);if(t>=0)return e[1|t]}function vu(e,n){return function Uh(e,n,t){let i=0,r=e.length>>t;for(;r!==i;){const l=i+(r-i>>1),d=e[l<<t];if(n===d)return l<<t;d>n?r=l:i=l+1}return~(r<<t)}(e,n,1)}const hc=dr(uc("Optional"),8),Pd=dr(uc("SkipSelf"),4);function Zh(e){return 128==(128&e.flags)}var xa=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(xa||{});const Xh=new Map;let Vv=0;const Eu="__ngContext__";function ji(e,n){er(n)?(e[Eu]=n[Jr],function Nf(e){Xh.set(e[Jr],e)}(n)):e[Eu]=n}let C;function S(e,n){return C(e,n)}function R(e){const n=e[Nn];return hi(n)?n[Nn]:n}function V(e){return K(e[Ms])}function H(e){return K(e[mo])}function K(e){for(;null!==e&&!hi(e);)e=e[mo];return e}function W(e,n,t,i,r){if(null!=i){let l,d=!1;hi(i)?l=i:er(i)&&(d=!0,i=i[cn]);const f=Hn(i);0===e&&null!==t?null==r?xi(n,t,f):gn(n,t,f,r||null,!0):1===e&&null!==t?gn(n,t,f,r||null,!0):2===e?function Ri(e,n,t){const i=pi(e,n);i&&function _r(e,n,t,i){e.removeChild(n,t,i)}(e,i,n,t)}(n,f,d):3===e&&n.destroyNode(f),null!=l&&function Fs(e,n,t,i,r){const l=t[eo];l!==Hn(t)&&W(n,e,i,l,r);for(let f=Qn;f<t.length;f++){const b=t[f];wi(b[Le],b,e,n,i,l)}}(n,e,l,t,r)}}function he(e,n,t){return e.createElement(n,t)}function Ue(e,n){const t=e[ca],i=t.indexOf(n);ef(n),t.splice(i,1)}function Ze(e,n){if(e.length<=Qn)return;const t=Qn+n,i=e[t];if(i){const r=i[xl];null!==r&&r!==e&&Ue(r,i),n>0&&(e[t-1][mo]=i[mo]);const l=Vh(e,Qn+n);!function me(e,n){wi(e,n,n[Fe],2,null,null),n[cn]=null,n[Ji]=null}(i[Le],i);const d=l[ns];null!==d&&d.detachView(l[Le]),i[Nn]=null,i[mo]=null,i[Pt]&=-129}return i}function qe(e,n){if(!(256&n[Pt])){const t=n[Fe];n[rs]&&ii(n[rs]),n[sa]&&ii(n[sa]),t.destroyNode&&wi(e,n,t,3,null,null),function nt(e){let n=e[Ms];if(!n)return Re(e[Le],e);for(;n;){let t=null;if(er(n))t=n[Ms];else{const i=n[Qn];i&&(t=i)}if(!t){for(;n&&!n[mo]&&n!==e;)er(n)&&Re(n[Le],n),n=n[Nn];null===n&&(n=e),er(n)&&Re(n[Le],n),t=n&&n[mo]}n=t}}(n)}}function Re(e,n){if(!(256&n[Pt])){n[Pt]&=-129,n[Pt]|=256,function rt(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let i=0;i<t.length;i+=2){const r=n[t[i]];if(!(r instanceof cu)){const l=t[i+1];if(Array.isArray(l))for(let d=0;d<l.length;d+=2){const f=r[l[d]],b=l[d+1];Bo(4,f,b);try{b.call(f)}finally{Bo(5,f,b)}}else{Bo(4,r,l);try{l.call(r)}finally{Bo(5,r,l)}}}}}(e,n),function ht(e,n){const t=e.cleanup,i=n[ra];if(null!==t)for(let l=0;l<t.length-1;l+=2)if("string"==typeof t[l]){const d=t[l+3];d>=0?i[d]():i[-d].unsubscribe(),l+=2}else t[l].call(i[t[l+1]]);null!==i&&(n[ra]=null);const r=n[An];if(null!==r){n[An]=null;for(let l=0;l<r.length;l++)(0,r[l])()}}(e,n),1===n[Le].type&&n[Fe].destroy();const t=n[xl];if(null!==t&&hi(n[Nn])){t!==n[Nn]&&Ue(t,n);const i=n[ns];null!==i&&i.detachView(e)}!function Ng(e){Xh.delete(e[Jr])}(n)}}function zt(e,n,t){return function Pn(e,n,t){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return t[cn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:l}=e.data[i.directiveStart+r];if(l===Qi.None||l===Qi.Emulated)return null}return nr(i,t)}}(e,n.parent,t)}function gn(e,n,t,i,r){e.insertBefore(n,t,i,r)}function xi(e,n,t){e.appendChild(n,t)}function yo(e,n,t,i,r){null!==i?gn(e,n,t,i,r):xi(e,n,t)}function pi(e,n){return e.parentNode(n)}function vr(e,n,t){return fi(e,n,t)}let Hi,xr,tp,fi=function Hr(e,n,t){return 40&e.type?nr(e,t):null};function or(e,n,t,i){const r=zt(e,i,n),l=n[Fe],f=vr(i.parent||n[Ji],i,n);if(null!=r)if(Array.isArray(t))for(let b=0;b<t.length;b++)yo(l,r,t[b],f,!1);else yo(l,r,t,f,!1);void 0!==Hi&&Hi(l,i,n,t,r)}function sr(e,n){if(null!==n){const t=n.type;if(3&t)return nr(n,e);if(4&t)return Zn(-1,e[n.index]);if(8&t){const i=n.child;if(null!==i)return sr(e,i);{const r=e[n.index];return hi(r)?Zn(-1,r):Hn(r)}}if(32&t)return S(n,e)()||Hn(e[n.index]);{const i=$r(e,n);return null!==i?Array.isArray(i)?i[0]:sr(R(e[sn]),i):sr(e,n.next)}}return null}function $r(e,n){return null!==n?e[sn][Ji].projection[n.projection]:null}function Zn(e,n){const t=Qn+e+1;if(t<n.length){const i=n[t],r=i[Le].firstChild;if(null!==r)return sr(i,r)}return n[eo]}function Gr(e,n,t,i,r,l,d){for(;null!=t;){const f=i[t.index],b=t.type;if(d&&0===n&&(f&&ji(Hn(f),i),t.flags|=2),32!=(32&t.flags))if(8&b)Gr(e,n,t.child,i,r,l,!1),W(n,e,r,f,l);else if(32&b){const E=S(t,i);let T;for(;T=E();)W(n,e,r,T,l);W(n,e,r,f,l)}else 16&b?jo(e,n,i,t,r,l):W(n,e,r,f,l);t=d?t.projectionNext:t.next}}function wi(e,n,t,i,r,l){Gr(t,i,e.firstChild,n,r,l,!1)}function jo(e,n,t,i,r,l){const d=t[sn],b=d[Ji].projection[i.projection];if(Array.isArray(b))for(let E=0;E<b.length;E++)W(n,e,r,b[E],l);else{let E=b;const T=d[Nn];Zh(i)&&(E.flags|=128),Gr(e,n,E,T,r,l,!0)}}function Ho(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function vo(e,n,t){const{mergedAttrs:i,classes:r,styles:l}=t;null!==i&&Yc(e,n,i),null!==r&&Ho(e,n,r),null!==l&&function qa(e,n,t){e.setAttribute(n,"style",t)}(e,n,l)}function wa(e){return function Ls(){if(void 0===xr&&(xr=null,wn.trustedTypes))try{xr=wn.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return xr}()?.createHTML(e)||e}class gc{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Kl})`}}class jv extends gc{getTypeName(){return"HTML"}}class Hv extends gc{getTypeName(){return"Style"}}class $v extends gc{getTypeName(){return"Script"}}class Ns extends gc{getTypeName(){return"URL"}}class np extends gc{getTypeName(){return"ResourceURL"}}function bo(e){return e instanceof gc?e.changingThisBreaksApplicationSecurity:e}function ri(e,n){const t=function Ea(e){return e instanceof gc&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${Kl})`)}return t===n}class r2{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(wa(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class o2{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=wa(n),t}}const a2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function $g(e){return(e=String(e)).match(a2)?e:"unsafe:"+e}function yc(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function Uf(...e){const n={};for(const t of e)for(const i in t)t.hasOwnProperty(i)&&(n[i]=!0);return n}const g1=yc("area,br,col,hr,img,wbr"),_1=yc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),y1=yc("rp,rt"),Gv=Uf(g1,Uf(_1,yc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Uf(y1,yc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Uf(y1,_1)),qv=yc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),v1=Uf(qv,yc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),yc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),l2=yc("script,style,template");class c2{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!Gv.hasOwnProperty(t))return this.sanitizedSomething=!0,!l2.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=n.attributes;for(let r=0;r<i.length;r++){const l=i.item(r),d=l.name,f=d.toLowerCase();if(!v1.hasOwnProperty(f)){this.sanitizedSomething=!0;continue}let b=l.value;qv[f]&&(b=$g(b)),this.buf.push(" ",d,'="',b1(b),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();Gv.hasOwnProperty(t)&&!g1.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(b1(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const u2=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d2=/([^\#-~ |!])/g;function b1(e){return e.replace(/&/g,"&amp;").replace(u2,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(d2,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Gg;function x1(e,n){let t=null;try{Gg=Gg||function m1(e){const n=new o2(e);return function s2(){try{return!!(new window.DOMParser).parseFromString(wa(""),"text/html")}catch{return!1}}()?new r2(n):n}(e);let i=n?String(n):"";t=Gg.getInertBodyElement(i);let r=5,l=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=l,l=t.innerHTML,t=Gg.getInertBodyElement(i)}while(i!==l);return wa((new c2).sanitizeChildren(Wv(t)||t))}finally{if(t){const i=Wv(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Wv(e){return"content"in e&&function h2(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var ro=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(ro||{});const qg=new Oe("ENVIRONMENT_INITIALIZER"),C1=new Oe("INJECTOR",-1),D1=new Oe("INJECTOR_DEF_TYPES");class Zv{get(n,t=dn){if(t===dn){const i=new Error(`NullInjectorError: No provider for ${yi(n)}!`);throw i.name="NullInjectorError",i}return t}}function b2(...e){return{\u0275providers:S1(0,e),\u0275fromNgModule:!0}}function S1(e,...n){const t=[],i=new Set;let r;const l=d=>{t.push(d)};return Rl(n,d=>{const f=d;Wg(f,l,[],i)&&(r||=[],r.push(f))}),void 0!==r&&I1(r,l),t}function I1(e,n){for(let t=0;t<e.length;t++){const{ngModule:i,providers:r}=e[t];Kv(r,l=>{n(l,i)})}}function Wg(e,n,t,i){if(!(e=Ct(e)))return!1;let r=null,l=Es(e);const d=!l&&Kt(e);if(l||d){if(d&&!d.standalone)return!1;r=e}else{const b=e.ngModule;if(l=Es(b),!l)return!1;r=b}const f=i.has(r);if(d){if(f)return!1;if(i.add(r),d.dependencies){const b="function"==typeof d.dependencies?d.dependencies():d.dependencies;for(const E of b)Wg(E,n,t,i)}}else{if(!l)return!1;{if(null!=l.imports&&!f){let E;i.add(r);try{Rl(l.imports,T=>{Wg(T,n,t,i)&&(E||=[],E.push(T))})}finally{}void 0!==E&&I1(E,n)}if(!f){const E=De(r)||(()=>new r);n({provide:r,useFactory:E,deps:on},r),n({provide:D1,useValue:r,multi:!0},r),n({provide:qg,useValue:()=>Te(r),multi:!0},r)}const b=l.providers;if(null!=b&&!f){const E=e;Kv(b,T=>{n(T,E)})}}}return r!==e&&void 0!==e.providers}function Kv(e,n){for(let t of e)jc(t)&&(t=t.\u0275providers),Array.isArray(t)?Kv(t,n):n(t)}const x2=mn({provide:String,useValue:mn});function Yv(e){return null!==e&&"object"==typeof e&&x2 in e}function jd(e){return"function"==typeof e}const Qv=new Oe("Set Injector scope."),Zg={},E2={};let Jv;function Xg(){return void 0===Jv&&(Jv=new Zv),Jv}class vc{}class ip extends vc{get destroyed(){return this._destroyed}constructor(n,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,tb(n,d=>this.processProvider(d)),this.records.set(C1,rp(void 0,this)),r.has("environment")&&this.records.set(vc,rp(void 0,this));const l=this.records.get(Qv);null!=l&&"string"==typeof l.value&&this.scopes.add(l.value),this.injectorDefTypes=new Set(this.get(D1.multi,on,Jt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=es(this),i=Sr(void 0);try{return n()}finally{es(t),Sr(i)}}get(n,t=dn,i=Jt.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(ad))return n[ad](this);i=qn(i);const l=es(this),d=Sr(void 0);try{if(!(i&Jt.SkipSelf)){let b=this.records.get(n);if(void 0===b){const E=function M2(e){return"function"==typeof e||"object"==typeof e&&e instanceof Oe}(n)&&pl(n);b=E&&this.injectableDefInScope(E)?rp(eb(n),Zg):null,this.records.set(n,b)}if(null!=b)return this.hydrate(n,b)}return(i&Jt.Self?Xg():this.parent).get(n,t=i&Jt.Optional&&t===dn?null:t)}catch(f){if("NullInjectorError"===f.name){if((f[Jl]=f[Jl]||[]).unshift(yi(n)),l)throw f;return function sd(e,n,t,i){const r=e[Jl];throw n[ec]&&r.unshift(n[ec]),e.message=function xh(e,n,t,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=yi(n);if(Array.isArray(n))r=n.map(yi).join(" -> ");else if("object"==typeof n){let l=[];for(let d in n)if(n.hasOwnProperty(d)){let f=n[d];l.push(d+":"+("string"==typeof f?JSON.stringify(f):yi(f)))}r=`{${l.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${e.replace(Up,"\n  ")}`}("\n"+e.message,r,t,i),e.ngTokenPath=r,e[Jl]=null,e}(f,n,"R3InjectorError",this.source)}throw f}finally{Sr(d),es(l)}}resolveInjectorInitializers(){const n=es(this),t=Sr(void 0);try{const r=this.get(qg.multi,on,Jt.Self);for(const l of r)l()}finally{es(n),Sr(t)}}toString(){const n=[],t=this.records;for(const i of t.keys())n.push(yi(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ee(205,!1)}processProvider(n){let t=jd(n=Ct(n))?n:Ct(n&&n.provide);const i=function D2(e){return Yv(e)?rp(void 0,e.useValue):rp(A1(e),Zg)}(n);if(jd(n)||!0!==n.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=rp(void 0,Zg,!0),r.factory=()=>Ds(r.multi),this.records.set(t,r)),t=n,r.multi.push(n)}this.records.set(t,i)}hydrate(n,t){return t.value===Zg&&(t.value=E2,t.value=t.factory()),"object"==typeof t.value&&t.value&&function I2(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=Ct(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function eb(e){const n=pl(e),t=null!==n?n.factory:De(e);if(null!==t)return t;if(e instanceof Oe)throw new Ee(204,!1);if(e instanceof Function)return function C2(e){const n=e.length;if(n>0)throw yu(n,"?"),new Ee(204,!1);const t=function Qu(e){return e&&(e[Yl]||e[Zc])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new Ee(204,!1)}function A1(e,n,t){let i;if(jd(e)){const r=Ct(e);return De(r)||eb(r)}if(Yv(e))i=()=>Ct(e.useValue);else if(function T1(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...Ds(e.deps||[]));else if(function M1(e){return!(!e||!e.useExisting)}(e))i=()=>Te(Ct(e.useExisting));else{const r=Ct(e&&(e.useClass||e.provide));if(!function S2(e){return!!e.deps}(e))return De(r)||eb(r);i=()=>new r(...Ds(e.deps))}return i}function rp(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function tb(e,n){for(const t of e)Array.isArray(t)?tb(t,n):t&&jc(t)?tb(t.\u0275providers,n):n(t)}const Kg=new Oe("AppId",{providedIn:"root",factory:()=>T2}),T2="ng",k1=new Oe("Platform Initializer"),bc=new Oe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),xc=new Oe("AnimationModuleType"),nb=new Oe("CSP nonce",{providedIn:"root",factory:()=>function Nl(){if(void 0!==tp)return tp;if(typeof document<"u")return document;throw new Ee(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let P1=(e,n,t)=>null;function ub(e,n,t=!1){return P1(e,n,t)}class z2{}class O1{}class U2{resolveComponentFactory(n){throw function V2(e){const n=Error(`No component factory found for ${yi(e)}.`);return n.ngComponent=e,n}(n)}}let Gf=(()=>{class e{static#e=this.NULL=new U2}return e})();function j2(){return ap(ir(),Pe())}function ap(e,n){return new Rn(nr(e,n))}let Rn=(()=>{class e{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=j2}return e})();function H2(e){return e instanceof Rn?e.nativeElement:e}class qf{}let Hd=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function $2(){const e=Pe(),t=zo(ir().index,e);return(er(t)?t:e)[Fe]}()}return e})(),G2=(()=>{class e{static#e=this.\u0275prov=at({token:e,providedIn:"root",factory:()=>null})}return e})();class lp{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const q2=new lp("16.2.11"),pb={};function V1(e,n=null,t=null,i){const r=U1(e,n,t,i);return r.resolveInjectorInitializers(),r}function U1(e,n=null,t=null,i,r=new Set){const l=[t||on,b2(e)];return i=i||("object"==typeof e?void 0:yi(e)),new ip(l,n||Xg(),i||null,r)}let $o=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=dn;static#t=this.NULL=new Zv;static create(t,i){if(Array.isArray(t))return V1({name:""},i,t,"");{const r=t.name??"";return V1({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=at({token:e,providedIn:"any",factory:()=>Te(C1)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function mb(e){return e.ngOriginalError}class Ca{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&mb(n);for(;t&&mb(t);)t=mb(t);return t||null}}function _b(e){return n=>{setTimeout(e,void 0,n)}}const $n=class J2 extends Ft{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,i){let r=n,l=t||(()=>null),d=i;if(n&&"object"==typeof n){const b=n;r=b.next?.bind(b),l=b.error?.bind(b),d=b.complete?.bind(b)}this.__isAsync&&(l=_b(l),r&&(r=_b(r)),d&&(d=_b(d)));const f=super.subscribe({next:r,error:l,complete:d});return n instanceof Qt&&n.add(f),f}};function H1(...e){}class qt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $n(!1),this.onMicrotaskEmpty=new $n(!1),this.onStable=new $n(!1),this.onError=new $n(!1),typeof Zone>"u")throw new Ee(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function eP(){const e="function"==typeof wn.requestAnimationFrame;let n=wn[e?"requestAnimationFrame":"setTimeout"],t=wn[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function iP(e){const n=()=>{!function nP(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(wn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,vb(e),e.isCheckStableRunning=!0,yb(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),vb(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,l,d,f)=>{if(function oP(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(f))return t.invokeTask(r,l,d,f);try{return $1(e),t.invokeTask(r,l,d,f)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===l.type||e.shouldCoalesceRunChangeDetection)&&n(),G1(e)}},onInvoke:(t,i,r,l,d,f,b)=>{try{return $1(e),t.invoke(r,l,d,f,b)}finally{e.shouldCoalesceRunChangeDetection&&n(),G1(e)}},onHasTask:(t,i,r,l)=>{t.hasTask(r,l),i===r&&("microTask"==l.change?(e._hasPendingMicrotasks=l.microTask,vb(e),yb(e)):"macroTask"==l.change&&(e.hasPendingMacrotasks=l.macroTask))},onHandleError:(t,i,r,l)=>(t.handleError(r,l),e.runOutsideAngular(()=>e.onError.emit(l)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!qt.isInAngularZone())throw new Ee(909,!1)}static assertNotInAngularZone(){if(qt.isInAngularZone())throw new Ee(909,!1)}run(n,t,i){return this._inner.run(n,t,i)}runTask(n,t,i,r){const l=this._inner,d=l.scheduleEventTask("NgZoneEvent: "+r,n,tP,H1,H1);try{return l.runTask(d,t,i)}finally{l.cancelTask(d)}}runGuarded(n,t,i){return this._inner.runGuarded(n,t,i)}runOutsideAngular(n){return this._outer.run(n)}}const tP={};function yb(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function vb(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function $1(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function G1(e){e._nesting--,yb(e)}class rP{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new $n,this.onMicrotaskEmpty=new $n,this.onStable=new $n,this.onError=new $n}run(n,t,i){return n.apply(t,i)}runGuarded(n,t,i){return n.apply(t,i)}runOutsideAngular(n){return n()}runTask(n,t,i,r){return n.apply(t,i)}}const q1=new Oe("",{providedIn:"root",factory:W1});function W1(){const e=St(qt);let n=!0;return Vt(new _n(r=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(n),r.complete()})}),new _n(r=>{let l;e.runOutsideAngular(()=>{l=e.onStable.subscribe(()=>{qt.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,r.next(!0))})})});const d=e.onUnstable.subscribe(()=>{qt.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{l.unsubscribe(),d.unsubscribe()}}).pipe(ul()))}let bb=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=at({token:e,providedIn:"root",factory:()=>new e})}return e})();function Wf(e){for(;e;){e[Pt]|=64;const n=R(e);if(Cl(e)&&!n)return e;e=n}return null}const Q1=new Oe("",{providedIn:"root",factory:()=>!1});let i_=null;function nE(e,n){return e[n]??oE()}function iE(e,n){const t=oE();t.producerNode?.length&&(e[n]=i_,t.lView=e,i_=rE())}const mP={...He,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Wf(e.lView)},lView:null};function rE(){return Object.create(mP)}function oE(){return i_??=rE(),i_}const Ht={};function Fi(e){sE(hn(),Pe(),to()+e,!1)}function sE(e,n,t,i){if(!i)if(3==(3&n[Pt])){const l=e.preOrderCheckHooks;null!==l&&Tl(n,l,t)}else{const l=e.preOrderHooks;null!==l&&lu(n,l,0,t)}Il(t)}function ge(e,n=Jt.Default){const t=Pe();return null===t?Te(e,n):wf(ir(),t,Ct(e),n)}function xb(){throw new Error("invalid")}function r_(e,n,t,i,r,l,d,f,b,E,T){const P=n.blueprint.slice();return P[cn]=r,P[Pt]=140|i,(null!==E||e&&2048&e[Pt])&&(P[Pt]|=2048),rg(P),P[Nn]=P[oa]=e,P[vn]=t,P[et]=d||e&&e[et],P[Fe]=f||e&&e[Fe],P[No]=b||e&&e[No]||null,P[Ji]=l,P[Jr]=function Lg(){return Vv++}(),P[is]=T,P[Yn]=E,P[sn]=2==n.type?e[sn]:P,P}function dp(e,n,t,i,r){let l=e.data[n];if(null===l)l=function wb(e,n,t,i,r){const l=og(),d=ei(),b=e.data[n]=function EP(e,n,t,i,r,l){let d=n?n.injectorIndex:-1,f=0;return sc()&&(f|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:d,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:f,providerIndexes:0,value:r,attrs:l,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,d?l:l&&l.parent,t,n,i,r);return null===e.firstChild&&(e.firstChild=b),null!==l&&(d?null==l.child&&null!==b.parent&&(l.child=b):null===l.next&&(l.next=b,b.prev=l)),b}(e,n,t,i,r),function af(){return kt.lFrame.inI18n}()&&(l.flags|=32);else if(64&l.type){l.type=t,l.value=i,l.attrs=r;const d=function pa(){const e=kt.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();l.injectorIndex=null===d?-1:d.injectorIndex}return fa(l,!0),l}function Zf(e,n,t,i){if(0===t)return-1;const r=n.length;for(let l=0;l<t;l++)n.push(i),e.blueprint.push(i),e.data.push(null);return r}function aE(e,n,t,i,r){const l=nE(n,rs),d=to(),f=2&i;try{Il(-1),f&&n.length>Gt&&sE(e,n,Gt,!1),Bo(f?2:0,r);const E=f?l:null,T=It(E);try{null!==E&&(E.dirty=!1),t(i,r)}finally{Wn(E,T)}}finally{f&&null===n[rs]&&iE(n,rs),Il(d),Bo(f?3:1,r)}}function Eb(e,n,t){if(El(n)){const i=gt(null);try{const l=n.directiveEnd;for(let d=n.directiveStart;d<l;d++){const f=e.data[d];f.contentQueries&&f.contentQueries(1,t[d],d)}}finally{gt(i)}}}function Cb(e,n,t){_d()&&(function AP(e,n,t,i){const r=t.directiveStart,l=t.directiveEnd;As(t)&&function NP(e,n,t){const i=nr(n,e),r=lE(t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const f=o_(e,r_(e,r,null,d,i,n,null,e[et].rendererFactory.createRenderer(i,t),null,null,null));e[n.index]=f}(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||Al(t,n),ji(i,n);const d=t.initialInputs;for(let f=r;f<l;f++){const b=e.data[f],E=cc(n,e,f,t);ji(E,n),null!==d&&BP(0,f-r,E,b,0,d),Ur(b)&&(zo(t.index,n)[vn]=cc(n,e,f,t))}}(e,n,t,nr(t,n)),64==(64&t.flags)&&pE(e,n,t))}function Db(e,n,t=nr){const i=n.localNames;if(null!==i){let r=n.index+1;for(let l=0;l<i.length;l+=2){const d=i[l+1],f=-1===d?t(n,e):e[d];e[r++]=f}}}function lE(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=Sb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Sb(e,n,t,i,r,l,d,f,b,E,T){const P=Gt+i,U=P+r,$=function _P(e,n){const t=[];for(let i=0;i<n;i++)t.push(i<e?null:Ht);return t}(P,U),Q="function"==typeof E?E():E;return $[Le]={type:e,blueprint:$,template:t,queries:null,viewQuery:f,declTNode:n,data:$.slice().fill(null,P),bindingStartIndex:P,expandoStartIndex:U,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof l?l():l,pipeRegistry:"function"==typeof d?d():d,firstChild:null,schemas:b,consts:Q,incompleteFirstPass:!1,ssrId:T}}let cE=e=>null;function uE(e,n,t,i){for(let r in e)if(e.hasOwnProperty(r)){t=null===t?{}:t;const l=e[r];null===i?dE(t,n,r,l):i.hasOwnProperty(r)&&dE(t,n,i[r],l)}return t}function dE(e,n,t,i){e.hasOwnProperty(t)?e[t].push(n,i):e[t]=[n,i]}function Bs(e,n,t,i,r,l,d,f){const b=nr(n,t);let T,E=n.inputs;!f&&null!=E&&(T=E[i])?(kb(e,t,T,i,r),As(n)&&function SP(e,n){const t=zo(n,e);16&t[Pt]||(t[Pt]|=64)}(t,n.index)):3&n.type&&(i=function DP(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=d?d(r,n.value||"",i):r,l.setProperty(b,i,r))}function Ib(e,n,t,i){if(_d()){const r=null===i?null:{"":-1},l=function PP(e,n){const t=e.directiveRegistry;let i=null,r=null;if(t)for(let l=0;l<t.length;l++){const d=t[l];if(za(n,d.selectors,!1))if(i||(i=[]),Ur(d))if(null!==d.findHostDirectiveDefs){const f=[];r=r||new Map,d.findHostDirectiveDefs(d,f,r),i.unshift(...f,d),Mb(e,n,f.length)}else i.unshift(d),Mb(e,n,0);else r=r||new Map,d.findHostDirectiveDefs?.(d,i,r),i.push(d)}return null===i?null:[i,r]}(e,t);let d,f;null===l?d=f=null:[d,f]=l,null!==d&&hE(e,n,t,d,r,f),r&&function RP(e,n,t){if(n){const i=e.localNames=[];for(let r=0;r<n.length;r+=2){const l=t[n[r+1]];if(null==l)throw new Ee(-301,!1);i.push(n[r],l)}}}(t,i,r)}t.mergedAttrs=vl(t.mergedAttrs,t.attrs)}function hE(e,n,t,i,r,l){for(let E=0;E<i.length;E++)Oh(Al(t,n),e,i[E].type);!function OP(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,i.length);for(let E=0;E<i.length;E++){const T=i[E];T.providersResolver&&T.providersResolver(T)}let d=!1,f=!1,b=Zf(e,n,i.length,null);for(let E=0;E<i.length;E++){const T=i[E];t.mergedAttrs=vl(t.mergedAttrs,T.hostAttrs),LP(e,t,n,b,T),FP(b,T,r),null!==T.contentQueries&&(t.flags|=4),(null!==T.hostBindings||null!==T.hostAttrs||0!==T.hostVars)&&(t.flags|=64);const P=T.type.prototype;!d&&(P.ngOnChanges||P.ngOnInit||P.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),d=!0),!f&&(P.ngOnChanges||P.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),f=!0),b++}!function CP(e,n,t){const r=n.directiveEnd,l=e.data,d=n.attrs,f=[];let b=null,E=null;for(let T=n.directiveStart;T<r;T++){const P=l[T],U=t?t.get(P):null,Q=U?U.outputs:null;b=uE(P.inputs,T,b,U?U.inputs:null),E=uE(P.outputs,T,E,Q);const oe=null===b||null===d||ui(n)?null:zP(b,T,d);f.push(oe)}null!==b&&(b.hasOwnProperty("class")&&(n.flags|=8),b.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=f,n.inputs=b,n.outputs=E}(e,t,l)}function pE(e,n,t){const i=t.directiveStart,r=t.directiveEnd,l=t.index,d=function ag(){return kt.lFrame.currentDirectiveIndex}();try{Il(l);for(let f=i;f<r;f++){const b=e.data[f],E=n[f];lc(f),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&kP(b,E)}}finally{Il(-1),lc(d)}}function kP(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function Mb(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function FP(e,n,t){if(t){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)t[n.exportAs[i]]=e;Ur(n)&&(t[""]=e)}}function LP(e,n,t,i,r){e.data[i]=r;const l=r.factory||(r.factory=De(r.type)),d=new cu(l,Ur(r),ge);e.blueprint[i]=d,t[i]=d,function MP(e,n,t,i,r){const l=r.hostBindings;if(l){let d=e.hostBindingOpCodes;null===d&&(d=e.hostBindingOpCodes=[]);const f=~n.index;(function TP(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(d)!=f&&d.push(f),d.push(t,i,l)}}(e,n,i,Zf(e,t,r.hostVars,Ht),r)}function Bl(e,n,t,i,r,l){const d=nr(e,n);!function Tb(e,n,t,i,r,l,d){if(null==l)e.removeAttribute(n,r,t);else{const f=null==d?Dt(l):d(l,i||"",r);e.setAttribute(n,r,f,t)}}(n[Fe],d,l,e.value,t,i,r)}function BP(e,n,t,i,r,l){const d=l[n];if(null!==d)for(let f=0;f<d.length;)fE(i,t,d[f++],d[f++],d[f++])}function fE(e,n,t,i,r){const l=gt(null);try{const d=e.inputTransforms;null!==d&&d.hasOwnProperty(i)&&(r=d[i].call(n,r)),null!==e.setInput?e.setInput(n,r,t,i):n[i]=r}finally{gt(l)}}function zP(e,n,t){let i=null,r=0;for(;r<t.length;){const l=t[r];if(0!==l)if(5!==l){if("number"==typeof l)break;if(e.hasOwnProperty(l)){null===i&&(i=[]);const d=e[l];for(let f=0;f<d.length;f+=2)if(d[f]===n){i.push(l,d[f+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function mE(e,n,t,i){return[e,!0,!1,n,null,0,i,t,null,null,null]}function gE(e,n){const t=e.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const l=t[i+1];if(-1!==l){const d=e.data[l];uf(t[i]),d.contentQueries(2,n[l],l)}}}function o_(e,n){return e[Ms]?e[nu][mo]=n:e[Ms]=n,e[nu]=n,n}function Ab(e,n,t){uf(0);const i=gt(null);try{n(e,t)}finally{gt(i)}}function _E(e){return e[ra]||(e[ra]=[])}function yE(e){return e.cleanup||(e.cleanup=[])}function bE(e,n){const t=e[No],i=t?t.get(Ca,null):null;i&&i.handleError(n)}function kb(e,n,t,i,r){for(let l=0;l<t.length;){const d=t[l++],f=t[l++];fE(e.data[d],n[d],i,f,r)}}function VP(e,n){const t=zo(n,e),i=t[Le];!function UP(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(i,t);const r=t[cn];null!==r&&null===t[is]&&(t[is]=ub(r,t[No])),Pb(i,t,t[vn])}function Pb(e,n,t){wd(n);try{const i=e.viewQuery;null!==i&&Ab(1,i,t);const r=e.template;null!==r&&aE(e,n,r,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&gE(e,n),e.staticViewQueries&&Ab(2,e.viewQuery,t);const l=e.components;null!==l&&function jP(e,n){for(let t=0;t<n.length;t++)VP(e,n[t])}(n,l)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{n[Pt]&=-5,ff()}}let xE=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const l=typeof Zone>"u"?null:Zone.current,d=function Sh(e,n,t){const i=Object.create(eg);t&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=n;const r=d=>{i.cleanupFn=d};return i.ref={notify:()=>nn(i),run:()=>{if(i.dirty=!1,i.hasRun&&!pr(i))return;i.hasRun=!0;const d=It(i);try{i.cleanupFn(),i.cleanupFn=Ih,i.fn(r)}finally{Wn(i,d)}},cleanup:()=>i.cleanupFn()},i.ref}(t,E=>{this.all.has(E)&&this.queue.set(E,l)},r);let f;this.all.add(d),d.notify();const b=()=>{d.cleanup(),f?.(),this.all.delete(d),this.queue.delete(d)};return f=i?.onDestroy(b),{destroy:b}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=at({token:e,providedIn:"root",factory:()=>new e})}return e})();function s_(e,n,t){let i=t?e.styles:null,r=t?e.classes:null,l=0;if(null!==n)for(let d=0;d<n.length;d++){const f=n[d];"number"==typeof f?l=f:1==l?r=Wu(r,f):2==l&&(i=Wu(i,f+": "+n[++d]+";"))}t?e.styles=i:e.stylesWithoutHost=i,t?e.classes=r:e.classesWithoutHost=r}function Xf(e,n,t,i,r=!1){for(;null!==t;){const l=n[t.index];null!==l&&i.push(Hn(l)),hi(l)&&wE(l,i);const d=t.type;if(8&d)Xf(e,n,t.child,i);else if(32&d){const f=S(t,n);let b;for(;b=f();)i.push(b)}else if(16&d){const f=$r(n,t);if(Array.isArray(f))i.push(...f);else{const b=R(n[sn]);Xf(b[Le],b,f,i,!0)}}t=r?t.projectionNext:t.next}return i}function wE(e,n){for(let t=Qn;t<e.length;t++){const i=e[t],r=i[Le].firstChild;null!==r&&Xf(i[Le],i,r,n)}e[eo]!==e[cn]&&n.push(e[eo])}function a_(e,n,t,i=!0){const r=n[et],l=r.rendererFactory,d=r.afterRenderEventManager;l.begin?.(),d?.begin();try{EE(e,n,e.template,t)}catch(b){throw i&&bE(n,b),b}finally{l.end?.(),r.effectManager?.flush(),d?.end()}}function EE(e,n,t,i){const r=n[Pt];if(256!=(256&r)){n[et].effectManager?.flush(),wd(n);try{rg(n),function sf(e){return kt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&aE(e,n,t,2,i);const d=3==(3&r);if(d){const E=e.preOrderCheckHooks;null!==E&&Tl(n,E,null)}else{const E=e.preOrderHooks;null!==E&&lu(n,E,0,null),_f(n,0)}if(function GP(e){for(let n=V(e);null!==n;n=H(n)){if(!n[aa])continue;const t=n[ca];for(let i=0;i<t.length;i++){Jp(t[i])}}}(n),CE(n,2),null!==e.contentQueries&&gE(e,n),d){const E=e.contentCheckHooks;null!==E&&Tl(n,E)}else{const E=e.contentHooks;null!==E&&lu(n,E,1),_f(n,1)}!function gP(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const i=nE(n,sa);try{for(let r=0;r<t.length;r++){const l=t[r];if(l<0)Il(~l);else{const d=l,f=t[++r],b=t[++r];cv(f,d),i.dirty=!1;const E=It(i);try{b(2,n[d])}finally{Wn(i,E)}}}}finally{null===n[sa]&&iE(n,sa),Il(-1)}}(e,n);const f=e.components;null!==f&&SE(n,f,0);const b=e.viewQuery;if(null!==b&&Ab(2,b,i),d){const E=e.viewCheckHooks;null!==E&&Tl(n,E)}else{const E=e.viewHooks;null!==E&&lu(n,E,2),_f(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[Pt]&=-73,ef(n)}finally{ff()}}}function CE(e,n){for(let t=V(e);null!==t;t=H(t))for(let i=Qn;i<t.length;i++)DE(t[i],n)}function qP(e,n,t){DE(zo(n,e),t)}function DE(e,n){if(!function ng(e){return 128==(128&e[Pt])}(e))return;const t=e[Le],i=e[Pt];if(80&i&&0===n||1024&i||2===n)EE(t,e,t.template,e[vn]);else if(e[Is]>0){CE(e,1);const r=t.components;null!==r&&SE(e,r,1)}}function SE(e,n,t){for(let i=0;i<n.length;i++)qP(e,n[i],t)}class Kf{get rootNodes(){const n=this._lView,t=n[Le];return Xf(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[vn]}set context(n){this._lView[vn]=n}get destroyed(){return 256==(256&this._lView[Pt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Nn];if(hi(n)){const t=n[8],i=t?t.indexOf(this):-1;i>-1&&(Ze(n,i),Vh(t,i))}this._attachedToViewContainer=!1}qe(this._lView[Le],this._lView)}onDestroy(n){!function ou(e,n){if(256==(256&e[Pt]))throw new Ee(911,!1);null===e[An]&&(e[An]=[]),e[An].push(n)}(this._lView,n)}markForCheck(){Wf(this._cdRefInjectingView||this._lView)}detach(){this._lView[Pt]&=-129}reattach(){this._lView[Pt]|=128}detectChanges(){a_(this._lView[Le],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Qe(e,n){wi(e,n,n[Fe],2,null,null)}(this._lView[Le],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Ee(902,!1);this._appRef=n}}class WP extends Kf{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;a_(n[Le],n,n[vn],!1)}checkNoChanges(){}get context(){return null}}class IE extends Gf{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=Kt(n);return new Yf(t,this.ngModule)}}function ME(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class XP{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,i){i=qn(i);const r=this.injector.get(n,pb,i);return r!==pb||t===pb?r:this.parentInjector.get(n,t,i)}}class Yf extends O1{get inputs(){const n=this.componentDef,t=n.inputTransforms,i=ME(n.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return ME(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function wh(e){return e.map(Ss).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,i,r){let l=(r=r||this.ngModule)instanceof vc?r:r?.injector;l&&null!==this.componentDef.getStandaloneInjector&&(l=this.componentDef.getStandaloneInjector(l)||l);const d=l?new XP(n,l):n,f=d.get(qf,null);if(null===f)throw new Ee(407,!1);const P={rendererFactory:f,sanitizer:d.get(G2,null),effectManager:d.get(xE,null),afterRenderEventManager:d.get(bb,null)},U=f.createRenderer(null,this.componentDef),$=this.componentDef.selectors[0][0]||"div",Q=i?function yP(e,n,t,i){const l=i.get(Q1,!1)||t===Qi.ShadowDom,d=e.selectRootElement(n,l);return function vP(e){cE(e)}(d),d}(U,i,this.componentDef.encapsulation,d):he(U,$,function ZP(e){const n=e.toLowerCase();return"svg"===n?gd:"math"===n?"math":null}($)),Me=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let ve=null;null!==Q&&(ve=ub(Q,d,!0));const it=Sb(0,null,null,1,0,null,null,null,null,null,null),st=r_(null,it,null,Me,null,null,P,U,d,null,ve);let jt,Xn;wd(st);try{const ai=this.componentDef;let lo,Hs=null;ai.findHostDirectiveDefs?(lo=[],Hs=new Map,ai.findHostDirectiveDefs(ai,lo,Hs),lo.push(ai)):lo=[ai];const il=function YP(e,n){const t=e[Le],i=Gt;return e[i]=n,dp(t,i,2,"#host",null)}(st,Q),tv=function QP(e,n,t,i,r,l,d){const f=r[Le];!function JP(e,n,t,i){for(const r of e)n.mergedAttrs=vl(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(s_(n,n.mergedAttrs,!0),null!==t&&vo(i,t,n))}(i,e,n,d);let b=null;null!==n&&(b=ub(n,r[No]));const E=l.rendererFactory.createRenderer(n,t);let T=16;t.signals?T=4096:t.onPush&&(T=64);const P=r_(r,lE(t),null,T,r[e.index],e,l,E,null,null,b);return f.firstCreatePass&&Mb(f,e,i.length-1),o_(r,P),r[e.index]=P}(il,Q,ai,lo,st,P,U);Xn=Qp(it,Gt),Q&&function tR(e,n,t,i){if(i)Yc(e,t,["ng-version",q2.full]);else{const{attrs:r,classes:l}=function Xe(e){const n=[],t=[];let i=1,r=2;for(;i<e.length;){let l=e[i];if("string"==typeof l)2===r?""!==l&&n.push(l,e[++i]):8===r&&t.push(l);else{if(!Lo(r))break;r=l}i++}return{attrs:n,classes:t}}(n.selectors[0]);r&&Yc(e,t,r),l&&l.length>0&&Ho(e,t,l.join(" "))}}(U,ai,Q,i),void 0!==t&&function nR(e,n,t){const i=e.projection=[];for(let r=0;r<n.length;r++){const l=t[r];i.push(null!=l?Array.from(l):null)}}(Xn,this.ngContentSelectors,t),jt=function eR(e,n,t,i,r,l){const d=ir(),f=r[Le],b=nr(d,r);hE(f,r,d,t,null,i);for(let T=0;T<t.length;T++)ji(cc(r,f,d.directiveStart+T,d),r);pE(f,r,d),b&&ji(b,r);const E=cc(r,f,d.directiveStart+d.componentOffset,d);if(e[vn]=r[vn]=E,null!==l)for(const T of l)T(E,n);return Eb(f,d,e),E}(tv,ai,lo,Hs,st,[iR]),Pb(it,st,null)}finally{ff()}return new KP(this.componentType,jt,ap(Xn,st),st,Xn)}}class KP extends z2{constructor(n,t,i,r,l){super(),this.location=i,this._rootLView=r,this._tNode=l,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new WP(r),this.componentType=n}setInput(n,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const l=this._rootLView;kb(l[Le],l,r,n,t),this.previousInputValues.set(n,t),Wf(zo(this._tNode.index,l))}}get injector(){return new no(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function iR(){const e=ir();au(Pe()[Le],e)}function Ot(e){let n=function TE(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const i=[e];for(;n;){let r;if(Ur(e))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Ee(903,!1);r=n.\u0275dir}if(r){if(t){i.push(r);const d=e;d.inputs=l_(e.inputs),d.inputTransforms=l_(e.inputTransforms),d.declaredInputs=l_(e.declaredInputs),d.outputs=l_(e.outputs);const f=r.hostBindings;f&&aR(e,f);const b=r.viewQuery,E=r.contentQueries;if(b&&oR(e,b),E&&sR(e,E),Vc(e.inputs,r.inputs),Vc(e.declaredInputs,r.declaredInputs),Vc(e.outputs,r.outputs),null!==r.inputTransforms&&(null===d.inputTransforms&&(d.inputTransforms={}),Vc(d.inputTransforms,r.inputTransforms)),Ur(r)&&r.data.animation){const T=e.data;T.animation=(T.animation||[]).concat(r.data.animation)}}const l=r.features;if(l)for(let d=0;d<l.length;d++){const f=l[d];f&&f.ngInherit&&f(e),f===Ot&&(t=!1)}}n=Object.getPrototypeOf(n)}!function rR(e){let n=0,t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=n+=r.hostVars,r.hostAttrs=vl(r.hostAttrs,t=vl(t,r.hostAttrs))}}(i)}function l_(e){return e===Ro?{}:e===on?[]:e}function oR(e,n){const t=e.viewQuery;e.viewQuery=t?(i,r)=>{n(i,r),t(i,r)}:n}function sR(e,n){const t=e.contentQueries;e.contentQueries=t?(i,r,l)=>{n(i,r,l),t(i,r,l)}:n}function aR(e,n){const t=e.hostBindings;e.hostBindings=t?(i,r)=>{n(i,r),t(i,r)}:n}function c_(e){return!!Rb(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function Rb(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function xo(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function ti(e,n,t,i){const r=Pe();return xo(r,ga(),n)&&(hn(),Bl(Bn(),r,e,n,t,i)),ti}function ss(e,n,t,i,r,l,d,f){const b=Pe(),E=hn(),T=e+Gt,P=E.firstCreatePass?function RR(e,n,t,i,r,l,d,f,b){const E=n.consts,T=dp(n,e,4,d||null,ja(E,f));Ib(n,t,T,ja(E,b)),au(n,T);const P=T.tView=Sb(2,T,i,r,l,n.directiveRegistry,n.pipeRegistry,null,n.schemas,E,null);return null!==n.queries&&(n.queries.template(n,T),P.queries=n.queries.embeddedTView(T)),T}(T,E,b,n,t,i,r,l,d):E.data[T];fa(P,!1);const U=GE(E,b,P,e);Rh()&&or(E,b,U,P),ji(U,b),o_(b,b[T]=mE(U,b,U,P)),Ua(P)&&Cb(E,b,P),null!=d&&Db(b,P,f)}let GE=function qE(e,n,t,i){return Ml(!0),n[Fe].createComment("")};function $i(e,n,t){const i=Pe();return xo(i,ga(),n)&&Bs(hn(),Bn(),i,e,n,i[Fe],t,!1),$i}function Vb(e,n,t,i,r){const d=r?"class":"style";kb(e,t,n.inputs[d],d,i)}function Yt(e,n,t,i){const r=Pe(),l=hn(),d=Gt+e,f=r[Fe],b=l.firstCreatePass?function NR(e,n,t,i,r,l){const d=n.consts,b=dp(n,e,2,i,ja(d,r));return Ib(n,t,b,ja(d,l)),null!==b.attrs&&s_(b,b.attrs,!1),null!==b.mergedAttrs&&s_(b,b.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,b),b}(d,l,r,n,t,i):l.data[d],E=WE(l,r,b,f,n,e);r[d]=E;const T=Ua(b);return fa(b,!0),vo(f,E,b),32!=(32&b.flags)&&Rh()&&or(l,r,E,b),0===function rv(){return kt.lFrame.elementDepthCount}()&&ji(E,r),function ov(){kt.lFrame.elementDepthCount++}(),T&&(Cb(l,r,b),Eb(l,b,r)),null!==i&&Db(r,b),Yt}function bn(){let e=ir();ei()?su():(e=e.parent,fa(e,!1));const n=e;(function ac(e){return kt.skipHydrationRootTNode===e})(n)&&function lv(){kt.skipHydrationRootTNode=null}(),function nf(){kt.lFrame.elementDepthCount--}();const t=hn();return t.firstCreatePass&&(au(t,e),El(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function gv(e){return 0!=(8&e.flags)}(n)&&Vb(t,n,Pe(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function _v(e){return 0!=(16&e.flags)}(n)&&Vb(t,n,Pe(),n.stylesWithoutHost,!1),bn}function wr(e,n,t,i){return Yt(e,n,t,i),bn(),wr}let WE=(e,n,t,i,r,l)=>(Ml(!0),he(i,r,function gf(){return kt.lFrame.currentNamespace}()));function f_(e){return!!e&&"function"==typeof e.then}function YE(e){return!!e&&"function"==typeof e.subscribe}function Gi(e,n,t,i){const r=Pe(),l=hn(),d=ir();return function JE(e,n,t,i,r,l,d){const f=Ua(i),E=e.firstCreatePass&&yE(e),T=n[vn],P=_E(n);let U=!0;if(3&i.type||d){const oe=nr(i,n),_e=d?d(oe):oe,Me=P.length,ve=d?st=>d(Hn(st[i.index])):i.index;let it=null;if(!d&&f&&(it=function HR(e,n,t,i){const r=e.cleanup;if(null!=r)for(let l=0;l<r.length-1;l+=2){const d=r[l];if(d===t&&r[l+1]===i){const f=n[ra],b=r[l+2];return f.length>b?f[b]:null}"string"==typeof d&&(l+=2)}return null}(e,n,r,i.index)),null!==it)(it.__ngLastListenerFn__||it).__ngNextListenerFn__=l,it.__ngLastListenerFn__=l,U=!1;else{l=tC(i,n,T,l,!1);const st=t.listen(_e,r,l);P.push(l,st),E&&E.push(r,ve,Me,Me+1)}}else l=tC(i,n,T,l,!1);const $=i.outputs;let Q;if(U&&null!==$&&(Q=$[r])){const oe=Q.length;if(oe)for(let _e=0;_e<oe;_e+=2){const jt=n[Q[_e]][Q[_e+1]].subscribe(l),Xn=P.length;P.push(l,jt),E&&E.push(r,i.index,Xn,-(Xn+1))}}}(l,r,r[Fe],d,e,n,i),Gi}function eC(e,n,t,i){try{return Bo(6,n,t),!1!==t(i)}catch(r){return bE(e,r),!1}finally{Bo(7,n,t)}}function tC(e,n,t,i,r){return function l(d){if(d===Function)return i;Wf(e.componentOffset>-1?zo(e.index,n):n);let b=eC(n,t,i,d),E=l.__ngNextListenerFn__;for(;E;)b=eC(n,t,E,d)&&b,E=E.__ngNextListenerFn__;return r&&!1===b&&d.preventDefault(),b}}function Gd(e=1){return function uv(e){return(kt.lFrame.contextLView=function Sl(e,n){for(;e>0;)n=n[oa],e--;return n}(e,kt.lFrame.contextLView))[vn]}(e)}function $R(e,n){let t=null;const i=function ic(e){const n=e.attrs;if(null!=n){const t=n.indexOf(5);if(!(1&t))return n[t+1]}return null}(e);for(let r=0;r<n.length;r++){const l=n[r];if("*"!==l){if(null===i?za(e,l,!0):Qc(i,l))return r}else t=r}return t}function zs(e){const n=Pe()[sn][Ji];if(!n.projection){const i=n.projection=yu(e?e.length:1,null),r=i.slice();let l=n.child;for(;null!==l;){const d=e?$R(l,e):0;null!==d&&(r[d]?r[d].projectionNext=l:i[d]=l,r[d]=l),l=l.next}}}function Ei(e,n=0,t){const i=Pe(),r=hn(),l=dp(r,Gt+e,16,null,t||null);null===l.projection&&(l.projection=n),su(),(!i[is]||sc())&&32!=(32&l.flags)&&function Pr(e,n,t){jo(n[Fe],0,n,t,zt(e,t,n),vr(t.parent||n[Ji],t,n))}(r,i,l)}function m_(e,n){return e<<17|n<<2}function Cu(e){return e>>17&32767}function jb(e){return 2|e}function qd(e){return(131068&e)>>2}function Hb(e,n){return-131069&e|n<<2}function $b(e){return 1|e}function dC(e,n,t,i,r){const l=e[t+1],d=null===n;let f=i?Cu(l):qd(l),b=!1;for(;0!==f&&(!1===b||d);){const T=e[f+1];KR(e[f],n)&&(b=!0,e[f+1]=i?$b(T):jb(T)),f=i?Cu(T):qd(T)}b&&(e[t+1]=i?jb(l):$b(l))}function KR(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&vu(e,n)>=0}function oo(e,n){return function Za(e,n,t,i){const r=Pe(),l=hn(),d=function Rs(e){const n=kt.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}(2);l.firstUpdatePass&&function bC(e,n,t,i){const r=e.data;if(null===r[t+1]){const l=r[to()],d=function vC(e,n){return n>=e.expandoStartIndex}(e,t);(function CC(e,n){return 0!=(e.flags&(n?8:16))})(l,i)&&null===n&&!d&&(n=!1),n=function oF(e,n,t,i){const r=function cf(e){const n=kt.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}(e);let l=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(t=nm(t=Gb(null,e,n,t,i),n.attrs,i),l=null);else{const d=n.directiveStylingLast;if(-1===d||e[d]!==r)if(t=Gb(r,e,n,t,i),null===l){let b=function sF(e,n,t){const i=t?n.classBindings:n.styleBindings;if(0!==qd(i))return e[Cu(i)]}(e,n,i);void 0!==b&&Array.isArray(b)&&(b=Gb(null,e,n,b[1],i),b=nm(b,n.attrs,i),function aF(e,n,t,i){e[Cu(t?n.classBindings:n.styleBindings)]=i}(e,n,i,b))}else l=function lF(e,n,t){let i;const r=n.directiveEnd;for(let l=1+n.directiveStylingLast;l<r;l++)i=nm(i,e[l].hostAttrs,t);return nm(i,n.attrs,t)}(e,n,i)}return void 0!==l&&(i?n.residualClasses=l:n.residualStyles=l),t}(r,l,n,i),function ZR(e,n,t,i,r,l){let d=l?n.classBindings:n.styleBindings,f=Cu(d),b=qd(d);e[i]=t;let T,E=!1;if(Array.isArray(t)?(T=t[1],(null===T||vu(t,T)>0)&&(E=!0)):T=t,r)if(0!==b){const U=Cu(e[f+1]);e[i+1]=m_(U,f),0!==U&&(e[U+1]=Hb(e[U+1],i)),e[f+1]=function qR(e,n){return 131071&e|n<<17}(e[f+1],i)}else e[i+1]=m_(f,0),0!==f&&(e[f+1]=Hb(e[f+1],i)),f=i;else e[i+1]=m_(b,0),0===f?f=i:e[b+1]=Hb(e[b+1],i),b=i;E&&(e[i+1]=jb(e[i+1])),dC(e,T,i,!0),dC(e,T,i,!1),function XR(e,n,t,i,r){const l=r?e.residualClasses:e.residualStyles;null!=l&&"string"==typeof n&&vu(l,n)>=0&&(t[i+1]=$b(t[i+1]))}(n,T,e,i,l),d=m_(f,b),l?n.classBindings=d:n.styleBindings=d}(r,l,n,t,d,i)}}(l,e,d,i),n!==Ht&&xo(r,d,n)&&function wC(e,n,t,i,r,l,d,f){if(!(3&n.type))return;const b=e.data,E=b[f+1],T=function WR(e){return 1==(1&e)}(E)?EC(b,n,t,r,qd(E),d):void 0;g_(T)||(g_(l)||function GR(e){return 2==(2&e)}(E)&&(l=EC(b,null,t,r,f,d)),function Os(e,n,t,i,r){if(n)r?e.addClass(t,i):e.removeClass(t,i);else{let l=-1===i.indexOf("-")?void 0:xa.DashCase;null==r?e.removeStyle(t,i,l):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),l|=xa.Important),e.setStyle(t,i,r,l))}}(i,d,tr(to(),t),r,l))}(l,l.data[to()],r,r[Fe],e,r[d+1]=function hF(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=yi(bo(e)))),e}(n,t),i,d)}(e,n,null,!0),oo}function Gb(e,n,t,i,r){let l=null;const d=t.directiveEnd;let f=t.directiveStylingLast;for(-1===f?f=t.directiveStart:f++;f<d&&(l=n[f],i=nm(i,l.hostAttrs,r),l!==e);)f++;return null!==e&&(t.directiveStylingLast=f),i}function nm(e,n,t){const i=t?1:2;let r=-1;if(null!==n)for(let l=0;l<n.length;l++){const d=n[l];"number"==typeof d?r=d:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),io(e,d,!!t||n[++l]))}return void 0===e?null:e}function EC(e,n,t,i,r,l){const d=null===n;let f;for(;r>0;){const b=e[r],E=Array.isArray(b),T=E?b[1]:b,P=null===T;let U=t[r+1];U===Ht&&(U=P?on:void 0);let $=P?Sf(U,i):T===i?U:void 0;if(E&&!g_($)&&($=Sf(b,i)),g_($)&&(f=$,d))return f;const Q=e[r+1];r=d?Cu(Q):qd(Q)}if(null!==n){let b=l?n.residualClasses:n.residualStyles;null!=b&&(f=Sf(b,i))}return f}function g_(e){return void 0!==e}function as(e,n=""){const t=Pe(),i=hn(),r=e+Gt,l=i.firstCreatePass?dp(i,r,1,n,null):i.data[r],d=DC(i,t,l,n,e);t[r]=d,Rh()&&or(i,t,d,l),fa(l,!1)}let DC=(e,n,t,i,r)=>(Ml(!0),function se(e,n){return e.createText(n)}(n[Fe],i));function im(e){return __("",e,""),im}function __(e,n,t){const i=Pe(),r=function pp(e,n,t,i){return xo(e,ga(),t)?n+Dt(t)+i:Ht}(i,e,n,t);return r!==Ht&&function Ec(e,n,t){const i=tr(n,e);!function ue(e,n,t){e.setValue(n,t)}(e[Fe],i,t)}(i,to(),r),__}function Du(e,n,t){const i=Pe();return xo(i,ga(),n)&&Bs(hn(),Bn(),i,e,n,i[Fe],t,!0),Du}const Dp="en-US";let qC=Dp;function Zb(e,n,t,i,r){if(e=Ct(e),Array.isArray(e))for(let l=0;l<e.length;l++)Zb(e[l],n,t,i,r);else{const l=hn(),d=Pe(),f=ir();let b=jd(e)?e:Ct(e.provide);const E=A1(e),T=1048575&f.providerIndexes,P=f.directiveStart,U=f.providerIndexes>>20;if(jd(e)||!e.multi){const $=new cu(E,r,ge),Q=Kb(b,n,r?T:T+U,P);-1===Q?(Oh(Al(f,d),l,b),Xb(l,e,n.length),n.push(b),f.directiveStart++,f.directiveEnd++,r&&(f.providerIndexes+=1048576),t.push($),d.push($)):(t[Q]=$,d[Q]=$)}else{const $=Kb(b,n,T+U,P),Q=Kb(b,n,T,T+U),_e=Q>=0&&t[Q];if(r&&!_e||!r&&!($>=0&&t[$])){Oh(Al(f,d),l,b);const Me=function RO(e,n,t,i,r){const l=new cu(e,t,ge);return l.multi=[],l.index=n,l.componentProviders=0,_D(l,r,i&&!t),l}(r?PO:kO,t.length,r,i,E);!r&&_e&&(t[Q].providerFactory=Me),Xb(l,e,n.length,0),n.push(b),f.directiveStart++,f.directiveEnd++,r&&(f.providerIndexes+=1048576),t.push(Me),d.push(Me)}else Xb(l,e,$>-1?$:Q,_D(t[r?Q:$],E,!r&&i));!r&&i&&_e&&t[Q].componentProviders++}}}function Xb(e,n,t,i){const r=jd(n),l=function w2(e){return!!e.useClass}(n);if(r||l){const b=(l?Ct(n.useClass):n).prototype.ngOnDestroy;if(b){const E=e.destroyHooks||(e.destroyHooks=[]);if(!r&&n.multi){const T=E.indexOf(t);-1===T?E.push(t,[i,b]):E[T+1].push(i,b)}else E.push(t,b)}}}function _D(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function Kb(e,n,t,i){for(let r=t;r<i;r++)if(n[r]===e)return r;return-1}function kO(e,n,t,i){return Yb(this.multi,[])}function PO(e,n,t,i){const r=this.multi;let l;if(this.providerFactory){const d=this.providerFactory.componentProviders,f=cc(t,t[Le],this.providerFactory.index,i);l=f.slice(0,d),Yb(r,l);for(let b=d;b<f.length;b++)l.push(f[b])}else l=[],Yb(r,l);return l}function Yb(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Cn(e,n=[]){return t=>{t.providersResolver=(i,r)=>function AO(e,n,t){const i=hn();if(i.firstCreatePass){const r=Ur(e);Zb(t,i.data,i.blueprint,r,!0),Zb(n,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,n)}}class Zd{}class FO{}class Qb extends Zd{constructor(n,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new IE(this);const r=function vi(e,n){const t=e[Fo]||null;if(!t&&!0===n)throw new Error(`Type ${yi(e)} does not have '\u0275mod' property.`);return t}(n);this._bootstrapComponents=function wc(e){return e instanceof Function?e():e}(r.bootstrap),this._r3Injector=U1(n,t,[{provide:Zd,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver},...i],yi(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class Jb extends FO{constructor(n){super(),this.moduleType=n}create(n){return new Qb(this.moduleType,n,[])}}class yD extends Zd{constructor(n){super(),this.componentFactoryResolver=new IE(this),this.instance=null;const t=new ip([...n.providers,{provide:Zd,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver}],n.parent||Xg(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}let BO=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=S1(0,t.type),r=i.length>0?function NO(e,n,t=null){return new yD({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=at({token:e,providedIn:"environment",factory:()=>new e(Te(vc))})}return e})();function vD(e){e.getStandaloneInjector=n=>n.get(BO).getOrCreateStandaloneInjector(e)}function uL(){return this._results[Symbol.iterator]()}class Xd{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new $n)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Xd.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=uL)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const i=this;i.dirty=!1;const r=function _o(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function wg(e,n,t){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],l=n[i];if(t&&(r=t(r),l=t(l)),l!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function hL(e,n,t,i=!0){const r=n[Le];if(function Ke(e,n,t,i){const r=Qn+i,l=t.length;i>0&&(t[r-1][mo]=n),i<l-Qn?(n[mo]=t[r],Eg(t,Qn+i,n)):(t.push(n),n[mo]=null),n[Nn]=t;const d=n[xl];null!==d&&t!==d&&function Ge(e,n){const t=e[ca];n[sn]!==n[Nn][Nn][sn]&&(e[aa]=!0),null===t?e[ca]=[n]:t.push(n)}(d,n);const f=n[ns];null!==f&&f.insertView(e),n[Pt]|=128}(r,n,e,t),i){const l=Zn(t,e),d=n[Fe],f=pi(d,e[eo]);null!==f&&function Ce(e,n,t,i,r,l){i[cn]=r,i[Ji]=n,wi(e,i,t,1,r,l)}(r,e[Ji],d,n,f,l)}}let jl=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=mL}return e})();const pL=jl,fL=class extends pL{constructor(n,t,i){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,i){const r=function dL(e,n,t,i){const r=n.tView,f=r_(e,r,t,4096&e[Pt]?4096:16,null,n,null,null,null,i?.injector??null,i?.hydrationInfo??null);f[xl]=e[n.index];const E=e[ns];return null!==E&&(f[ns]=E.createEmbeddedView(r)),Pb(r,f,t),f}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:i});return new Kf(r)}};function mL(){return w_(ir(),Pe())}function w_(e,n){return 4&e.type?new fL(n,e,ap(e,n)):null}let Ka=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=xL}return e})();function xL(){return ND(ir(),Pe())}const wL=Ka,OD=class extends wL{constructor(n,t,i){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=i}get element(){return ap(this._hostTNode,this._hostLView)}get injector(){return new no(this._hostTNode,this._hostLView)}get parentInjector(){const n=Dd(this._hostTNode,this._hostLView);if(Fh(n)){const t=Ed(n,this._hostLView),i=uu(n);return new no(t[Le].data[i+8],t)}return new no(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=LD(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-Qn}createEmbeddedView(n,t,i){let r,l;"number"==typeof i?r=i:null!=i&&(r=i.index,l=i.injector);const f=n.createEmbeddedViewImpl(t||{},l,null);return this.insertImpl(f,r,false),f}createComponent(n,t,i,r,l){const d=n&&!function _u(e){return"function"==typeof e}(n);let f;if(d)f=t;else{const oe=t||{};f=oe.index,i=oe.injector,r=oe.projectableNodes,l=oe.environmentInjector||oe.ngModuleRef}const b=d?n:new Yf(Kt(n)),E=i||this.parentInjector;if(!l&&null==b.ngModule){const _e=(d?E:this.parentInjector).get(vc,null);_e&&(l=_e)}Kt(b.componentType??{});const $=b.create(E,r,null,l);return this.insertImpl($.hostView,f,false),$}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,i){const r=n._lView;if(function ig(e){return hi(e[Nn])}(r)){const b=this.indexOf(n);if(-1!==b)this.detach(b);else{const E=r[Nn],T=new OD(E,E[Ji],E[Nn]);T.detach(T.indexOf(n))}}const d=this._adjustIndex(t),f=this._lContainer;return hL(f,r,d,!i),n.attachToViewContainerRef(),Eg(tx(f),d,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=LD(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),i=Ze(this._lContainer,t);i&&(Vh(tx(this._lContainer),t),qe(i[Le],i))}detach(n){const t=this._adjustIndex(n,-1),i=Ze(this._lContainer,t);return i&&null!=Vh(tx(this._lContainer),t)?new Kf(i):null}_adjustIndex(n,t=0){return n??this.length+t}};function LD(e){return e[8]}function tx(e){return e[8]||(e[8]=[])}function ND(e,n){let t;const i=n[e.index];return hi(i)?t=i:(t=mE(i,n,null,e),n[e.index]=t,o_(n,t)),BD(t,n,e,i),new OD(t,e,n)}let BD=function zD(e,n,t,i){if(e[eo])return;let r;r=8&t.type?Hn(i):function EL(e,n){const t=e[Fe],i=t.createComment(""),r=nr(n,e);return gn(t,pi(t,r),i,function yr(e,n){return e.nextSibling(n)}(t,r),!1),i}(n,t),e[eo]=r};class nx{constructor(n){this.queryList=n,this.matches=null}clone(){return new nx(this.queryList)}setDirty(){this.queryList.setDirty()}}class ix{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const i=null!==n.contentQueries?n.contentQueries[0]:t.length,r=[];for(let l=0;l<i;l++){const d=t.getByIndex(l);r.push(this.queries[d.indexInDeclarationView].clone())}return new ix(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==$D(n,t).matches&&this.queries[t].setDirty()}}class VD{constructor(n,t,i=null){this.predicate=n,this.flags=t,this.read=i}}class rx{constructor(n=[]){this.queries=n}elementStart(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,l=this.getByIndex(i).embeddedTView(n,r);l&&(l.indexInDeclarationView=i,null!==t?t.push(l):t=[l])}return null!==t?new rx(t):null}template(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class ox{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new ox(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const l=i[r];this.matchTNodeWithReadOption(n,t,SL(t,l)),this.matchTNodeWithReadOption(n,t,Sd(t,n,l,!1,!1))}else i===jl?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,Sd(t,n,i,!1,!1))}matchTNodeWithReadOption(n,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Rn||r===Ka||r===jl&&4&t.type)this.addMatch(t.index,-2);else{const l=Sd(t,n,r,!1,!1);null!==l&&this.addMatch(t.index,l)}else this.addMatch(t.index,i)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function SL(e,n){const t=e.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===n)return t[i+1];return null}function ML(e,n,t,i){return-1===t?function IL(e,n){return 11&e.type?ap(e,n):4&e.type?w_(e,n):null}(n,e):-2===t?function TL(e,n,t){return t===Rn?ap(n,e):t===jl?w_(n,e):t===Ka?ND(n,e):void 0}(e,n,i):cc(e,e[Le],t,n)}function UD(e,n,t,i){const r=n[ns].queries[i];if(null===r.matches){const l=e.data,d=t.matches,f=[];for(let b=0;b<d.length;b+=2){const E=d[b];f.push(E<0?null:ML(n,l[E],d[b+1],t.metadata.read))}r.matches=f}return r.matches}function sx(e,n,t,i){const r=e.queries.getByIndex(t),l=r.matches;if(null!==l){const d=UD(e,n,r,t);for(let f=0;f<l.length;f+=2){const b=l[f];if(b>0)i.push(d[f/2]);else{const E=l[f+1],T=n[-b];for(let P=Qn;P<T.length;P++){const U=T[P];U[xl]===U[Nn]&&sx(U[Le],U,E,i)}if(null!==T[ca]){const P=T[ca];for(let U=0;U<P.length;U++){const $=P[U];sx($[Le],$,E,i)}}}}}return i}function Fr(e){const n=Pe(),t=hn(),i=kh();uf(i+1);const r=$D(t,i);if(e.dirty&&function Th(e){return 4==(4&e[Pt])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const l=r.crossesNgTemplate?sx(t,n,i,[]):UD(t,n,r,i);e.reset(l,H2),e.notifyOnChanges()}return!0}return!1}function dm(e,n,t){const i=hn();i.firstCreatePass&&(HD(i,new VD(e,n,t),-1),2==(2&n)&&(i.staticViewQueries=!0)),jD(i,Pe(),n)}function qo(e,n,t,i){const r=hn();if(r.firstCreatePass){const l=ir();HD(r,new VD(n,t,i),l.index),function kL(e,n){const t=e.contentQueries||(e.contentQueries=[]);n!==(t.length?t[t.length-1]:-1)&&t.push(e.queries.length-1,n)}(r,e),2==(2&t)&&(r.staticContentQueries=!0)}jD(r,Pe(),t)}function Or(){return function AL(e,n){return e[ns].queries[n].queryList}(Pe(),kh())}function jD(e,n,t){const i=new Xd(4==(4&t));(function wP(e,n,t,i){const r=_E(n);r.push(t),e.firstCreatePass&&yE(e).push(i,r.length-1)})(e,n,i,i.destroy),null===n[ns]&&(n[ns]=new ix),n[ns].queries.push(new nx(i))}function HD(e,n,t){null===e.queries&&(e.queries=new rx),e.queries.track(new ox(n,t))}function $D(e,n){return e.queries.getByIndex(n)}const cS=new Oe("Application Initializer");let dx=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=St(cS,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const l=r();if(f_(l))t.push(l);else if(YE(l)){const d=new Promise((f,b)=>{l.subscribe({complete:f,error:b})});t.push(d)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Hl=new Oe("LocaleId",{providedIn:"root",factory:()=>St(Hl,Jt.Optional|Jt.SkipSelf)||function JL(){return typeof $localize<"u"&&$localize.locale||Dp}()});let nN=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new xs(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const pS=new Oe(""),S_=new Oe("");let gx,fx=(()=>{class e{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,gx||(function DN(e){gx=e}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{qt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let l=-1;i&&i>0&&(l=setTimeout(()=>{this._callbacks=this._callbacks.filter(d=>d.timeoutId!==l),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:l,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||e)(Te(qt),Te(mx),Te(S_))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})(),mx=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return gx?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Su=null;const fS=new Oe("AllowMultipleToken"),_x=new Oe("PlatformDestroyListeners"),mS=new Oe("appBootstrapListener");function yS(e,n,t=[]){const i=`Platform: ${n}`,r=new Oe(i);return(l=[])=>{let d=yx();if(!d||d.injector.get(fS,!1)){const f=[...t,...l,{provide:r,useValue:!0}];e?e(f):function MN(e){if(Su&&!Su.get(fS,!1))throw new Ee(400,!1);(function gS(){!function Ai(e){Ti=e}(()=>{throw new Ee(600,!1)})})(),Su=e;const n=e.get(bS);(function _S(e){e.get(k1,null)?.forEach(t=>t())})(e)}(function vS(e=[],n){return $o.create({name:n,providers:[{provide:Qv,useValue:"platform"},{provide:_x,useValue:new Set([()=>Su=null])},...e]})}(f,i))}return function AN(e){const n=yx();if(!n)throw new Ee(401,!1);return n}()}}function yx(){return Su?.get(bS)??null}let bS=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function kN(e="zone.js",n){return"noop"===e?new rP:"zone.js"===e?new qt(n):e}(i?.ngZone,function xS(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const l=function LO(e,n,t){return new Qb(e,n,t)}(t.moduleType,this.injector,function SS(e){return[{provide:qt,useFactory:e},{provide:qg,multi:!0,useFactory:()=>{const n=St(RN,{optional:!0});return()=>n.initialize()}},{provide:DS,useFactory:PN},{provide:q1,useFactory:W1}]}(()=>r)),d=l.injector.get(Ca,null);return r.runOutsideAngular(()=>{const f=r.onError.subscribe({next:b=>{d.handleError(b)}});l.onDestroy(()=>{I_(this._modules,l),f.unsubscribe()})}),function wS(e,n,t){try{const i=t();return f_(i)?i.catch(r=>{throw n.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>e.handleError(i)),i}}(d,r,()=>{const f=l.injector.get(dx);return f.runInitializers(),f.donePromise.then(()=>(function WC(e){Yr(e,"Expected localeId to be defined"),"string"==typeof e&&(qC=e.toLowerCase().replace(/_/g,"-"))}(l.injector.get(Hl,Dp)||Dp),this._moduleDoBootstrap(l),l))})})}bootstrapModule(t,i=[]){const r=ES({},i);return function SN(e,n,t){const i=new Jb(t);return Promise.resolve(i)}(0,0,t).then(l=>this.bootstrapModuleFactory(l,r))}_moduleDoBootstrap(t){const i=t.injector.get(Iu);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Ee(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ee(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(_x,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||e)(Te($o))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function ES(e,n){return Array.isArray(n)?n.reduce(ES,e):{...e,...n}}let Iu=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=St(DS),this.zoneIsStable=St(q1),this.componentTypes=[],this.components=[],this.isStable=St(nN).hasPendingTasks.pipe(ws(t=>t?Ni(!1):this.zoneIsStable),zc(),ul()),this._injector=St(vc)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof O1;if(!this._injector.get(dx).done)throw!r&&function Bi(e){const n=Kt(e)||Si(e)||Ii(e);return null!==n&&n.standalone}(t),new Ee(405,!1);let d;d=r?t:this._injector.get(Gf).resolveComponentFactory(t),this.componentTypes.push(d.componentType);const f=function IN(e){return e.isBoundToModule}(d)?void 0:this._injector.get(Zd),E=d.create($o.NULL,[],i||d.selector,f),T=E.location.nativeElement,P=E.injector.get(pS,null);return P?.registerApplication(T),E.onDestroy(()=>{this.detachView(E.hostView),I_(this.components,E),P?.unregisterApplication(T)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new Ee(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;I_(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(mS,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>I_(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Ee(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function I_(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const DS=new Oe("",{providedIn:"root",factory:()=>St(Ca).handleError.bind(void 0)});function PN(){const e=St(qt),n=St(Ca);return t=>e.runOutsideAngular(()=>n.handleError(t))}let RN=(()=>{class e{constructor(){this.zone=St(qt),this.applicationRef=St(Iu)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let $l=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=LN}return e})();function LN(e){return function NN(e,n,t){if(As(e)&&!t){const i=zo(e.index,n);return new Kf(i,i)}return 47&e.type?new Kf(n[sn],n):null}(ir(),Pe(),16==(16&e))}class AS{constructor(){}supports(n){return c_(n)}create(n){return new HN(n)}}const jN=(e,n)=>n;class HN{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||jN}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,i=this._removalsHead,r=0,l=null;for(;t||i;){const d=!i||t&&t.currentIndex<PS(i,r,l)?t:i,f=PS(d,r,l),b=d.currentIndex;if(d===i)r--,i=i._nextRemoved;else if(t=t._next,null==d.previousIndex)r++;else{l||(l=[]);const E=f-r,T=b-r;if(E!=T){for(let U=0;U<E;U++){const $=U<l.length?l[U]:l[U]=0,Q=$+U;T<=Q&&Q<E&&(l[U]=$+1)}l[d.previousIndex]=T-E}}f!==b&&n(d,f,b)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!c_(n))throw new Ee(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,l,d,t=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let f=0;f<this.length;f++)l=n[f],d=this._trackByFn(f,l),null!==t&&Object.is(t.trackById,d)?(i&&(t=this._verifyReinsertion(t,l,d,f)),Object.is(t.item,l)||this._addIdentityChange(t,l)):(t=this._mismatch(t,l,d,f),i=!0),t=t._next}else r=0,function mR(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let i;for(;!(i=t.next()).done;)n(i.value)}}(n,f=>{d=this._trackByFn(r,f),null!==t&&Object.is(t.trackById,d)?(i&&(t=this._verifyReinsertion(t,f,d,r)),Object.is(t.item,f)||this._addIdentityChange(t,f)):(t=this._mismatch(t,f,d,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,i,r){let l;return null===n?l=this._itTail:(l=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,l,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,l,r)):n=this._addAfter(new $N(t,i),l,r),n}_verifyReinsertion(n,t,i,r){let l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==l?n=this._reinsertAfter(l,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,l=n._nextRemoved;return null===r?this._removalsHead=l:r._nextRemoved=l,null===l?this._removalsTail=r:l._prevRemoved=r,this._insertAfter(n,t,i),this._addToMoves(n,i),n}_moveAfter(n,t,i){return this._unlink(n),this._insertAfter(n,t,i),this._addToMoves(n,i),n}_addAfter(n,t,i){return this._insertAfter(n,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,i){const r=null===t?this._itHead:t._next;return n._next=r,n._prev=t,null===r?this._itTail=n:r._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new kS),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,i=n._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new kS),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class $N{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class GN{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const t=n._prevDup,i=n._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class kS{constructor(){this.map=new Map}put(n){const t=n.trackById;let i=this.map.get(t);i||(i=new GN,this.map.set(t,i)),i.add(n)}get(n,t){const r=this.map.get(n);return r?r.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function PS(e,n,t){const i=e.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+n+r}class RS{constructor(){}supports(n){return n instanceof Map||Rb(n)}create(){return new qN}}class qN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||Rb(n)))throw new Ee(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const l=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,l)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const i=n._prev;return t._next=n,t._prev=i,n._prev=t,i&&(i._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,t);const l=r._prev,d=r._next;return l&&(l._next=d),d&&(d._prev=l),r._next=null,r._prev=null,r}const i=new WN(n);return this._records.set(n,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(i=>t(n[i],i))}}class WN{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function FS(){return new A_([new AS])}let A_=(()=>{class e{static#e=this.\u0275prov=at({token:e,providedIn:"root",factory:FS});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||FS()),deps:[[e,new Pd,new hc]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Ee(901,!1)}}return e})();function OS(){return new fm([new RS])}let fm=(()=>{class e{static#e=this.\u0275prov=at({token:e,providedIn:"root",factory:OS});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||OS()),deps:[[e,new Pd,new hc]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Ee(901,!1)}}return e})();const KN=yS(null,"core",[]);let YN=(()=>{class e{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||e)(Te(Iu))};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({})}return e})(),Dx=null;function Mu(){return Dx}class uB{}const pn=new Oe("DocumentToken");let $S=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:function(){return St(dB)},providedIn:"platform"})}return e})(),dB=(()=>{class e extends $S{constructor(){super(),this._doc=St(pn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Mu().getBaseHref(this._doc)}onPopState(t){const i=Mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function GS(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function qS(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function Yd(e){return e&&"?"!==e[0]?"?"+e:e}let Sx=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:function(){return St(pB)},providedIn:"root"})}return e})();const hB=new Oe("appBaseHref");let pB=(()=>{class e extends Sx{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??St(pn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return GS(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Yd(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,l){const d=this.prepareExternalUrl(r+Yd(l));this._platformLocation.pushState(t,i,d)}replaceState(t,i,r,l){const d=this.prepareExternalUrl(r+Yd(l));this._platformLocation.replaceState(t,i,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Te($S),Te(hB,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),WS=(()=>{class e{constructor(t){this._subject=new $n,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function gB(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(qS(ZS(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Yd(i))}normalize(t){return e.stripTrailingSlash(function mB(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,ZS(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Yd(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Yd(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=Yd;static#t=this.joinWithSlash=GS;static#n=this.stripTrailingSlash=qS;static#i=this.\u0275fac=function(i){return new(i||e)(Te(Sx))};static#r=this.\u0275prov=at({token:e,factory:function(){return function fB(){return new WS(Te(Sx))}()},providedIn:"root"})}return e})();function ZS(e){return e.replace(/\/index.html$/,"")}const Lx=/\s+/,iI=[];let rI=(()=>{class e{constructor(t,i,r,l){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=l,this.initialClasses=iI,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(Lx):iI}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(Lx):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(Lx).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||e)(ge(A_),ge(fm),ge(Rn),ge(Hd))};static#t=this.\u0275dir=mt({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return e})(),_m=(()=>{class e{constructor(t,i){this._viewContainer=t,this._context=new rz,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){aI("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){aI("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Ka),ge(jl))};static#t=this.\u0275dir=mt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class rz{constructor(){this.$implicit=null,this.ngIf=null}}function aI(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${yi(n)}'.`)}let Vx=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({})}return e})();const dI="browser";function Ux(e){return e===dI}function hI(e){return"server"===e}class tV extends uB{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class $x extends tV{static makeCurrent(){!function cB(e){Dx||(Dx=e)}(new $x)}onAndCancel(n,t,i){return n.addEventListener(t,i),()=>{n.removeEventListener(t,i)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function nV(){return vm=vm||document.querySelector("base"),vm?vm.getAttribute("href"):null}();return null==t?null:function iV(e){G_=G_||document.createElement("a"),G_.setAttribute("href",e);const n=G_.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){vm=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function ez(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const i=t.indexOf("="),[r,l]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===n)return decodeURIComponent(l)}return null}(document.cookie,n)}}let G_,vm=null,oV=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();const Gx=new Oe("EventManagerPlugins");let _I=(()=>{class e{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(l=>l.supports(t)),!i)throw new Ee(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||e)(Te(Gx),Te(qt))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();class yI{constructor(n){this._doc=n}}const qx="ng-app-id";let vI=(()=>{class e{constructor(t,i,r,l={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=l,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=hI(l),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${qx}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const l=r.get(t);return l.usage+=i,l.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,l=r?.get(i);if(l?.parentNode===t)return r.delete(i),l.removeAttribute(qx),l;{const d=this.doc.createElement("style");return this.nonce&&d.setAttribute("nonce",this.nonce),d.textContent=i,this.platformIsServer&&d.setAttribute(qx,this.appId),d}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const l=this.styleRef,d=l.get(i)?.elements;d?d.push(r):l.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn),Te(Kg),Te(nb,8),Te(bc))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();const Wx={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Zx=/%COMP%/g,cV=new Oe("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function xI(e,n){return n.map(t=>t.replace(Zx,e))}let Xx=(()=>{class e{constructor(t,i,r,l,d,f,b,E=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=l,this.doc=d,this.platformId=f,this.ngZone=b,this.nonce=E,this.rendererByCompId=new Map,this.platformIsServer=hI(f),this.defaultRenderer=new Kx(t,d,b,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Qi.ShadowDom&&(i={...i,encapsulation:Qi.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof EI?r.applyToHost(t):r instanceof Yx&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let l=r.get(i.id);if(!l){const d=this.doc,f=this.ngZone,b=this.eventManager,E=this.sharedStylesHost,T=this.removeStylesOnCompDestroy,P=this.platformIsServer;switch(i.encapsulation){case Qi.Emulated:l=new EI(b,E,i,this.appId,T,d,f,P);break;case Qi.ShadowDom:return new pV(b,E,t,i,d,f,this.nonce,P);default:l=new Yx(b,E,i,T,d,f,P)}r.set(i.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||e)(Te(_I),Te(vI),Te(Kg),Te(cV),Te(pn),Te(bc),Te(qt),Te(nb))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();class Kx{constructor(n,t,i,r){this.eventManager=n,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(Wx[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(wI(n)?n.content:n).appendChild(t)}insertBefore(n,t,i){n&&(wI(n)?n.content:n).insertBefore(t,i)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new Ee(-5104,!1);return t||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,i,r){if(r){t=r+":"+t;const l=Wx[r];l?n.setAttributeNS(l,t,i):n.setAttribute(t,i)}else n.setAttribute(t,i)}removeAttribute(n,t,i){if(i){const r=Wx[i];r?n.removeAttributeNS(r,t):n.removeAttribute(`${i}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,i,r){r&(xa.DashCase|xa.Important)?n.style.setProperty(t,i,r&xa.Important?"important":""):n.style[t]=i}removeStyle(n,t,i){i&xa.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,i){n[t]=i}setValue(n,t){n.nodeValue=t}listen(n,t,i){if("string"==typeof n&&!(n=Mu().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(i))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function wI(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class pV extends Kx{constructor(n,t,i,r,l,d,f,b){super(n,l,d,b),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const E=xI(r.id,r.styles);for(const T of E){const P=document.createElement("style");f&&P.setAttribute("nonce",f),P.textContent=T,this.shadowRoot.appendChild(P)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,i){return super.insertBefore(this.nodeOrShadowRoot(n),t,i)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Yx extends Kx{constructor(n,t,i,r,l,d,f,b){super(n,l,d,f),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=b?xI(b,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class EI extends Yx{constructor(n,t,i,r,l,d,f,b){const E=r+"-"+i.id;super(n,t,i,l,d,f,b,E),this.contentAttr=function uV(e){return"_ngcontent-%COMP%".replace(Zx,e)}(E),this.hostAttr=function dV(e){return"_nghost-%COMP%".replace(Zx,e)}(E)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const i=super.createElement(n,t);return super.setAttribute(i,this.contentAttr,""),i}}let fV=(()=>{class e extends yI{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();const CI=["alt","control","meta","shift"],mV={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gV={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let _V=(()=>{class e extends yI{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const l=e.parseEventName(i),d=e.eventCallback(l.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mu().onAndCancel(t,l.domEventName,d))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const l=e._normalizeKey(i.pop());let d="",f=i.indexOf("code");if(f>-1&&(i.splice(f,1),d="code."),CI.forEach(E=>{const T=i.indexOf(E);T>-1&&(i.splice(T,1),d+=E+".")}),d+=l,0!=i.length||0===l.length)return null;const b={};return b.domEventName=r,b.fullKey=d,b}static matchEventFullKeyCode(t,i){let r=mV[t.key]||t.key,l="";return i.indexOf("code.")>-1&&(r=t.code,l="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),CI.forEach(d=>{d!==r&&(0,gV[d])(t)&&(l+=d+".")}),l+=r,l===i)}static eventCallback(t,i,r){return l=>{e.matchEventFullKeyCode(l,t)&&r.runGuarded(()=>i(l))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();const xV=yS(KN,"browser",[{provide:bc,useValue:dI},{provide:k1,useValue:function yV(){$x.makeCurrent()},multi:!0},{provide:pn,useFactory:function bV(){return function zf(e){tp=e}(document),document},deps:[]}]),wV=new Oe(""),II=[{provide:S_,useClass:class rV{addToWindow(n){wn.getAngularTestability=(i,r=!0)=>{const l=n.findTestabilityInTree(i,r);if(null==l)throw new Ee(5103,!1);return l},wn.getAllAngularTestabilities=()=>n.getAllTestabilities(),wn.getAllAngularRootElements=()=>n.getAllRootElements(),wn.frameworkStabilizers||(wn.frameworkStabilizers=[]),wn.frameworkStabilizers.push(i=>{const r=wn.getAllAngularTestabilities();let l=r.length,d=!1;const f=function(b){d=d||b,l--,0==l&&i(d)};r.forEach(b=>{b.whenStable(f)})})}findTestabilityInTree(n,t,i){return null==t?null:n.getTestability(t)??(i?Mu().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:pS,useClass:fx,deps:[qt,mx,S_]},{provide:fx,useClass:fx,deps:[qt,mx,S_]}],MI=[{provide:Qv,useValue:"root"},{provide:Ca,useFactory:function vV(){return new Ca},deps:[]},{provide:Gx,useClass:fV,multi:!0,deps:[pn,qt,bc]},{provide:Gx,useClass:_V,multi:!0,deps:[pn]},Xx,vI,_I,{provide:qf,useExisting:Xx},{provide:class Pz{},useClass:oV,deps:[]},[]];let TI=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:Kg,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||e)(Te(wV,12))};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({providers:[...MI,...II],imports:[Vx,YN]})}return e})();typeof window<"u"&&window;let e0,Jx=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:function(i){let r=null;return r=i?new(i||e):Te(PI),r},providedIn:"root"})}return e})(),PI=(()=>{class e extends Jx{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case ro.NONE:return i;case ro.HTML:return ri(i,"HTML")?bo(i):x1(this._doc,String(i)).toString();case ro.STYLE:return ri(i,"Style")?bo(i):i;case ro.SCRIPT:if(ri(i,"Script"))return bo(i);throw new Ee(5200,!1);case ro.URL:return ri(i,"URL")?bo(i):$g(String(i));case ro.RESOURCE_URL:if(ri(i,"ResourceURL"))return bo(i);throw new Ee(5201,!1);default:throw new Ee(5202,!1)}}bypassSecurityTrustHtml(t){return function Vd(e){return new jv(e)}(t)}bypassSecurityTrustStyle(t){return function Ud(e){return new Hv(e)}(t)}bypassSecurityTrustScript(t){return function Hg(e){return new $v(e)}(t)}bypassSecurityTrustUrl(t){return function _c(e){return new Ns(e)}(t)}bypassSecurityTrustResourceUrl(t){return function n2(e){return new np(e)}(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn))};static#t=this.\u0275prov=at({token:e,factory:function(i){let r=null;return r=i?new i:function MV(e){return new PI(e.get(pn))}(Te($o)),r},providedIn:"root"})}return e})();try{e0=typeof Intl<"u"&&Intl.v8BreakIterator}catch{e0=!1}let bm,Qd,t0,us=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Ux(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!e0)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||e)(Te(bc))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function xm(e){return function TV(){if(null==bm&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>bm=!0}))}finally{bm=bm||!1}return bm}()?e:!!e.capture}function AV(){if(null==Qd){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Qd=!1,Qd;if("scrollBehavior"in document.documentElement.style)Qd=!0;else{const e=Element.prototype.scrollTo;Qd=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return Qd}function Au(e){return e.composedPath?e.composedPath()[0]:e.target}function n0(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function W_(e,...n){return n.length?n.some(t=>e[t]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function Em(e,n,t){const i=$t(e)||n||t?{next:e,error:n,complete:t}:e;return i?Vn((r,l)=>{var d;null===(d=i.subscribe)||void 0===d||d.call(i);let f=!0;r.subscribe(Mn(l,b=>{var E;null===(E=i.next)||void 0===E||E.call(i,b),l.next(b)},()=>{var b;f=!1,null===(b=i.complete)||void 0===b||b.call(i),l.complete()},b=>{var E;f=!1,null===(E=i.error)||void 0===E||E.call(i,b),l.error(b)},()=>{var b,E;f&&(null===(b=i.unsubscribe)||void 0===b||b.call(i)),null===(E=i.finalize)||void 0===E||E.call(i)}))}):Lr}class ZV extends Qt{constructor(n,t){super()}schedule(n,t=0){return this}}const Z_={setInterval(e,n,...t){const{delegate:i}=Z_;return i?.setInterval?i.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=Z_;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};class c0 extends ZV{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const r=this.id,l=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(l,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(l,this.id,t),this}requestAsyncId(n,t,i=0){return Z_.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Z_.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r,i=!1;try{this.work(n)}catch(l){i=!0,r=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,y(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}const NI={now:()=>(NI.delegate||Date).now(),delegate:void 0};class Cm{constructor(n,t=Cm.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}Cm.now=NI.now;class u0 extends Cm{constructor(n,t=Cm.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}const X_=new u0(c0),XV=X_;function BI(e,n=X_){return Vn((t,i)=>{let r=null,l=null,d=null;const f=()=>{if(r){r.unsubscribe(),r=null;const E=l;l=null,i.next(E)}};function b(){const E=d+e,T=n.now();if(T<E)return r=this.schedule(void 0,E-T),void i.add(r);f()}t.subscribe(Mn(i,E=>{l=E,d=n.now(),r||(r=n.schedule(b,e),i.add(r))},()=>{f(),i.complete()},void 0,()=>{l=r=null}))})}function wo(e,n){return Vn((t,i)=>{let r=0;t.subscribe(Mn(i,l=>e.call(n,l,r++)&&i.next(l)))})}function zI(e){return wo((n,t)=>e<=t)}function Eo(e){return Vn((n,t)=>{we(e).subscribe(Mn(t,()=>t.complete(),Zr)),!t.closed&&n.subscribe(t)})}function lr(e){return null!=e&&"false"!=`${e}`}function K_(e){return Array.isArray(e)?e:[e]}function Cr(e){return null==e?"":"string"==typeof e?e:`${e}px`}function Ap(e){return e instanceof Rn?e.nativeElement:e}const{isArray:QV}=Array,{getPrototypeOf:JV,prototype:e3,keys:t3}=Object;function VI(e){if(1===e.length){const n=e[0];if(QV(n))return{args:n,keys:null};if(function n3(e){return e&&"object"==typeof e&&JV(e)===e3}(n)){const t=t3(n);return{args:t.map(i=>n[i]),keys:t}}}return{args:e,keys:null}}const{isArray:r3}=Array;function d0(e){return fn(n=>function o3(e,n){return r3(n)?e(...n):e(n)}(e,n))}function UI(e,n){return e.reduce((t,i,r)=>(t[i]=n[r],t),{})}function jI(e,n,t){e?Bt(t,e,n):n()}function Dm(...e){return function l3(){return vt(1)}()(Xr(e,Ks(e)))}function Xo(e){return e<=0?()=>jn:Vn((n,t)=>{let i=0;n.subscribe(Mn(t,r=>{++i<=e&&(t.next(r),e<=i&&t.complete())}))})}function ku(...e){const n=Ks(e);return Vn((t,i)=>{(n?Dm(e,t,n):Dm(e,t)).subscribe(i)})}const HI=new Set;let Jd,c3=(()=>{class e{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):d3}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function u3(e,n){if(!HI.has(e))try{Jd||(Jd=document.createElement("style"),n&&(Jd.nonce=n),Jd.setAttribute("type","text/css"),document.head.appendChild(Jd)),Jd.sheet&&(Jd.sheet.insertRule(`@media ${e} {body{ }}`,0),HI.add(e))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(us),Te(nb,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function d3(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let h3=(()=>{class e{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Ft}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return $I(K_(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let l=function s3(...e){const n=Ks(e),t=Oa(e),{args:i,keys:r}=VI(e);if(0===i.length)return Xr([],n);const l=new _n(function a3(e,n,t=Lr){return i=>{jI(n,()=>{const{length:r}=e,l=new Array(r);let d=r,f=r;for(let b=0;b<r;b++)jI(n,()=>{const E=Xr(e[b],n);let T=!1;E.subscribe(Mn(i,P=>{l[b]=P,T||(T=!0,f--),f||i.next(t(l.slice()))},()=>{--d||i.complete()}))},i)},i)}}(i,n,r?d=>UI(r,d):Lr));return t?l.pipe(d0(t)):l}($I(K_(t)).map(d=>this._registerQuery(d).observable));return l=Dm(l.pipe(Xo(1)),l.pipe(zI(1),BI(0))),l.pipe(fn(d=>{const f={matches:!1,breakpoints:{}};return d.forEach(({matches:b,query:E})=>{f.matches=f.matches||b,f.breakpoints[E]=b}),f}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),l={observable:new _n(d=>{const f=b=>this._zone.run(()=>d.next(b));return i.addListener(f),()=>{i.removeListener(f)}}).pipe(ku(i),fn(({matches:d})=>({query:t,matches:d})),Eo(this._destroySubject)),mql:i};return this._queries.set(t,l),l}static#e=this.\u0275fac=function(i){return new(i||e)(Te(c3),Te(qt))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function $I(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}class m3{constructor(n){this._items=n,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Ft,this._typeaheadSubscription=Qt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Ft,this.change=new Ft,n instanceof Xd&&(this._itemChangesSubscription=n.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(n){return this._skipPredicateFn=n,this}withWrap(n=!0){return this._wrap=n,this}withVerticalOrientation(n=!0){return this._vertical=n,this}withHorizontalOrientation(n){return this._horizontal=n,this}withAllowedModifierKeys(n){return this._allowedModifierKeys=n,this}withTypeAhead(n=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Em(t=>this._pressedLetters.push(t)),BI(n),wo(()=>this._pressedLetters.length>0),fn(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const l=(this._activeItemIndex+r)%i.length,d=i[l];if(!this._skipPredicateFn(d)&&0===d.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(l);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(n=!0){return this._homeAndEnd=n,this}withPageUpDown(n=!0,t=10){return this._pageUpAndDown={enabled:n,delta:t},this}setActiveItem(n){const t=this._activeItem;this.updateActiveItem(n),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(n){const t=n.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(l=>!n[l]||this._allowedModifierKeys.indexOf(l)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const l=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(l>0?l:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const l=this._activeItemIndex+this._pageUpAndDown.delta,d=this._getItemsArray().length;this._setActiveItemByIndex(l<d?l:d-1,-1);break}return;default:return void((r||W_(n,"shiftKey"))&&(n.key&&1===n.key.length?this._letterKeyStream.next(n.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],n.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(n){const t=this._getItemsArray(),i="number"==typeof n?n:t.indexOf(n);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(n){this._wrap?this._setActiveInWrapMode(n):this._setActiveInDefaultMode(n)}_setActiveInWrapMode(n){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+n*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(n){this._setActiveItemByIndex(this._activeItemIndex+n,n)}_setActiveItemByIndex(n,t){const i=this._getItemsArray();if(i[n]){for(;this._skipPredicateFn(i[n]);)if(!i[n+=t])return;this.setActiveItem(n)}}_getItemsArray(){return this._items instanceof Xd?this._items.toArray():this._items}}class WI extends m3{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(n){return this._origin=n,this}setActiveItem(n){super.setActiveItem(n),this.activeItem&&this.activeItem.focus(this._origin)}}function h0(e){return 0===e.buttons||0===e.offsetX&&0===e.offsetY}function p0(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const x3=new Oe("cdk-input-modality-detector-options"),w3={ignoreKeys:[18,17,224,91,16]},kp=xm({passive:!0,capture:!0});let E3=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(t,i,r,l){this._platform=t,this._mostRecentTarget=null,this._modality=new xs(null),this._lastTouchMs=0,this._onKeydown=d=>{this._options?.ignoreKeys?.some(f=>f===d.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Au(d))},this._onMousedown=d=>{Date.now()-this._lastTouchMs<650||(this._modality.next(h0(d)?"keyboard":"mouse"),this._mostRecentTarget=Au(d))},this._onTouchstart=d=>{p0(d)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Au(d))},this._options={...w3,...l},this.modalityDetected=this._modality.pipe(zI(1)),this.modalityChanged=this.modalityDetected.pipe(zc()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,kp),r.addEventListener("mousedown",this._onMousedown,kp),r.addEventListener("touchstart",this._onTouchstart,kp)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,kp),document.removeEventListener("mousedown",this._onMousedown,kp),document.removeEventListener("touchstart",this._onTouchstart,kp))}static#e=this.\u0275fac=function(i){return new(i||e)(Te(us),Te(qt),Te(pn),Te(x3,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const D3=new Oe("cdk-focus-monitor-default-options"),Y_=xm({passive:!0,capture:!0});let Sm=(()=>{class e{constructor(t,i,r,l,d){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ft,this._rootNodeFocusAndBlurListener=f=>{for(let E=Au(f);E;E=E.parentElement)"focus"===f.type?this._onFocus(f,E):this._onBlur(f,E)},this._document=l,this._detectionMode=d?.detectionMode||0}monitor(t,i=!1){const r=Ap(t);if(!this._platform.isBrowser||1!==r.nodeType)return Ni();const l=function PV(e){if(function kV(){if(null==t0){const e=typeof document<"u"?document.head:null;t0=!(!e||!e.createShadowRoot&&!e.attachShadow)}return t0}()){const n=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(r)||this._getDocument(),d=this._elementInfo.get(r);if(d)return i&&(d.checkChildren=!0),d.subject;const f={checkChildren:i,subject:new Ft,rootNode:l};return this._elementInfo.set(r,f),this._registerGlobalListeners(f),f.subject}stopMonitoring(t){const i=Ap(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const l=Ap(t);l===this._getDocument().activeElement?this._getClosestElementsInfo(l).forEach(([f,b])=>this._originChanged(f,i,b)):(this._setOrigin(i),"function"==typeof l.focus&&l.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),l=Au(t);!r||!r.checkChildren&&i!==l||this._originChanged(i,this._getFocusOrigin(l),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Y_),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Y_)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Eo(this._stopInputModalityDetector)).subscribe(l=>{this._setOrigin(l,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Y_),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Y_),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,l)=>{(l===t||r.checkChildren&&l.contains(t))&&i.push([l,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const l=t.labels;if(l)for(let d=0;d<l.length;d++)if(l[d].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||e)(Te(qt),Te(us),Te(E3),Te(pn,8),Te(D3,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const KI="cdk-high-contrast-black-on-white",YI="cdk-high-contrast-white-on-black",f0="cdk-high-contrast-active";let S3=(()=>{class e{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=St(h3).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,l=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),l){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(f0,KI,YI),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(f0,KI):2===i&&t.add(f0,YI)}}static#e=this.\u0275fac=function(i){return new(i||e)(Te(us),Te(pn))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const I3=new Oe("cdk-dir-doc",{providedIn:"root",factory:function M3(){return St(pn)}}),T3=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Q_=(()=>{class e{constructor(t){this.value="ltr",this.change=new $n,t&&(this.value=function A3(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?T3.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||e)(Te(I3,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Im=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({})}return e})();const P3=new Oe("mat-sanity-checks",{providedIn:"root",factory:function k3(){return!0}});let Ma=(()=>{class e{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!n0()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||e)(Te(S3),Te(P3,8),Te(pn))};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({imports:[Im,Im]})}return e})();function m0(e){return class extends e{get disabled(){return this._disabled}set disabled(n){this._disabled=lr(n)}constructor(...n){super(...n),this._disabled=!1}}}function J_(e,n){return class extends e{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=n,this.color=n}}}function g0(e){return class extends e{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=lr(n)}constructor(...n){super(...n),this._disableRipple=!1}}}function _0(e,n=0){return class extends e{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?function KV(e,n=0){return function YV(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):n}(t):this.defaultTabIndex}constructor(...t){super(...t),this._tabIndex=n,this.defaultTabIndex=n}}}let eM=(()=>{class e{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class O3{constructor(n,t,i,r=!1){this._renderer=n,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const tM=xm({passive:!0,capture:!0});class L3{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const t=Au(n);t&&this._events.get(n.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(l=>l.handleEvent(n))})}}addHandler(n,t,i,r){const l=this._events.get(t);if(l){const d=l.get(i);d?d.add(r):l.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,tM)})}removeHandler(n,t,i){const r=this._events.get(n);if(!r)return;const l=r.get(t);l&&(l.delete(i),0===l.size&&r.delete(t),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,tM)))}}const nM={enterDuration:225,exitDuration:150},iM=xm({passive:!0,capture:!0}),rM=["mousedown","touchstart"],oM=["mouseup","mouseleave","touchend","touchcancel"];class ey{static#e=this._eventManager=new L3;constructor(n,t,i,r){this._target=n,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Ap(i))}fadeInRipple(n,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),l={...nM,...i.animation};i.centered&&(n=r.left+r.width/2,t=r.top+r.height/2);const d=i.radius||function B3(e,n,t){const i=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),r=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(i*i+r*r)}(n,t,r),f=n-r.left,b=t-r.top,E=l.enterDuration,T=document.createElement("div");T.classList.add("mat-ripple-element"),T.style.left=f-d+"px",T.style.top=b-d+"px",T.style.height=2*d+"px",T.style.width=2*d+"px",null!=i.color&&(T.style.backgroundColor=i.color),T.style.transitionDuration=`${E}ms`,this._containerElement.appendChild(T);const P=window.getComputedStyle(T),$=P.transitionDuration,Q="none"===P.transitionProperty||"0s"===$||"0s, 0s"===$||0===r.width&&0===r.height,oe=new O3(this,T,i,Q);T.style.transform="scale3d(1, 1, 1)",oe.state=0,i.persistent||(this._mostRecentTransientRipple=oe);let _e=null;return!Q&&(E||l.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Me=()=>this._finishRippleTransition(oe),ve=()=>this._destroyRipple(oe);T.addEventListener("transitionend",Me),T.addEventListener("transitioncancel",ve),_e={onTransitionEnd:Me,onTransitionCancel:ve}}),this._activeRipples.set(oe,_e),(Q||!E)&&this._finishRippleTransition(oe),oe}fadeOutRipple(n){if(2===n.state||3===n.state)return;const t=n.element,i={...nM,...n.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=Ap(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,rM.forEach(i=>{ey._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{oM.forEach(t=>{this._triggerElement.addEventListener(t,this,iM)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:i}=n.config;n.state=1,!i&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel)),n.element.remove()}_onMousedown(n){const t=h0(n),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!p0(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(rM.forEach(t=>ey._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&oM.forEach(t=>n.removeEventListener(t,this,iM)))}}const ty=new Oe("mat-ripple-global-options");let sM=(()=>{class e{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,l,d){this._elementRef=t,this._animationMode=d,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=l||{},this._rippleRenderer=new ey(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(qt),ge(us),ge(ty,8),ge(xc,8))};static#t=this.\u0275dir=mt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&oo("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return e})(),y0=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({imports:[Ma,Ma]})}return e})();const aM={capture:!0},lM=["focus","click","mouseenter","touchstart"],v0="mat-ripple-loader-uninitialized",b0="mat-ripple-loader-class-name",cM="mat-ripple-loader-centered",ny="mat-ripple-loader-disabled";let uM=(()=>{class e{constructor(){this._document=St(pn,{optional:!0}),this._animationMode=St(xc,{optional:!0}),this._globalRippleOptions=St(ty,{optional:!0}),this._platform=St(us),this._ngZone=St(qt),this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;const r=t.target.closest(`[${v0}]`);r&&this.createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const t of lM)this._document?.addEventListener(t,this._onInteraction,aM)})}ngOnDestroy(){for(const t of lM)this._document?.removeEventListener(t,this._onInteraction,aM)}configureRipple(t,i){t.setAttribute(v0,""),(i.className||!t.hasAttribute(b0))&&t.setAttribute(b0,i.className||""),i.centered&&t.setAttribute(cM,""),i.disabled&&t.setAttribute(ny,"")}getRipple(t){return t.matRipple?t.matRipple:this.createRipple(t)}setDisabled(t,i){const r=t.matRipple;r?r.disabled=i:i?t.setAttribute(ny,""):t.removeAttribute(ny)}createRipple(t){if(!this._document)return;t.querySelector(".mat-ripple")?.remove();const i=this._document.createElement("span");i.classList.add("mat-ripple",t.getAttribute(b0)),t.append(i);const r=new sM(new Rn(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=t,r.centered=t.hasAttribute(cM),r.disabled=t.hasAttribute(ny),this.attachRipple(t,r),r}attachRipple(t,i){t.removeAttribute(v0),t.matRipple=i}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function dM(e,n){const t=$t(e)?e:()=>e,i=r=>r.error(t());return new _n(n?r=>n.schedule(i,0,r):i)}function pM(e){return Vn((n,t)=>{let l,i=null,r=!1;i=n.subscribe(Mn(t,void 0,void 0,d=>{l=we(e(d,pM(e)(n))),i?(i.unsubscribe(),i=null,l.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,l.subscribe(t))})}class x0{}class Sc{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),l=r.toLowerCase(),d=t.slice(i+1).trim();this.maybeSetNormalizedName(r,l),this.headers.has(l)?this.headers.get(l).push(d):this.headers.set(l,[d])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof Sc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new Sc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Sc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,t);const r=("a"===n.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const l=n.value;if(l){let d=this.headers.get(t);if(!d)return;d=d.filter(f=>-1===l.indexOf(f)),0===d.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,d)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const i=(Array.isArray(t)?t:[t]).map(l=>l.toString()),r=n.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(n,r)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class U3{encodeKey(n){return fM(n)}encodeValue(n){return fM(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const H3=/%(\d[a-f0-9])/gi,$3={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function fM(e){return encodeURIComponent(e).replace(H3,(n,t)=>$3[t]??n)}function iy(e){return`${e}`}class Pu{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new U3,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function j3(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const l=r.indexOf("="),[d,f]=-1==l?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,l)),n.decodeValue(r.slice(l+1))],b=t.get(d)||[];b.push(f),t.set(d,b)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const i=n.fromObject[t],r=Array.isArray(i)?i.map(iy):[iy(i)];this.map.set(t,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(i=>{const r=n[i];Array.isArray(r)?r.forEach(l=>{t.push({param:i,value:l,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new Pu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(iy(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const r=i.indexOf(iy(n.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class G3{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function mM(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function gM(e){return typeof Blob<"u"&&e instanceof Blob}function _M(e){return typeof FormData<"u"&&e instanceof FormData}class Tm{constructor(n,t,i,r){let l;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function q3(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,l=r):l=i,l&&(this.reportProgress=!!l.reportProgress,this.withCredentials=!!l.withCredentials,l.responseType&&(this.responseType=l.responseType),l.headers&&(this.headers=l.headers),l.context&&(this.context=l.context),l.params&&(this.params=l.params)),this.headers||(this.headers=new Sc),this.context||(this.context=new G3),this.params){const d=this.params.toString();if(0===d.length)this.urlWithParams=t;else{const f=t.indexOf("?");this.urlWithParams=t+(-1===f?"?":f<t.length-1?"&":"")+d}}else this.params=new Pu,this.urlWithParams=t}serializeBody(){return null===this.body?null:mM(this.body)||gM(this.body)||_M(this.body)||function W3(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Pu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||_M(this.body)?null:gM(this.body)?this.body.type||null:mM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Pu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,i=n.url||this.url,r=n.responseType||this.responseType,l=void 0!==n.body?n.body:this.body,d=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,f=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let b=n.headers||this.headers,E=n.params||this.params;const T=n.context??this.context;return void 0!==n.setHeaders&&(b=Object.keys(n.setHeaders).reduce((P,U)=>P.set(U,n.setHeaders[U]),b)),n.setParams&&(E=Object.keys(n.setParams).reduce((P,U)=>P.set(U,n.setParams[U]),E)),new Tm(t,i,l,{params:E,headers:b,context:T,reportProgress:f,responseType:r,withCredentials:d})}}var E0=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(E0||{});class Z3{constructor(n,t=200,i="OK"){this.headers=n.headers||new Sc,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class Am extends Z3{constructor(n={}){super(n),this.type=E0.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new Am({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}function C0(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let D0=(()=>{class e{constructor(t){this.handler=t}request(t,i,r={}){let l;if(t instanceof Tm)l=t;else{let b,E;b=r.headers instanceof Sc?r.headers:new Sc(r.headers),r.params&&(E=r.params instanceof Pu?r.params:new Pu({fromObject:r.params})),l=new Tm(t,i,void 0!==r.body?r.body:null,{headers:b,context:r.context,params:E,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const d=Ni(l).pipe(function V3(e,n){return $t(n)?Un(e,n,1):Un(e,1)}(b=>this.handler.handle(b)));if(t instanceof Tm||"events"===r.observe)return d;const f=d.pipe(wo(b=>b instanceof Am));switch(r.observe||"body"){case"body":switch(l.responseType){case"arraybuffer":return f.pipe(fn(b=>{if(null!==b.body&&!(b.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return b.body}));case"blob":return f.pipe(fn(b=>{if(null!==b.body&&!(b.body instanceof Blob))throw new Error("Response is not a Blob.");return b.body}));case"text":return f.pipe(fn(b=>{if(null!==b.body&&"string"!=typeof b.body)throw new Error("Response is not a string.");return b.body}));default:return f.pipe(fn(b=>b.body))}case"response":return f;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Pu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,C0(r,i))}post(t,i,r={}){return this.request("POST",t,C0(r,i))}put(t,i,r={}){return this.request("PUT",t,C0(r,i))}static#e=this.\u0275fac=function(i){return new(i||e)(Te(x0))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();const m5=["*"];let sy;function km(e){return function g5(){if(void 0===sy&&(sy=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(sy=e.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return sy}()?.createHTML(e)||e}function IM(e){return Error(`Unable to find icon with the name "${e}"`)}function MM(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function TM(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class th{constructor(n,t,i){this.url=n,this.svgText=t,this.options=i}}let ay=(()=>{class e{constructor(t,i,r,l){this._httpClient=t,this._sanitizer=i,this._errorHandler=l,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,l){return this._addSvgIconConfig(t,i,new th(r,null,l))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,l){const d=this._sanitizer.sanitize(ro.HTML,r);if(!d)throw TM(r);const f=km(d);return this._addSvgIconConfig(t,i,new th("",f,l))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new th(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const l=this._sanitizer.sanitize(ro.HTML,i);if(!l)throw TM(i);const d=km(l);return this._addSvgIconSetConfig(t,new th("",d,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(ro.RESOURCE_URL,t);if(!i)throw MM(t);const r=this._cachedIconsByUrl.get(i);return r?Ni(ly(r)):this._loadSvgIconFromConfig(new th(t,null)).pipe(Em(l=>this._cachedIconsByUrl.set(i,l)),fn(l=>ly(l)))}getNamedSvgIcon(t,i=""){const r=AM(i,t);let l=this._svgIconConfigs.get(r);if(l)return this._getSvgFromConfig(l);if(l=this._getIconConfigFromResolvers(i,t),l)return this._svgIconConfigs.set(r,l),this._getSvgFromConfig(l);const d=this._iconSetConfigs.get(i);return d?this._getSvgFromIconSetConfigs(t,d):dM(IM(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Ni(ly(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(fn(i=>ly(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Ni(r):function hM(...e){const n=Oa(e),{args:t,keys:i}=VI(e),r=new _n(l=>{const{length:d}=t;if(!d)return void l.complete();const f=new Array(d);let b=d,E=d;for(let T=0;T<d;T++){let P=!1;we(t[T]).subscribe(Mn(l,U=>{P||(P=!0,E--),f[T]=U},()=>b--,void 0,()=>{(!b||!P)&&(E||l.next(i?UI(i,f):f),l.complete())}))}});return n?r.pipe(d0(n)):r}(i.filter(d=>!d.svgText).map(d=>this._loadSvgIconSetFromConfig(d).pipe(pM(f=>{const E=`Loading icon set URL: ${this._sanitizer.sanitize(ro.RESOURCE_URL,d.url)} failed: ${f.message}`;return this._errorHandler.handleError(new Error(E)),Ni(null)})))).pipe(fn(()=>{const d=this._extractIconWithNameFromAnySet(t,i);if(!d)throw IM(t);return d}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const l=i[r];if(l.svgText&&l.svgText.toString().indexOf(t)>-1){const d=this._svgElementFromConfig(l),f=this._extractSvgIconFromSet(d,t,l.options);if(f)return f}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Em(i=>t.svgText=i),fn(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Ni(null):this._fetchIcon(t).pipe(Em(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const l=t.querySelector(`[id="${i}"]`);if(!l)return null;const d=l.cloneNode(!0);if(d.removeAttribute("id"),"svg"===d.nodeName.toLowerCase())return this._setSvgAttributes(d,r);if("symbol"===d.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(d),r);const f=this._svgElementFromString(km("<svg></svg>"));return f.appendChild(d),this._setSvgAttributes(f,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(km("<svg></svg>")),r=t.attributes;for(let l=0;l<r.length;l++){const{name:d,value:f}=r[l];"id"!==d&&i.setAttribute(d,f)}for(let l=0;l<t.childNodes.length;l++)t.childNodes[l].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[l].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,l=r?.withCredentials??!1;if(!this._httpClient)throw function _5(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const d=this._sanitizer.sanitize(ro.RESOURCE_URL,i);if(!d)throw MM(i);const f=this._inProgressUrlFetches.get(d);if(f)return f;const b=this._httpClient.get(d,{responseType:"text",withCredentials:l}).pipe(fn(E=>km(E)),function z3(e){return Vn((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}(()=>this._inProgressUrlFetches.delete(d)),ul());return this._inProgressUrlFetches.set(d,b),b}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(AM(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const l=this._resolvers[r](i,t);if(l)return v5(l)?new th(l.url,null,l.options):new th(l,null)}}static#e=this.\u0275fac=function(i){return new(i||e)(Te(D0,8),Te(Jx),Te(pn,8),Te(Ca))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function ly(e){return e.cloneNode(!0)}function AM(e,n){return e+":"+n}function v5(e){return!(!e.url||!e.options)}const b5=J_(class{constructor(e){this._elementRef=e}}),x5=new Oe("MAT_ICON_DEFAULT_OPTIONS"),w5=new Oe("mat-icon-location",{providedIn:"root",factory:function E5(){const e=St(pn),n=e?e.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),kM=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],C5=kM.map(e=>`[${e}]`).join(", "),D5=/^url\(['"]?#(.*?)['"]?\)$/;let S5=(()=>{class e extends b5{get inline(){return this._inline}set inline(t){this._inline=lr(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,l,d,f){super(t),this._iconRegistry=i,this._location=l,this._errorHandler=d,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Qt.EMPTY,f&&(f.color&&(this.color=this.defaultColor=f.color),f.fontSet&&(this.fontSet=f.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,l)=>{r.forEach(d=>{l.setAttribute(d.name,`url('${t}#${d.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(C5),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let l=0;l<i.length;l++)kM.forEach(d=>{const f=i[l],b=f.getAttribute(d),E=b?b.match(D5):null;if(E){let T=r.get(f);T||(T=[],r.set(f,T)),T.push({name:d,value:E[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Xo(1)).subscribe(l=>this._setSvgElement(l),l=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${l.message}`))})}}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(ay),kl("aria-hidden"),ge(w5),ge(Ca),ge(x5,8))};static#t=this.\u0275cmp=Di({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(i,r){2&i&&(ti("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),oo("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Ot],ngContentSelectors:m5,decls:1,vars:0,template:function(i,r){1&i&&(zs(),Ei(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return e})(),I5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({imports:[Ma,Ma]})}return e})();const M5=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],T5=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],PM=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}",RM=["mat-icon-button",""],A5=["*"],P5=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],R5=J_(m0(g0(class{constructor(e){this._elementRef=e}})));let FM=(()=>{class e extends R5{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=lr(t),this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=lr(t),this._updateRippleDisabled()}constructor(t,i,r,l){super(t),this._platform=i,this._ngZone=r,this._animationMode=l,this._focusMonitor=St(Sm),this._rippleLoader=St(uM),this._isFab=!1,this._disableRipple=!1,this._disabled=!1,this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-button-ripple"});const d=t.nativeElement.classList;for(const f of P5)this._hasHostAttributes(f.selector)&&f.mdcClasses.forEach(b=>{d.add(b)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){xb()};static#t=this.\u0275dir=mt({type:e,features:[Ot]})}return e})(),O5=(()=>{class e extends FM{constructor(t,i,r,l){super(t,i,r,l),this._haltDisabledEvents=d=>{this.disabled&&(d.preventDefault(),d.stopImmediatePropagation())}}ngOnInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)})}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}static#e=this.\u0275fac=function(i){xb()};static#t=this.\u0275dir=mt({type:e,features:[Ot]})}return e})(),N5=(()=>{class e extends FM{constructor(t,i,r,l){super(t,i,r,l),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(us),ge(qt),ge(xc,8))};static#t=this.\u0275cmp=Di({type:e,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(i,r){2&i&&(ti("disabled",r.disabled||null),oo("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Ot],attrs:RM,ngContentSelectors:A5,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(zs(),wr(0,"span",0),Ei(1),wr(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',PM],encapsulation:2,changeDetection:0})}return e})(),B5=(()=>{class e extends O5{constructor(t,i,r,l){super(t,i,r,l)}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(us),ge(qt),ge(xc,8))};static#t=this.\u0275cmp=Di({type:e,selectors:[["a","mat-icon-button",""]],hostVars:9,hostBindings:function(i,r){2&i&&(ti("disabled",r.disabled||null)("tabindex",r.disabled?-1:r.tabIndex)("aria-disabled",r.disabled.toString()),oo("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[Ot],attrs:RM,ngContentSelectors:T5,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(zs(M5),wr(0,"span",0),Ei(1),Yt(2,"span",1),Ei(3,1),bn(),Ei(4,2),wr(5,"span",2)(6,"span",3)),2&i&&oo("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',PM],encapsulation:2,changeDetection:0})}return e})(),z5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({imports:[Ma,y0,Ma]})}return e})();const V5=["*",[["mat-toolbar-row"]]],U5=["*","mat-toolbar-row"],j5=J_(class{constructor(e){this._elementRef=e}});let H5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=mt({type:e,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return e})(),$5=(()=>{class e extends j5{constructor(t,i,r){super(t),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(us),ge(pn))};static#t=this.\u0275cmp=Di({type:e,selectors:[["mat-toolbar"]],contentQueries:function(i,r,l){if(1&i&&qo(l,H5,5),2&i){let d;Fr(d=Or())&&(r._toolbarRows=d)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(i,r){2&i&&oo("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",0===r._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Ot],ngContentSelectors:U5,decls:2,vars:0,template:function(i,r){1&i&&(zs(V5),Ei(0),Ei(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}return e})(),G5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({imports:[Ma,Ma]})}return e})();class BT{}class G4{}const Mc="*";function q0(e,n){return{type:7,name:e,definitions:n,options:{}}}function by(e,n=null){return{type:4,styles:n,timings:e}}function zT(e,n=null){return{type:2,steps:e,options:n}}function Tc(e){return{type:6,styles:e,offset:null}}function W0(e,n,t){return{type:0,name:e,styles:n,options:t}}function xy(e,n,t=null){return{type:1,expr:e,animation:n,options:t}}class Nm{constructor(n=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class VT{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let t=0,i=0,r=0;const l=this.players.length;0==l?queueMicrotask(()=>this._onFinish()):this.players.forEach(d=>{d.onDone(()=>{++t==l&&this._onFinish()}),d.onDestroy(()=>{++i==l&&this._onDestroy()}),d.onStart(()=>{++r==l&&this._onStart()})}),this.totalTime=this.players.reduce((d,f)=>Math.max(d,f.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const t=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function eU(e,n){1&e&&(Yt(0,"span",7),Ei(1,1),bn())}function tU(e,n){1&e&&(Yt(0,"span",8),Ei(1,2),bn())}const UT=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],jT=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"];function nU(e,n){1&e&&(Yt(0,"span",8),Ei(1,1),Yt(2,"span",9),mf(),Yt(3,"svg",10),wr(4,"path",11),bn()()())}function iU(e,n){1&e&&(Yt(0,"span",12),Ei(1,2),bn())}const wy=new Oe("mat-chips-default-options"),K0=new Oe("MatChipAvatar"),Y0=new Oe("MatChipTrailingIcon"),Q0=new Oe("MatChipRemove"),Ey=new Oe("MatChip");class pU{}const fU=_0(pU,-1);let Rp=(()=>{class e extends fU{get disabled(){return this._disabled||this._parentChip.disabled}set disabled(t){this._disabled=lr(t)}_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(t,i){super(),this._elementRef=t,this._parentChip=i,this.isInteractive=!0,this._isPrimary=!0,this._disabled=!1,this._allowFocusWhenDisabled=!1,"BUTTON"===t.nativeElement.nodeName&&t.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(t){!this.disabled&&this.isInteractive&&this._isPrimary&&(t.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(t.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(Ey))};static#t=this.\u0275dir=mt({type:e,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(i,r){1&i&&Gi("click",function(d){return r._handleClick(d)})("keydown",function(d){return r._handleKeydown(d)}),2&i&&(ti("tabindex",r._getTabindex())("disabled",r._getDisabledAttribute())("aria-disabled",r.disabled),oo("mdc-evolution-chip__action--primary",r._isPrimary)("mdc-evolution-chip__action--presentational",!r.isInteractive)("mdc-evolution-chip__action--trailing",!r._isPrimary))},inputs:{disabled:"disabled",tabIndex:"tabIndex",isInteractive:"isInteractive",_allowFocusWhenDisabled:"_allowFocusWhenDisabled"},features:[Ot]})}return e})(),yU=0;const vU=_0(J_(g0(m0(class{constructor(e){this._elementRef=e}})),"primary"),-1);let tw,Fp=(()=>{class e extends vU{_hasFocus(){return this._hasFocusInternal}get value(){return void 0!==this._value?this._value:this._textElement.textContent.trim()}set value(t){this._value=t}get removable(){return this._removable}set removable(t){this._removable=lr(t)}get highlighted(){return this._highlighted}set highlighted(t){this._highlighted=lr(t)}get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}constructor(t,i,r,l,d,f,b,E){super(i),this._changeDetectorRef=t,this._ngZone=r,this._focusMonitor=l,this._globalRippleOptions=b,this._onFocus=new Ft,this._onBlur=new Ft,this.role=null,this._hasFocusInternal=!1,this.id="mat-mdc-chip-"+yU++,this.ariaLabel=null,this.ariaDescription=null,this._ariaDescriptionId=`${this.id}-aria-description`,this._removable=!0,this._highlighted=!1,this.removed=new $n,this.destroyed=new $n,this.basicChipAttrName="mat-basic-chip",this._rippleLoader=St(uM),this._document=d,this._animationsDisabled="NoopAnimations"===f,null!=E&&(this.tabIndex=parseInt(E)??this.defaultTabIndex),this._monitorFocus(),this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-chip-ripple",disabled:this._isRippleDisabled()})}ngOnInit(){const t=this._elementRef.nativeElement;this._isBasicChip=t.hasAttribute(this.basicChipAttrName)||t.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=Vt(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngDoCheck(){this._rippleLoader.setDisabled(this._elementRef.nativeElement,this._isRippleDisabled())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!(!this.trailingIcon&&!this.removeIcon)}_handleKeydown(t){(8===t.keyCode||46===t.keyCode)&&(t.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(t){return this._getActions().find(i=>{const r=i._elementRef.nativeElement;return r===t||r.contains(t)})}_getActions(){const t=[];return this.primaryAction&&t.push(this.primaryAction),this.removeIcon&&t.push(this.removeIcon),this.trailingIcon&&t.push(this.trailingIcon),t}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{const i=null!==t;i!==this._hasFocusInternal&&(this._hasFocusInternal=i,i?this._onFocus.next({chip:this}):this._ngZone.onStable.pipe(Xo(1)).subscribe(()=>this._ngZone.run(()=>this._onBlur.next({chip:this}))))})}static#e=this.\u0275fac=function(i){return new(i||e)(ge($l),ge(Rn),ge(qt),ge(Sm),ge(pn),ge(xc,8),ge(ty,8),kl("tabindex"))};static#t=this.\u0275cmp=Di({type:e,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(i,r,l){if(1&i&&(qo(l,K0,5),qo(l,Y0,5),qo(l,Q0,5),qo(l,K0,5),qo(l,Y0,5),qo(l,Q0,5)),2&i){let d;Fr(d=Or())&&(r.leadingIcon=d.first),Fr(d=Or())&&(r.trailingIcon=d.first),Fr(d=Or())&&(r.removeIcon=d.first),Fr(d=Or())&&(r._allLeadingIcons=d),Fr(d=Or())&&(r._allTrailingIcons=d),Fr(d=Or())&&(r._allRemoveIcons=d)}},viewQuery:function(i,r){if(1&i&&dm(Rp,5),2&i){let l;Fr(l=Or())&&(r.primaryAction=l.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:30,hostBindings:function(i,r){1&i&&Gi("keydown",function(d){return r._handleKeydown(d)}),2&i&&(Du("id",r.id),ti("role",r.role)("tabindex",r.role?r.tabIndex:null)("aria-label",r.ariaLabel),oo("mdc-evolution-chip",!r._isBasicChip)("mdc-evolution-chip--disabled",r.disabled)("mdc-evolution-chip--with-trailing-action",r._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",r.leadingIcon)("mdc-evolution-chip--with-primary-icon",r.leadingIcon)("mdc-evolution-chip--with-avatar",r.leadingIcon)("mat-mdc-chip-with-avatar",r.leadingIcon)("mat-mdc-chip-highlighted",r.highlighted)("mat-mdc-chip-disabled",r.disabled)("mat-mdc-basic-chip",r._isBasicChip)("mat-mdc-standard-chip",!r._isBasicChip)("mat-mdc-chip-with-trailing-icon",r._hasTrailingIcon())("_mat-animation-noopable",r._animationsDisabled))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaDescription:["aria-description","ariaDescription"],value:"value",removable:"removable",highlighted:"highlighted"},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[Cn([{provide:Ey,useExisting:e}]),Ot],ngContentSelectors:jT,decls:8,vars:3,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(i,r){1&i&&(zs(UT),wr(0,"span",0),Yt(1,"span",1)(2,"span",2),ss(3,eU,2,0,"span",3),Yt(4,"span",4),Ei(5),wr(6,"span",5),bn()()(),ss(7,tU,2,0,"span",6)),2&i&&(Fi(2),$i("isInteractive",!1),Fi(1),$i("ngIf",r.leadingIcon),Fi(4),$i("ngIf",r._hasTrailingIcon()))},dependencies:[_m,Rp],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius);height:var(--mdc-chip-container-height);--mdc-chip-container-shape-family:rounded;--mdc-chip-container-shape-radius:16px 16px 16px 16px;--mdc-chip-with-avatar-avatar-shape-family:rounded;--mdc-chip-with-avatar-avatar-shape-radius:14px 14px 14px 14px;--mdc-chip-with-avatar-avatar-size:28px;--mdc-chip-with-icon-icon-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size);width:var(--mdc-chip-with-avatar-avatar-size);font-size:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font);line-height:var(--mdc-chip-label-text-line-height);font-size:var(--mdc-chip-label-text-size);font-weight:var(--mdc-chip-label-text-weight);letter-spacing:var(--mdc-chip-label-text-tracking)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size);width:var(--mdc-chip-with-icon-icon-size);font-size:var(--mdc-chip-with-icon-icon-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary.mdc-ripple-upgraded--background-focused .mdc-evolution-chip__ripple::before,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:not(.mdc-ripple-upgraded):focus .mdc-evolution-chip__ripple::before{transition-duration:75ms;opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color);opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{flex-basis:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})(),J0=(()=>{class e extends Fp{constructor(){super(...arguments),this._defaultOptions=St(wy,{optional:!0}),this.chipListSelectable=!0,this._chipListMultiple=!1,this._chipListHideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._selectable=!0,this._selected=!1,this.basicChipAttrName="mat-basic-chip-option",this.selectionChange=new $n}get selectable(){return this._selectable&&this.chipListSelectable}set selectable(t){this._selectable=lr(t),this._changeDetectorRef.markForCheck()}get selected(){return this._selected}set selected(t){this._setSelectedState(lr(t),!1,!0)}get ariaSelected(){return this.selectable?this.selected.toString():null}ngOnInit(){super.ngOnInit(),this.role="presentation"}select(){this._setSelectedState(!0,!1,!0)}deselect(){this._setSelectedState(!1,!1,!0)}selectViaInteraction(){this._setSelectedState(!0,!0,!0)}toggleSelected(t=!1){return this._setSelectedState(!this.selected,t,!0),this.selected}_handlePrimaryActionInteraction(){this.disabled||(this.focus(),this.selectable&&this.toggleSelected(!0))}_hasLeadingGraphic(){return!!this.leadingIcon||!this._chipListHideSingleSelectionIndicator||this._chipListMultiple}_setSelectedState(t,i,r){t!==this.selected&&(this._selected=t,r&&this.selectionChange.emit({source:this,isUserInput:i,selected:this.selected}),this._changeDetectorRef.markForCheck())}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=ki(e)))(r||e)}}();static#t=this.\u0275cmp=Di({type:e,selectors:[["mat-basic-chip-option"],["","mat-basic-chip-option",""],["mat-chip-option"],["","mat-chip-option",""]],hostAttrs:[1,"mat-mdc-chip","mat-mdc-chip-option"],hostVars:37,hostBindings:function(i,r){2&i&&(Du("id",r.id),ti("tabindex",null)("aria-label",null)("aria-description",null)("role",r.role),oo("mdc-evolution-chip",!r._isBasicChip)("mdc-evolution-chip--filter",!r._isBasicChip)("mdc-evolution-chip--selectable",!r._isBasicChip)("mat-mdc-chip-selected",r.selected)("mat-mdc-chip-multiple",r._chipListMultiple)("mat-mdc-chip-disabled",r.disabled)("mat-mdc-chip-with-avatar",r.leadingIcon)("mdc-evolution-chip--disabled",r.disabled)("mdc-evolution-chip--selected",r.selected)("mdc-evolution-chip--selecting",!r._animationsDisabled)("mdc-evolution-chip--with-trailing-action",r._hasTrailingIcon())("mdc-evolution-chip--with-primary-icon",r.leadingIcon)("mdc-evolution-chip--with-primary-graphic",r._hasLeadingGraphic())("mdc-evolution-chip--with-avatar",r.leadingIcon)("mat-mdc-chip-highlighted",r.highlighted)("mat-mdc-chip-with-trailing-icon",r._hasTrailingIcon()))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",selectable:"selectable",selected:"selected"},outputs:{selectionChange:"selectionChange"},features:[Cn([{provide:Fp,useExisting:e},{provide:Ey,useExisting:e}]),Ot],ngContentSelectors:jT,decls:10,vars:9,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","","role","option",3,"tabIndex","_allowFocusWhenDisabled"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"cdk-visually-hidden",3,"id"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__checkmark"],["viewBox","-2 -3 30 30","focusable","false","aria-hidden","true",1,"mdc-evolution-chip__checkmark-svg"],["fill","none","stroke","currentColor","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-evolution-chip__checkmark-path"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(i,r){1&i&&(zs(UT),wr(0,"span",0),Yt(1,"span",1)(2,"button",2),ss(3,nU,5,0,"span",3),Yt(4,"span",4),Ei(5),wr(6,"span",5),bn()()(),ss(7,iU,2,0,"span",6),Yt(8,"span",7),as(9),bn()),2&i&&(Fi(2),$i("tabIndex",r.tabIndex)("_allowFocusWhenDisabled",!0),ti("aria-selected",r.ariaSelected)("aria-label",r.ariaLabel)("aria-describedby",r._ariaDescriptionId),Fi(1),$i("ngIf",r._hasLeadingGraphic()),Fi(4),$i("ngIf",r._hasTrailingIcon()),Fi(1),$i("id",r._ariaDescriptionId),Fi(1),im(r.ariaDescription))},dependencies:[_m,Rp],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius);height:var(--mdc-chip-container-height);--mdc-chip-container-shape-family:rounded;--mdc-chip-container-shape-radius:16px 16px 16px 16px;--mdc-chip-with-avatar-avatar-shape-family:rounded;--mdc-chip-with-avatar-avatar-shape-radius:14px 14px 14px 14px;--mdc-chip-with-avatar-avatar-size:28px;--mdc-chip-with-icon-icon-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size);width:var(--mdc-chip-with-avatar-avatar-size);font-size:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font);line-height:var(--mdc-chip-label-text-line-height);font-size:var(--mdc-chip-label-text-size);font-weight:var(--mdc-chip-label-text-weight);letter-spacing:var(--mdc-chip-label-text-tracking)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size);width:var(--mdc-chip-with-icon-icon-size);font-size:var(--mdc-chip-with-icon-icon-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary.mdc-ripple-upgraded--background-focused .mdc-evolution-chip__ripple::before,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:not(.mdc-ripple-upgraded):focus .mdc-evolution-chip__ripple::before{transition-duration:75ms;opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color);opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{flex-basis:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})(),TU=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({providers:[eM,{provide:wy,useValue:{separatorKeyCodes:[13]}}],imports:[Ma,Vx,y0,Ma]})}return e})(),AU=1;const Dy={};function WT(e){return e in Dy&&(delete Dy[e],!0)}const kU={setImmediate(e){const n=AU++;return Dy[n]=!0,tw||(tw=Promise.resolve()),tw.then(()=>WT(n)&&e()),n},clearImmediate(e){WT(e)}},{setImmediate:PU,clearImmediate:RU}=kU,Sy={setImmediate(...e){const{delegate:n}=Sy;return(n?.setImmediate||PU)(...e)},clearImmediate(e){const{delegate:n}=Sy;return(n?.clearImmediate||RU)(e)},delegate:void 0},nw=new class OU extends u0{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class FU extends c0{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=Sy.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:l}=n;null!=t&&(null===(r=l[l.length-1])||void 0===r?void 0:r.id)!==t&&(Sy.clearImmediate(t),n._scheduled===t&&(n._scheduled=void 0))}});function ZT(e,n){return n?t=>Dm(n.pipe(Xo(1),function LU(){return Vn((e,n)=>{e.subscribe(Mn(n,Zr))})}()),t.pipe(ZT(e))):Un((t,i)=>we(e(t,i)).pipe(Xo(1),function NU(e){return fn(()=>e)}(t)))}function XT(e=0,n,t=XV){let i=-1;return null!=n&&(zr(n)?t=n:i=n),new _n(r=>{let l=function BU(e){return e instanceof Date&&!isNaN(e)}(e)?+e-t.now():e;l<0&&(l=0);let d=0;return t.schedule(function(){r.closed||(r.next(d++),0<=i?this.schedule(void 0,i):r.complete())},l)})}function iw(e,n=X_){const t=XT(e,n);return ZT(()=>t)}class rw{attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class zU extends rw{constructor(n,t,i,r,l){super(),this.component=n,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=l}}class KT extends rw{constructor(n,t,i,r){super(),this.templateRef=n,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(n,t=this.context){return this.context=t,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class VU extends rw{constructor(n){super(),this.element=n instanceof Rn?n.nativeElement:n}}class UU{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof zU?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof KT?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof VU?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class jU extends UU{constructor(n,t,i,r,l){super(),this.outletElement=n,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=d=>{const f=d.element,b=this._document.createComment("dom-portal");f.parentNode.insertBefore(b,f),this.outletElement.appendChild(f),this._attachedPortal=d,super.setDisposeFn(()=>{b.parentNode&&b.parentNode.replaceChild(f,b)})},this._document=l}attachComponentPortal(n){const i=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component);let r;return n.viewContainerRef?(r=n.viewContainerRef.createComponent(i,n.viewContainerRef.length,n.injector||n.viewContainerRef.injector,n.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(n.injector||this._defaultInjector||$o.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=n,r}attachTemplatePortal(n){let t=n.viewContainerRef,i=t.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=n,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let HU=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({})}return e})();const $U=["addListener","removeListener"],GU=["addEventListener","removeEventListener"],qU=["on","off"];function Bm(e,n,t,i){if($t(t)&&(i=t,t=void 0),i)return Bm(e,n,t).pipe(d0(i));const[r,l]=function XU(e){return $t(e.addEventListener)&&$t(e.removeEventListener)}(e)?GU.map(d=>f=>e[d](n,f,t)):function WU(e){return $t(e.addListener)&&$t(e.removeListener)}(e)?$U.map(YT(e,n)):function ZU(e){return $t(e.on)&&$t(e.off)}(e)?qU.map(YT(e,n)):[];if(!r&&z(e))return Un(d=>Bm(d,n,t))(we(e));if(!r)throw new TypeError("Invalid event target");return new _n(d=>{const f=(...b)=>d.next(1<b.length?b:b[0]);return r(f),()=>l(f)})}function YT(e,n){return t=>i=>e[t](n,i)}const zm={schedule(e){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=zm;i&&(n=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=n(l=>{t=void 0,e(l)});return new Qt(()=>t?.(r))},requestAnimationFrame(...e){const{delegate:n}=zm;return(n?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:n}=zm;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0};new class YU extends u0{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class KU extends c0{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=zm.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:l}=n;null!=t&&(null===(r=l[l.length-1])||void 0===r?void 0:r.id)!==t&&(zm.cancelAnimationFrame(t),n._scheduled=void 0)}});function QT(e,n=X_){return function JU(e){return Vn((n,t)=>{let i=!1,r=null,l=null,d=!1;const f=()=>{if(l?.unsubscribe(),l=null,i){i=!1;const E=r;r=null,t.next(E)}d&&t.complete()},b=()=>{l=null,d&&t.complete()};n.subscribe(Mn(t,E=>{i=!0,r=E,l||we(e(E)).subscribe(l=Mn(t,f,b))},()=>{d=!0,(!i||!l||l.closed)&&t.complete()}))})}(()=>XT(e,n))}let tj=(()=>{class e{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new Ft,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new _n(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(QT(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ni()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(wo(l=>!l||r.indexOf(l)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,l)=>{this._scrollableContainsElement(l,t)&&i.push(l)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Ap(i),l=t.getElementRef().nativeElement;do{if(r==l)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Bm(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(qt),Te(us),Te(pn,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),JT=(()=>{class e{constructor(t,i,r){this._platform=t,this._change=new Ft,this._changeListener=l=>{this._change.next(l)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,l=r.getBoundingClientRect();return{top:-l.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-l.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(QT(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||e)(Te(us),Te(qt),Te(pn,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ow=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({})}return e})(),eA=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({imports:[Im,ow,Im,ow]})}return e})();const tA=AV();class ij{constructor(n,t){this._viewportRuler=n,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=Cr(-this._previousScrollPosition.left),n.style.top=Cr(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,i=n.style,r=this._document.body.style,l=i.scrollBehavior||"",d=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),tA&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),tA&&(i.scrollBehavior=l,r.scrollBehavior=d)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class rj{constructor(n,t,i,r){this._scrollDispatcher=n,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(wo(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class nA{enable(){}disable(){}attach(){}}function sw(e,n){return n.some(t=>e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right)}function iA(e,n){return n.some(t=>e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}class oj{constructor(n,t,i,r){this._scrollDispatcher=n,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();sw(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let sj=(()=>{class e{constructor(t,i,r,l){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new nA,this.close=d=>new rj(this._scrollDispatcher,this._ngZone,this._viewportRuler,d),this.block=()=>new ij(this._viewportRuler,this._document),this.reposition=d=>new oj(this._scrollDispatcher,this._viewportRuler,this._ngZone,d),this._document=l}static#e=this.\u0275fac=function(i){return new(i||e)(Te(tj),Te(JT),Te(qt),Te(pn))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class rA{constructor(n){if(this.scrollStrategy=new nA,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,n){const t=Object.keys(n);for(const i of t)void 0!==n[i]&&(this[i]=n[i])}}}class aj{constructor(n,t){this.connectionPair=n,this.scrollableViewProperties=t}}let oA=(()=>{class e{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),lj=(()=>{class e extends oA{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const l=this._attachedOverlays;for(let d=l.length-1;d>-1;d--)if(l[d]._keydownEvents.observers.length>0){const f=l[d]._keydownEvents;this._ngZone?this._ngZone.run(()=>f.next(r)):f.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn),Te(qt,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),cj=(()=>{class e extends oA{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=l=>{this._pointerDownEventTarget=Au(l)},this._clickListener=l=>{const d=Au(l),f="click"===l.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:d;this._pointerDownEventTarget=null;const b=this._attachedOverlays.slice();for(let E=b.length-1;E>-1;E--){const T=b[E];if(T._outsidePointerEvents.observers.length<1||!T.hasAttached())continue;if(T.overlayElement.contains(d)||T.overlayElement.contains(f))break;const P=T._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>P.next(l)):P.next(l)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn),Te(us),Te(qt,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),sA=(()=>{class e{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||n0()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let l=0;l<r.length;l++)r[l].remove()}const i=this._document.createElement("div");i.classList.add(t),n0()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn),Te(us))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class uj{constructor(n,t,i,r,l,d,f,b,E,T=!1){this._portalOutlet=n,this._host=t,this._pane=i,this._config=r,this._ngZone=l,this._keyboardDispatcher=d,this._document=f,this._location=b,this._outsideClickDispatcher=E,this._animationsDisabled=T,this._backdropElement=null,this._backdropClick=new Ft,this._attachments=new Ft,this._detachments=new Ft,this._locationChanges=Qt.EMPTY,this._backdropClickHandler=P=>this._backdropClick.next(P),this._backdropTransitionendHandler=P=>{this._disposeBackdrop(P.target)},this._keydownEvents=new Ft,this._outsidePointerEvents=new Ft,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(n){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(n);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Xo(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,n&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=Cr(this._config.width),n.height=Cr(this._config.height),n.minWidth=Cr(this._config.minWidth),n.minHeight=Cr(this._config.minHeight),n.maxWidth=Cr(this._config.maxWidth),n.maxHeight=Cr(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(n)})}):this._backdropElement.classList.add(n)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const n=this._backdropElement;if(n){if(this._animationsDisabled)return void this._disposeBackdrop(n);n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{n.addEventListener("transitionend",this._backdropTransitionendHandler)}),n.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(n)},500))}}_toggleClasses(n,t,i){const r=K_(t||[]).filter(l=>!!l);r.length&&(i?n.classList.add(...r):n.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const n=this._ngZone.onStable.pipe(Eo(Vt(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),n.unsubscribe())})})}_disposeScrollStrategy(){const n=this._scrollStrategy;n&&(n.disable(),n.detach&&n.detach())}_disposeBackdrop(n){n&&(n.removeEventListener("click",this._backdropClickHandler),n.removeEventListener("transitionend",this._backdropTransitionendHandler),n.remove(),this._backdropElement===n&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const aA="cdk-overlay-connected-position-bounding-box",dj=/([A-Za-z%]+)$/;class hj{get positions(){return this._preferredPositions}constructor(n,t,i,r,l){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=l,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Ft,this._resizeSubscription=Qt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(aA),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,l=[];let d;for(let f of this._preferredPositions){let b=this._getOriginPoint(n,r,f),E=this._getOverlayPoint(b,t,f),T=this._getOverlayFit(E,t,i,f);if(T.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(f,b);this._canFitWithFlexibleDimensions(T,E,i)?l.push({position:f,origin:b,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(b,f)}):(!d||d.overlayFit.visibleArea<T.visibleArea)&&(d={overlayFit:T,overlayPoint:E,originPoint:b,position:f,overlayRect:t})}if(l.length){let f=null,b=-1;for(const E of l){const T=E.boundingBoxRect.width*E.boundingBoxRect.height*(E.position.weight||1);T>b&&(b=T,f=E)}return this._isPushed=!1,void this._applyPosition(f.position,f.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(d.position,d.originPoint);this._applyPosition(d.position,d.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&rh(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(aA),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;if(n){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,n);this._applyPosition(n,t)}else this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}_getOriginPoint(n,t,i){let r,l;if("center"==i.originX)r=n.left+n.width/2;else{const d=this._isRtl()?n.right:n.left,f=this._isRtl()?n.left:n.right;r="start"==i.originX?d:f}return t.left<0&&(r-=t.left),l="center"==i.originY?n.top+n.height/2:"top"==i.originY?n.top:n.bottom,t.top<0&&(l-=t.top),{x:r,y:l}}_getOverlayPoint(n,t,i){let r,l;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,l="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:n.x+r,y:n.y+l}}_getOverlayFit(n,t,i,r){const l=cA(t);let{x:d,y:f}=n,b=this._getOffset(r,"x"),E=this._getOffset(r,"y");b&&(d+=b),E&&(f+=E);let U=0-f,$=f+l.height-i.height,Q=this._subtractOverflows(l.width,0-d,d+l.width-i.width),oe=this._subtractOverflows(l.height,U,$),_e=Q*oe;return{visibleArea:_e,isCompletelyWithinViewport:l.width*l.height===_e,fitsInViewportVertically:oe===l.height,fitsInViewportHorizontally:Q==l.width}}_canFitWithFlexibleDimensions(n,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,l=i.right-t.x,d=lA(this._overlayRef.getConfig().minHeight),f=lA(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=d&&d<=r)&&(n.fitsInViewportHorizontally||null!=f&&f<=l)}return!1}_pushOverlayOnScreen(n,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const r=cA(t),l=this._viewportRect,d=Math.max(n.x+r.width-l.width,0),f=Math.max(n.y+r.height-l.height,0),b=Math.max(l.top-i.top-n.y,0),E=Math.max(l.left-i.left-n.x,0);let T=0,P=0;return T=r.width<=l.width?E||-d:n.x<this._viewportMargin?l.left-i.left-n.x:0,P=r.height<=l.height?b||-f:n.y<this._viewportMargin?l.top-i.top-n.y:0,this._previousPushAmount={x:T,y:P},{x:n.x+T,y:n.y+P}}_applyPosition(n,t){if(this._setTransformOrigin(n),this._setOverlayElementStyles(t,n),this._setBoundingBoxStyles(t,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._lastPosition=n,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new aj(n,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=n.overlayY;i="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let l=0;l<t.length;l++)t[l].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(n,t){const i=this._viewportRect,r=this._isRtl();let l,d,f,T,P,U;if("top"===t.overlayY)d=n.y,l=i.height-d+this._viewportMargin;else if("bottom"===t.overlayY)f=i.height-n.y+2*this._viewportMargin,l=i.height-f+this._viewportMargin;else{const $=Math.min(i.bottom-n.y+i.top,n.y),Q=this._lastBoundingBoxSize.height;l=2*$,d=n.y-$,l>Q&&!this._isInitialRender&&!this._growAfterOpen&&(d=n.y-Q/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)U=i.width-n.x+this._viewportMargin,T=n.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)P=n.x,T=i.right-n.x;else{const $=Math.min(i.right-n.x+i.left,n.x),Q=this._lastBoundingBoxSize.width;T=2*$,P=n.x-$,T>Q&&!this._isInitialRender&&!this._growAfterOpen&&(P=n.x-Q/2)}return{top:d,left:P,bottom:f,right:U,width:T,height:l}}_setBoundingBoxStyles(n,t){const i=this._calculateBoundingBoxRect(n,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const l=this._overlayRef.getConfig().maxHeight,d=this._overlayRef.getConfig().maxWidth;r.height=Cr(i.height),r.top=Cr(i.top),r.bottom=Cr(i.bottom),r.width=Cr(i.width),r.left=Cr(i.left),r.right=Cr(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",l&&(r.maxHeight=Cr(l)),d&&(r.maxWidth=Cr(d))}this._lastBoundingBoxSize=i,rh(this._boundingBox.style,r)}_resetBoundingBoxStyles(){rh(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){rh(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,t){const i={},r=this._hasExactPosition(),l=this._hasFlexibleDimensions,d=this._overlayRef.getConfig();if(r){const T=this._viewportRuler.getViewportScrollPosition();rh(i,this._getExactOverlayY(t,n,T)),rh(i,this._getExactOverlayX(t,n,T))}else i.position="static";let f="",b=this._getOffset(t,"x"),E=this._getOffset(t,"y");b&&(f+=`translateX(${b}px) `),E&&(f+=`translateY(${E}px)`),i.transform=f.trim(),d.maxHeight&&(r?i.maxHeight=Cr(d.maxHeight):l&&(i.maxHeight="")),d.maxWidth&&(r?i.maxWidth=Cr(d.maxWidth):l&&(i.maxWidth="")),rh(this._pane.style,i)}_getExactOverlayY(n,t,i){let r={top:"",bottom:""},l=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(l=this._pushOverlayOnScreen(l,this._overlayRect,i)),"bottom"===n.overlayY?r.bottom=this._document.documentElement.clientHeight-(l.y+this._overlayRect.height)+"px":r.top=Cr(l.y),r}_getExactOverlayX(n,t,i){let d,r={left:"",right:""},l=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(l=this._pushOverlayOnScreen(l,this._overlayRect,i)),d=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===d?r.right=this._document.documentElement.clientWidth-(l.x+this._overlayRect.width)+"px":r.left=Cr(l.x),r}_getScrollVisibility(){const n=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:iA(n,i),isOriginOutsideView:sw(n,i),isOverlayClipped:iA(t,i),isOverlayOutsideView:sw(t,i)}}_subtractOverflows(n,...t){return t.reduce((i,r)=>i-Math.max(r,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+n-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:n-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,t){return"x"===t?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&K_(n).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getOriginRect(){const n=this._origin;if(n instanceof Rn)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const t=n.width||0,i=n.height||0;return{top:n.y,bottom:n.y+i,left:n.x,right:n.x+t,height:i,width:t}}}function rh(e,n){for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function lA(e){if("number"!=typeof e&&null!=e){const[n,t]=e.split(dj);return t&&"px"!==t?null:parseFloat(n)}return e||null}function cA(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const uA="cdk-global-overlay-wrapper";class pj{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(n){const t=n.getConfig();this._overlayRef=n,this._width&&!t.width&&n.updateSize({width:this._width}),this._height&&!t.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(uA),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:l,maxWidth:d,maxHeight:f}=i,b=!("100%"!==r&&"100vw"!==r||d&&"100%"!==d&&"100vw"!==d),E=!("100%"!==l&&"100vh"!==l||f&&"100%"!==f&&"100vh"!==f),T=this._xPosition,P=this._xOffset,U="rtl"===this._overlayRef.getConfig().direction;let $="",Q="",oe="";b?oe="flex-start":"center"===T?(oe="center",U?Q=P:$=P):U?"left"===T||"end"===T?(oe="flex-end",$=P):("right"===T||"start"===T)&&(oe="flex-start",Q=P):"left"===T||"start"===T?(oe="flex-start",$=P):("right"===T||"end"===T)&&(oe="flex-end",Q=P),n.position=this._cssPosition,n.marginLeft=b?"0":$,n.marginTop=E?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=b?"0":Q,t.justifyContent=oe,t.alignItems=E?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(uA),i.justifyContent=i.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let fj=(()=>{class e{constructor(t,i,r,l){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=l}global(){return new pj}flexibleConnectedTo(t){return new hj(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(JT),Te(pn),Te(us),Te(sA))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),mj=0,Iy=(()=>{class e{constructor(t,i,r,l,d,f,b,E,T,P,U,$){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=l,this._keyboardDispatcher=d,this._injector=f,this._ngZone=b,this._document=E,this._directionality=T,this._location=P,this._outsideClickDispatcher=U,this._animationsModuleType=$}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),l=this._createPortalOutlet(r),d=new rA(t);return d.direction=d.direction||this._directionality.value,new uj(l,i,r,d,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+mj++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Iu)),new jU(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(sj),Te(sA),Te(Gf),Te(fj),Te(lj),Te($o),Te(qt),Te(pn),Te(Q_),Te(WS),Te(cj),Te(xc,8))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const yj={provide:new Oe("cdk-connected-overlay-scroll-strategy"),deps:[Iy],useFactory:function _j(e){return()=>e.scrollStrategies.reposition()}};let vj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({providers:[Iy,yj],imports:[Im,HU,eA,eA]})}return e})();const bj=["mat-menu-item",""];function xj(e,n){1&e&&(mf(),Yt(0,"svg",3),wr(1,"polygon",4),bn())}const wj=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Ej=["mat-icon, [matMenuItemIcon]","*"];function Cj(e,n){if(1&e){const t=function KE(){return Pe()}();Yt(0,"div",0),Gi("keydown",function(r){return vd(t),bd(Gd()._handleKeydown(r))})("click",function(){return vd(t),bd(Gd().closed.emit("click"))})("@transformMenu.start",function(r){return vd(t),bd(Gd()._onAnimationStart(r))})("@transformMenu.done",function(r){return vd(t),bd(Gd()._onAnimationDone(r))}),Yt(1,"div",1),Ei(2),bn()()}if(2&e){const t=Gd();$i("id",t.panelId)("ngClass",t._classList)("@transformMenu",t._panelAnimationState),ti("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const Dj=["*"],aw=new Oe("MAT_MENU_PANEL"),Sj=g0(m0(class{}));let My=(()=>{class e extends Sj{constructor(t,i,r,l,d){super(),this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=l,this._changeDetectorRef=d,this.role="menuitem",this._hovered=new Ft,this._focused=new Ft,this._highlighted=!1,this._triggersSubmenu=!1,l?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(pn),ge(Sm),ge(aw,8),ge($l))};static#t=this.\u0275cmp=Di({type:e,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(i,r){1&i&&Gi("click",function(d){return r._checkDisabled(d)})("mouseenter",function(){return r._handleMouseEnter()}),2&i&&(ti("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),oo("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[Ot],attrs:bj,ngContentSelectors:Ej,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-mdc-menu-submenu-icon","viewBox","0 0 5 10","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(i,r){1&i&&(zs(wj),Ei(0),Yt(1,"span",0),Ei(2,1),bn(),wr(3,"div",1),ss(4,xj,2,0,"svg",2)),2&i&&(Fi(3),$i("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),Fi(1),$i("ngIf",r._triggersSubmenu))},dependencies:[_m,sM],encapsulation:2,changeDetection:0})}return e})();const Ij=new Oe("MatMenuContent"),Ty={transformMenu:q0("transformMenu",[W0("void",Tc({opacity:0,transform:"scale(0.8)"})),xy("void => enter",by("120ms cubic-bezier(0, 0, 0.2, 1)",Tc({opacity:1,transform:"scale(1)"}))),xy("* => void",by("100ms 25ms linear",Tc({opacity:0})))]),fadeInItems:q0("fadeInItems",[W0("showing",Tc({opacity:1})),xy("void => *",[Tc({opacity:0}),by("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Mj=0;const dA=new Oe("mat-menu-default-options",{providedIn:"root",factory:function Tj(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let Vm=(()=>{class e{get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(t){this._overlapTrigger=lr(t)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=lr(t)}set panelClass(t){const i=this._previousPanelClass;i&&i.length&&i.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(t){this.panelClass=t}constructor(t,i,r,l){this._elementRef=t,this._ngZone=i,this._changeDetectorRef=l,this._directDescendantItems=new Xd,this._classList={},this._panelAnimationState="void",this._animationDone=new Ft,this.closed=new $n,this.close=this.closed,this.panelId="mat-menu-panel-"+Mj++,this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this._overlapTrigger=r.overlapTrigger,this._hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new WI(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(ku(this._directDescendantItems),ws(t=>Vt(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),l=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[l]&&!r[l].disabled?i.setActiveItem(l):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe(ku(this._directDescendantItems),ws(i=>Vt(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:W_(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe(Xo(1)).subscribe(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,l=Object.keys(this._classList).find(d=>d.startsWith(this._elevationPrefix));(!l||l===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(t=this.xPosition,i=this.yPosition){const r=this._classList;r["mat-menu-before"]="before"===t,r["mat-menu-after"]="after"===t,r["mat-menu-above"]="above"===i,r["mat-menu-below"]="below"===i,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(ku(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(qt),ge(dA),ge($l))};static#t=this.\u0275dir=mt({type:e,contentQueries:function(i,r,l){if(1&i&&(qo(l,Ij,5),qo(l,My,5),qo(l,My,4)),2&i){let d;Fr(d=Or())&&(r.lazyContent=d.first),Fr(d=Or())&&(r._allItems=d),Fr(d=Or())&&(r.items=d)}},viewQuery:function(i,r){if(1&i&&dm(jl,5),2&i){let l;Fr(l=Or())&&(r.templateRef=l.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}})}return e})(),Aj=(()=>{class e extends Vm{constructor(t,i,r,l){super(t,i,r,l),this._elevationPrefix="mat-elevation-z",this._baseElevation=8}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Rn),ge(qt),ge(dA),ge($l))};static#t=this.\u0275cmp=Di({type:e,selectors:[["mat-menu"]],hostAttrs:["ngSkipHydration",""],hostVars:3,hostBindings:function(i,r){2&i&&ti("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Cn([{provide:aw,useExisting:e}]),Ot],ngContentSelectors:Dj,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"id","ngClass","keydown","click"],[1,"mat-mdc-menu-content"]],template:function(i,r){1&i&&(zs(),ss(0,Cj,3,6,"ng-template"))},dependencies:[rI],styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;white-space:normal;font-family:var(--mat-menu-item-label-text-font);line-height:var(--mat-menu-item-label-text-line-height);font-size:var(--mat-menu-item-label-text-size);letter-spacing:var(--mat-menu-item-label-text-tracking);font-weight:var(--mat-menu-item-label-text-weight)}.mat-mdc-menu-panel{--mat-menu-container-shape:4px;min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape);background-color:var(--mat-menu-container-color);will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;align-items:center;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color)}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color)}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{margin-right:16px}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:16px}.mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-mdc-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[Ty.transformMenu,Ty.fadeInItems]},changeDetection:0})}return e})();const hA=new Oe("mat-menu-scroll-strategy"),Pj={provide:hA,deps:[Iy],useFactory:function kj(e){return()=>e.scrollStrategies.reposition()}},pA=xm({passive:!0});let Rj=(()=>{class e{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(t,i,r,l,d,f,b,E,T){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=f,this._dir=b,this._focusMonitor=E,this._ngZone=T,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=Qt.EMPTY,this._hoverSubscription=Qt.EMPTY,this._menuCloseSubscription=Qt.EMPTY,this._changeDetectorRef=St($l),this._handleTouchStart=P=>{p0(P)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new $n,this.onMenuOpen=this.menuOpened,this.menuClosed=new $n,this.onMenuClose=this.menuClosed,this._scrollStrategy=l,this._parentMaterialMenu=d instanceof Vm?d:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,pA)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,pA),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const i=this._createOverlay(t),r=i.getConfig(),l=r.positionStrategy;this._setPosition(t,l),r.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,i.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof Vm&&(t._startAnimation(),t._directDescendantItems.changes.pipe(Eo(t.close)).subscribe(()=>{l.withLockedPosition(!1).reapplyLastPosition(),l.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof Vm?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(wo(r=>"void"===r.toState),Xo(1),Eo(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let i=0,r=t.parentMenu;for(;r;)i++,r=r.parentMenu;t.setElevation(i)}}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new rA({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{const l="start"===r.connectionPair.overlayX?"after":"before",d="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(l,d)):t.setPositionClasses(l,d)})}_setPosition(t,i){let[r,l]="before"===t.xPosition?["end","start"]:["start","end"],[d,f]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[b,E]=[d,f],[T,P]=[r,l],U=0;if(this.triggersSubmenu()){if(P=r="before"===t.xPosition?"start":"end",l=T="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const $=this._parentMaterialMenu.items.first;this._parentInnerPadding=$?$._getHostElement().offsetTop:0}U="bottom"===d?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(b="top"===d?"bottom":"top",E="top"===f?"bottom":"top");i.withPositions([{originX:r,originY:b,overlayX:T,overlayY:d,offsetY:U},{originX:l,originY:b,overlayX:P,overlayY:d,offsetY:U},{originX:r,originY:E,overlayX:T,overlayY:f,offsetY:-U},{originX:l,originY:E,overlayX:P,overlayY:f,offsetY:-U}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return Vt(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:Ni(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(wo(d=>d!==this._menuItemInstance),wo(()=>this._menuOpen)):Ni(),i)}_handleMousedown(t){h0(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(wo(t=>t===this._menuItemInstance&&!t.disabled),iw(0,nw)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof Vm&&this.menu._isAnimating?this.menu._animationDone.pipe(Xo(1),iw(0,nw),Eo(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new KT(t.templateRef,this._viewContainerRef)),this._portal}static#e=this.\u0275fac=function(i){return new(i||e)(ge(Iy),ge(Rn),ge(Ka),ge(hA),ge(aw,8),ge(My,10),ge(Q_,8),ge(Sm),ge(qt))};static#t=this.\u0275dir=mt({type:e,hostVars:3,hostBindings:function(i,r){1&i&&Gi("click",function(d){return r._handleClick(d)})("mousedown",function(d){return r._handleMousedown(d)})("keydown",function(d){return r._handleKeydown(d)}),2&i&&ti("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}})}return e})(),Fj=(()=>{class e extends Rj{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=ki(e)))(r||e)}}();static#t=this.\u0275dir=mt({type:e,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],exportAs:["matMenuTrigger"],features:[Ot]})}return e})(),Oj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({providers:[Pj],imports:[Vx,y0,Ma,vj,ow,Ma]})}return e})();const Lj=JSON.parse('{"data":[{"id":1,"name":"Japanese Sword Museum","city":"Tokyo","lat":35.6986389,"lng":139.7912029,"photo":"https://www.touken.or.jp/Portals/0/images/museum/img_kv04_\u6b63\u9762\u7384\u95a2.jpg","notes":"Japanese swords spanning several centuries displayed in a modern museum with gardens.","url":"https://www.touken.or.jp/english/"},{"id":2,"name":"Kurashiki Art Sword Museum","city":"Kurashiki","lat":34.577528,"lng":133.8223832,"photo":"https://www.touken-sato.com/top-01.jpg","notes":"Nothing for now","url":"https://touken-sato.com"},{"id":3,"name":"The Metropolitan Museum of Art","city":"New York","lat":40.7794273,"lng":-73.9634904,"photo":"https://cdn.sanity.io/images/cctd4ker/production/73a42b4ea1644b2085acaad2896bfa4699687664-2320x920.jpg","notes":"Over 5,000 years of art from around the world.","url":"https://www.metmuseum.org/"},{"id":4,"name":"Rijksmuseum","city":"Amsterdam","lat":52.3599976,"lng":4.8826439,"photo":"https://www.artnews.com/wp-content/uploads/2023/02/GettyImages-1215971600-copy-1.jpg","notes":"Collected Works of Taisei Yamaguchi","url":"https://www.rijksmuseum.nl/en/rijksstudio/3277561--taisei-yamaguchi/collections"},{"id":5,"name":"Museo Stibbert","city":"Firenze","lat":43.7927544,"lng":11.2525549,"photo":"https://www.museostibbert.it/frontend/img/header_ridotto5.jpg","notes":"Japanese Armoury","url":"https://www.museostibbert.it"}]}');var Nj=ps.t(Lj,2);let fA=(()=>{class e{constructor(){this.katanaLocationList=Nj.data}getAllKatanaLocations(){return this.katanaLocationList??[]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let mA=(()=>{class e{constructor(){this.katanaLocationList=[],this.katanaService=St(fA),this.appVersion="0.1.0",this.katanaLocationList=this.katanaService.getAllKatanaLocations()}onShare(){navigator.share({url:location.href,title:"Katana Map",text:"Map of places, where to see katana swords"})}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Di({type:e,selectors:[["app-navbar"]],standalone:!0,features:[vD],decls:33,vars:3,consts:[["mat-icon-button","","aria-label","Menu icon",1,"example-icon",3,"matMenuTriggerFor"],[1,"example-spacer"],["color","accent","selected","","disabled",""],["mat-icon-button","","href","https://github.com/aleksandr-vin/katana-map/wiki/Adding-location","aria-label","Add location","target","_blank"],["mat-icon-button","","aria-label","Share",1,"example-icon",3,"click"],["menu","matMenu"],["mat-menu-item","","href","https://github.com/aleksandr-vin/katana-map/wiki/About","aria-label","About","target","_blank"],["mat-menu-item","","href","https://github.com/aleksandr-vin/katana-map/wiki/Adding-location","aria-label","Add location","target","_blank"],["mat-menu-item","","href","https://github.com/aleksandr-vin/katana-map/commits/main","aria-label","Versions","target","_blank"]],template:function(i,r){if(1&i&&(Yt(0,"mat-toolbar")(1,"button",0)(2,"mat-icon"),as(3,"menu"),bn()(),Yt(4,"span"),as(5,"Katana Map"),bn(),wr(6,"span",1),Yt(7,"mat-chip-option",2),as(8),bn(),wr(9,"span",1),Yt(10,"a",3)(11,"mat-icon"),as(12,"add"),bn()(),Yt(13,"button",4),Gi("click",function(){return r.onShare()}),Yt(14,"mat-icon"),as(15,"share"),bn()()(),Yt(16,"mat-menu",null,5)(18,"a",6)(19,"mat-icon"),as(20,"info"),bn(),Yt(21,"span"),as(22,"About"),bn()(),Yt(23,"a",7)(24,"mat-icon"),as(25,"add"),bn(),Yt(26,"span"),as(27,"Add location"),bn()(),Yt(28,"a",8)(29,"mat-icon"),as(30,"open_in_new"),bn(),Yt(31,"span"),as(32),bn()()()),2&i){const l=function zb(e){return function ha(e,n){return e[n]}(function sg(){return kt.lFrame.contextLView}(),Gt+e)}(17);Fi(1),$i("matMenuTriggerFor",l),Fi(7),im(r.katanaLocationList.length),Fi(24),__("Version ",r.appVersion,"")}},dependencies:[G5,$5,z5,B5,N5,I5,S5,TU,J0,Oj,Aj,My,Fj],styles:[".heading[_ngcontent-%COMP%]{margin:0;padding:0;background-color:#f2f4f5;color:#000}.heading[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{padding:3px;margin:0}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]})}return e})();var Zt=ps(624);const Uj="function"==typeof btoa,Op="function"==typeof Buffer,Um=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),so=((e=>{let n={};e.forEach((t,i)=>n[t]=i)})(Um),String.fromCharCode.bind(String)),bA=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,n=>"+"==n?"-":"_")),lw=Uj?e=>btoa(e):Op?e=>Buffer.from(e,"binary").toString("base64"):e=>{let n,t,i,r,l="";const d=e.length%3;for(let f=0;f<e.length;){if((t=e.charCodeAt(f++))>255||(i=e.charCodeAt(f++))>255||(r=e.charCodeAt(f++))>255)throw new TypeError("invalid character found");n=t<<16|i<<8|r,l+=Um[n>>18&63]+Um[n>>12&63]+Um[n>>6&63]+Um[63&n]}return d?l.slice(0,d-3)+"===".substring(d):l},cw=Op?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let i=0,r=e.length;i<r;i+=4096)t.push(so.apply(null,e.subarray(i,i+4096)));return lw(t.join(""))},Kj_fromUint8Array=(e,n=!1)=>n?bA(cw(e)):cw(e);var Yj=ps(16);function FA(e,n,t,i,r,l,d){try{var f=e[l](d),b=f.value}catch(E){return void t(E)}f.done?n(b):Promise.resolve(b).then(i,r)}function Ac(e){return function(){var n=this,t=arguments;return new Promise(function(i,r){var l=e.apply(n,t);function d(b){FA(l,i,r,d,f,"next",b)}function f(b){FA(l,i,r,d,f,"throw",b)}d(void 0)})}}Math;const ds=new class i6{constructor(){this._apiKey="",this._fetch=function n6(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}()}set apiKey(n){this._apiKey=n}get apiKey(){return this._apiKey}set fetch(n){this._fetch=n}get fetch(){return this._fetch}};function fw(){return(fw=Ac(function*(e,n={}){if(null===ds.fetch)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(""===new URL(e).searchParams.get("key").trim())throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return ds.fetch(e,n)})).apply(this,arguments)}new Set(Object.values({AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"}));const Ta={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(Ta);class Bu extends Error{constructor(n,t=""){super(`Call to enpoint ${n.url} failed with the status code ${n.status}. ${t}`),this.res=n}}const $A={403:"Key is missing, invalid or restricted"};function vw(){return(vw=Ac(function*(e={}){const n=new URL("geolocation/ip.json",Ta.maptilerApiURL);n.searchParams.set("key",e.apiKey??ds.apiKey);const t=n.toString(),i=yield function Nu(e){return fw.apply(this,arguments)}(t);if(!i.ok)throw new Bu(i,i.status in $A?$A[i.status]:"");return yield i.json()})).apply(this,arguments)}const GA={info:function u6(){return vw.apply(this,arguments)}};function WA(e){let t;const i=e.trim();let r;return r=i.startsWith("http://")||i.startsWith("https://")?i:null!==(t=/^maptiler:\/\/(.*)/.exec(i))?`https://api.maptiler.com/maps/${t[1]}/style.json`:`https://api.maptiler.com/maps/${i}/style.json`,r}class Ew{constructor(n,t,i,r,l,d){this.name=n,this.variantType=t,this.id=i,this.referenceStyle=r,this.description=l,this.imageURL=d}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(n){return this.referenceStyle.hasVariant(n)}getVariant(n){return this.referenceStyle.getVariant(n)}getVariants(){return this.referenceStyle.getVariants().filter(n=>n!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return WA(this.getId())}}class Cw{constructor(n,t){this.name=n,this.id=t,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(n){this.variants[n.getType()]=n,this.orderedVariants.push(n)}hasVariant(n){return n in this.variants}getVariant(n){return n in this.variants?this.variants[n]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Ny=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function f6(e){return new Proxy(e,{get:(n,t,i)=>n.hasVariant(t)?n.getVariant(t):t.toString().toUpperCase()===t?e.getDefaultVariant():Reflect.get(n,t,i)})}const Sw=function m6(){const e={};for(let n=0;n<Ny.length;n+=1){const t=Ny[n],i=f6(new Cw(t.name,t.referenceStyleID));for(let r=0;r<t.variants.length;r+=1){const l=t.variants[r],d=new Ew(l.name,l.variantType,l.id,i,l.description,l.imageURL);i.addVariant(d)}e[t.referenceStyleID]=i}return e}(),KA={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let By;const O6=new Uint8Array(16);function L6(){if(!By&&(By=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!By))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return By(O6)}const ao=[];for(let e=0;e<256;++e)ao.push((e+256).toString(16).slice(1));const el={AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"latin",NON_LATIN:"nonlatin",LOCAL:"",ALBANIAN:"sq",AMHARIC:"am",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BASQUE:"eu",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CORSICAN:"co",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HINDI:"hi",HUNGARIAN:"hu",ICELANDIC:"is",INDONESIAN:"id",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",JAPANESE_HIRAGANA:"ja-Hira",JAPANESE_KANA:"ja_kana",JAPANESE_LATIN:"ja_rm",JAPANESE_2018:"ja-Latn",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",KOREAN_LATIN:"ko-Latn",KURDISH:"ku",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALAYALAM:"ml",MALTESE:"mt",NORWEGIAN:"no",OCCITAN:"oc",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SERBIAN_LATIN:"sr-Latn",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",TAMIL:"ta",TELUGU:"te",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"},z6=new Set(Object.values(el));function QA(e){return z6.has(e)}const V6=new Set(Object.values(el));function Fw(){if(typeof navigator>"u")return Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];const e=Array.from(new Set(navigator.languages.map(n=>n.split("-")[0]))).filter(n=>V6.has(n));return e.length?e[0]:el.LATIN}const JA=function N6(e,n,t){if(KA.randomUUID&&!n&&!e)return KA.randomUUID();const i=(e=e||{}).random||(e.rng||L6)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,n){t=t||0;for(let r=0;r<16;++r)n[t+r]=i[r];return n}return function YA(e,n=0){return ao[e[n+0]]+ao[e[n+1]]+ao[e[n+2]]+ao[e[n+3]]+"-"+ao[e[n+4]]+ao[e[n+5]]+"-"+ao[e[n+6]]+ao[e[n+7]]+"-"+ao[e[n+8]]+ao[e[n+9]]+"-"+ao[e[n+10]]+ao[e[n+11]]+ao[e[n+12]]+ao[e[n+13]]+ao[e[n+14]]+ao[e[n+15]]}(i)}(),tl=new class U6 extends Yj{constructor(){super(),this.primaryLanguage=el.AUTO,this.secondaryLanguage=null,this.session=!0,this._unit="metric",this._apiKey=""}set unit(n){this._unit=n,this.emit("unit",n)}get unit(){return this._unit}set apiKey(n){this._apiKey=n,ds.apiKey=n,this.emit("apiKey",n)}get apiKey(){return this._apiKey}set fetch(n){ds.fetch=n}get fetch(){return ds.fetch}},hs={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:el.AUTO,secondaryLanguage:el.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(hs);class j6 extends Zt.LogoControl{onAdd(n){return super.onAdd(n)}}class ek extends j6{constructor(n={}){var t,i;super(n),this.logoURL="",this.linkURL="",this.logoURL=null!=(t=n.logoURL)?t:hs.maptilerLogoURL,this.linkURL=null!=(i=n.linkURL)?i:hs.maptilerURL}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const t=window.document.createElement("a");return t.style.backgroundRepeat="no-repeat",t.style.cursor="pointer",t.style.display="block",t.style.height="23px",t.style.margin="0 0 -4px -4px",t.style.overflow="hidden",t.style.width="88px",t.style.backgroundImage=`url(${this.logoURL})`,t.style.backgroundSize="100px 30px",t.style.width="100px",t.style.height="30px",t.target="_blank",t.rel="noopener",t.href=this.linkURL,t.setAttribute("aria-label","MapTiler logo"),t.setAttribute("rel","noopener"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var H6=Object.defineProperty,tk=Object.getOwnPropertySymbols,$6=Object.prototype.hasOwnProperty,G6=Object.prototype.propertyIsEnumerable,nk=(e,n,t)=>n in e?H6(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,ik=(e,n)=>{for(var t in n||(n={}))$6.call(n,t)&&nk(e,t,n[t]);if(tk)for(var t of tk(n))G6.call(n,t)&&nk(e,t,n[t]);return e};function sh(e,n,t){const i=window.document.createElement(e);return void 0!==n&&(i.className=n),t&&t.appendChild(i),i}function rk(e,n){let t=null;try{t=new URL(e)}catch{return{url:e}}return t.host===hs.maptilerApiHost&&(t.searchParams.has("key")||t.searchParams.append("key",tl.apiKey),tl.session&&t.searchParams.append("mtsid",JA)),{url:t.href}}function ok(e=null){return function(n,t){if(e){const i=e(n,t),r=rk(i.url);return ik(ik({},i),r)}return rk(n)}}function sk(e){return e?"string"==typeof e||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:WA(e):e instanceof Ew?e.getExpandedStyleURL():e instanceof Cw?e.getDefaultVariant().getExpandedStyleURL():e:Sw[Ny[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class X6{constructor(){!function W6(e,n){e.forEach(t=>{n[t]&&(n[t]=n[t].bind(n))})}(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(n){return this._map=n,this._container=sh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=sh("button","maplibregl-ctrl-terrain",this._container),sh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){(function Z6(e){e.parentNode&&e.parentNode.removeChild(e)})(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}}class K6 extends Zt.NavigationControl{onAdd(n){return super.onAdd(n)}}class Y6 extends K6{constructor(){super({showCompass:!0,showZoom:!0,visualizePitch:!0}),this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",n=>{0===this._map.getPitch()?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})}_createButton(n,t){const i=super._createButton(n,t);return i.clickFunction=t,i}_rotateCompassArrow(){const n=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5))}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n}}class Q6 extends Zt.GeolocateControl{onAdd(n){return super.onAdd(n)}}var J6=Object.defineProperty,e8=Object.defineProperties,t8=Object.getOwnPropertyDescriptors,ak=Object.getOwnPropertySymbols,n8=Object.prototype.hasOwnProperty,i8=Object.prototype.propertyIsEnumerable,lk=(e,n,t)=>n in e?J6(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const ck=Zt.Marker,uk=Zt.LngLat,s8=Zt.LngLatBounds;class a8 extends Q6{constructor(){super(...arguments),this.lastUpdatedCenter=new uk(0,0)}_updateCamera(n){const t=new uk(n.coords.longitude,n.coords.latitude),i=n.coords.accuracy,l=(e=((e,n)=>{for(var t in n||(n={}))n8.call(n,t)&&lk(e,t,n[t]);if(ak)for(var t of ak(n))i8.call(n,t)&&lk(e,t,n[t]);return e})({bearing:this._map.getBearing()},this.options.fitBoundsOptions),e8(e,t8({linear:!0}))),d=this._map.getZoom();var e;d>this.options.fitBoundsOptions.maxZoom&&(l.zoom=d),this._map.fitBounds(s8.fromLngLat(t,i),l,{geolocateSource:!0});let f=!1;const b=()=>{f=!0};this._map.once("click",b),this._map.once("dblclick",b),this._map.once("dragstart",b),this._map.once("mousedown",b),this._map.once("touchstart",b),this._map.once("wheel",b),this._map.once("moveend",()=>{this._map.off("click",b),this._map.off("dblclick",b),this._map.off("dragstart",b),this._map.off("mousedown",b),this._map.off("touchstart",b),this._map.off("wheel",b),!f&&(this.lastUpdatedCenter=this._map.getCenter())})}_setupUI(n){if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=sh("button","maplibregl-ctrl-geolocate",this._container),sh("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===n){const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=sh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ck(this._dotElement),this._circleElement=sh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ck({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",t=>{const i=t.originalEvent&&"resize"===t.originalEvent.type,r=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!t.geolocateSource&&"ACTIVE_LOCK"===this._watchState&&!i&&r>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}_updateCircleRadius(){if("BACKGROUND"!==this._watchState&&"ACTIVE_LOCK"!==this._watchState)return;const t=this._map.project([this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude]),i=this._map.unproject([t.x,t.y]),r=this._map.unproject([t.x+20,t.y]),l=i.distanceTo(r)/20,d=Math.ceil(2*this._accuracy/l);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}}class l8 extends Zt.AttributionControl{onAdd(n){return super.onAdd(n)}}class c8 extends Zt.ScaleControl{onAdd(n){return super.onAdd(n)}}class u8 extends Zt.FullscreenControl{onAdd(n){return super.onAdd(n)}}var d8=Object.defineProperty,h8=Object.defineProperties,p8=Object.getOwnPropertyDescriptors,dk=Object.getOwnPropertySymbols,f8=Object.prototype.hasOwnProperty,m8=Object.prototype.propertyIsEnumerable,hk=(e,n,t)=>n in e?d8(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Vu=(e,n,t)=>new Promise((i,r)=>{var l=b=>{try{f(t.next(b))}catch(E){r(E)}},d=b=>{try{f(t.throw(b))}catch(E){r(E)}},f=b=>b.done?i(b.value):Promise.resolve(b.value).then(l,d);f((t=t.apply(e,n)).next())});class v8 extends Zt.Map{constructor(n){var t,i,r;n.apiKey&&(tl.apiKey=n.apiKey);const l=sk(n.style),d=location.hash;tl.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!"),super(((e,n)=>h8(e,p8(n)))(((e,n)=>{for(var t in n||(n={}))f8.call(n,t)&&hk(e,t,n[t]);if(dk)for(var t of dk(n))m8.call(n,t)&&hk(e,t,n[t]);return e})({},n),{style:l,maplibreLogo:!1,transformRequest:ok(n.transformRequest)})),this.isTerrainEnabled=!1,this.terrainExaggeration=1,this.primaryLanguage=null,this.secondaryLanguage=null,this.terrainGrowing=!1,this.terrainFlattening=!1,this.primaryLanguage=null!=(t=n.language)?t:tl.primaryLanguage,this.secondaryLanguage=tl.secondaryLanguage,this.terrainExaggeration=null!=(i=n.terrainExaggeration)?i:this.terrainExaggeration,this.once("styledata",()=>Vu(this,null,function*(){if(!n.geolocate||n.center||n.hash&&d)return;try{if("COUNTRY"===n.geolocate)return void(yield this.fitToIpBounds())}catch($){console.warn($.message)}let P=null;try{yield this.centerOnIpPoint(n.zoom),P=this.getCameraHash()}catch($){console.warn($.message)}"granted"===(yield navigator.permissions.query({name:"geolocation"})).state&&navigator.geolocation.getCurrentPosition($=>{P===this.getCameraHash()&&(this.terrain?this.easeTo({center:[$.coords.longitude,$.coords.latitude],zoom:n.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[$.coords.longitude,$.coords.latitude],zoom:n.zoom||12,duration:2e3})}))},null,{maximumAge:864e5,timeout:5e3,enableHighAccuracy:!1})})),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage),this.setSecondaryLanguage(this.secondaryLanguage)}),this.on("styledata",()=>{null===this.getTerrain()&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",()=>Vu(this,null,function*(){!function q6(){"unavailable"===Zt.getRTLTextPluginStatus()&&Zt.setRTLTextPlugin(hs.rtlPluginURL,null,!0)}()})),this.once("load",()=>Vu(this,null,function*(){let P={logo:null};try{const U=Object.keys(this.style.sourceCaches).map(oe=>this.getSource(oe)).filter(oe=>"string"==typeof oe.url&&oe.url.includes("tiles.json")),$=new URL(U[0].url);$.searchParams.has("key")||$.searchParams.append("key",tl.apiKey),P=yield(yield fetch($.href)).json()}catch{}if("logo"in P&&P.logo?(this.addControl(new ek({logoURL:P.logo}),n.logoPosition),!1===n.attributionControl&&this.addControl(new l8({customAttribution:n.customAttribution}))):n.maptilerLogo&&this.addControl(new ek,n.logoPosition),n.scaleControl){const U=!0===n.scaleControl||void 0===n.scaleControl?"bottom-right":n.scaleControl,$=new c8({unit:tl.unit});this.addControl($,U),tl.on("unit",Q=>{$.setUnit(Q)})}if(!1!==n.navigationControl){const U=!0===n.navigationControl||void 0===n.navigationControl?"top-right":n.navigationControl;this.addControl(new Y6,U)}if(!1!==n.geolocateControl){const U=!0===n.geolocateControl||void 0===n.geolocateControl?"top-right":n.geolocateControl;this.addControl(new a8({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),U)}if(n.terrainControl){const U=!0===n.terrainControl||void 0===n.terrainControl?"top-right":n.terrainControl;this.addControl(new X6,U)}if(n.fullscreenControl){const U=!0===n.fullscreenControl||void 0===n.fullscreenControl?"top-right":n.fullscreenControl;this.addControl(new u8({}),U)}}));let f=!1,b=!1,E=null;this.once("load",P=>{f=!0,b&&this.fire("loadWithTerrain",E)});const T=P=>{P.terrain&&(b=!0,E={type:"loadWithTerrain",target:this,terrain:P.terrain},this.off("terrain",T),f&&this.fire("loadWithTerrain",E))};this.on("terrain",T),n.terrain&&this.enableTerrain(null!=(r=n.terrainExaggeration)?r:this.terrainExaggeration)}onLoadAsync(){return Vu(this,null,function*(){return new Promise((n,t)=>{if(this.loaded())return n(this);this.once("load",i=>{n(this)})})})}onLoadWithTerrainAsync(){return Vu(this,null,function*(){return new Promise((n,t)=>{if(this.loaded()&&this.terrain)return n(this);this.once("loadWithTerrain",i=>{n(this)})})})}setStyle(n,t){return super.setStyle(sk(n),t)}setLanguage(n=hs.primaryLanguage){if(n===el.AUTO)return this.setLanguage(Fw());this.setPrimaryLanguage(n)}setPrimaryLanguage(n=hs.primaryLanguage){this.primaryLanguage!==el.STYLE_LOCK?QA(n)&&(this.primaryLanguage=n,this.onStyleReady(()=>{if(n===el.AUTO)return this.setPrimaryLanguage(Fw());const t=this.getStyle().layers,i=/^\s*{\s*name\s*(:\s*(\S*))?\s*}$/,r=/^\s*name\s*(:\s*(\S*))?\s*$/,l=/^\s*{\s*name\s*(:\s*(\S*))?\s*}(\s*){\s*name\s*(:\s*(\S*))?\s*}$/,d=/^(.*)({\s*name\s*(:\s*(\S*))?\s*})(.*)$/,f=n?`name:${n}`:"name",b=["case",["has",f],["get",f],["get","name"]];for(let E=0;E<t.length;E+=1){const T=t[E],P=T.layout;if(!P||!P["text-field"])continue;const U=this.getLayoutProperty(T.id,"text-field");let $;if(Array.isArray(U)&&U.length>=2&&"concat"===U[0].trim().toLowerCase()){const Q=U.slice();for(let oe=0;oe<U.length;oe+=1){const _e=U[oe];if(("string"==typeof _e||_e instanceof String)&&i.exec(_e.toString())){Q[oe]=b;break}if(Array.isArray(_e)&&_e.length>=2&&"get"===_e[0].trim().toLowerCase()&&r.exec(_e[1].toString())){Q[oe]=b;break}if(Array.isArray(_e)&&4===_e.length&&"case"===_e[0].trim().toLowerCase()){Q[oe]=b;break}}this.setLayoutProperty(T.id,"text-field",Q)}else Array.isArray(U)&&U.length>=2&&"get"===U[0].trim().toLowerCase()&&r.exec(U[1].toString())||("string"==typeof U||U instanceof String)&&i.exec(U.toString())||Array.isArray(U)&&4===U.length&&"case"===U[0].trim().toLowerCase()?this.setLayoutProperty(T.id,"text-field",b):("string"==typeof U||U instanceof String)&&null!==($=l.exec(U.toString()))?this.setLayoutProperty(T.id,"text-field",`{${f}}${$[3]}{name${$[4]||""}}`):("string"==typeof U||U instanceof String)&&null!==($=d.exec(U.toString()))&&this.setLayoutProperty(T.id,"text-field",`${$[1]}{${f}}${$[5]}`)}})):console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.")}setSecondaryLanguage(n=hs.secondaryLanguage){this.primaryLanguage!==el.STYLE_LOCK?QA(n)&&(this.secondaryLanguage=n,this.onStyleReady(()=>{if(n===el.AUTO)return this.setSecondaryLanguage(Fw());const t=this.getStyle().layers,i=/^\s*{\s*name\s*(:\s*(\S*))?\s*}$/,r=/^\s*name\s*(:\s*(\S*))?\s*$/,l=/^\s*{\s*name\s*(:\s*(\S*))?\s*}(\s*){\s*name\s*(:\s*(\S*))?\s*}$/;let d;for(let f=0;f<t.length;f+=1){const b=t[f],E=b.layout;if(!E||!E["text-field"])continue;const T=this.getLayoutProperty(b.id,"text-field");let P;if(Array.isArray(T)&&T.length>=2&&"concat"===T[0].trim().toLowerCase()){P=T.slice();let U=0;for(let $=0;$<T.length;$+=1){const Q=T[$];if(("string"==typeof Q||Q instanceof String)&&i.exec(Q.toString())){if(1===U){P[$]=`{name:${n}}`;break}U+=1}else if(Array.isArray(Q)&&Q.length>=2&&"get"===Q[0].trim().toLowerCase()&&r.exec(Q[1].toString())){if(1===U){P[$][1]=`name:${n}`;break}U+=1}else if(Array.isArray(Q)&&4===Q.length&&"case"===Q[0].trim().toLowerCase()){if(1===U){P[$]=["get",`name:${n}`];break}U+=1}}this.setLayoutProperty(b.id,"text-field",P)}else("string"==typeof T||T instanceof String)&&null!==(d=l.exec(T.toString()))&&(P=`{name${d[1]||""}}${d[3]}{${n?`name:${n}`:"name"}}`,this.setLayoutProperty(b.id,"text-field",P))}})):console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.")}getPrimaryLanguage(){return this.primaryLanguage}getSecondaryLanguage(){return this.secondaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(n,t=1e3){if(!this.terrain)return;const i=performance.now(),r=this.terrain.exaggeration,l=n-r,d=()=>{if(!this.terrain||this.terrainFlattening)return;const f=(performance.now()-i)/t;if(f<.99){const b=1-Math.pow(1-f,4);this.terrain.exaggeration=r+b*l,requestAnimationFrame(d)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=n;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(d)}enableTerrain(n=this.terrainExaggeration){if(n<0)return void console.warn("Terrain exaggeration cannot be negative.");const t=r=>Vu(this,null,function*(){!this.terrain||"data"!==r.type||"source"!==r.dataType||!("source"in r)||"maptiler-terrain"!==r.sourceId||"raster-dem"!==r.source.type||r.isSourceLoaded&&(this.off("data",t),this.growTerrain(n))}),i=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=n,this.on("data",t),this.addSource(hs.terrainSourceId,{type:"raster-dem",url:hs.terrainSourceURL}),this.setTerrain({source:hs.terrainSourceId,exaggeration:0})};if(this.getTerrain())return this.isTerrainEnabled=!0,void this.growTerrain(n);this.loaded()||this.isTerrainEnabled?i():this.once("load",()=>{this.getTerrain()&&this.getSource(hs.terrainSourceId)||i()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const t=performance.now(),i=this.terrain.exaggeration,r=()=>{if(!this.terrain||this.terrainGrowing)return;const l=(performance.now()-t)/1e3;if(l<.99){const d=Math.pow(1-l,4);this.terrain.exaggeration=i*d,requestAnimationFrame(r)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(null),this.getSource(hs.terrainSourceId)&&this.removeSource(hs.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(r)}setTerrainExaggeration(n,t=!0){!t&&this.terrain?(this.terrainExaggeration=n,this.terrain.exaggeration=n,this.triggerRepaint()):this.enableTerrain(n)}onStyleReady(n){this.isStyleLoaded()?n():this.once("styledata",()=>{n()})}fitToIpBounds(){return Vu(this,null,function*(){const n=yield GA.info();this.fitBounds(n.country_bounds,{duration:0,padding:100})})}centerOnIpPoint(n){return Vu(this,null,function*(){const t=yield GA.info();this.jumpTo({center:[t.longitude,t.latitude],zoom:n||11})})}getCameraHash(){const n=new Float32Array(5),t=this.getCenter();return n[0]=t.lng,n[1]=t.lat,n[2]=this.getZoom(),n[3]=this.getPitch(),n[4]=this.getBearing(),Kj_fromUint8Array(new Uint8Array(n.buffer))}getSdkConfig(){return tl}getMaptilerSessionId(){return JA}setTransformRequest(n){return super.setTransformRequest(ok(n)),this}}class b8 extends Zt.Marker{addTo(n){return super.addTo(n)}}class x8 extends Zt.Popup{addTo(n){return super.addTo(n)}}const E8=["map"];let C8=(()=>{class e{constructor(){this.katanaLocationList=[],this.katanaService=St(fA),this.katanaLocationList=this.katanaService.getAllKatanaLocations()}ngOnInit(){tl.apiKey="s3Z3dlUtjpkA63HXA5LH",this.loadStateFromFragment()}ngAfterViewInit(){let t={lat:24.577528,lng:133.8223832,zoom:2};if(this.initialKatanaLocationId){const i=this.getKatanaLocationById(this.initialKatanaLocationId);i&&(t={lat:i.lat,lng:i.lng,zoom:16})}this.map=new v8({container:this.mapContainer.nativeElement,style:Sw.STREETS,center:[t.lng,t.lat],zoom:t.zoom});for(const i of this.katanaLocationList){let r=`${location.href}#${i.id}`,l=new b8({color:"#FF0011"}).setLngLat([i.lng,i.lat]).addTo(this.map).setPopup((new x8).setMaxWidth("500px").setHTML(`\n            <div align="left">\n            <img src="${i.photo}" width="450px" alt="Photo of ${i.name}" />\n            <h3>\n              <a href="${i.url}" target="_blank">${i.name}</a>\n            </h3>\n            <h4>${i.city}</h4>\n            <p>\n            ${i.notes}\n            </p>\n            <button aria-label="Share" onclick="navigator.share({ url: '${r}', title: '${i.name} on Katana Map', text: '${i.name} on Katana Map --- map of places, where you can see katana swords' });">\n              share\n            </button>\n            </div>\n          `));this.initialKatanaLocationId==i.id&&l.togglePopup()}}ngOnDestroy(){this.map?.remove()}loadStateFromFragment(){let t=location.href.replace(/^.*[#]/,"");if(t.length>0)try{this.initialKatanaLocationId=parseInt(t)}catch(i){console.warn(i)}}getKatanaLocationById(t){return this.katanaLocationList.find(i=>i.id===t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Di({type:e,selectors:[["app-map"]],viewQuery:function(i,r){if(1&i&&dm(E8,5),2&i){let l;Fr(l=Or())&&(r.mapContainer=l.first)}},decls:3,vars:0,consts:[[1,"map-wrap"],[1,"map"],["map",""]],template:function(i,r){1&i&&(Yt(0,"div",0),wr(1,"div",1,2),bn())},styles:[".map-wrap[_ngcontent-%COMP%]{position:relative;width:100%;height:calc(100vh - 60px)}.map[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}"]})}return e})(),D8=(()=>{class e{constructor(){this.title="katana-map"}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Di({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"App"]],template:function(i,r){1&i&&(Yt(0,"div",0),wr(1,"app-navbar")(2,"app-map"),bn())},dependencies:[mA,C8],styles:[".App[_ngcontent-%COMP%]{text-align:center}"]})}return e})();function pk(e){return new _n(n=>{we(e()).subscribe(n)})}const Uu=new _n(Zr);class I8 extends _n{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ra(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new Qt;const t=this.getSubject();n.add(this.source.subscribe(Mn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=Qt.EMPTY)}return n}refCount(){return function S8(){return Vn((e,n)=>{let t=null;e._refCount++;const i=Mn(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const r=e._connection,l=t;t=null,r&&(!l||r===l)&&r.unsubscribe(),n.unsubscribe()});e.subscribe(i),i.closed||(t=e.connect())})}()(this)}}const T8={connector:()=>new Ft};function fk(e,n=T8){const{connector:t}=n;return Vn((i,r)=>{const l=t();we(e(function M8(e){return new _n(n=>e.subscribe(n))}(l))).subscribe(r),r.add(i.subscribe(l))})}const Hm="Service workers are disabled or not supported by this browser";class Vy{constructor(n){if(this.serviceWorker=n,n){const i=Bm(n,"controllerchange").pipe(fn(()=>n.controller)),l=Dm(pk(()=>Ni(n.controller)),i);this.worker=l.pipe(wo(T=>!!T)),this.registration=this.worker.pipe(ws(()=>n.getRegistration()));const E=Bm(n,"message").pipe(fn(T=>T.data)).pipe(wo(T=>T&&T.type)).pipe(function k8(e){return e?n=>fk(e)(n):n=>function A8(e,n){const t=$t(e)?e:()=>e;return $t(n)?fk(n,{connector:t}):i=>new I8(i,t)}(new Ft)(n)}());E.connect(),this.events=E}else this.worker=this.events=this.registration=function P8(e){return pk(()=>dM(new Error(e)))}(Hm)}postMessage(n,t){return this.worker.pipe(Xo(1),Em(i=>{i.postMessage({action:n,...t})})).toPromise().then(()=>{})}postMessageWithOperation(n,t,i){const r=this.waitForOperationCompleted(i),l=this.postMessage(n,t);return Promise.all([l,r]).then(([,d])=>d)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let t;return t="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(wo(t))}nextEventOfType(n){return this.eventsOfType(n).pipe(Xo(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(wo(t=>t.nonce===n),Xo(1),fn(t=>{if(void 0!==t.result)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let mk=(()=>{class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new Ft,!t.isEnabled)return this.messages=Uu,this.notificationClicks=Uu,void(this.subscription=Uu);this.messages=this.sw.eventsOfType("PUSH").pipe(fn(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(fn(r=>r.data)),this.pushManager=this.sw.registration.pipe(fn(r=>r.pushManager));const i=this.pushManager.pipe(ws(r=>r.getSubscription()));this.subscription=Vt(i,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(Hm));const i={userVisibleOnly:!0};let r=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),l=new Uint8Array(new ArrayBuffer(r.length));for(let d=0;d<r.length;d++)l[d]=r.charCodeAt(d);return i.applicationServerKey=l,this.pushManager.pipe(ws(d=>d.subscribe(i)),Xo(1)).toPromise().then(d=>(this.subscriptionChanges.next(d),d))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(Xo(1),ws(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(Hm))}decodeBase64(t){return atob(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(Vy))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})(),Ow=(()=>{class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled)return this.versionUpdates=Uu,this.available=Uu,this.activated=Uu,void(this.unrecoverable=Uu);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(wo(i=>"VERSION_READY"===i.type),fn(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Hm));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Hm));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(Vy))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();const gk=new Oe("NGSW_REGISTER_SCRIPT");function R8(e,n,t,i){return()=>{if(!Ux(i)||!("serviceWorker"in navigator)||!1===t.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof t.registrationStrategy)r=t.registrationStrategy();else{const[d,...f]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(d){case"registerImmediately":r=Ni(null);break;case"registerWithDelay":r=_k(+f[0]||0);break;case"registerWhenStable":r=f[0]?Vt(yk(e),_k(+f[0])):yk(e);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}e.get(qt).runOutsideAngular(()=>r.pipe(Xo(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:t.scope}).catch(d=>console.error("Service worker registration failed with:",d))))}}function _k(e){return Ni(null).pipe(iw(e))}function yk(e){return e.get(Iu).isStable.pipe(wo(t=>t))}function F8(e,n){return new Vy(Ux(n)&&!1!==e.enabled?navigator.serviceWorker:void 0)}class Lw{}function O8(e,n={}){return function Xv(e){return{\u0275providers:e}}([mk,Ow,{provide:gk,useValue:e},{provide:Lw,useValue:n},{provide:Vy,useFactory:F8,deps:[Lw,bc]},{provide:cS,useFactory:R8,deps:[$o,gk,Lw,bc],multi:!0}])}let L8=(()=>{class e{static register(t,i={}){return{ngModule:e,providers:[O8(t,i)]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({providers:[mk,Ow]})}return e})();function vk(e){return new Ee(3e3,!1)}function ju(e){switch(e.length){case 0:return new Nm;case 1:return e[0];default:return new VT(e)}}function bk(e,n,t=new Map,i=new Map){const r=[],l=[];let d=-1,f=null;if(n.forEach(b=>{const E=b.get("offset"),T=E==d,P=T&&f||new Map;b.forEach((U,$)=>{let Q=$,oe=U;if("offset"!==$)switch(Q=e.normalizePropertyName(Q,r),oe){case"!":oe=t.get($);break;case Mc:oe=i.get($);break;default:oe=e.normalizeStyleValue($,Q,oe,r)}P.set(Q,oe)}),T||l.push(P),f=P,d=E}),r.length)throw function oH(e){return new Ee(3502,!1)}();return l}function Nw(e,n,t,i){switch(n){case"start":e.onStart(()=>i(t&&Bw(t,"start",e)));break;case"done":e.onDone(()=>i(t&&Bw(t,"done",e)));break;case"destroy":e.onDestroy(()=>i(t&&Bw(t,"destroy",e)))}}function Bw(e,n,t){const l=zw(e.element,e.triggerName,e.fromState,e.toState,n||e.phaseName,t.totalTime??e.totalTime,!!t.disabled),d=e._data;return null!=d&&(l._data=d),l}function zw(e,n,t,i,r="",l=0,d){return{element:e,triggerName:n,fromState:t,toState:i,phaseName:r,totalTime:l,disabled:!!d}}function Us(e,n,t){let i=e.get(n);return i||e.set(n,i=t),i}function xk(e){const n=e.indexOf(":");return[e.substring(1,n),e.slice(n+1)]}const _H=(()=>typeof document>"u"?null:document.documentElement)();function Vw(e){const n=e.parentNode||e.host||null;return n===_H?null:n}let ah=null,wk=!1;function Ek(e,n){for(;n;){if(n===e)return!0;n=Vw(n)}return!1}function Ck(e,n,t){if(t)return Array.from(e.querySelectorAll(n));const i=e.querySelector(n);return i?[i]:[]}let Dk=(()=>{class e{validateStyleProperty(t){return function vH(e){ah||(ah=function bH(){return typeof document<"u"?document.body:null}()||{},wk=!!ah.style&&"WebkitAppearance"in ah.style);let n=!0;return ah.style&&!function yH(e){return"ebkit"==e.substring(1,6)}(e)&&(n=e in ah.style,!n&&wk&&(n="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in ah.style)),n}(t)}matchesElement(t,i){return!1}containsElement(t,i){return Ek(t,i)}getParentElement(t){return Vw(t)}query(t,i,r){return Ck(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,l,d,f=[],b){return new Nm(r,l)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})(),Uw=(()=>{class e{static#e=this.NOOP=new Dk}return e})();const xH=1e3,jw="ng-enter",Uy="ng-leave",jy="ng-trigger",Hy=".ng-trigger",Ik="ng-animating",Hw=".ng-animating";function kc(e){if("number"==typeof e)return e;const n=e.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:$w(parseFloat(n[1]),n[2])}function $w(e,n){return"s"===n?e*xH:e}function $y(e,n,t){return e.hasOwnProperty("duration")?e:function EH(e,n,t){let r,l=0,d="";if("string"==typeof e){const f=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===f)return n.push(vk()),{duration:0,delay:0,easing:""};r=$w(parseFloat(f[1]),f[2]);const b=f[3];null!=b&&(l=$w(parseFloat(b),f[4]));const E=f[5];E&&(d=E)}else r=e;if(!t){let f=!1,b=n.length;r<0&&(n.push(function N8(){return new Ee(3100,!1)}()),f=!0),l<0&&(n.push(function B8(){return new Ee(3101,!1)}()),f=!0),f&&n.splice(b,0,vk())}return{duration:r,delay:l,easing:d}}(e,n,t)}function $m(e,n={}){return Object.keys(e).forEach(t=>{n[t]=e[t]}),n}function Mk(e){const n=new Map;return Object.keys(e).forEach(t=>{n.set(t,e[t])}),n}function Hu(e,n=new Map,t){if(t)for(let[i,r]of t)n.set(i,r);for(let[i,r]of e)n.set(i,r);return n}function Gl(e,n,t){n.forEach((i,r)=>{const l=qw(r);t&&!t.has(r)&&t.set(r,e.style[l]),e.style[l]=i})}function lh(e,n){n.forEach((t,i)=>{const r=qw(i);e.style[r]=""})}function Gm(e){return Array.isArray(e)?1==e.length?e[0]:zT(e):e}const Gw=new RegExp("{{\\s*(.+?)\\s*}}","g");function Ak(e){let n=[];if("string"==typeof e){let t;for(;t=Gw.exec(e);)n.push(t[1]);Gw.lastIndex=0}return n}function qm(e,n,t){const i=e.toString(),r=i.replace(Gw,(l,d)=>{let f=n[d];return null==f&&(t.push(function V8(e){return new Ee(3003,!1)}()),f=""),f.toString()});return r==i?e:r}function Gy(e){const n=[];let t=e.next();for(;!t.done;)n.push(t.value),t=e.next();return n}const SH=/-+([a-z0-9])/g;function qw(e){return e.replace(SH,(...n)=>n[1].toUpperCase())}function js(e,n,t){switch(n.type){case 7:return e.visitTrigger(n,t);case 0:return e.visitState(n,t);case 1:return e.visitTransition(n,t);case 2:return e.visitSequence(n,t);case 3:return e.visitGroup(n,t);case 4:return e.visitAnimate(n,t);case 5:return e.visitKeyframes(n,t);case 6:return e.visitStyle(n,t);case 8:return e.visitReference(n,t);case 9:return e.visitAnimateChild(n,t);case 10:return e.visitAnimateRef(n,t);case 11:return e.visitQuery(n,t);case 12:return e.visitStagger(n,t);default:throw function U8(e){return new Ee(3004,!1)}()}}function kk(e,n){return window.getComputedStyle(e)[n]}const qy="*";function TH(e,n){const t=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function AH(e,n,t){if(":"==e[0]){const b=function kH(e,n){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return n.push(function tH(e){return new Ee(3016,!1)}()),"* => *"}}(e,t);if("function"==typeof b)return void n.push(b);e=b}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function eH(e){return new Ee(3015,!1)}()),n;const r=i[1],l=i[2],d=i[3];n.push(Pk(r,d));"<"==l[0]&&!(r==qy&&d==qy)&&n.push(Pk(d,r))}(i,t,n)):t.push(e),t}const Wy=new Set(["true","1"]),Zy=new Set(["false","0"]);function Pk(e,n){const t=Wy.has(e)||Zy.has(e),i=Wy.has(n)||Zy.has(n);return(r,l)=>{let d=e==qy||e==r,f=n==qy||n==l;return!d&&t&&"boolean"==typeof r&&(d=r?Wy.has(e):Zy.has(e)),!f&&i&&"boolean"==typeof l&&(f=l?Wy.has(n):Zy.has(n)),d&&f}}const PH=new RegExp("s*:selfs*,?","g");function Ww(e,n,t,i){return new RH(e).build(n,t,i)}class RH{constructor(n){this._driver=n}build(n,t,i){const r=new LH(t);return this._resetContextStyleTimingState(r),js(this,Gm(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,t){let i=t.queryCount=0,r=t.depCount=0;const l=[],d=[];return"@"==n.name.charAt(0)&&t.errors.push(function H8(){return new Ee(3006,!1)}()),n.definitions.forEach(f=>{if(this._resetContextStyleTimingState(t),0==f.type){const b=f,E=b.name;E.toString().split(/\s*,\s*/).forEach(T=>{b.name=T,l.push(this.visitState(b,t))}),b.name=E}else if(1==f.type){const b=this.visitTransition(f,t);i+=b.queryCount,r+=b.depCount,d.push(b)}else t.errors.push(function $8(){return new Ee(3007,!1)}())}),{type:7,name:n.name,states:l,transitions:d,queryCount:i,depCount:r,options:null}}visitState(n,t){const i=this.visitStyle(n.styles,t),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const l=new Set,d=r||{};i.styles.forEach(f=>{f instanceof Map&&f.forEach(b=>{Ak(b).forEach(E=>{d.hasOwnProperty(E)||l.add(E)})})}),l.size&&(Gy(l.values()),t.errors.push(function G8(e,n){return new Ee(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,t){t.queryCount=0,t.depCount=0;const i=js(this,Gm(n.animation),t);return{type:1,matchers:TH(n.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:ch(n.options)}}visitSequence(n,t){return{type:2,steps:n.steps.map(i=>js(this,i,t)),options:ch(n.options)}}visitGroup(n,t){const i=t.currentTime;let r=0;const l=n.steps.map(d=>{t.currentTime=i;const f=js(this,d,t);return r=Math.max(r,t.currentTime),f});return t.currentTime=r,{type:3,steps:l,options:ch(n.options)}}visitAnimate(n,t){const i=function BH(e,n){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return Zw($y(e,n).duration,0,"");const t=e;if(t.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=Zw(0,0,"");return l.dynamic=!0,l.strValue=t,l}const r=$y(t,n);return Zw(r.duration,r.delay,r.easing)}(n.timings,t.errors);t.currentAnimateTimings=i;let r,l=n.styles?n.styles:Tc({});if(5==l.type)r=this.visitKeyframes(l,t);else{let d=n.styles,f=!1;if(!d){f=!0;const E={};i.easing&&(E.easing=i.easing),d=Tc(E)}t.currentTime+=i.duration+i.delay;const b=this.visitStyle(d,t);b.isEmptyStep=f,r=b}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,t){const i=this._makeStyleAst(n,t);return this._validateStyleAst(i,t),i}_makeStyleAst(n,t){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let f of r)"string"==typeof f?f===Mc?i.push(f):t.errors.push(new Ee(3002,!1)):i.push(Mk(f));let l=!1,d=null;return i.forEach(f=>{if(f instanceof Map&&(f.has("easing")&&(d=f.get("easing"),f.delete("easing")),!l))for(let b of f.values())if(b.toString().indexOf("{{")>=0){l=!0;break}}),{type:6,styles:i,easing:d,offset:n.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(n,t){const i=t.currentAnimateTimings;let r=t.currentTime,l=t.currentTime;i&&l>0&&(l-=i.duration+i.delay),n.styles.forEach(d=>{"string"!=typeof d&&d.forEach((f,b)=>{const E=t.collectedStyles.get(t.currentQuerySelector),T=E.get(b);let P=!0;T&&(l!=r&&l>=T.startTime&&r<=T.endTime&&(t.errors.push(function W8(e,n,t,i,r){return new Ee(3010,!1)}()),P=!1),l=T.startTime),P&&E.set(b,{startTime:l,endTime:r}),t.options&&function DH(e,n,t){const i=n.params||{},r=Ak(e);r.length&&r.forEach(l=>{i.hasOwnProperty(l)||t.push(function z8(e){return new Ee(3001,!1)}())})}(f,t.options,t.errors)})})}visitKeyframes(n,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Z8(){return new Ee(3011,!1)}()),i;let l=0;const d=[];let f=!1,b=!1,E=0;const T=n.steps.map(Me=>{const ve=this._makeStyleAst(Me,t);let it=null!=ve.offset?ve.offset:function NH(e){if("string"==typeof e)return null;let n=null;if(Array.isArray(e))e.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const t=e;n=parseFloat(t.get("offset")),t.delete("offset")}return n}(ve.styles),st=0;return null!=it&&(l++,st=ve.offset=it),b=b||st<0||st>1,f=f||st<E,E=st,d.push(st),ve});b&&t.errors.push(function X8(){return new Ee(3012,!1)}()),f&&t.errors.push(function K8(){return new Ee(3200,!1)}());const P=n.steps.length;let U=0;l>0&&l<P?t.errors.push(function Y8(){return new Ee(3202,!1)}()):0==l&&(U=1/(P-1));const $=P-1,Q=t.currentTime,oe=t.currentAnimateTimings,_e=oe.duration;return T.forEach((Me,ve)=>{const it=U>0?ve==$?1:U*ve:d[ve],st=it*_e;t.currentTime=Q+oe.delay+st,oe.duration=st,this._validateStyleAst(Me,t),Me.offset=it,i.styles.push(Me)}),i}visitReference(n,t){return{type:8,animation:js(this,Gm(n.animation),t),options:ch(n.options)}}visitAnimateChild(n,t){return t.depCount++,{type:9,options:ch(n.options)}}visitAnimateRef(n,t){return{type:10,animation:this.visitReference(n.animation,t),options:ch(n.options)}}visitQuery(n,t){const i=t.currentQuerySelector,r=n.options||{};t.queryCount++,t.currentQuery=n;const[l,d]=function FH(e){const n=!!e.split(/\s*,\s*/).find(t=>":self"==t);return n&&(e=e.replace(PH,"")),e=e.replace(/@\*/g,Hy).replace(/@\w+/g,t=>Hy+"-"+t.slice(1)).replace(/:animating/g,Hw),[e,n]}(n.selector);t.currentQuerySelector=i.length?i+" "+l:l,Us(t.collectedStyles,t.currentQuerySelector,new Map);const f=js(this,Gm(n.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:l,limit:r.limit||0,optional:!!r.optional,includeSelf:d,animation:f,originalSelector:n.selector,options:ch(n.options)}}visitStagger(n,t){t.currentQuery||t.errors.push(function Q8(){return new Ee(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:$y(n.timings,t.errors,!0);return{type:12,animation:js(this,Gm(n.animation),t),timings:i,options:null}}}class LH{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function ch(e){return e?(e=$m(e)).params&&(e.params=function OH(e){return e?$m(e):null}(e.params)):e={},e}function Zw(e,n,t){return{duration:e,delay:n,easing:t}}function Xw(e,n,t,i,r,l,d=null,f=!1){return{type:1,element:e,keyframes:n,preStyleProps:t,postStyleProps:i,duration:r,delay:l,totalTime:r+l,easing:d,subTimeline:f}}class Xy{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,t){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...t)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const UH=new RegExp(":enter","g"),HH=new RegExp(":leave","g");function Kw(e,n,t,i,r,l=new Map,d=new Map,f,b,E=[]){return(new $H).buildKeyframes(e,n,t,i,r,l,d,f,b,E)}class $H{buildKeyframes(n,t,i,r,l,d,f,b,E,T=[]){E=E||new Xy;const P=new Yw(n,t,E,r,l,T,[]);P.options=b;const U=b.delay?kc(b.delay):0;P.currentTimeline.delayNextStep(U),P.currentTimeline.setStyles([d],null,P.errors,b),js(this,i,P);const $=P.timelines.filter(Q=>Q.containsAnimation());if($.length&&f.size){let Q;for(let oe=$.length-1;oe>=0;oe--){const _e=$[oe];if(_e.element===t){Q=_e;break}}Q&&!Q.allowOnlyTimelineStyles()&&Q.setStyles([f],null,P.errors,b)}return $.length?$.map(Q=>Q.buildKeyframes()):[Xw(t,[],[],[],0,U,"",!1)]}visitTrigger(n,t){}visitState(n,t){}visitTransition(n,t){}visitAnimateChild(n,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(n.options),l=t.currentTimeline.currentTime,d=this._visitSubInstructions(i,r,r.options);l!=d&&t.transformIntoNewTimeline(d)}t.previousNode=n}visitAnimateRef(n,t){const i=t.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],t,i),this.visitReference(n.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=n}_applyAnimationRefDelays(n,t,i){for(const r of n){const l=r?.delay;if(l){const d="number"==typeof l?l:kc(qm(l,r?.params??{},t.errors));i.delayNextStep(d)}}}_visitSubInstructions(n,t,i){let l=t.currentTimeline.currentTime;const d=null!=i.duration?kc(i.duration):null,f=null!=i.delay?kc(i.delay):null;return 0!==d&&n.forEach(b=>{const E=t.appendInstructionToTimeline(b,d,f);l=Math.max(l,E.duration+E.delay)}),l}visitReference(n,t){t.updateOptions(n.options,!0),js(this,n.animation,t),t.previousNode=n}visitSequence(n,t){const i=t.subContextCount;let r=t;const l=n.options;if(l&&(l.params||l.delay)&&(r=t.createSubContext(l),r.transformIntoNewTimeline(),null!=l.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Ky);const d=kc(l.delay);r.delayNextStep(d)}n.steps.length&&(n.steps.forEach(d=>js(this,d,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=n}visitGroup(n,t){const i=[];let r=t.currentTimeline.currentTime;const l=n.options&&n.options.delay?kc(n.options.delay):0;n.steps.forEach(d=>{const f=t.createSubContext(n.options);l&&f.delayNextStep(l),js(this,d,f),r=Math.max(r,f.currentTimeline.currentTime),i.push(f.currentTimeline)}),i.forEach(d=>t.currentTimeline.mergeTimelineCollectedStyles(d)),t.transformIntoNewTimeline(r),t.previousNode=n}_visitTiming(n,t){if(n.dynamic){const i=n.strValue;return $y(t.params?qm(i,t.params,t.errors):i,t.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,t){const i=t.currentAnimateTimings=this._visitTiming(n.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const l=n.style;5==l.type?this.visitKeyframes(l,t):(t.incrementTime(i.duration),this.visitStyle(l,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=n}visitStyle(n,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const l=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(l):i.setStyles(n.styles,l,t.errors,t.options),t.previousNode=n}visitKeyframes(n,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,l=i.duration,f=t.createSubContext().currentTimeline;f.easing=i.easing,n.styles.forEach(b=>{f.forwardTime((b.offset||0)*l),f.setStyles(b.styles,b.easing,t.errors,t.options),f.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(f),t.transformIntoNewTimeline(r+l),t.previousNode=n}visitQuery(n,t){const i=t.currentTimeline.currentTime,r=n.options||{},l=r.delay?kc(r.delay):0;l&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Ky);let d=i;const f=t.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=f.length;let b=null;f.forEach((E,T)=>{t.currentQueryIndex=T;const P=t.createSubContext(n.options,E);l&&P.delayNextStep(l),E===t.element&&(b=P.currentTimeline),js(this,n.animation,P),P.currentTimeline.applyStylesToKeyframe(),d=Math.max(d,P.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(d),b&&(t.currentTimeline.mergeTimelineCollectedStyles(b),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=n}visitStagger(n,t){const i=t.parentContext,r=t.currentTimeline,l=n.timings,d=Math.abs(l.duration),f=d*(t.currentQueryTotal-1);let b=d*t.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":b=f-b;break;case"full":b=i.currentStaggerTime}const T=t.currentTimeline;b&&T.delayNextStep(b);const P=T.currentTime;js(this,n.animation,t),t.previousNode=n,i.currentStaggerTime=r.currentTime-P+(r.startTime-i.currentTimeline.startTime)}}const Ky={};class Yw{constructor(n,t,i,r,l,d,f,b){this._driver=n,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=l,this.errors=d,this.timelines=f,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ky,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=b||new Yy(this._driver,t,0),f.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,t){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=kc(i.duration)),null!=i.delay&&(r.delay=kc(i.delay));const l=i.params;if(l){let d=r.params;d||(d=this.options.params={}),Object.keys(l).forEach(f=>{(!t||!d.hasOwnProperty(f))&&(d[f]=qm(l[f],d,this.errors))})}}_copyOptions(){const n={};if(this.options){const t=this.options.params;if(t){const i=n.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return n}createSubContext(n=null,t,i){const r=t||this.element,l=new Yw(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(n),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(n){return this.previousNode=Ky,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,t,i){const r={duration:t??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},l=new GH(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(l),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,t,i,r,l,d){let f=[];if(r&&f.push(this.element),n.length>0){n=(n=n.replace(UH,"."+this._enterClassName)).replace(HH,"."+this._leaveClassName);let E=this._driver.query(this.element,n,1!=i);0!==i&&(E=i<0?E.slice(E.length+i,E.length):E.slice(0,i)),f.push(...E)}return!l&&0==f.length&&d.push(function J8(e){return new Ee(3014,!1)}()),f}}class Yy{constructor(n,t,i,r){this._driver=n,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+n),t&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,t){return this.applyStylesToKeyframe(),new Yy(this._driver,n,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,t){this._localTimelineStyles.set(n,t),this._globalTimelineStyles.set(n,t),this._styleSummary.set(n,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Mc),this._currentKeyframe.set(t,Mc);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,t,i,r){t&&this._previousKeyframe.set("easing",t);const l=r&&r.params||{},d=function qH(e,n){const t=new Map;let i;return e.forEach(r=>{if("*"===r){i=i||n.keys();for(let l of i)t.set(l,Mc)}else Hu(r,t)}),t}(n,this._globalTimelineStyles);for(let[f,b]of d){const E=qm(b,l,i);this._pendingStyles.set(f,E),this._localTimelineStyles.has(f)||this._backFill.set(f,this._globalTimelineStyles.get(f)??Mc),this._updateStyle(f,E)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,t)=>{this._currentKeyframe.set(t,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,n)}))}snapshotCurrentStyles(){for(let[n,t]of this._localTimelineStyles)this._pendingStyles.set(n,t),this._updateStyle(n,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let t in this._currentKeyframe)n.push(t);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((f,b)=>{const E=Hu(f,new Map,this._backFill);E.forEach((T,P)=>{"!"===T?n.add(P):T===Mc&&t.add(P)}),i||E.set("offset",b/this.duration),r.push(E)});const l=n.size?Gy(n.values()):[],d=t.size?Gy(t.values()):[];if(i){const f=r[0],b=new Map(f);f.set("offset",0),b.set("offset",1),r=[f,b]}return Xw(this.element,r,l,d,this.duration,this.startTime,this.easing,!1)}}class GH extends Yy{constructor(n,t,i,r,l,d,f=!1){super(n,t,d.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=l,this._stretchStartingKeyframe=f,this.timings={duration:d.duration,delay:d.delay,easing:d.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const l=[],d=i+t,f=t/d,b=Hu(n[0]);b.set("offset",0),l.push(b);const E=Hu(n[0]);E.set("offset",Ok(f)),l.push(E);const T=n.length-1;for(let P=1;P<=T;P++){let U=Hu(n[P]);const $=U.get("offset");U.set("offset",Ok((t+$*i)/d)),l.push(U)}i=d,t=0,r="",n=l}return Xw(this.element,n,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function Ok(e,n=3){const t=Math.pow(10,n-1);return Math.round(e*t)/t}class Qw{}const WH=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class ZH extends Qw{normalizePropertyName(n,t){return qw(n)}normalizeStyleValue(n,t,i,r){let l="";const d=i.toString().trim();if(WH.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)l="px";else{const f=i.match(/^[+-]?[\d\.]+([a-z]*)$/);f&&0==f[1].length&&r.push(function j8(e,n){return new Ee(3005,!1)}())}return d+l}}function Lk(e,n,t,i,r,l,d,f,b,E,T,P,U){return{type:0,element:e,triggerName:n,isRemovalTransition:r,fromState:t,fromStyles:l,toState:i,toStyles:d,timelines:f,queriedElements:b,preStyleProps:E,postStyleProps:T,totalTime:P,errors:U}}const Jw={};class Nk{constructor(n,t,i){this._triggerName=n,this.ast=t,this._stateStyles=i}match(n,t,i,r){return function XH(e,n,t,i,r){return e.some(l=>l(n,t,i,r))}(this.ast.matchers,n,t,i,r)}buildStyles(n,t,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(t,i):new Map}build(n,t,i,r,l,d,f,b,E,T){const P=[],U=this.ast.options&&this.ast.options.params||Jw,Q=this.buildStyles(i,f&&f.params||Jw,P),oe=b&&b.params||Jw,_e=this.buildStyles(r,oe,P),Me=new Set,ve=new Map,it=new Map,st="void"===r,jt={params:KH(oe,U),delay:this.ast.options?.delay},Xn=T?[]:Kw(n,t,this.ast.animation,l,d,Q,_e,jt,E,P);let ai=0;if(Xn.forEach(Hs=>{ai=Math.max(Hs.duration+Hs.delay,ai)}),P.length)return Lk(t,this._triggerName,i,r,st,Q,_e,[],[],ve,it,ai,P);Xn.forEach(Hs=>{const il=Hs.element,tv=Us(ve,il,new Set);Hs.preStyleProps.forEach(uh=>tv.add(uh));const Zm=Us(it,il,new Set);Hs.postStyleProps.forEach(uh=>Zm.add(uh)),il!==t&&Me.add(il)});const lo=Gy(Me.values());return Lk(t,this._triggerName,i,r,st,Q,_e,Xn,lo,ve,it,ai)}}function KH(e,n){const t=$m(n);for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&(t[i]=e[i]);return t}class YH{constructor(n,t,i){this.styles=n,this.defaultParams=t,this.normalizer=i}buildStyles(n,t){const i=new Map,r=$m(this.defaultParams);return Object.keys(n).forEach(l=>{const d=n[l];null!==d&&(r[l]=d)}),this.styles.styles.forEach(l=>{"string"!=typeof l&&l.forEach((d,f)=>{d&&(d=qm(d,r,t));const b=this.normalizer.normalizePropertyName(f,t);d=this.normalizer.normalizeStyleValue(f,b,d,t),i.set(f,d)})}),i}}class JH{constructor(n,t,i){this.name=n,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new YH(r.style,r.options&&r.options.params||{},i))}),Bk(this.states,"true","1"),Bk(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new Nk(n,r,this.states))}),this.fallbackTransition=function e$(e,n,t){return new Nk(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(d,f)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,t,i,r){return this.transitionFactories.find(d=>d.match(n,t,i,r))||null}matchStyles(n,t,i){return this.fallbackTransition.buildStyles(n,t,i)}}function Bk(e,n,t){e.has(n)?e.has(t)||e.set(t,e.get(n)):e.has(t)&&e.set(n,e.get(t))}const t$=new Xy;class n${constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,t){const i=[],l=Ww(this._driver,t,i,[]);if(i.length)throw function sH(e){return new Ee(3503,!1)}();this._animations.set(n,l)}_buildPlayer(n,t,i){const r=n.element,l=bk(this._normalizer,n.keyframes,t,i);return this._driver.animate(r,l,n.duration,n.delay,n.easing,[],!0)}create(n,t,i={}){const r=[],l=this._animations.get(n);let d;const f=new Map;if(l?(d=Kw(this._driver,t,l,jw,Uy,new Map,new Map,i,t$,r),d.forEach(T=>{const P=Us(f,T.element,new Map);T.postStyleProps.forEach(U=>P.set(U,null))})):(r.push(function aH(){return new Ee(3300,!1)}()),d=[]),r.length)throw function lH(e){return new Ee(3504,!1)}();f.forEach((T,P)=>{T.forEach((U,$)=>{T.set($,this._driver.computeStyle(P,$,Mc))})});const E=ju(d.map(T=>{const P=f.get(T.element);return this._buildPlayer(T,new Map,P)}));return this._playersById.set(n,E),E.onDestroy(()=>this.destroy(n)),this.players.push(E),E}destroy(n){const t=this._getPlayer(n);t.destroy(),this._playersById.delete(n);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(n){const t=this._playersById.get(n);if(!t)throw function cH(e){return new Ee(3301,!1)}();return t}listen(n,t,i,r){const l=zw(t,"","","");return Nw(this._getPlayer(n),i,l,r),()=>{}}command(n,t,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,t,r[0]||{});const l=this._getPlayer(n);switch(i){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const zk="ng-animate-queued",e1="ng-animate-disabled",a$=[],Vk={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},l$={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},nl="__ng_removed";class t1{get params(){return this.options.params}constructor(n,t=""){this.namespaceId=t;const i=n&&n.hasOwnProperty("value");if(this.value=function h$(e){return e??null}(i?n.value:n),i){const l=$m(n);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const t=n.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Wm="void",n1=new t1(Wm);class c${constructor(n,t,i){this.id=n,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Aa(t,this._hostClassName)}listen(n,t,i,r){if(!this._triggers.has(t))throw function uH(e,n){return new Ee(3302,!1)}();if(null==i||0==i.length)throw function dH(e){return new Ee(3303,!1)}();if(!function p$(e){return"start"==e||"done"==e}(i))throw function hH(e,n){return new Ee(3400,!1)}();const l=Us(this._elementListeners,n,[]),d={name:t,phase:i,callback:r};l.push(d);const f=Us(this._engine.statesByElement,n,new Map);return f.has(t)||(Aa(n,jy),Aa(n,jy+"-"+t),f.set(t,n1)),()=>{this._engine.afterFlush(()=>{const b=l.indexOf(d);b>=0&&l.splice(b,1),this._triggers.has(t)||f.delete(t)})}}register(n,t){return!this._triggers.has(n)&&(this._triggers.set(n,t),!0)}_getTrigger(n){const t=this._triggers.get(n);if(!t)throw function pH(e){return new Ee(3401,!1)}();return t}trigger(n,t,i,r=!0){const l=this._getTrigger(t),d=new r1(this.id,t,n);let f=this._engine.statesByElement.get(n);f||(Aa(n,jy),Aa(n,jy+"-"+t),this._engine.statesByElement.set(n,f=new Map));let b=f.get(t);const E=new t1(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&b&&E.absorbOptions(b.options),f.set(t,E),b||(b=n1),E.value!==Wm&&b.value===E.value){if(!function g$(e,n){const t=Object.keys(e),i=Object.keys(n);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const l=t[r];if(!n.hasOwnProperty(l)||e[l]!==n[l])return!1}return!0}(b.params,E.params)){const oe=[],_e=l.matchStyles(b.value,b.params,oe),Me=l.matchStyles(E.value,E.params,oe);oe.length?this._engine.reportError(oe):this._engine.afterFlush(()=>{lh(n,_e),Gl(n,Me)})}return}const U=Us(this._engine.playersByElement,n,[]);U.forEach(oe=>{oe.namespaceId==this.id&&oe.triggerName==t&&oe.queued&&oe.destroy()});let $=l.matchTransition(b.value,E.value,n,E.params),Q=!1;if(!$){if(!r)return;$=l.fallbackTransition,Q=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:t,transition:$,fromState:b,toState:E,player:d,isFallbackTransition:Q}),Q||(Aa(n,zk),d.onStart(()=>{Bp(n,zk)})),d.onDone(()=>{let oe=this.players.indexOf(d);oe>=0&&this.players.splice(oe,1);const _e=this._engine.playersByElement.get(n);if(_e){let Me=_e.indexOf(d);Me>=0&&_e.splice(Me,1)}}),this.players.push(d),U.push(d),d}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(t=>t.delete(n)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const t=this._engine.playersByElement.get(n);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,t){const i=this._engine.driver.query(n,Hy,!0);i.forEach(r=>{if(r[nl])return;const l=this._engine.fetchNamespacesByElement(r);l.size?l.forEach(d=>d.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,t,i,r){const l=this._engine.statesByElement.get(n),d=new Map;if(l){const f=[];if(l.forEach((b,E)=>{if(d.set(E,b.value),this._triggers.has(E)){const T=this.trigger(n,E,Wm,r);T&&f.push(T)}}),f.length)return this._engine.markElementAsRemoved(this.id,n,!0,t,d),i&&ju(f).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const t=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(t&&i){const r=new Set;t.forEach(l=>{const d=l.name;if(r.has(d))return;r.add(d);const b=this._triggers.get(d).fallbackTransition,E=i.get(d)||n1,T=new t1(Wm),P=new r1(this.id,d,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:d,transition:b,fromState:E,toState:T,player:P,isFallbackTransition:!0})})}}removeNode(n,t){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,t),this.triggerLeaveAnimation(n,t,!0))return;let r=!1;if(i.totalAnimations){const l=i.players.length?i.playersByQueriedElement.get(n):[];if(l&&l.length)r=!0;else{let d=n;for(;d=d.parentNode;)if(i.statesByElement.get(d)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,t);else{const l=n[nl];(!l||l===Vk)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,t))}}insertNode(n,t){Aa(n,this._hostClassName)}drainQueuedTransitions(n){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const l=i.element,d=this._elementListeners.get(l);d&&d.forEach(f=>{if(f.name==i.triggerName){const b=zw(l,i.triggerName,i.fromState.value,i.toState.value);b._data=n,Nw(i.player,f.phase,b,f.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const l=i.transition.ast.depCount,d=r.transition.ast.depCount;return 0==l||0==d?l-d:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class u${_onRemovalComplete(n,t){this.onRemovalComplete(n,t)}constructor(n,t,i){this.bodyNode=n,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,l)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,t){const i=new c$(n,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let d=!1,f=this.driver.getParentElement(t);for(;f;){const b=r.get(f);if(b){const E=i.indexOf(b);i.splice(E+1,0,n),d=!0;break}f=this.driver.getParentElement(f)}d||i.unshift(n)}else i.push(n);return r.set(t,n),n}register(n,t){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,t)),i}registerTrigger(n,t,i){let r=this._namespaceLookup[n];r&&r.register(t,i)&&this.totalAnimations++}destroy(n,t){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const t=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const l=this._fetchNamespace(r.namespaceId);l&&t.add(l)}return t}trigger(n,t,i,r){if(Qy(t)){const l=this._fetchNamespace(n);if(l)return l.trigger(t,i,r),!0}return!1}insertNode(n,t,i,r){if(!Qy(t))return;const l=t[nl];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const d=this.collectedLeaveElements.indexOf(t);d>=0&&this.collectedLeaveElements.splice(d,1)}if(n){const d=this._fetchNamespace(n);d&&d.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,t){t?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Aa(n,e1)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Bp(n,e1))}removeNode(n,t,i){if(Qy(t)){const r=n?this._fetchNamespace(n):null;r?r.removeNode(t,i):this.markElementAsRemoved(n,t,!1,i);const l=this.namespacesByHostElement.get(t);l&&l.id!==n&&l.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(n,t,i,r,l){this.collectedLeaveElements.push(t),t[nl]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:l}}listen(n,t,i,r,l){return Qy(t)?this._fetchNamespace(n).listen(t,i,r,l):()=>{}}_buildInstruction(n,t,i,r,l){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,t,l)}destroyInnerAnimations(n){let t=this.driver.query(n,Hy,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(n,Hw,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const t=this.playersByElement.get(n);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const t=this.playersByQueriedElement.get(n);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return ju(this.players).onDone(()=>n());n()})}processLeaveNode(n){const t=n[nl];if(t&&t.setForRemoval){if(n[nl]=Vk,t.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,t.setForRemoval)}n.classList?.contains(e1)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Aa(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?ju(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function fH(e){return new Ee(3402,!1)}()}_flushAnimations(n,t){const i=new Xy,r=[],l=new Map,d=[],f=new Map,b=new Map,E=new Map,T=new Set;this.disabledNodes.forEach(_t=>{T.add(_t);const Mt=this.driver.query(_t,".ng-animate-queued",!0);for(let Rt=0;Rt<Mt.length;Rt++)T.add(Mt[Rt])});const P=this.bodyNode,U=Array.from(this.statesByElement.keys()),$=Hk(U,this.collectedEnterElements),Q=new Map;let oe=0;$.forEach((_t,Mt)=>{const Rt=jw+oe++;Q.set(Mt,Rt),_t.forEach(Dn=>Aa(Dn,Rt))});const _e=[],Me=new Set,ve=new Set;for(let _t=0;_t<this.collectedLeaveElements.length;_t++){const Mt=this.collectedLeaveElements[_t],Rt=Mt[nl];Rt&&Rt.setForRemoval&&(_e.push(Mt),Me.add(Mt),Rt.hasAnimation?this.driver.query(Mt,".ng-star-inserted",!0).forEach(Dn=>Me.add(Dn)):ve.add(Mt))}const it=new Map,st=Hk(U,Array.from(Me));st.forEach((_t,Mt)=>{const Rt=Uy+oe++;it.set(Mt,Rt),_t.forEach(Dn=>Aa(Dn,Rt))}),n.push(()=>{$.forEach((_t,Mt)=>{const Rt=Q.get(Mt);_t.forEach(Dn=>Bp(Dn,Rt))}),st.forEach((_t,Mt)=>{const Rt=it.get(Mt);_t.forEach(Dn=>Bp(Dn,Rt))}),_e.forEach(_t=>{this.processLeaveNode(_t)})});const jt=[],Xn=[];for(let _t=this._namespaceList.length-1;_t>=0;_t--)this._namespaceList[_t].drainQueuedTransitions(t).forEach(Rt=>{const Dn=Rt.player,qr=Rt.element;if(jt.push(Dn),this.collectedEnterElements.length){const Do=qr[nl];if(Do&&Do.setForMove){if(Do.previousTriggersValues&&Do.previousTriggersValues.has(Rt.triggerName)){const dh=Do.previousTriggersValues.get(Rt.triggerName),ka=this.statesByElement.get(Rt.element);if(ka&&ka.has(Rt.triggerName)){const nv=ka.get(Rt.triggerName);nv.value=dh,ka.set(Rt.triggerName,nv)}}return void Dn.destroy()}}const ql=!P||!this.driver.containsElement(P,qr),$s=it.get(qr),$u=Q.get(qr),Oi=this._buildInstruction(Rt,i,$u,$s,ql);if(Oi.errors&&Oi.errors.length)return void Xn.push(Oi);if(ql)return Dn.onStart(()=>lh(qr,Oi.fromStyles)),Dn.onDestroy(()=>Gl(qr,Oi.toStyles)),void r.push(Dn);if(Rt.isFallbackTransition)return Dn.onStart(()=>lh(qr,Oi.fromStyles)),Dn.onDestroy(()=>Gl(qr,Oi.toStyles)),void r.push(Dn);const e2=[];Oi.timelines.forEach(Do=>{Do.stretchStartingKeyframe=!0,this.disabledNodes.has(Do.element)||e2.push(Do)}),Oi.timelines=e2,i.append(qr,Oi.timelines),d.push({instruction:Oi,player:Dn,element:qr}),Oi.queriedElements.forEach(Do=>Us(f,Do,[]).push(Dn)),Oi.preStyleProps.forEach((Do,dh)=>{if(Do.size){let ka=b.get(dh);ka||b.set(dh,ka=new Set),Do.forEach((nv,a1)=>ka.add(a1))}}),Oi.postStyleProps.forEach((Do,dh)=>{let ka=E.get(dh);ka||E.set(dh,ka=new Set),Do.forEach((nv,a1)=>ka.add(a1))})});if(Xn.length){const _t=[];Xn.forEach(Mt=>{_t.push(function mH(e,n){return new Ee(3505,!1)}())}),jt.forEach(Mt=>Mt.destroy()),this.reportError(_t)}const ai=new Map,lo=new Map;d.forEach(_t=>{const Mt=_t.element;i.has(Mt)&&(lo.set(Mt,Mt),this._beforeAnimationBuild(_t.player.namespaceId,_t.instruction,ai))}),r.forEach(_t=>{const Mt=_t.element;this._getPreviousPlayers(Mt,!1,_t.namespaceId,_t.triggerName,null).forEach(Dn=>{Us(ai,Mt,[]).push(Dn),Dn.destroy()})});const Hs=_e.filter(_t=>Gk(_t,b,E)),il=new Map;jk(il,this.driver,ve,E,Mc).forEach(_t=>{Gk(_t,b,E)&&Hs.push(_t)});const Zm=new Map;$.forEach((_t,Mt)=>{jk(Zm,this.driver,new Set(_t),b,"!")}),Hs.forEach(_t=>{const Mt=il.get(_t),Rt=Zm.get(_t);il.set(_t,new Map([...Mt?.entries()??[],...Rt?.entries()??[]]))});const uh=[],Qk=[],Jk={};d.forEach(_t=>{const{element:Mt,player:Rt,instruction:Dn}=_t;if(i.has(Mt)){if(T.has(Mt))return Rt.onDestroy(()=>Gl(Mt,Dn.toStyles)),Rt.disabled=!0,Rt.overrideTotalTime(Dn.totalTime),void r.push(Rt);let qr=Jk;if(lo.size>1){let $s=Mt;const $u=[];for(;$s=$s.parentNode;){const Oi=lo.get($s);if(Oi){qr=Oi;break}$u.push($s)}$u.forEach(Oi=>lo.set(Oi,qr))}const ql=this._buildAnimation(Rt.namespaceId,Dn,ai,l,Zm,il);if(Rt.setRealPlayer(ql),qr===Jk)uh.push(Rt);else{const $s=this.playersByElement.get(qr);$s&&$s.length&&(Rt.parentPlayer=ju($s)),r.push(Rt)}}else lh(Mt,Dn.fromStyles),Rt.onDestroy(()=>Gl(Mt,Dn.toStyles)),Qk.push(Rt),T.has(Mt)&&r.push(Rt)}),Qk.forEach(_t=>{const Mt=l.get(_t.element);if(Mt&&Mt.length){const Rt=ju(Mt);_t.setRealPlayer(Rt)}}),r.forEach(_t=>{_t.parentPlayer?_t.syncPlayerEvents(_t.parentPlayer):_t.destroy()});for(let _t=0;_t<_e.length;_t++){const Mt=_e[_t],Rt=Mt[nl];if(Bp(Mt,Uy),Rt&&Rt.hasAnimation)continue;let Dn=[];if(f.size){let ql=f.get(Mt);ql&&ql.length&&Dn.push(...ql);let $s=this.driver.query(Mt,Hw,!0);for(let $u=0;$u<$s.length;$u++){let Oi=f.get($s[$u]);Oi&&Oi.length&&Dn.push(...Oi)}}const qr=Dn.filter(ql=>!ql.destroyed);qr.length?f$(this,Mt,qr):this.processLeaveNode(Mt)}return _e.length=0,uh.forEach(_t=>{this.players.push(_t),_t.onDone(()=>{_t.destroy();const Mt=this.players.indexOf(_t);this.players.splice(Mt,1)}),_t.play()}),uh}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,t,i,r,l){let d=[];if(t){const f=this.playersByQueriedElement.get(n);f&&(d=f)}else{const f=this.playersByElement.get(n);if(f){const b=!l||l==Wm;f.forEach(E=>{E.queued||!b&&E.triggerName!=r||d.push(E)})}}return(i||r)&&(d=d.filter(f=>!(i&&i!=f.namespaceId||r&&r!=f.triggerName))),d}_beforeAnimationBuild(n,t,i){const l=t.element,d=t.isRemovalTransition?void 0:n,f=t.isRemovalTransition?void 0:t.triggerName;for(const b of t.timelines){const E=b.element,T=E!==l,P=Us(i,E,[]);this._getPreviousPlayers(E,T,d,f,t.toState).forEach($=>{const Q=$.getRealPlayer();Q.beforeDestroy&&Q.beforeDestroy(),$.destroy(),P.push($)})}lh(l,t.fromStyles)}_buildAnimation(n,t,i,r,l,d){const f=t.triggerName,b=t.element,E=[],T=new Set,P=new Set,U=t.timelines.map(Q=>{const oe=Q.element;T.add(oe);const _e=oe[nl];if(_e&&_e.removedBeforeQueried)return new Nm(Q.duration,Q.delay);const Me=oe!==b,ve=function m$(e){const n=[];return $k(e,n),n}((i.get(oe)||a$).map(ai=>ai.getRealPlayer())).filter(ai=>!!ai.element&&ai.element===oe),it=l.get(oe),st=d.get(oe),jt=bk(this._normalizer,Q.keyframes,it,st),Xn=this._buildPlayer(Q,jt,ve);if(Q.subTimeline&&r&&P.add(oe),Me){const ai=new r1(n,f,oe);ai.setRealPlayer(Xn),E.push(ai)}return Xn});E.forEach(Q=>{Us(this.playersByQueriedElement,Q.element,[]).push(Q),Q.onDone(()=>function d$(e,n,t){let i=e.get(n);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&e.delete(n)}return i}(this.playersByQueriedElement,Q.element,Q))}),T.forEach(Q=>Aa(Q,Ik));const $=ju(U);return $.onDestroy(()=>{T.forEach(Q=>Bp(Q,Ik)),Gl(b,t.toStyles)}),P.forEach(Q=>{Us(r,Q,[]).push($)}),$}_buildPlayer(n,t,i){return t.length>0?this.driver.animate(n.element,t,n.duration,n.delay,n.easing,i):new Nm(n.duration,n.delay)}}class r1{constructor(n,t,i){this.namespaceId=n,this.triggerName=t,this.element=i,this._player=new Nm,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>Nw(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const t=this._player;t.triggerCallback&&n.onStart(()=>t.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,t){Us(this._queuedCallbacks,n,[]).push(t)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const t=this._player;t.triggerCallback&&t.triggerCallback(n)}}function Qy(e){return e&&1===e.nodeType}function Uk(e,n){const t=e.style.display;return e.style.display=n??"none",t}function jk(e,n,t,i,r){const l=[];t.forEach(b=>l.push(Uk(b)));const d=[];i.forEach((b,E)=>{const T=new Map;b.forEach(P=>{const U=n.computeStyle(E,P,r);T.set(P,U),(!U||0==U.length)&&(E[nl]=l$,d.push(E))}),e.set(E,T)});let f=0;return t.forEach(b=>Uk(b,l[f++])),d}function Hk(e,n){const t=new Map;if(e.forEach(f=>t.set(f,[])),0==n.length)return t;const r=new Set(n),l=new Map;function d(f){if(!f)return 1;let b=l.get(f);if(b)return b;const E=f.parentNode;return b=t.has(E)?E:r.has(E)?1:d(E),l.set(f,b),b}return n.forEach(f=>{const b=d(f);1!==b&&t.get(b).push(f)}),t}function Aa(e,n){e.classList?.add(n)}function Bp(e,n){e.classList?.remove(n)}function f$(e,n,t){ju(t).onDone(()=>e.processLeaveNode(n))}function $k(e,n){for(let t=0;t<e.length;t++){const i=e[t];i instanceof VT?$k(i.players,n):n.push(i)}}function Gk(e,n,t){const i=t.get(e);if(!i)return!1;let r=n.get(e);return r?i.forEach(l=>r.add(l)):n.set(e,i),t.delete(e),!0}class Jy{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,l)=>{},this._transitionEngine=new u$(n,t,i),this._timelineEngine=new n$(n,t,i),this._transitionEngine.onRemovalComplete=(r,l)=>this.onRemovalComplete(r,l)}registerTrigger(n,t,i,r,l){const d=n+"-"+r;let f=this._triggerCache[d];if(!f){const b=[],T=Ww(this._driver,l,b,[]);if(b.length)throw function rH(e,n){return new Ee(3404,!1)}();f=function QH(e,n,t){return new JH(e,n,t)}(r,T,this._normalizer),this._triggerCache[d]=f}this._transitionEngine.registerTrigger(t,r,f)}register(n,t){this._transitionEngine.register(n,t)}destroy(n,t){this._transitionEngine.destroy(n,t)}onInsert(n,t,i,r){this._transitionEngine.insertNode(n,t,i,r)}onRemove(n,t,i){this._transitionEngine.removeNode(n,t,i)}disableAnimations(n,t){this._transitionEngine.markElementAsDisabled(n,t)}process(n,t,i,r){if("@"==i.charAt(0)){const[l,d]=xk(i);this._timelineEngine.command(l,t,d,r)}else this._transitionEngine.trigger(n,t,i,r)}listen(n,t,i,r,l){if("@"==i.charAt(0)){const[d,f]=xk(i);return this._timelineEngine.listen(d,t,f,l)}return this._transitionEngine.listen(n,t,i,r,l)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let y$=(()=>{class e{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let l=e.initialStylesByElement.get(t);l||e.initialStylesByElement.set(t,l=new Map),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&Gl(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Gl(this._element,this._initialStyles),this._endStyles&&(Gl(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(lh(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(lh(this._element,this._endStyles),this._endStyles=null),Gl(this._element,this._initialStyles),this._state=3)}}return e})();function o1(e){let n=null;return e.forEach((t,i)=>{(function v$(e){return"display"===e||"position"===e})(i)&&(n=n||new Map,n.set(i,t))}),n}class qk{constructor(n,t,i,r){this.element=n,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const t=[];return n.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(n,t,i){return n.animate(this._convertKeyframesToObject(t),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:kk(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const t="start"===n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class b${validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,t){return!1}containsElement(n,t){return Ek(n,t)}getParentElement(n){return Vw(n)}query(n,t,i){return Ck(n,t,i)}computeStyle(n,t,i){return window.getComputedStyle(n)[t]}animate(n,t,i,r,l,d=[]){const b={duration:i,delay:r,fill:0==r?"both":"forwards"};l&&(b.easing=l);const E=new Map,T=d.filter($=>$ instanceof qk);(function IH(e,n){return 0===e||0===n})(i,r)&&T.forEach($=>{$.currentSnapshot.forEach((Q,oe)=>E.set(oe,Q))});let P=function CH(e){return e.length?e[0]instanceof Map?e:e.map(n=>Mk(n)):[]}(t).map($=>Hu($));P=function MH(e,n,t){if(t.size&&n.length){let i=n[0],r=[];if(t.forEach((l,d)=>{i.has(d)||r.push(d),i.set(d,l)}),r.length)for(let l=1;l<n.length;l++){let d=n[l];r.forEach(f=>d.set(f,kk(e,f)))}}return n}(n,P,E);const U=function _$(e,n){let t=null,i=null;return Array.isArray(n)&&n.length?(t=o1(n[0]),n.length>1&&(i=o1(n[n.length-1]))):n instanceof Map&&(t=o1(n)),t||i?new y$(e,t,i):null}(n,P);return new qk(n,P,b,U)}}let x$=(()=>{class e extends BT{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Qi.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?zT(t):t;return Wk(this._renderer,null,i,"register",[r]),new w$(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||e)(Te(qf),Te(pn))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();class w$ extends G4{constructor(n,t){super(),this._id=n,this._renderer=t}create(n,t){return new E$(this._id,n,t||{},this._renderer)}}class E${constructor(n,t,i,r){this.id=n,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,t){return this._renderer.listen(this.element,`@@${this.id}:${n}`,t)}_command(n,...t){return Wk(this._renderer,this.element,this.id,n,t)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function Wk(e,n,t,i,r){return e.setProperty(n,`@@${t}:${i}`,r)}const Zk="@.disabled";let C$=(()=>{class e{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(l,d)=>{const f=d?.parentNode(l);f&&d.removeChild(f,l)}}createRenderer(t,i){const l=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let T=this._rendererCache.get(l);return T||(T=new Xk("",l,this.engine,()=>this._rendererCache.delete(l)),this._rendererCache.set(l,T)),T}const d=i.id,f=i.id+"-"+this._currentId;this._currentId++,this.engine.register(f,t);const b=T=>{Array.isArray(T)?T.forEach(b):this.engine.registerTrigger(d,f,t,T.name,T)};return i.data.animation.forEach(b),new D$(this,f,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[d,f]=l;d(f)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||e)(Te(qf),Te(Jy),Te(qt))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})();class Xk{constructor(n,t,i,r){this.namespaceId=n,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,t){return this.delegate.createElement(n,t)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,t){this.delegate.appendChild(n,t),this.engine.onInsert(this.namespaceId,t,n,!1)}insertBefore(n,t,i,r=!0){this.delegate.insertBefore(n,t,i),this.engine.onInsert(this.namespaceId,t,n,r)}removeChild(n,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(n,t){return this.delegate.selectRootElement(n,t)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,t,i,r){this.delegate.setAttribute(n,t,i,r)}removeAttribute(n,t,i){this.delegate.removeAttribute(n,t,i)}addClass(n,t){this.delegate.addClass(n,t)}removeClass(n,t){this.delegate.removeClass(n,t)}setStyle(n,t,i,r){this.delegate.setStyle(n,t,i,r)}removeStyle(n,t,i){this.delegate.removeStyle(n,t,i)}setProperty(n,t,i){"@"==t.charAt(0)&&t==Zk?this.disableAnimations(n,!!i):this.delegate.setProperty(n,t,i)}setValue(n,t){this.delegate.setValue(n,t)}listen(n,t,i){return this.delegate.listen(n,t,i)}disableAnimations(n,t){this.engine.disableAnimations(n,t)}}class D$ extends Xk{constructor(n,t,i,r,l){super(t,i,r,l),this.factory=n,this.namespaceId=t}setProperty(n,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==Zk?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,t.slice(1),i):this.delegate.setProperty(n,t,i)}listen(n,t,i){if("@"==t.charAt(0)){const r=function S$(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(n);let l=t.slice(1),d="";return"@"!=l.charAt(0)&&([l,d]=function I$(e){const n=e.indexOf(".");return[e.substring(0,n),e.slice(n+1)]}(l)),this.engine.listen(this.namespaceId,r,l,d,f=>{this.factory.scheduleListenerCallback(f._data||-1,i,f)})}return this.delegate.listen(n,t,i)}}const Kk=[{provide:BT,useClass:x$},{provide:Qw,useFactory:function T$(){return new ZH}},{provide:Jy,useClass:(()=>{class e extends Jy{constructor(t,i,r,l){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||e)(Te(pn),Te(Uw),Te(Qw),Te(Iu))};static#t=this.\u0275prov=at({token:e,factory:e.\u0275fac})}return e})()},{provide:qf,useFactory:function A$(e,n,t){return new C$(e,n,t)},deps:[Xx,Jy,qt]}],s1=[{provide:Uw,useFactory:()=>new b$},{provide:xc,useValue:"BrowserAnimations"},...Kk],Yk=[{provide:Uw,useClass:Dk},{provide:xc,useValue:"NoopAnimations"},...Kk];let k$=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?Yk:s1}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=di({type:e});static#n=this.\u0275inj=ci({providers:s1,imports:[TI]})}return e})(),R$=(()=>{class e{constructor(t){t.versionUpdates.pipe(wo(i=>"VERSION_READY"===i.type)).subscribe(i=>{document.location.reload()})}static#e=this.\u0275fac=function(i){return new(i||e)(Te(Ow))};static#t=this.\u0275mod=di({type:e,bootstrap:[D8]});static#n=this.\u0275inj=ci({imports:[TI,L8.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:1000"}),k$,mA]})}return e})();xV().bootstrapModule(R$).catch(e=>console.error(e))},16:Pc=>{"use strict";var $t,So="object"==typeof Reflect?Reflect:null,ps=So&&"function"==typeof So.apply?So.apply:function(ze,We,ct){return Function.prototype.apply.call(ze,We,ct)};$t=So&&"function"==typeof So.ownKeys?So.ownKeys:Object.getOwnPropertySymbols?function(ze){return Object.getOwnPropertyNames(ze).concat(Object.getOwnPropertySymbols(ze))}:function(ze){return Object.getOwnPropertyNames(ze)};var Fc=Number.isNaN||function(ze){return ze!=ze};function y(){y.init.call(this)}Pc.exports=y,Pc.exports.once=function Ci($e,ze){return new Promise(function(We,ct){function pt(Lt){$e.removeListener(ze,ut),ct(Lt)}function ut(){"function"==typeof $e.removeListener&&$e.removeListener("error",pt),We([].slice.call(arguments))}Mo($e,ze,ut,{once:!0}),"error"!==ze&&function Io($e,ze,We){"function"==typeof $e.on&&Mo($e,"error",ze,We)}($e,pt,{once:!0})})},y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var Qt=10;function be($e){if("function"!=typeof $e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof $e)}function Wi($e){return void 0===$e._maxListeners?y.defaultMaxListeners:$e._maxListeners}function lt($e,ze,We,ct){var pt,ut,Lt;if(be(We),void 0===(ut=$e._events)?(ut=$e._events=Object.create(null),$e._eventsCount=0):(void 0!==ut.newListener&&($e.emit("newListener",ze,We.listener?We.listener:We),ut=$e._events),Lt=ut[ze]),void 0===Lt)Lt=ut[ze]=We,++$e._eventsCount;else if("function"==typeof Lt?Lt=ut[ze]=ct?[We,Lt]:[Lt,We]:ct?Lt.unshift(We):Lt.push(We),(pt=Wi($e))>0&&Lt.length>pt&&!Lt.warned){Lt.warned=!0;var Gn=new Error("Possible EventEmitter memory leak detected. "+Lt.length+" "+String(ze)+" listeners added. Use emitter.setMaxListeners() to increase limit");Gn.name="MaxListenersExceededWarning",Gn.emitter=$e,Gn.type=ze,Gn.count=Lt.length,function Rc($e){console&&console.warn&&console.warn($e)}(Gn)}return $e}function cr(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Wr($e,ze,We){var ct={fired:!1,wrapFn:void 0,target:$e,type:ze,listener:We},pt=cr.bind(ct);return pt.listener=We,ct.wrapFn=pt,pt}function fs($e,ze,We){var ct=$e._events;if(void 0===ct)return[];var pt=ct[ze];return void 0===pt?[]:"function"==typeof pt?We?[pt.listener||pt]:[pt]:We?function co($e){for(var ze=new Array($e.length),We=0;We<ze.length;++We)ze[We]=$e[We].listener||$e[We];return ze}(pt):Yo(pt,pt.length)}function Zr($e){var ze=this._events;if(void 0!==ze){var We=ze[$e];if("function"==typeof We)return 1;if(void 0!==We)return We.length}return 0}function Yo($e,ze){for(var We=new Array(ze),ct=0;ct<ze;++ct)We[ct]=$e[ct];return We}function Mo($e,ze,We,ct){if("function"==typeof $e.on)ct.once?$e.once(ze,We):$e.on(ze,We);else{if("function"!=typeof $e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof $e);$e.addEventListener(ze,function pt(ut){ct.once&&$e.removeEventListener(ze,pt),We(ut)})}}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return Qt},set:function($e){if("number"!=typeof $e||$e<0||Fc($e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+$e+".");Qt=$e}}),y.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(ze){if("number"!=typeof ze||ze<0||Fc(ze))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ze+".");return this._maxListeners=ze,this},y.prototype.getMaxListeners=function(){return Wi(this)},y.prototype.emit=function(ze){for(var We=[],ct=1;ct<arguments.length;ct++)We.push(arguments[ct]);var pt="error"===ze,ut=this._events;if(void 0!==ut)pt=pt&&void 0===ut.error;else if(!pt)return!1;if(pt){var Lt;if(We.length>0&&(Lt=We[0]),Lt instanceof Error)throw Lt;var Gn=new Error("Unhandled error."+(Lt?" ("+Lt.message+")":""));throw Gn.context=Lt,Gn}var Zi=ut[ze];if(void 0===Zi)return!1;if("function"==typeof Zi)ps(Zi,this,We);else{var To=Zi.length,Ao=Yo(Zi,To);for(ct=0;ct<To;++ct)ps(Ao[ct],this,We)}return!0},y.prototype.on=y.prototype.addListener=function(ze,We){return lt(this,ze,We,!1)},y.prototype.prependListener=function(ze,We){return lt(this,ze,We,!0)},y.prototype.once=function(ze,We){return be(We),this.on(ze,Wr(this,ze,We)),this},y.prototype.prependOnceListener=function(ze,We){return be(We),this.prependListener(ze,Wr(this,ze,We)),this},y.prototype.off=y.prototype.removeListener=function(ze,We){var ct,pt,ut,Lt,Gn;if(be(We),void 0===(pt=this._events))return this;if(void 0===(ct=pt[ze]))return this;if(ct===We||ct.listener===We)0==--this._eventsCount?this._events=Object.create(null):(delete pt[ze],pt.removeListener&&this.emit("removeListener",ze,ct.listener||We));else if("function"!=typeof ct){for(ut=-1,Lt=ct.length-1;Lt>=0;Lt--)if(ct[Lt]===We||ct[Lt].listener===We){Gn=ct[Lt].listener,ut=Lt;break}if(ut<0)return this;0===ut?ct.shift():function zn($e,ze){for(;ze+1<$e.length;ze++)$e[ze]=$e[ze+1];$e.pop()}(ct,ut),1===ct.length&&(pt[ze]=ct[0]),void 0!==pt.removeListener&&this.emit("removeListener",ze,Gn||We)}return this},y.prototype.removeAllListeners=function(ze){var We,ct,pt;if(void 0===(ct=this._events))return this;if(void 0===ct.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ct[ze]&&(0==--this._eventsCount?this._events=Object.create(null):delete ct[ze]),this;if(0===arguments.length){var Lt,ut=Object.keys(ct);for(pt=0;pt<ut.length;++pt)"removeListener"!==(Lt=ut[pt])&&this.removeAllListeners(Lt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(We=ct[ze]))this.removeListener(ze,We);else if(void 0!==We)for(pt=We.length-1;pt>=0;pt--)this.removeListener(ze,We[pt]);return this},y.prototype.listeners=function(ze){return fs(this,ze,!0)},y.prototype.rawListeners=function(ze){return fs(this,ze,!1)},y.listenerCount=function($e,ze){return"function"==typeof $e.listenerCount?$e.listenerCount(ze):Zr.call($e,ze)},y.prototype.listenerCount=Zr,y.prototype.eventNames=function(){return this._eventsCount>0?$t(this._events):[]}},624:function(Pc){Pc.exports=function(){"use strict";var So,ps,$t;function Rc(y,Qt){if(So)if(ps){var be="var sharedChunk = {}; ("+So+")(sharedChunk); ("+ps+")(sharedChunk);",Wi={};So(Wi),$t=Qt(Wi),typeof window<"u"&&($t.workerUrl=window.URL.createObjectURL(new Blob([be],{type:"text/javascript"})))}else ps=Qt;else So=Qt}return Rc(0,function(y){function Qt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var be=Wi;function Wi(a,o){this.x=a,this.y=o}Wi.prototype={clone:function(){return new Wi(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,o){return this.clone()._rotateAround(a,o)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var o=a.x-this.x,c=a.y-this.y;return o*o+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,o){return Math.atan2(this.x*o-this.y*a,this.x*a+this.y*o)},_matMult:function(a){var o=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=o,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var o=Math.cos(a),c=Math.sin(a),h=c*this.x+o*this.y;return this.x=o*this.x-c*this.y,this.y=h,this},_rotateAround:function(a,o){var c=Math.cos(a),h=Math.sin(a),g=o.y+h*(this.x-o.x)+c*(this.y-o.y);return this.x=o.x+c*(this.x-o.x)-h*(this.y-o.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Wi.convert=function(a){return a instanceof Wi?a:Array.isArray(a)?new Wi(a[0],a[1]):a};var lt=Qt(be),cr=Wr;function Wr(a,o,c,h){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(h-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=c,this.p2y=h}Wr.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,o){if(void 0===o&&(o=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,h=0;h<8;h++){var g=this.sampleCurveX(c)-a;if(Math.abs(g)<o)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=g/v}var x=0,C=1;for(c=a,h=0;h<20&&(g=this.sampleCurveX(c),!(Math.abs(g-a)<o));h++)a>g?x=c:C=c,c=.5*(C-x)+x;return c},solve:function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))}};var fs=Qt(cr);function Zr(a,o,c,h){const g=new fs(a,o,c,h);return function(v){return g.solve(v)}}const Yo=Zr(.25,.1,.25,1);function zn(a,o,c){return Math.min(c,Math.max(o,a))}function co(a,o,c){const h=c-o,g=((a-o)%h+h)%h+o;return g===o?c:g}function Ci(a,...o){for(const c of o)for(const h in c)a[h]=c[h];return a}let Io=1;function Mo(a,o){a.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function $e(a,o,c){const h={};for(const g in a)h[g]=o.call(c||this,a[g],g,a);return h}function ze(a,o,c){const h={};for(const g in a)o.call(c||this,a[g],g,a)&&(h[g]=a[g]);return h}function We(a){return Array.isArray(a)?a.map(We):"object"==typeof a&&a?$e(a,We):a}const ct={};function pt(a){ct[a]||(typeof console<"u"&&console.warn(a),ct[a]=!0)}function ut(a,o,c){return(c.y-a.y)*(o.x-a.x)>(o.y-a.y)*(c.x-a.x)}function Lt(a){let o=0;for(let c,h,g=0,v=a.length,x=v-1;g<v;x=g++)c=a[g],h=a[x],o+=(h.x-c.x)*(c.y+h.y);return o}function Gn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Zi=null;function To(a){if(null==Zi){const o=a.navigator?a.navigator.userAgent:null;Zi=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Zi}function Ao(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Lr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Wl,Gs;const _n={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const o=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(a,o=0){return this.getImageCanvasContext(a).getImageData(-o,-o,a.width+2*o,a.height+2*o)},getImageCanvasContext(a){const o=window.document.createElement("canvas"),c=o.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return o.width=a.width,o.height=a.height,c.drawImage(a,0,0,a.width,a.height),c},resolveURL:a=>(Wl||(Wl=document.createElement("a")),Wl.href=a,Wl.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==Gs&&(Gs=matchMedia("(prefers-reduced-motion: reduce)")),Gs.matches)}},rl={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class qs extends Error{constructor(o,c,h,g){super(`AJAXError: ${c} (${o}): ${h}`),this.status=o,this.statusText=c,this.url=h,this.body=g}}const Dr=Gn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,uo=a=>rl.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))];function Ft(a,o){const c=new AbortController,h=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:Dr(),signal:c.signal});let g=!1,v=!1;return"json"===a.type&&h.headers.set("Accept","application/json"),v||fetch(h).then(x=>{return x.ok?(C=x,void("arrayBuffer"===a.type||"image"===a.type?C.arrayBuffer():"json"===a.type?C.json():C.text()).then(S=>{v||(g=!0,o(null,S,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(S=>{v||o(new Error(S.message))})):x.blob().then(C=>o(new qs(x.status,x.statusText,a.url,C)));var C}).catch(x=>{20!==x.code&&o(new Error(x.message))}),{cancel:()=>{v=!0,g||c.abort()}}}const Pa=function(a,o){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(Gn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o);if(!Gn())return(uo(a.url)||Ft)(a,o)}if(!(/^file:/.test(c=a.url)||/^file:/.test(Dr())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ft(a,o);if(Gn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o,void 0,!0)}var c;return function(h,g){const v=new XMLHttpRequest;v.open(h.method||"GET",h.url,!0),"arrayBuffer"!==h.type&&"image"!==h.type||(v.responseType="arraybuffer");for(const x in h.headers)v.setRequestHeader(x,h.headers[x]);return"json"===h.type&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials="include"===h.credentials,v.onerror=()=>{g(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||0===v.status)&&null!==v.response){let x=v.response;if("json"===h.type)try{x=JSON.parse(v.response)}catch(C){return g(C)}g(null,x,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else{const x=new Blob([v.response],{type:v.getResponseHeader("Content-Type")});g(new qs(v.status,v.statusText,h.url,x))}},v.send(h.body),{cancel:()=>v.abort()}}(a,o)},Ra=function(a,o){return Pa(Ci(a,{type:"arrayBuffer"}),o)};function Vn(a){if(!a||a.indexOf("://")<=0||0===a.indexOf("data:image/")||0===a.indexOf("blob:"))return!0;const o=new URL(a),c=window.location;return o.protocol===c.protocol&&o.host===c.host}function Mn(a,o,c){c[a]&&-1!==c[a].indexOf(o)||(c[a]=c[a]||[],c[a].push(o))}function ms(a,o,c){if(c&&c[a]){const h=c[a].indexOf(o);-1!==h&&c[a].splice(h,1)}}class fn{constructor(o,c={}){Ci(this,c),this.type=o}}class Nr extends fn{constructor(o,c={}){super("error",Ci({error:o},c))}}class ol{on(o,c){return this._listeners=this._listeners||{},Mn(o,c,this._listeners),this}off(o,c){return ms(o,c,this._listeners),ms(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Mn(o,c,this._oneTimeListeners),this):new Promise(h=>this.once(o,h))}fire(o,c){"string"==typeof o&&(o=new fn(o,c||{}));const h=o.type;if(this.listens(h)){o.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const C of g)C.call(this,o);const v=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const C of v)ms(h,C,this._oneTimeListeners),C.call(this,o);const x=this._eventedParent;x&&(Ci(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),x.fire(o))}else o instanceof Nr&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ws=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Zl(a,o){const c={};for(const h in a)"ref"!==h&&(c[h]=a[h]);return Ws.forEach(h=>{h in o&&(c[h]=o[h])}),c}function Sn(a,o){if(Array.isArray(a)){if(!Array.isArray(o)||a.length!==o.length)return!1;for(let c=0;c<a.length;c++)if(!Sn(a[c],o[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==o){if("object"!=typeof o||Object.keys(a).length!==Object.keys(o).length)return!1;for(const c in a)if(!Sn(a[c],o[c]))return!1;return!0}return a===o}const ln={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function sl(a,o,c){c.push({command:ln.addSource,args:[a,o[a]]})}function Oc(a,o,c){o.push({command:ln.removeSource,args:[a]}),c[a]=!0}function Gu(a,o,c,h){Oc(a,c,h),sl(a,o,c)}function mi(a,o,c){let h;for(h in a[c])if(Object.prototype.hasOwnProperty.call(a[c],h)&&"data"!==h&&!Sn(a[c][h],o[c][h]))return!1;for(h in o[c])if(Object.prototype.hasOwnProperty.call(o[c],h)&&"data"!==h&&!Sn(a[c][h],o[c][h]))return!1;return!0}function Zs(a,o,c,h,g,v){let x;for(x in o=o||{},a=a||{})Object.prototype.hasOwnProperty.call(a,x)&&(Sn(a[x],o[x])||c.push({command:v,args:[h,x,o[x],g]}));for(x in o)Object.prototype.hasOwnProperty.call(o,x)&&!Object.prototype.hasOwnProperty.call(a,x)&&(Sn(a[x],o[x])||c.push({command:v,args:[h,x,o[x],g]}))}function al(a){return a.id}function gs(a,o){return a[o.id]=o,a}class je{constructor(o,c,h,g){this.message=(o?`${o}: `:"")+h,g&&(this.identifier=g),null!=c&&c.__line__&&(this.line=c.__line__)}}function ho(a,...o){for(const c of o)for(const h in c)a[h]=c[h];return a}class Xi extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}class ll{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[h,g]of c)this.bindings[h]=g}concat(o){return new ll(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Xs={kind:"null"},Ve={kind:"number"},wt={kind:"string"},Tt={kind:"boolean"},Br={kind:"color"},gi={kind:"object"},At={kind:"value"},_s={kind:"collator"},ys={kind:"formatted"},ko={kind:"padding"},vs={kind:"resolvedImage"};function Ki(a,o){return{kind:"array",itemType:a,N:o}}function Tn(a){if("array"===a.kind){const o=Tn(a.itemType);return"number"==typeof a.N?`array<${o}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${o}>`}return a.kind}const Xl=[Xs,Ve,wt,Tt,Br,ys,gi,Ki(At),ko,vs];function Qo(a,o){if("error"===o.kind)return null;if("array"===a.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!Qo(a.itemType,o.itemType))&&("number"!=typeof a.N||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if("value"===a.kind)for(const c of Xl)if(!Qo(c,o))return null}return`Expected ${Tn(a)} but found ${Tn(o)} instead.`}function Y(a,o){return o.some(c=>c.kind===a.kind)}function N(a,o){return o.some(c=>"null"===c?null===a:"array"===c?Array.isArray(a):"object"===c?a&&!Array.isArray(a)&&"object"==typeof a:c===typeof a)}function z(a,o){return"array"===a.kind&&"array"===o.kind?a.itemType.kind===o.itemType.kind&&"number"==typeof a.N:a.kind===o.kind}const G=.96422,ne=4/29,ce=6/29,ae=3*ce*ce,ie=ce*ce*ce,de=Math.PI/180,Se=180/Math.PI;function Ie(a){return(a%=360)<0&&(a+=360),a}function we([a,o,c,h]){let g,v;const x=Et((.2225045*(a=ft(a))+.7168786*(o=ft(o))+.0606169*(c=ft(c)))/1);a===o&&o===c?g=v=x:(g=Et((.4360747*a+.3850649*o+.1430804*c)/G),v=Et((.0139322*a+.0971045*o+.7141733*c)/.82521));const C=116*x-16;return[C<0?0:C,500*(g-x),200*(x-v),h]}function ft(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Et(a){return a>ie?Math.pow(a,1/3):a/ae+ne}function tt([a,o,c,h]){let g=(a+16)/116,v=isNaN(o)?g:g+o/500,x=isNaN(c)?g:g-c/200;return g=1*xt(g),v=G*xt(v),x=.82521*xt(x),[dt(3.1338561*v-1.6168667*g-.4906146*x),dt(-.9787684*v+1.9161415*g+.033454*x),dt(.0719453*v-.2289914*g+1.4052427*x),h]}function dt(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function xt(a){return a>ce?a*a*a:ae*(a-ne)}function Xt(a){return parseInt(a.padEnd(2,a),16)/255}function Nt(a,o){return Bt(o?a/100:a,0,1)}function Bt(a,o,c){return Math.min(Math.max(o,a),c)}function In(a){return!a.some(Number.isNaN)}const Un={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class vt{constructor(o,c,h,g=1,v=!0){this.r=o,this.g=c,this.b=h,this.a=g,v||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[o,c,h,g]))}static parse(o){if(o instanceof vt)return o;if("string"!=typeof o)return;const c=function(h){if("transparent"===(h=h.toLowerCase()))return[0,0,0,0];const g=Un[h];if(g){const[x,C,S]=g;return[x/255,C/255,S/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const x=h.length<6?1:2;let C=1;return[Xt(h.slice(C,C+=x)),Xt(h.slice(C,C+=x)),Xt(h.slice(C,C+=x)),Xt(h.slice(C,C+x)||"ff")]}if(h.startsWith("rgb")){const x=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[C,S,A,R,L,B,V,H,K,W,se,ue]=x,re=[R||" ",V||" ",W].join("");if("  "===re||"  /"===re||",,"===re||",,,"===re){const he=[A,B,K].join(""),me="%%%"===he?100:""===he?255:0;if(me){const Ce=[Bt(+S/me,0,1),Bt(+L/me,0,1),Bt(+H/me,0,1),se?Nt(+se,ue):1];if(In(Ce))return Ce}}return}}const v=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,C,S,A,R,L,B,V,H]=v,K=[S||" ",R||" ",B].join("");if("  "===K||"  /"===K||",,"===K||",,,"===K){const W=[+C,Bt(+A,0,100),Bt(+L,0,100),V?Nt(+V,H):1];if(In(W))return function([se,ue,re,he]){function me(Ce){const Qe=(Ce+se/30)%12,nt=ue*Math.min(re,1-re);return re-nt*Math.max(-1,Math.min(Qe-3,9-Qe,1))}return se=Ie(se),ue/=100,re/=100,[me(0),me(8),me(4),he]}(W)}}}(o);return c?new vt(...c,!1):void 0}get rgb(){const{r:o,g:c,b:h,a:g}=this,v=g||1/0;return this.overwriteGetter("rgb",[o/v,c/v,h/v,g])}get hcl(){return this.overwriteGetter("hcl",function(o){const[c,h,g,v]=we(o),x=Math.sqrt(h*h+g*g);return[Math.round(1e4*x)?Ie(Math.atan2(g,h)*Se):NaN,x,c,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",we(this.rgb))}overwriteGetter(o,c){return Object.defineProperty(this,o,{value:c}),c}toString(){const[o,c,h,g]=this.rgb;return`rgba(${[o,c,h].map(v=>Math.round(255*v)).join(",")},${g})`}}vt.black=new vt(0,0,0,1),vt.white=new vt(1,1,1,1),vt.transparent=new vt(0,0,0,0),vt.red=new vt(1,0,0,1);class jn{constructor(o,c,h){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fa{constructor(o,c,h,g,v){this.text=o,this.image=c,this.scale=h,this.fontStack=g,this.textColor=v}}class Yi{constructor(o){this.sections=o}static fromString(o){return new Yi([new Fa(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof Yi?o:Yi.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}}class zr{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof zr)return o;if("number"==typeof o)return new zr([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const c of o)if("number"!=typeof c)return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new zr(o)}}toString(){return JSON.stringify(this.values)}}class Vr{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Vr({name:o,available:!1}):null}}function Oa(a,o,c,h){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===h||"number"==typeof h&&h>=0&&h<=1?null:`Invalid rgba value [${[a,o,c,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof h?[a,o,c,h]:[a,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ks(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof vt||a instanceof jn||a instanceof Yi||a instanceof zr||a instanceof Vr)return!0;if(Array.isArray(a)){for(const o of a)if(!Ks(o))return!1;return!0}if("object"==typeof a){for(const o in a)if(!Ks(a[o]))return!1;return!0}return!1}function _i(a){if(null===a)return Xs;if("string"==typeof a)return wt;if("boolean"==typeof a)return Tt;if("number"==typeof a)return Ve;if(a instanceof vt)return Br;if(a instanceof jn)return _s;if(a instanceof Yi)return ys;if(a instanceof zr)return ko;if(a instanceof Vr)return vs;if(Array.isArray(a)){const o=a.length;let c;for(const h of a){const g=_i(h);if(c){if(c===g)continue;c=At;break}c=g}return Ki(c||At,o)}return gi}function cl(a){const o=typeof a;return null===a?"":"string"===o||"number"===o||"boolean"===o?String(a):a instanceof vt||a instanceof Yi||a instanceof zr||a instanceof Vr?a.toString():JSON.stringify(a)}class bs{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(2!==o.length)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Ks(o[1]))return c.error("invalid value");const h=o[1];let g=_i(h);const v=c.expectedType;return"array"!==g.kind||0!==g.N||!v||"array"!==v.kind||"number"==typeof v.N&&0!==v.N||(g=v),new bs(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class li{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Lc={string:wt,number:Ve,boolean:Tt,object:gi};class Po{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let h,g=1;const v=o[0];if("array"===v){let C,S;if(o.length>2){const A=o[1];if("string"!=typeof A||!(A in Lc)||"object"===A)return c.error('The item type argument of "array" must be one of string, number, boolean',1);C=Lc[A],g++}else C=At;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);S=o[2],g++}h=Ki(C,S)}else{if(!Lc[v])throw new Error(`Types doesn't contain name = ${v}`);h=Lc[v]}const x=[];for(;g<o.length;g++){const C=c.parse(o[g],g,At);if(!C)return null;x.push(C)}return new Po(h,x)}evaluate(o){for(let c=0;c<this.args.length;c++){const h=this.args[c].evaluate(o);if(!Qo(this.type,_i(h)))return h;if(c===this.args.length-1)throw new li(`Expected value to be of type ${Tn(this.type)}, but found ${Tn(_i(h))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const hh={"to-boolean":Tt,"to-color":Br,"to-number":Ve,"to-string":wt};class Li{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const h=o[0];if(!hh[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if(("to-boolean"===h||"to-string"===h)&&2!==o.length)return c.error("Expected one argument.");const g=hh[h],v=[];for(let x=1;x<o.length;x++){const C=c.parse(o[x],x,At);if(!C)return null;v.push(C)}return new Li(g,v)}evaluate(o){if("boolean"===this.type.kind)return!!this.args[0].evaluate(o);if("color"===this.type.kind){let c,h;for(const g of this.args){if(c=g.evaluate(o),h=null,c instanceof vt)return c;if("string"==typeof c){const v=o.parseColor(c);if(v)return v}else if(Array.isArray(c)&&(h=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Oa(c[0],c[1],c[2],c[3]),!h))return new vt(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new li(h||`Could not parse color from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}if("padding"===this.type.kind){let c;for(const h of this.args){c=h.evaluate(o);const g=zr.parse(c);if(g)return g}throw new li(`Could not parse padding from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}if("number"===this.type.kind){let c=null;for(const h of this.args){if(c=h.evaluate(o),null===c)return 0;const g=Number(c);if(!isNaN(g))return g}throw new li(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?Yi.fromString(cl(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Vr.fromString(cl(this.args[0].evaluate(o))):cl(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const qu=["Unknown","Point","LineString","Polygon"];class Nc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?qu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let c=this._parseColorCache[o];return c||(c=this._parseColorCache[o]=vt.parse(o)),c}}class Xr{constructor(o,c,h=[],g,v=new ll,x=[]){this.registry=o,this.path=h,this.key=h.map(C=>`[${C}]`).join(""),this.scope=v,this.errors=x,this.expectedType=g,this._isConstant=c}parse(o,c,h,g,v={}){return c?this.concat(c,h,g)._parse(o,v):this._parse(o,v)}_parse(o,c){function h(g,v,x){return"assert"===x?new Po(v,[g]):"coerce"===x?new Li(v,[g]):g}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=o[0];if("string"!=typeof g)return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[g];if(v){let x=v.parse(o,this);if(!x)return null;if(this.expectedType){const C=this.expectedType,S=x.type;if("string"!==C.kind&&"number"!==C.kind&&"boolean"!==C.kind&&"object"!==C.kind&&"array"!==C.kind||"value"!==S.kind)if("color"!==C.kind&&"formatted"!==C.kind&&"resolvedImage"!==C.kind||"value"!==S.kind&&"string"!==S.kind)if("padding"!==C.kind||"value"!==S.kind&&"number"!==S.kind&&"array"!==S.kind){if(this.checkSubtype(C,S))return null}else x=h(x,C,c.typeAnnotation||"coerce");else x=h(x,C,c.typeAnnotation||"coerce");else x=h(x,C,c.typeAnnotation||"assert")}if(!(x instanceof bs)&&"resolvedImage"!==x.type.kind&&this._isConstant(x)){const C=new Nc;try{x=new bs(x.type,x.evaluate(C))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,h){const g="number"==typeof o?this.path.concat(o):this.path,v=h?this.scope.concat(h):this.scope;return new Xr(this.registry,this._isConstant,g,c||null,v,this.errors)}error(o,...c){const h=`${this.key}${c.map(g=>`[${g}]`).join("")}`;this.errors.push(new Xi(h,o))}checkSubtype(o,c){const h=Qo(o,c);return h&&this.error(h),h}}class Vt{constructor(o,c,h){this.type=_s,this.locale=h,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(2!==o.length)return c.error("Expected one argument.");const h=o[1];if("object"!=typeof h||Array.isArray(h))return c.error("Collator options argument must be an object.");const g=c.parse(void 0!==h["case-sensitive"]&&h["case-sensitive"],1,Tt);if(!g)return null;const v=c.parse(void 0!==h["diacritic-sensitive"]&&h["diacritic-sensitive"],1,Tt);if(!v)return null;let x=null;return h.locale&&(x=c.parse(h.locale,1,wt),!x)?null:new Vt(g,v,x)}evaluate(o){return new jn(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}const xs=8192;function Ni(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function ul(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function Bc(a,o){const c=(180+a[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,o.z);return[Math.round(c*g*xs),Math.round(h*g*xs)]}function ws(a,o,c){const h=a[0]-o[0],g=a[1]-o[1],v=a[0]-c[0],x=a[1]-c[1];return h*x-v*g==0&&h*v<=0&&g*x<=0}function zc(a,o){let c=!1;for(let x=0,C=o.length;x<C;x++){const S=o[x];for(let A=0,R=S.length;A<R-1;A++){if(ws(a,S[A],S[A+1]))return!1;(g=S[A])[1]>(h=a)[1]!=(v=S[A+1])[1]>h[1]&&h[0]<(v[0]-g[0])*(h[1]-g[1])/(v[1]-g[1])+g[0]&&(c=!c)}}var h,g,v;return c}function ph(a,o){for(let c=0;c<o.length;c++)if(zc(a,o[c]))return!0;return!1}function mn(a,o,c,h){const g=h[0]-c[0],v=h[1]-c[1],x=(a[0]-c[0])*v-g*(a[1]-c[1]),C=(o[0]-c[0])*v-g*(o[1]-c[1]);return x>0&&C<0||x<0&&C>0}function Vc(a,o,c){for(const A of c)for(let R=0;R<A.length-1;++R)if((C=[(x=A[R+1])[0]-(v=A[R])[0],x[1]-v[1]])[0]*(S=[(g=o)[0]-(h=a)[0],g[1]-h[1]])[1]-C[1]*S[0]!=0&&mn(h,g,v,x)&&mn(v,x,h,g))return!0;var h,g,v,x,C,S;return!1}function yi(a,o){for(let c=0;c<a.length;++c)if(!zc(a[c],o))return!1;for(let c=0;c<a.length-1;++c)if(Vc(a[c],a[c+1],o))return!1;return!0}function Wu(a,o){for(let c=0;c<o.length;c++)if(yi(a,o[c]))return!0;return!1}function Zu(a,o,c){const h=[];for(let g=0;g<a.length;g++){const v=[];for(let x=0;x<a[g].length;x++){const C=Bc(a[g][x],c);Ni(o,C),v.push(C)}h.push(v)}return h}function xn(a,o,c){const h=[];for(let g=0;g<a.length;g++){const v=Zu(a[g],o,c);h.push(v)}return h}function Ct(a,o,c,h){if(a[0]<c[0]||a[0]>c[2]){const g=.5*h;let v=a[0]-c[0]>g?-h:c[0]-a[0]>g?h:0;0===v&&(v=a[0]-c[2]>g?-h:c[2]-a[0]>g?h:0),a[0]+=v}Ni(o,a)}function Uc(a,o,c,h){const g=Math.pow(2,h.z)*xs,v=[h.x*xs,h.y*xs],x=[];for(const C of a)for(const S of C){const A=[S.x+v[0],S.y+v[1]];Ct(A,o,c,g),x.push(A)}return x}function jc(a,o,c,h){const g=Math.pow(2,h.z)*xs,v=[h.x*xs,h.y*xs],x=[];for(const S of a){const A=[];for(const R of S){const L=[R.x+v[0],R.y+v[1]];Ni(o,L),A.push(L)}x.push(A)}if(o[2]-o[0]<=g/2){(C=o)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const S of x)for(const A of S)Ct(A,o,c,g)}var C;return x}class Ys{constructor(o,c){this.type=Tt,this.geojson=o,this.geometries=c}static parse(o,c){if(2!==o.length)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Ks(o[1])){const h=o[1];if("FeatureCollection"===h.type)for(let g=0;g<h.features.length;++g){const v=h.features[g].geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new Ys(h,h.features[g].geometry)}else if("Feature"===h.type){const g=h.geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new Ys(h,h.geometry)}else if("Polygon"===h.type||"MultiPolygon"===h.type)return new Ys(h,h)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(c,h){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if("Polygon"===h.type){const C=Zu(h.coordinates,v,x),S=Uc(c.geometry(),g,v,x);if(!ul(g,v))return!1;for(const A of S)if(!zc(A,C))return!1}if("MultiPolygon"===h.type){const C=xn(h.coordinates,v,x),S=Uc(c.geometry(),g,v,x);if(!ul(g,v))return!1;for(const A of S)if(!ph(A,C))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(c,h){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if("Polygon"===h.type){const C=Zu(h.coordinates,v,x),S=jc(c.geometry(),g,v,x);if(!ul(g,v))return!1;for(const A of S)if(!yi(A,C))return!1}if("MultiPolygon"===h.type){const C=xn(h.coordinates,v,x),S=jc(c.geometry(),g,v,x);if(!ul(g,v))return!1;for(const A of S)if(!Wu(A,C))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Kl{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(2!==o.length||"string"!=typeof o[1])return c.error("'var' expression requires exactly one string literal argument.");const h=o[1];return c.scope.has(h)?new Kl(h,c.scope.get(h)):c.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class Ee{constructor(o,c,h,g){this.name=o,this.type=c,this._evaluate=h,this.args=g}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,c){const h=o[0],g=Ee.definitions[h];if(!g)return c.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=x.filter(([A])=>!Array.isArray(A)||A.length===o.length-1);let S=null;for(const[A,R]of C){S=new Xr(c.registry,La,c.path,null,c.scope);const L=[];let B=!1;for(let V=1;V<o.length;V++){const H=o[V],K=Array.isArray(A)?A[V-1]:A.type,W=S.parse(H,1+L.length,K);if(!W){B=!0;break}L.push(W)}if(!B)if(Array.isArray(A)&&A.length!==L.length)S.error(`Expected ${A.length} arguments, but found ${L.length} instead.`);else{for(let V=0;V<L.length;V++){const H=Array.isArray(A)?A[V]:A.type,K=L[V];S.concat(V+1).checkSubtype(H,K.type)}if(0===S.errors.length)return new Ee(h,v,R,L)}}if(1===C.length)c.errors.push(...S.errors);else{const A=(C.length?C:x).map(([L])=>{return B=L,Array.isArray(B)?`(${B.map(Tn).join(", ")})`:`(${Tn(B.type)}...)`;var B}).join(" | "),R=[];for(let L=1;L<o.length;L++){const B=c.parse(o[L],1+R.length);if(!B)return null;R.push(Tn(B.type))}c.error(`Expected arguments of type ${A}, but found (${R.join(", ")}) instead.`)}return null}static register(o,c){Ee.definitions=c;for(const h in c)o[h]=Ee}}function La(a){if(a instanceof Kl)return La(a.boundExpression);if(a instanceof Ee&&"error"===a.name||a instanceof Vt||a instanceof Ys)return!1;const o=a instanceof Li||a instanceof Po;let c=!0;return a.eachChild(h=>{c=o?c&&La(h):c&&h instanceof bs}),!!c&&Dt(a)&&Hc(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Dt(a){if(a instanceof Ee&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Ys)return!1;let o=!0;return a.eachChild(c=>{o&&!Dt(c)&&(o=!1)}),o}function en(a){if(a instanceof Ee&&"feature-state"===a.name)return!1;let o=!0;return a.eachChild(c=>{o&&!en(c)&&(o=!1)}),o}function Hc(a,o){if(a instanceof Ee&&o.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild(h=>{c&&!Hc(h,o)&&(c=!1)}),c}function Xu(a,o){const c=a.length-1;let h,g,v=0,x=c,C=0;for(;v<=x;)if(C=Math.floor((v+x)/2),h=a[C],g=a[C+1],h<=o){if(C===c||o<g)return C;v=C+1}else{if(!(h>o))throw new li("Input is not a number.");x=C-1}return 0}class dl{constructor(o,c,h){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[g,v]of h)this.labels.push(g),this.outputs.push(v)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const h=c.parse(o[1],1,Ve);if(!h)return null;const g=[];let v=null;c.expectedType&&"value"!==c.expectedType.kind&&(v=c.expectedType);for(let x=1;x<o.length;x+=2){const C=1===x?-1/0:o[x],S=o[x+1],A=x,R=x+1;if("number"!=typeof C)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(g.length&&g[g.length-1][0]>=C)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const L=c.parse(S,R,v);if(!L)return null;v=v||L.type,g.push([C,L])}return new dl(v,h,g)}evaluate(o){const c=this.labels,h=this.outputs;if(1===c.length)return h[0].evaluate(o);const g=this.input.evaluate(o);if(g<=c[0])return h[0].evaluate(o);const v=c.length;return g>=c[v-1]?h[v-1].evaluate(o):h[Xu(c,g)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function Qs(a,o,c){return a+c*(o-a)}function ur(a,o,c){return a.map((h,g)=>Qs(h,o[g],c))}const po={number:Qs,color:function(a,o,c,h="rgb"){switch(h){case"rgb":{const[g,v,x,C]=ur(a.rgb,o.rgb,c);return new vt(g,v,x,C,!1)}case"hcl":{const[g,v,x,C]=a.hcl,[S,A,R,L]=o.hcl;let B,V;if(isNaN(g)||isNaN(S))isNaN(g)?isNaN(S)?B=NaN:(B=S,1!==x&&0!==x||(V=A)):(B=g,1!==R&&0!==R||(V=v));else{let ue=S-g;S>g&&ue>180?ue-=360:S<g&&g-S>180&&(ue+=360),B=g+c*ue}const[H,K,W,se]=function([ue,re,he,me]){return ue=isNaN(ue)?0:ue*de,tt([he,Math.cos(ue)*re,Math.sin(ue)*re,me])}([B,V??Qs(v,A,c),Qs(x,R,c),Qs(C,L,c)]);return new vt(H,K,W,se,!1)}case"lab":{const[g,v,x,C]=tt(ur(a.lab,o.lab,c));return new vt(g,v,x,C,!1)}}},array:ur,padding:function(a,o,c){return new zr(ur(a.values,o.values,c))}};class Kr{constructor(o,c,h,g,v){this.type=o,this.operator=c,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[x,C]of v)this.labels.push(x),this.outputs.push(C)}static interpolationFactor(o,c,h,g){let v=0;if("exponential"===o.name)v=fh(c,o.base,h,g);else if("linear"===o.name)v=fh(c,1,h,g);else if("cubic-bezier"===o.name){const x=o.controlPoints;v=new fs(x[0],x[1],x[2],x[3]).solve(fh(c,1,h,g))}return v}static parse(o,c){let[h,g,v,...x]=o;if(!Array.isArray(g)||0===g.length)return c.error("Expected an interpolation type expression.",1);if("linear"===g[0])g={name:"linear"};else if("exponential"===g[0]){const A=g[1];if("number"!=typeof A)return c.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:A}}else{if("cubic-bezier"!==g[0])return c.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const A=g.slice(1);if(4!==A.length||A.some(R=>"number"!=typeof R||R<0||R>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:A}}}if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(v=c.parse(v,2,Ve),!v)return null;const C=[];let S=null;"interpolate-hcl"===h||"interpolate-lab"===h?S=Br:c.expectedType&&"value"!==c.expectedType.kind&&(S=c.expectedType);for(let A=0;A<x.length;A+=2){const R=x[A],L=x[A+1],B=A+3,V=A+4;if("number"!=typeof R)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(C.length&&C[C.length-1][0]>=R)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const H=c.parse(L,V,S);if(!H)return null;S=S||H.type,C.push([R,H])}return z(S,Ve)||z(S,Br)||z(S,ko)||z(S,Ki(Ve))?new Kr(S,h,g,v,C):c.error(`Type ${Tn(S)} is not interpolatable.`)}evaluate(o){const c=this.labels,h=this.outputs;if(1===c.length)return h[0].evaluate(o);const g=this.input.evaluate(o);if(g<=c[0])return h[0].evaluate(o);const v=c.length;if(g>=c[v-1])return h[v-1].evaluate(o);const x=Xu(c,g),C=Kr.interpolationFactor(this.interpolation,g,c[x],c[x+1]),S=h[x].evaluate(o),A=h[x+1].evaluate(o);switch(this.operator){case"interpolate":return po[this.type.kind](S,A,C);case"interpolate-hcl":return po.color(S,A,C,"hcl");case"interpolate-lab":return po.color(S,A,C,"lab")}}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function fh(a,o,c,h){const g=h-c,v=a-c;return 0===g?0:1===o?v/g:(Math.pow(o,v)-1)/(Math.pow(o,g)-1)}class Jo{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let h=null;const g=c.expectedType;g&&"value"!==g.kind&&(h=g);const v=[];for(const C of o.slice(1)){const S=c.parse(C,1+v.length,h,void 0,{typeAnnotation:"omit"});if(!S)return null;h=h||S.type,v.push(S)}if(!h)throw new Error("No output type");const x=g&&v.some(C=>Qo(g,C.type));return new Jo(x?At:h,v)}evaluate(o){let c,h=null,g=0;for(const v of this.args)if(g++,h=v.evaluate(o),h&&h instanceof Vr&&!h.available&&(c||(c=h.name),h=null,g===this.args.length&&(h=c)),null!==h)break;return h}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}class Ku{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const h=[];for(let v=1;v<o.length-1;v+=2){const x=o[v];if("string"!=typeof x)return c.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",v);const C=c.parse(o[v+1],v+1);if(!C)return null;h.push([x,C])}const g=c.parse(o[o.length-1],o.length-1,c.expectedType,h);return g?new Ku(h,g):null}outputDefined(){return this.result.outputDefined()}}class mh{constructor(o,c,h){this.type=o,this.index=c,this.input=h}static parse(o,c){if(3!==o.length)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,Ve),g=c.parse(o[2],2,Ki(c.expectedType||At));return h&&g?new mh(g.type.itemType,h,g):null}evaluate(o){const c=this.index.evaluate(o),h=this.input.evaluate(o);if(c<0)throw new li(`Array index out of bounds: ${c} < 0.`);if(c>=h.length)throw new li(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c!==Math.floor(c))throw new li(`Array index must be an integer, but found ${c} instead.`);return h[c]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class $c{constructor(o,c){this.type=Tt,this.needle=o,this.haystack=c}static parse(o,c){if(3!==o.length)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,At),g=c.parse(o[2],2,At);return h&&g?Y(h.type,[Tt,wt,Ve,Xs,At])?new $c(h,g):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(h.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),h=this.haystack.evaluate(o);if(!h)return!1;if(!N(c,["boolean","string","number","null"]))throw new li(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(_i(c))} instead.`);if(!N(h,["string","array"]))throw new li(`Expected second argument to be of type array or string, but found ${Tn(_i(h))} instead.`);return h.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class hl{constructor(o,c,h){this.type=Ve,this.needle=o,this.haystack=c,this.fromIndex=h}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,At),g=c.parse(o[2],2,At);if(!h||!g)return null;if(!Y(h.type,[Tt,wt,Ve,Xs,At]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(h.type)} instead`);if(4===o.length){const v=c.parse(o[3],3,Ve);return v?new hl(h,g,v):null}return new hl(h,g)}evaluate(o){const c=this.needle.evaluate(o),h=this.haystack.evaluate(o);if(!N(c,["boolean","string","number","null"]))throw new li(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(_i(c))} instead.`);if(!N(h,["string","array"]))throw new li(`Expected second argument to be of type array or string, but found ${Tn(_i(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(o);return h.indexOf(c,g)}return h.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class rn{constructor(o,c,h,g,v,x){this.inputType=o,this.type=c,this.input=h,this.cases=g,this.outputs=v,this.otherwise=x}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let h,g;c.expectedType&&"value"!==c.expectedType.kind&&(g=c.expectedType);const v={},x=[];for(let A=2;A<o.length-1;A+=2){let R=o[A];const L=o[A+1];Array.isArray(R)||(R=[R]);const B=c.concat(A);if(0===R.length)return B.error("Expected at least one branch label.");for(const H of R){if("number"!=typeof H&&"string"!=typeof H)return B.error("Branch labels must be numbers or strings.");if("number"==typeof H&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof H&&Math.floor(H)!==H)return B.error("Numeric branch labels must be integer values.");if(h){if(B.checkSubtype(h,_i(H)))return null}else h=_i(H);if(void 0!==v[String(H)])return B.error("Branch labels must be unique.");v[String(H)]=x.length}const V=c.parse(L,A,g);if(!V)return null;g=g||V.type,x.push(V)}const C=c.parse(o[1],1,At);if(!C)return null;const S=c.parse(o[o.length-1],o.length-1,g);return S?"value"!==C.type.kind&&c.concat(1).checkSubtype(h,C.type)?null:new rn(h,g,C,v,x,S):null}evaluate(o){const c=this.input.evaluate(o);return(_i(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class gh{constructor(o,c,h){this.type=o,this.branches=c,this.otherwise=h}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let h;c.expectedType&&"value"!==c.expectedType.kind&&(h=c.expectedType);const g=[];for(let x=1;x<o.length-1;x+=2){const C=c.parse(o[x],x,Tt);if(!C)return null;const S=c.parse(o[x+1],x+1,h);if(!S)return null;g.push([C,S]),h=h||S.type}const v=c.parse(o[o.length-1],o.length-1,h);if(!v)return null;if(!h)throw new Error("Can't infer output type");return new gh(h,g,v)}evaluate(o){for(const[c,h]of this.branches)if(c.evaluate(o))return h.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,h]of this.branches)o(c),o(h);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class Gc{constructor(o,c,h,g){this.type=o,this.input=c,this.beginIndex=h,this.endIndex=g}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const h=c.parse(o[1],1,At),g=c.parse(o[2],2,Ve);if(!h||!g)return null;if(!Y(h.type,[Ki(At),wt,At]))return c.error(`Expected first argument to be of type array or string, but found ${Tn(h.type)} instead`);if(4===o.length){const v=c.parse(o[3],3,Ve);return v?new Gc(h.type,h,g,v):null}return new Gc(h.type,h,g)}evaluate(o){const c=this.input.evaluate(o),h=this.beginIndex.evaluate(o);if(!N(c,["string","array"]))throw new li(`Expected first argument to be of type array or string, but found ${Tn(_i(c))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(o);return c.slice(h,g)}return c.slice(h)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function zp(a,o){return"=="===a||"!="===a?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function Yr(a,o,c,h){return 0===h.compare(o,c)}function bt(a,o,c){const h="=="!==a&&"!="!==a;return class t2{constructor(v,x,C){this.type=Tt,this.lhs=v,this.rhs=x,this.collator=C,this.hasUntypedArgument="value"===v.type.kind||"value"===x.type.kind}static parse(v,x){if(3!==v.length&&4!==v.length)return x.error("Expected two or three arguments.");const C=v[0];let S=x.parse(v[1],1,At);if(!S)return null;if(!zp(C,S.type))return x.concat(1).error(`"${C}" comparisons are not supported for type '${Tn(S.type)}'.`);let A=x.parse(v[2],2,At);if(!A)return null;if(!zp(C,A.type))return x.concat(2).error(`"${C}" comparisons are not supported for type '${Tn(A.type)}'.`);if(S.type.kind!==A.type.kind&&"value"!==S.type.kind&&"value"!==A.type.kind)return x.error(`Cannot compare types '${Tn(S.type)}' and '${Tn(A.type)}'.`);h&&("value"===S.type.kind&&"value"!==A.type.kind?S=new Po(A.type,[S]):"value"!==S.type.kind&&"value"===A.type.kind&&(A=new Po(S.type,[A])));let R=null;if(4===v.length){if("string"!==S.type.kind&&"string"!==A.type.kind&&"value"!==S.type.kind&&"value"!==A.type.kind)return x.error("Cannot use collator to compare non-string types.");if(R=x.parse(v[3],3,_s),!R)return null}return new t2(S,A,R)}evaluate(v){const x=this.lhs.evaluate(v),C=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){const S=_i(x),A=_i(C);if(S.kind!==A.kind||"string"!==S.kind&&"number"!==S.kind)throw new li(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${S.kind}, ${A.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const S=_i(x),A=_i(C);if("string"!==S.kind||"string"!==A.kind)return o(v,x,C)}return this.collator?c(v,x,C,this.collator.evaluate(v)):o(v,x,C)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Xm=bt("==",function(a,o,c){return o===c},Yr),Km=bt("!=",function(a,o,c){return o!==c},function(a,o,c,h){return!Yr(0,o,c,h)}),Ym=bt("<",function(a,o,c){return o<c},function(a,o,c,h){return h.compare(o,c)<0}),at=bt(">",function(a,o,c){return o>c},function(a,o,c,h){return h.compare(o,c)>0}),Qm=bt("<=",function(a,o,c){return o<=c},function(a,o,c,h){return h.compare(o,c)<=0}),ci=bt(">=",function(a,o,c){return o>=c},function(a,o,c,h){return h.compare(o,c)>=0});class pl{constructor(o,c,h,g,v){this.type=wt,this.number=o,this.locale=c,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(o,c){if(3!==o.length)return c.error("Expected two arguments.");const h=c.parse(o[1],1,Ve);if(!h)return null;const g=o[2];if("object"!=typeof g||Array.isArray(g))return c.error("NumberFormat options argument must be an object.");let v=null;if(g.locale&&(v=c.parse(g.locale,1,wt),!v))return null;let x=null;if(g.currency&&(x=c.parse(g.currency,1,wt),!x))return null;let C=null;if(g["min-fraction-digits"]&&(C=c.parse(g["min-fraction-digits"],1,Ve),!C))return null;let S=null;return g["max-fraction-digits"]&&(S=c.parse(g["max-fraction-digits"],1,Ve),!S)?null:new pl(h,v,x,C,S)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class Yu{constructor(o){this.type=ys,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const h=o[1];if(!Array.isArray(h)&&"object"==typeof h)return c.error("First argument must be an image or text section.");const g=[];let v=!1;for(let x=1;x<=o.length-1;++x){const C=o[x];if(v&&"object"==typeof C&&!Array.isArray(C)){v=!1;let S=null;if(C["font-scale"]&&(S=c.parse(C["font-scale"],1,Ve),!S))return null;let A=null;if(C["text-font"]&&(A=c.parse(C["text-font"],1,Ki(wt)),!A))return null;let R=null;if(C["text-color"]&&(R=c.parse(C["text-color"],1,Br),!R))return null;const L=g[g.length-1];L.scale=S,L.font=A,L.textColor=R}else{const S=c.parse(o[x],1,At);if(!S)return null;const A=S.type.kind;if("string"!==A&&"value"!==A&&"null"!==A&&"resolvedImage"!==A)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,g.push({content:S,scale:null,font:null,textColor:null})}}return new Yu(g)}evaluate(o){return new Yi(this.sections.map(c=>{const h=c.content.evaluate(o);return _i(h)===vs?new Fa("",h,null,null,null):new Fa(cl(h),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}}class qc{constructor(o){this.type=vs,this.input=o}static parse(o,c){if(2!==o.length)return c.error("Expected two arguments.");const h=c.parse(o[1],1,wt);return h?new qc(h):c.error("No image name provided.")}evaluate(o){const c=this.input.evaluate(o),h=Vr.fromString(c);return h&&o.availableImages&&(h.available=o.availableImages.indexOf(c)>-1),h}eachChild(o){o(this.input)}outputDefined(){return!1}}class Qu{constructor(o){this.type=Ve,this.input=o}static parse(o,c){if(2!==o.length)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const h=c.parse(o[1],1);return h?"array"!==h.type.kind&&"string"!==h.type.kind&&"value"!==h.type.kind?c.error(`Expected argument of type string or array, but found ${Tn(h.type)} instead.`):new Qu(h):null}evaluate(o){const c=this.input.evaluate(o);if("string"==typeof c||Array.isArray(c))return c.length;throw new li(`Expected value to be of type string or array, but found ${Tn(_i(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const Es={"==":Xm,"!=":Km,">":at,"<":Ym,">=":ci,"<=":Qm,array:Po,at:mh,boolean:Po,case:gh,coalesce:Jo,collator:Vt,format:Yu,image:qc,in:$c,"index-of":hl,interpolate:Kr,"interpolate-hcl":Kr,"interpolate-lab":Kr,length:Qu,let:Ku,literal:bs,match:rn,number:Po,"number-format":pl,object:Po,slice:Gc,step:dl,string:Po,"to-boolean":Li,"to-color":Li,"to-number":Li,"to-string":Li,var:Kl,within:Ys};function Yl(a,[o,c,h,g]){o=o.evaluate(a),c=c.evaluate(a),h=h.evaluate(a);const v=g?g.evaluate(a):1,x=Oa(o,c,h,v);if(x)throw new li(x);return new vt(o/255,c/255,h/255,v,!1)}function Wc(a,o){return a in o}function Zc(a,o){const c=o[a];return void 0===c?null:c}function Na(a){return{type:a}}function Jt(a){return{result:"success",value:a}}function Js(a){return{result:"error",value:a}}function Ba(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function Sr(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Xc(a){return!!a.expression&&a.expression.interpolated}function yn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function wn(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function Jm(a){return a}function Vp(a,o){const c="color"===o.type,h=a.stops&&"object"==typeof a.stops[0][0],g=h||!(h||void 0!==a.property),v=a.type||(Xc(o)?"exponential":"interval");if(c||"padding"===o.type){const R=c?vt.parse:zr.parse;(a=ho({},a)).stops&&(a.stops=a.stops.map(L=>[L[0],R(L[1])])),a.default=R(a.default?a.default:o.default)}if(a.colorSpace&&"rgb"!==(x=a.colorSpace)&&"hcl"!==x&&"lab"!==x)throw new Error(`Unknown color space: "${a.colorSpace}"`);var x;let C,S,A;if("exponential"===v)C=ed;else if("interval"===v)C=Ql;else if("categorical"===v){C=Ju,S=Object.create(null);for(const R of a.stops)S[R[0]]=R[1];A=typeof a.stops[0][0]}else{if("identity"!==v)throw new Error(`Unknown function type "${v}"`);C=td}if(h){const R={},L=[];for(let H=0;H<a.stops.length;H++){const K=a.stops[H],W=K[0].zoom;void 0===R[W]&&(R[W]={zoom:W,type:a.type,property:a.property,default:a.default,stops:[]},L.push(W)),R[W].stops.push([K[0].value,K[1]])}const B=[];for(const H of L)B.push([R[H].zoom,Vp(R[H],o)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Kr.interpolationFactor.bind(void 0,V),zoomStops:B.map(H=>H[0]),evaluate:({zoom:H},K)=>ed({stops:B,base:a.base},o,H).evaluate(H,K)}}if(g){const R="exponential"===v?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Kr.interpolationFactor.bind(void 0,R),zoomStops:a.stops.map(L=>L[0]),evaluate:({zoom:L})=>C(a,o,L,S,A)}}return{kind:"source",evaluate(R,L){const B=L&&L.properties?L.properties[a.property]:void 0;return void 0===B?Oe(a.default,o.default):C(a,o,B,S,A)}}}function Oe(a,o,c){return void 0!==a?a:void 0!==o?o:void 0!==c?c:void 0}function Ju(a,o,c,h,g){return Oe(typeof c===g?h[c]:void 0,a.default,o.default)}function Ql(a,o,c){if("number"!==yn(c))return Oe(a.default,o.default);const h=a.stops.length;if(1===h||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[h-1][0])return a.stops[h-1][1];const g=Xu(a.stops.map(v=>v[0]),c);return a.stops[g][1]}function ed(a,o,c){const h=void 0!==a.base?a.base:1;if("number"!==yn(c))return Oe(a.default,o.default);const g=a.stops.length;if(1===g||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[g-1][0])return a.stops[g-1][1];const v=Xu(a.stops.map(R=>R[0]),c),x=function(R,L,B,V){const H=V-B,K=R-B;return 0===H?0:1===L?K/H:(Math.pow(L,K)-1)/(Math.pow(L,H)-1)}(c,h,a.stops[v][0],a.stops[v+1][0]),C=a.stops[v][1],S=a.stops[v+1][1],A=po[o.type]||Jm;return"function"==typeof C.evaluate?{evaluate(...R){const L=C.evaluate.apply(void 0,R),B=S.evaluate.apply(void 0,R);if(void 0!==L&&void 0!==B)return A(L,B,x,a.colorSpace)}}:A(C,S,x,a.colorSpace)}function td(a,o,c){switch(o.type){case"color":c=vt.parse(c);break;case"formatted":c=Yi.fromString(c.toString());break;case"resolvedImage":c=Vr.fromString(c.toString());break;case"padding":c=zr.parse(c);break;default:yn(c)===o.type||"enum"===o.type&&o.values[c]||(c=void 0)}return Oe(c,a.default,o.default)}Ee.register(Es,{error:[{kind:"error"},[wt],(a,[o])=>{throw new li(o.evaluate(a))}],typeof:[wt,[At],(a,[o])=>Tn(_i(o.evaluate(a)))],"to-rgba":[Ki(Ve,4),[Br],(a,[o])=>{const[c,h,g,v]=o.evaluate(a).rgb;return[255*c,255*h,255*g,v]}],rgb:[Br,[Ve,Ve,Ve],Yl],rgba:[Br,[Ve,Ve,Ve,Ve],Yl],has:{type:Tt,overloads:[[[wt],(a,[o])=>Wc(o.evaluate(a),a.properties())],[[wt,gi],(a,[o,c])=>Wc(o.evaluate(a),c.evaluate(a))]]},get:{type:At,overloads:[[[wt],(a,[o])=>Zc(o.evaluate(a),a.properties())],[[wt,gi],(a,[o,c])=>Zc(o.evaluate(a),c.evaluate(a))]]},"feature-state":[At,[wt],(a,[o])=>Zc(o.evaluate(a),a.featureState||{})],properties:[gi,[],a=>a.properties()],"geometry-type":[wt,[],a=>a.geometryType()],id:[At,[],a=>a.id()],zoom:[Ve,[],a=>a.globals.zoom],"heatmap-density":[Ve,[],a=>a.globals.heatmapDensity||0],"line-progress":[Ve,[],a=>a.globals.lineProgress||0],accumulated:[At,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Ve,Na(Ve),(a,o)=>{let c=0;for(const h of o)c+=h.evaluate(a);return c}],"*":[Ve,Na(Ve),(a,o)=>{let c=1;for(const h of o)c*=h.evaluate(a);return c}],"-":{type:Ve,overloads:[[[Ve,Ve],(a,[o,c])=>o.evaluate(a)-c.evaluate(a)],[[Ve],(a,[o])=>-o.evaluate(a)]]},"/":[Ve,[Ve,Ve],(a,[o,c])=>o.evaluate(a)/c.evaluate(a)],"%":[Ve,[Ve,Ve],(a,[o,c])=>o.evaluate(a)%c.evaluate(a)],ln2:[Ve,[],()=>Math.LN2],pi:[Ve,[],()=>Math.PI],e:[Ve,[],()=>Math.E],"^":[Ve,[Ve,Ve],(a,[o,c])=>Math.pow(o.evaluate(a),c.evaluate(a))],sqrt:[Ve,[Ve],(a,[o])=>Math.sqrt(o.evaluate(a))],log10:[Ve,[Ve],(a,[o])=>Math.log(o.evaluate(a))/Math.LN10],ln:[Ve,[Ve],(a,[o])=>Math.log(o.evaluate(a))],log2:[Ve,[Ve],(a,[o])=>Math.log(o.evaluate(a))/Math.LN2],sin:[Ve,[Ve],(a,[o])=>Math.sin(o.evaluate(a))],cos:[Ve,[Ve],(a,[o])=>Math.cos(o.evaluate(a))],tan:[Ve,[Ve],(a,[o])=>Math.tan(o.evaluate(a))],asin:[Ve,[Ve],(a,[o])=>Math.asin(o.evaluate(a))],acos:[Ve,[Ve],(a,[o])=>Math.acos(o.evaluate(a))],atan:[Ve,[Ve],(a,[o])=>Math.atan(o.evaluate(a))],min:[Ve,Na(Ve),(a,o)=>Math.min(...o.map(c=>c.evaluate(a)))],max:[Ve,Na(Ve),(a,o)=>Math.max(...o.map(c=>c.evaluate(a)))],abs:[Ve,[Ve],(a,[o])=>Math.abs(o.evaluate(a))],round:[Ve,[Ve],(a,[o])=>{const c=o.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[Ve,[Ve],(a,[o])=>Math.floor(o.evaluate(a))],ceil:[Ve,[Ve],(a,[o])=>Math.ceil(o.evaluate(a))],"filter-==":[Tt,[wt,At],(a,[o,c])=>a.properties()[o.value]===c.value],"filter-id-==":[Tt,[At],(a,[o])=>a.id()===o.value],"filter-type-==":[Tt,[wt],(a,[o])=>a.geometryType()===o.value],"filter-<":[Tt,[wt,At],(a,[o,c])=>{const h=a.properties()[o.value],g=c.value;return typeof h==typeof g&&h<g}],"filter-id-<":[Tt,[At],(a,[o])=>{const c=a.id(),h=o.value;return typeof c==typeof h&&c<h}],"filter->":[Tt,[wt,At],(a,[o,c])=>{const h=a.properties()[o.value],g=c.value;return typeof h==typeof g&&h>g}],"filter-id->":[Tt,[At],(a,[o])=>{const c=a.id(),h=o.value;return typeof c==typeof h&&c>h}],"filter-<=":[Tt,[wt,At],(a,[o,c])=>{const h=a.properties()[o.value],g=c.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[Tt,[At],(a,[o])=>{const c=a.id(),h=o.value;return typeof c==typeof h&&c<=h}],"filter->=":[Tt,[wt,At],(a,[o,c])=>{const h=a.properties()[o.value],g=c.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[Tt,[At],(a,[o])=>{const c=a.id(),h=o.value;return typeof c==typeof h&&c>=h}],"filter-has":[Tt,[At],(a,[o])=>o.value in a.properties()],"filter-has-id":[Tt,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[Tt,[Ki(wt)],(a,[o])=>o.value.indexOf(a.geometryType())>=0],"filter-id-in":[Tt,[Ki(At)],(a,[o])=>o.value.indexOf(a.id())>=0],"filter-in-small":[Tt,[wt,Ki(At)],(a,[o,c])=>c.value.indexOf(a.properties()[o.value])>=0],"filter-in-large":[Tt,[wt,Ki(At)],(a,[o,c])=>function(h,g,v,x){for(;v<=x;){const C=v+x>>1;if(g[C]===h)return!0;g[C]>h?x=C-1:v=C+1}return!1}(a.properties()[o.value],c.value,0,c.value.length-1)],all:{type:Tt,overloads:[[[Tt,Tt],(a,[o,c])=>o.evaluate(a)&&c.evaluate(a)],[Na(Tt),(a,o)=>{for(const c of o)if(!c.evaluate(a))return!1;return!0}]]},any:{type:Tt,overloads:[[[Tt,Tt],(a,[o,c])=>o.evaluate(a)||c.evaluate(a)],[Na(Tt),(a,o)=>{for(const c of o)if(c.evaluate(a))return!0;return!1}]]},"!":[Tt,[Tt],(a,[o])=>!o.evaluate(a)],"is-supported-script":[Tt,[wt],(a,[o])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(o.evaluate(a))}],upcase:[wt,[wt],(a,[o])=>o.evaluate(a).toUpperCase()],downcase:[wt,[wt],(a,[o])=>o.evaluate(a).toLowerCase()],concat:[wt,Na(At),(a,o)=>o.map(c=>cl(c.evaluate(a))).join("")],"resolved-locale":[wt,[_s],(a,[o])=>o.evaluate(a).resolvedLocale()]});class nd{constructor(o,c){var h;this.expression=o,this._warningHistory={},this._evaluator=new Nc,this._defaultValue=c?"color"===(h=c).type&&wn(h.default)?new vt(0,0,0,0):"color"===h.type?vt.parse(h.default)||null:"padding"===h.type?zr.parse(h.default)||null:void 0===h.default?null:h.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(o,c,h,g,v,x){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(o,c,h,g,v,x){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new li(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function fl(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in Es}function Kn(a,o){const c=new Xr(Es,La,[],o?function(g){const v={color:Br,string:wt,number:Ve,enum:wt,boolean:Tt,formatted:ys,padding:ko,resolvedImage:vs};return"array"===g.type?Ki(v[g.value]||At,g.length):v[g.type]}(o):void 0),h=c.parse(a,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return h?Jt(new nd(h,o)):Js(c.errors)}class _h{constructor(o,c){this.kind=o,this._styleExpression=c,this.isStateDependent="constant"!==o&&!en(c.expression)}evaluateWithoutErrorHandling(o,c,h,g,v,x){return this._styleExpression.evaluateWithoutErrorHandling(o,c,h,g,v,x)}evaluate(o,c,h,g,v,x){return this._styleExpression.evaluate(o,c,h,g,v,x)}}class Wt{constructor(o,c,h,g){this.kind=o,this.zoomStops=h,this._styleExpression=c,this.isStateDependent="camera"!==o&&!en(c.expression),this.interpolationType=g}evaluateWithoutErrorHandling(o,c,h,g,v,x){return this._styleExpression.evaluateWithoutErrorHandling(o,c,h,g,v,x)}evaluate(o,c,h,g,v,x){return this._styleExpression.evaluate(o,c,h,g,v,x)}interpolationFactor(o,c,h){return this.interpolationType?Kr.interpolationFactor(this.interpolationType,o,c,h):0}}function id(a,o){const c=Kn(a,o);if("error"===c.result)return c;const h=c.value.expression,g=Dt(h);if(!g&&!Ba(o))return Js([new Xi("","data expressions not supported")]);const v=Hc(h,["zoom"]);if(!v&&!Sr(o))return Js([new Xi("","zoom expressions not supported")]);const x=dn(h);return x||v?x instanceof Xi?Js([x]):x instanceof Kr&&!Xc(o)?Js([new Xi("",'"interpolate" expressions cannot be used with this property')]):Jt(x?new Wt(g?"camera":"composite",c.value,x.labels,x instanceof Kr?x.interpolation:void 0):new _h(g?"constant":"source",c.value)):Js([new Xi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ln{constructor(o,c){this._parameters=o,this._specification=c,ho(this,Vp(this._parameters,this._specification))}static deserialize(o){return new Ln(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function dn(a){let o=null;if(a instanceof Ku)o=dn(a.result);else if(a instanceof Jo){for(const c of a.args)if(o=dn(c),o)break}else(a instanceof dl||a instanceof Kr)&&a.input instanceof Ee&&"zoom"===a.input.name&&(o=a);return o instanceof Xi||a.eachChild(c=>{const h=dn(c);h instanceof Xi?o=h:!o&&h?o=new Xi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&h&&o!==h&&(o=new Xi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function ea(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const o of a.slice(1))if(!ea(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}const Jl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rd(a){if(null==a)return{filter:()=>!0,needGeometry:!1};ea(a)||(a=ec(a));const o=Kn(a,Jl);if("error"===o.result)throw new Error(o.value.map(c=>`${c.key}: ${c.message}`).join(", "));return{filter:(c,h,g)=>o.value.evaluate(c,h,{},g),needGeometry:yh(a)}}function Up(a,o){return a<o?-1:a>o?1:0}function yh(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let o=1;o<a.length;o++)if(yh(a[o]))return!0;return!1}function ec(a){if(!a)return!0;const o=a[0];return a.length<=1?"any"!==o:"=="===o?Cs(a[1],a[2],"=="):"!="===o?tc(Cs(a[1],a[2],"==")):"<"===o||">"===o||"<="===o||">="===o?Cs(a[1],a[2],o):"any"===o?(c=a.slice(1),["any"].concat(c.map(ec))):"all"===o?["all"].concat(a.slice(1).map(ec)):"none"===o?["all"].concat(a.slice(1).map(ec).map(tc)):"in"===o?od(a[1],a.slice(2)):"!in"===o?tc(od(a[1],a.slice(2))):"has"===o?es(a[1]):"!has"===o?tc(es(a[1])):"within"!==o||a;var c}function Cs(a,o,c){switch(a){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,a,o]}}function od(a,o){if(0===o.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",a,["literal",o.sort(Up)]]:["filter-in-small",a,["literal",o]]}}function es(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function tc(a){return["!",a]}function Te(a){const o=typeof a;if("number"===o||"boolean"===o||"string"===o||null==a)return JSON.stringify(a);if(Array.isArray(a)){let g="[";for(const v of a)g+=`${Te(v)},`;return`${g}]`}const c=Object.keys(a).sort();let h="{";for(let g=0;g<c.length;g++)h+=`${JSON.stringify(c[g])}:${Te(a[c[g]])},`;return`${h}}`}function vh(a){let o="";for(const c of Ws)o+=`/${Te(a[c])}`;return o}function St(a){const o=a.value;return o?[new je(a.key,o,"constants have been deprecated as of v8")]:[]}function qn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Ds(a){if(Array.isArray(a))return a.map(Ds);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const o={};for(const c in a)o[c]=Ds(a[c]);return o}return qn(a)}function dr(a){const o=a.key,c=a.value,h=a.valueSpec||{},g=a.objectElementValidators||{},v=a.style,x=a.styleSpec,C=a.validateSpec;let S=[];const A=yn(c);if("object"!==A)return[new je(o,c,`object expected, ${A} found`)];for(const R in c){const L=R.split(".")[0],B=h[L]||h["*"];let V;if(g[L])V=g[L];else if(h[L])V=C;else if(g["*"])V=g["*"];else{if(!h["*"]){S.push(new je(o,c[R],`unknown property "${R}"`));continue}V=C}S=S.concat(V({key:(o&&`${o}.`)+R,value:c[R],valueSpec:B,style:v,styleSpec:x,object:c,objectKey:R,validateSpec:C},c))}for(const R in h)g[R]||h[R].required&&void 0===h[R].default&&void 0===c[R]&&S.push(new je(o,c,`missing required property "${R}"`));return S}function bh(a){const o=a.value,c=a.valueSpec,h=a.style,g=a.styleSpec,v=a.key,x=a.arrayElementValidator||a.validateSpec;if("array"!==yn(o))return[new je(v,o,`array expected, ${yn(o)} found`)];if(c.length&&o.length!==c.length)return[new je(v,o,`array length ${c.length} expected, length ${o.length} found`)];if(c["min-length"]&&o.length<c["min-length"])return[new je(v,o,`array length at least ${c["min-length"]} expected, length ${o.length} found`)];let C={type:c.value,values:c.values};g.$version<7&&(C.function=c.function),"object"===yn(c.value)&&(C=c.value);let S=[];for(let A=0;A<o.length;A++)S=S.concat(x({array:o,arrayIndex:A,value:o[A],valueSpec:C,validateSpec:a.validateSpec,style:h,styleSpec:g,key:`${v}[${A}]`}));return S}function sd(a){const o=a.key,c=a.value,h=a.valueSpec;let g=yn(c);return"number"===g&&c!=c&&(g="NaN"),"number"!==g?[new je(o,c,`number expected, ${g} found`)]:"minimum"in h&&c<h.minimum?[new je(o,c,`${c} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&c>h.maximum?[new je(o,c,`${c} is greater than the maximum value ${h.maximum}`)]:[]}function xh(a){const o=a.valueSpec,c=qn(a.value.type);let h,g,v,x={};const C="categorical"!==c&&void 0===a.value.property,S=!C,A="array"===yn(a.value.stops)&&"array"===yn(a.value.stops[0])&&"object"===yn(a.value.stops[0][0]),R=dr({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(V){if("identity"===c)return[new je(V.key,V.value,'identity function may not have a "stops" property')];let H=[];const K=V.value;return H=H.concat(bh({key:V.key,value:K,valueSpec:V.valueSpec,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:L})),"array"===yn(K)&&0===K.length&&H.push(new je(V.key,K,"array must have at least one stop")),H},default:function(V){return V.validateSpec({key:V.key,value:V.value,valueSpec:o,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec})}}});return"identity"===c&&C&&R.push(new je(a.key,a.value,'missing required property "property"')),"identity"===c||a.value.stops||R.push(new je(a.key,a.value,'missing required property "stops"')),"exponential"===c&&a.valueSpec.expression&&!Xc(a.valueSpec)&&R.push(new je(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(S&&!Ba(a.valueSpec)?R.push(new je(a.key,a.value,"property functions not supported")):C&&!Sr(a.valueSpec)&&R.push(new je(a.key,a.value,"zoom functions not supported"))),"categorical"!==c&&!A||void 0!==a.value.property||R.push(new je(a.key,a.value,'"property" property is required')),R;function L(V){let H=[];const K=V.value,W=V.key;if("array"!==yn(K))return[new je(W,K,`array expected, ${yn(K)} found`)];if(2!==K.length)return[new je(W,K,`array length 2 expected, length ${K.length} found`)];if(A){if("object"!==yn(K[0]))return[new je(W,K,`object expected, ${yn(K[0])} found`)];if(void 0===K[0].zoom)return[new je(W,K,"object stop key must have zoom")];if(void 0===K[0].value)return[new je(W,K,"object stop key must have value")];if(v&&v>qn(K[0].zoom))return[new je(W,K[0].zoom,"stop zoom values must appear in ascending order")];qn(K[0].zoom)!==v&&(v=qn(K[0].zoom),g=void 0,x={}),H=H.concat(dr({key:`${W}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:sd,value:B}}))}else H=H.concat(B({key:`${W}[0]`,value:K[0],valueSpec:{},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec},K));return fl(Ds(K[1]))?H.concat([new je(`${W}[1]`,K[1],"expressions are not allowed in function stops.")]):H.concat(V.validateSpec({key:`${W}[1]`,value:K[1],valueSpec:o,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec}))}function B(V,H){const K=yn(V.value),W=qn(V.value),se=null!==V.value?V.value:H;if(h){if(K!==h)return[new je(V.key,se,`${K} stop domain type must match previous stop domain type ${h}`)]}else h=K;if("number"!==K&&"string"!==K&&"boolean"!==K)return[new je(V.key,se,"stop domain value must be a number, string, or boolean")];if("number"!==K&&"categorical"!==c){let ue=`number expected, ${K} found`;return Ba(o)&&void 0===c&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new je(V.key,se,ue)]}return"categorical"!==c||"number"!==K||isFinite(W)&&Math.floor(W)===W?"categorical"!==c&&"number"===K&&void 0!==g&&W<g?[new je(V.key,se,"stop domain values must appear in ascending order")]:(g=W,"categorical"===c&&W in x?[new je(V.key,se,"stop domain values must be unique")]:(x[W]=!0,[])):[new je(V.key,se,`integer expected, found ${W}`)]}}function Ir(a){const o=("property"===a.expressionContext?id:Kn)(Ds(a.value),a.valueSpec);if("error"===o.result)return o.value.map(h=>new je(`${a.key}${h.key}`,a.value,h.message));const c=o.value.expression||o.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!c.outputDefined())return[new je(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!en(c))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!en(c))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Hc(c,["zoom","feature-state"]))return[new je(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Dt(c))return[new je(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ta(a){const o=a.key,c=a.value,h=a.valueSpec,g=[];return Array.isArray(h.values)?-1===h.values.indexOf(qn(c))&&g.push(new je(o,c,`expected one of [${h.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(h.values).indexOf(qn(c))&&g.push(new je(o,c,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(c)} found`)),g}function Qi(a){return ea(Ds(a.value))?Ir(ho({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ro(a)}function Ro(a){const o=a.value,c=a.key;if("array"!==yn(o))return[new je(c,o,`array expected, ${yn(o)} found`)];const h=a.styleSpec;let g,v=[];if(o.length<1)return[new je(c,o,"filter array must have at least 1 element")];switch(v=v.concat(ta({key:`${c}[0]`,value:o[0],valueSpec:h.filter_operator,style:a.style,styleSpec:a.styleSpec})),qn(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===qn(o[1])&&v.push(new je(c,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&v.push(new je(c,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(g=yn(o[1]),"string"!==g&&v.push(new je(`${c}[1]`,o[1],`string expected, ${g} found`)));for(let x=2;x<o.length;x++)g=yn(o[x]),"$type"===qn(o[1])?v=v.concat(ta({key:`${c}[${x}]`,value:o[x],valueSpec:h.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==g&&"number"!==g&&"boolean"!==g&&v.push(new je(`${c}[${x}]`,o[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<o.length;x++)v=v.concat(Ro({key:`${c}[${x}]`,value:o[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=yn(o[1]),2!==o.length?v.push(new je(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==g&&v.push(new je(`${c}[1]`,o[1],`string expected, ${g} found`));break;case"within":g=yn(o[1]),2!==o.length?v.push(new je(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==g&&v.push(new je(`${c}[1]`,o[1],`object expected, ${g} found`))}return v}function on(a,o){const c=a.key,h=a.validateSpec,g=a.style,v=a.styleSpec,x=a.value,C=a.objectKey,S=v[`${o}_${a.layerType}`];if(!S)return[];const A=C.match(/^(.*)-transition$/);if("paint"===o&&A&&S[A[1]]&&S[A[1]].transition)return h({key:c,value:x,valueSpec:v.transition,style:g,styleSpec:v});const R=a.valueSpec||S[C];if(!R)return[new je(c,x,`unknown property "${C}"`)];let L;if("string"===yn(x)&&Ba(R)&&!R.tokens&&(L=/^{([^}]+)}$/.exec(x)))return[new je(c,x,`"${C}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const B=[];return"symbol"===a.layerType&&("text-field"===C&&g&&!g.glyphs&&B.push(new je(c,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===C&&wn(Ds(x))&&"identity"===qn(x.type)&&B.push(new je(c,x,'"text-font" does not support identity functions'))),B.concat(h({key:a.key,value:x,valueSpec:R,style:g,styleSpec:v,expressionContext:"property",propertyType:o,propertyKey:C}))}function ml(a){return on(a,"paint")}function Kc(a){return on(a,"layout")}function gl(a){let o=[];const c=a.value,h=a.key,g=a.style,v=a.styleSpec;c.type||c.ref||o.push(new je(h,c,'either "type" or "ref" is required'));let x=qn(c.type);const C=qn(c.ref);if(c.id){const S=qn(c.id);for(let A=0;A<a.arrayIndex;A++){const R=g.layers[A];qn(R.id)===S&&o.push(new je(h,c.id,`duplicate layer id "${c.id}", previously used at line ${R.id.__line__}`))}}if("ref"in c){let S;["type","source","source-layer","filter","layout"].forEach(A=>{A in c&&o.push(new je(h,c[A],`"${A}" is prohibited for ref layers`))}),g.layers.forEach(A=>{qn(A.id)===C&&(S=A)}),S?S.ref?o.push(new je(h,c.ref,"ref cannot reference another ref layer")):x=qn(S.type):o.push(new je(h,c.ref,`ref layer "${C}" not found`))}else if("background"!==x)if(c.source){const S=g.sources&&g.sources[c.source],A=S&&qn(S.type);S?"vector"===A&&"raster"===x?o.push(new je(h,c.source,`layer "${c.id}" requires a raster source`)):"raster"===A&&"raster"!==x?o.push(new je(h,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==A||c["source-layer"]?"raster-dem"===A&&"hillshade"!==x?o.push(new je(h,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==x||!c.paint||!c.paint["line-gradient"]||"geojson"===A&&S.lineMetrics||o.push(new je(h,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new je(h,c,`layer "${c.id}" must specify a "source-layer"`)):o.push(new je(h,c.source,`source "${c.source}" not found`))}else o.push(new je(h,c,'missing required property "source"'));return o=o.concat(dr({key:h,value:c,valueSpec:v.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${h}.type`,value:c.type,valueSpec:v.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:c,objectKey:"type"}),filter:Qi,layout:S=>dr({layer:c,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":A=>Kc(ho({layerType:x},A))}}),paint:S=>dr({layer:c,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":A=>ml(ho({layerType:x},A))}})}})),o}function Fo(a){const o=a.value,c=a.key,h=yn(o);return"string"!==h?[new je(c,o,`string expected, ${h} found`)]:[]}const fo={promoteId:function({key:a,value:o}){if("string"===yn(o))return Fo({key:a,value:o});{const c=[];for(const h in o)c.push(...Fo({key:`${a}.${h}`,value:o[h]}));return c}}};function na(a){const o=a.value,c=a.key,h=a.styleSpec,g=a.style,v=a.validateSpec;if(!o.type)return[new je(c,o,'"type" is required')];const x=qn(o.type);let C;switch(x){case"vector":case"raster":case"raster-dem":return C=dr({key:c,value:o,valueSpec:h[`source_${x.replace("-","_")}`],style:a.style,styleSpec:h,objectElementValidators:fo,validateSpec:v}),C;case"geojson":if(C=dr({key:c,value:o,valueSpec:h.source_geojson,style:g,styleSpec:h,validateSpec:v,objectElementValidators:fo}),o.cluster)for(const S in o.clusterProperties){const[A,R]=o.clusterProperties[S],L="string"==typeof A?[A,["accumulated"],["get",S]]:A;C.push(...Ir({key:`${c}.${S}.map`,value:R,validateSpec:v,expressionContext:"cluster-map"})),C.push(...Ir({key:`${c}.${S}.reduce`,value:L,validateSpec:v,expressionContext:"cluster-reduce"}))}return C;case"video":return dr({key:c,value:o,valueSpec:h.source_video,style:g,validateSpec:v,styleSpec:h});case"image":return dr({key:c,value:o,valueSpec:h.source_image,style:g,validateSpec:v,styleSpec:h});case"canvas":return[new je(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ta({key:`${c}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:v,styleSpec:h})}}function ad(a){const o=a.value,c=a.styleSpec,h=c.light,g=a.style;let v=[];const x=yn(o);if(void 0===o)return v;if("object"!==x)return v=v.concat([new je("light",o,`object expected, ${x} found`)]),v;for(const C in o){const S=C.match(/^(.*)-transition$/);v=v.concat(S&&h[S[1]]&&h[S[1]].transition?a.validateSpec({key:C,value:o[C],valueSpec:c.transition,validateSpec:a.validateSpec,style:g,styleSpec:c}):h[C]?a.validateSpec({key:C,value:o[C],valueSpec:h[C],validateSpec:a.validateSpec,style:g,styleSpec:c}):[new je(C,o[C],`unknown property "${C}"`)])}return v}function _l(a){const o=a.value,c=a.styleSpec,h=c.terrain,g=a.style;let v=[];const x=yn(o);if(void 0===o)return v;if("object"!==x)return v=v.concat([new je("terrain",o,`object expected, ${x} found`)]),v;for(const C in o)v=v.concat(h[C]?a.validateSpec({key:C,value:o[C],valueSpec:h[C],validateSpec:a.validateSpec,style:g,styleSpec:c}):[new je(C,o[C],`unknown property "${C}"`)]);return v}function Yc(a){let o=[];const c=a.value,h=a.key;if(Array.isArray(c)){const g=[],v=[];for(const x in c)c[x].id&&g.includes(c[x].id)&&o.push(new je(h,c,`all the sprites' ids must be unique, but ${c[x].id} is duplicated`)),g.push(c[x].id),c[x].url&&v.includes(c[x].url)&&o.push(new je(h,c,`all the sprites' URLs must be unique, but ${c[x].url} is duplicated`)),v.push(c[x].url),o=o.concat(dr({key:`${h}[${x}]`,value:c[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return o}return Fo({key:h,value:c})}const ld={"*":()=>[],array:bh,boolean:function(a){const o=a.value,c=a.key,h=yn(o);return"boolean"!==h?[new je(c,o,`boolean expected, ${h} found`)]:[]},number:sd,color:function(a){const o=a.key,c=a.value,h=yn(c);return"string"!==h?[new je(o,c,`color expected, ${h} found`)]:vt.parse(String(c))?[]:[new je(o,c,`color expected, "${c}" found`)]},constants:St,enum:ta,filter:Qi,function:xh,layer:gl,object:dr,source:na,light:ad,terrain:_l,string:Fo,formatted:function(a){return 0===Fo(a).length?[]:Ir(a)},resolvedImage:function(a){return 0===Fo(a).length?[]:Ir(a)},padding:function(a){const o=a.key,c=a.value;if("array"===yn(c)){if(c.length<1||c.length>4)return[new je(o,c,`padding requires 1 to 4 values; ${c.length} values found`)];const h={type:"number"};let g=[];for(let v=0;v<c.length;v++)g=g.concat(a.validateSpec({key:`${o}[${v}]`,value:c[v],validateSpec:a.validateSpec,valueSpec:h}));return g}return sd({key:o,value:c,valueSpec:{}})},sprite:Yc};function yl(a){const o=a.value,c=a.valueSpec,h=a.styleSpec;return a.validateSpec=yl,c.expression&&wn(qn(o))?xh(a):c.expression&&fl(Ds(o))?Ir(a):c.type&&ld[c.type]?ld[c.type](a):dr(ho({},a,{valueSpec:c.type?h[c.type]:c}))}function vl(a){const o=a.value,c=a.key,h=Fo(a);return h.length||(-1===o.indexOf("{fontstack}")&&h.push(new je(c,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&h.push(new je(c,o,'"glyphs" url must include a "{range}" token'))),h}function Oo(a,o=xe){let c=[];return c=c.concat(yl({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,validateSpec:yl,objectElementValidators:{glyphs:vl,"*":()=>[]}})),a.constants&&(c=c.concat(St({key:"constants",value:a.constants,style:a,styleSpec:o,validateSpec:yl}))),nc(c)}function Qr(a){return function(o){return a({...o,validateSpec:yl})}}function nc(a){return[].concat(a).sort((o,c)=>o.line-c.line)}function ui(a){return function(...o){return nc(a.apply(this,o))}}Oo.source=ui(Qr(na)),Oo.sprite=ui(Qr(Yc)),Oo.glyphs=ui(Qr(vl)),Oo.light=ui(Qr(ad)),Oo.terrain=ui(Qr(_l)),Oo.layer=ui(Qr(gl)),Oo.filter=ui(Qr(Qi)),Oo.paintProperty=ui(Qr(ml)),Oo.layoutProperty=ui(Qr(Kc));const ia=Oo,jp=ia.light,Lo=ia.paintProperty,Hp=ia.layoutProperty;function za(a,o){let c=!1;if(o&&o.length)for(const h of o)a.fire(new Nr(new Error(h.message))),c=!0;return c}class ic{constructor(o,c,h){const g=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const x=new Int32Array(this.arrayBuffer);o=x[0],this.d=(c=x[1])+2*(h=x[2]);for(let S=0;S<this.d*this.d;S++){const A=x[3+S],R=x[3+S+1];g.push(A===R?null:x.subarray(A,R))}const C=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],C),this.bboxes=x.subarray(C),this.insert=this._insertReadonly}else{this.d=c+2*h;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=o,this.padding=h,this.scale=c/o,this.uid=0;const v=h/c*o;this.min=-v,this.max=o+v}insert(o,c,h,g,v){this._forEachCell(c,h,g,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,c,h,g,v,x){this.cells[v].push(x)}query(o,c,h,g,v){const x=this.min,C=this.max;if(o<=x&&c<=x&&C<=h&&C<=g&&!v)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(o,c,h,g,this._queryCell,S,{},v),S}}_queryCell(o,c,h,g,v,x,C,S){const A=this.cells[v];if(null!==A){const R=this.keys,L=this.bboxes;for(let B=0;B<A.length;B++){const V=A[B];if(void 0===C[V]){const H=4*V;(S?S(L[H+0],L[H+1],L[H+2],L[H+3]):o<=L[H+2]&&c<=L[H+3]&&h>=L[H+0]&&g>=L[H+1])?(C[V]=!0,x.push(R[V])):C[V]=!1}}}}_forEachCell(o,c,h,g,v,x,C,S){const A=this._convertToCellCoord(o),R=this._convertToCellCoord(c),L=this._convertToCellCoord(h),B=this._convertToCellCoord(g);for(let V=A;V<=L;V++)for(let H=R;H<=B;H++){const K=this.d*H+V;if((!S||S(this._convertFromCellCoord(V),this._convertFromCellCoord(H),this._convertFromCellCoord(V+1),this._convertFromCellCoord(H+1)))&&v.call(this,o,c,h,g,K,x,C,S))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,c=3+this.cells.length+1+1;let h=0;for(let x=0;x<this.cells.length;x++)h+=this.cells[x].length;const g=new Int32Array(c+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let v=c;for(let x=0;x<o.length;x++){const C=o[x];g[3+x]=v,g.set(C,v),v+=C.length}return g[3+o.length]=v,g.set(this.keys,v),v+=this.keys.length,g[3+o.length+1]=v,g.set(this.bboxes,v),v+=this.bboxes.length,g.buffer}static serialize(o,c){const h=o.toArrayBuffer();return c&&c.push(h),{buffer:h}}static deserialize(o){return new ic(o.buffer)}}const ts={};function Je(a,o,c={}){if(ts[a])throw new Error(`${a} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:a,writeable:!1}),ts[a]={klass:o,omit:c.omit||[],shallow:c.shallow||[]}}Je("Object",Object),Je("TransferableGridIndex",ic),Je("Color",vt),Je("Error",Error),Je("AJAXError",qs),Je("ResolvedImage",Vr),Je("StylePropertyFunction",Ln),Je("StyleExpression",nd,{omit:["_evaluator"]}),Je("ZoomDependentExpression",Wt),Je("ZoomConstantExpression",_h),Je("CompoundExpression",Ee,{omit:["_evaluate"]});for(const a in Es)Es[a]._classRegistryKey||Je(`Expression_${a}`,Es[a]);function Qc(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function bl(a,o){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(Qc(a)||Ao(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){const c=a;return o&&o.push(c.buffer),c}if(a instanceof ImageData)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){const c=[];for(const h of a)c.push(bl(h,o));return c}if("object"==typeof a){const c=a.constructor,h=c._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!ts[h])throw new Error(`${h} is not registered.`);const g=c.serialize?c.serialize(a,o):{};if(c.serialize){if(o&&g===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in a){if(!a.hasOwnProperty(v)||ts[h].omit.indexOf(v)>=0)continue;const x=a[v];g[v]=ts[h].shallow.indexOf(v)>=0?x:bl(x,o)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==h&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof a)}function Ss(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||Qc(a)||Ao(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Ss);if("object"==typeof a){const o=a.$name||"Object";if(!ts[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:c}=ts[o];if(!c)throw new Error(`can't deserialize unregistered class ${o}`);if(c.deserialize)return c.deserialize(a);const h=Object.create(c.prototype);for(const g of Object.keys(a)){if("$name"===g)continue;const v=a[g];h[g]=ts[o].shallow.indexOf(g)>=0?v:Ss(v)}return h}throw new Error("can't deserialize object of type "+typeof a)}class wh{constructor(){this.first=!0}update(o,c){const h=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=c),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=h,!0))}}const Xe={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Di(a){for(const o of a)if(Jc(o.charCodeAt(0)))return!0;return!1}function cd(a){for(const o of a)if(!Eh(o.charCodeAt(0)))return!1;return!0}function Eh(a){return!(Xe.Arabic(a)||Xe["Arabic Supplement"](a)||Xe["Arabic Extended-A"](a)||Xe["Arabic Presentation Forms-A"](a)||Xe["Arabic Presentation Forms-B"](a))}function Jc(a){return!(746!==a&&747!==a&&(a<4352||!(Xe["Bopomofo Extended"](a)||Xe.Bopomofo(a)||Xe["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Xe["CJK Compatibility Ideographs"](a)||Xe["CJK Compatibility"](a)||Xe["CJK Radicals Supplement"](a)||Xe["CJK Strokes"](a)||!(!Xe["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Xe["CJK Unified Ideographs Extension A"](a)||Xe["CJK Unified Ideographs"](a)||Xe["Enclosed CJK Letters and Months"](a)||Xe["Hangul Compatibility Jamo"](a)||Xe["Hangul Jamo Extended-A"](a)||Xe["Hangul Jamo Extended-B"](a)||Xe["Hangul Jamo"](a)||Xe["Hangul Syllables"](a)||Xe.Hiragana(a)||Xe["Ideographic Description Characters"](a)||Xe.Kanbun(a)||Xe["Kangxi Radicals"](a)||Xe["Katakana Phonetic Extensions"](a)||Xe.Katakana(a)&&12540!==a||!(!Xe["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Xe["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Xe["Unified Canadian Aboriginal Syllabics"](a)||Xe["Unified Canadian Aboriginal Syllabics Extended"](a)||Xe["Vertical Forms"](a)||Xe["Yijing Hexagram Symbols"](a)||Xe["Yi Syllables"](a)||Xe["Yi Radicals"](a))))}function di(a){return!(Jc(a)||(o=a,Xe["Latin-1 Supplement"](o)&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||Xe["General Punctuation"](o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||Xe["Letterlike Symbols"](o)||Xe["Number Forms"](o)||Xe["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||Xe["Control Pictures"](o)&&9251!==o||Xe["Optical Character Recognition"](o)||Xe["Enclosed Alphanumerics"](o)||Xe["Geometric Shapes"](o)||Xe["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Xe["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Xe["CJK Symbols and Punctuation"](o)||Xe.Katakana(o)||Xe["Private Use Area"](o)||Xe["CJK Compatibility Forms"](o)||Xe["Small Form Variants"](o)||Xe["Halfwidth and Fullwidth Forms"](o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o}function eu(a){return a>=1424&&a<=2303||Xe["Arabic Presentation Forms-A"](a)||Xe["Arabic Presentation Forms-B"](a)}function rc(a,o){return!(!o&&eu(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Xe.Khmer(a))}function mt(a){for(const o of a)if(eu(o.charCodeAt(0)))return!0;return!1}const hr="deferred",Kt="loading",Si="loaded";let Ii=null,Bi="unavailable",vi=null;const ud=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(Bi="error"),Ii&&Ii(a)};function tu(){Va.fire(new fn("pluginStateChange",{pluginStatus:Bi,pluginURL:vi}))}const Va=new ol,dd=function(){return Bi},Ch=function(){if(Bi!==hr||!vi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bi=Kt,tu(),vi&&Ra({url:vi},a=>{a?ud(a):(Bi=Si,tu())})},cn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Bi===Si||null!=cn.applyArabicShaping,isLoading:()=>Bi===Kt,setState(a){if(!Gn())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Bi=a.pluginStatus,vi=a.pluginURL},isParsed(){if(!Gn())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=cn.applyArabicShaping&&null!=cn.processBidirectionalText&&null!=cn.processStyledBidirectionalText},getPluginURL(){if(!Gn())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return vi}};class Le{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wh,this.transition={})}isSupportedScript(o){return function(c,h){for(const g of c)if(!rc(g.charCodeAt(0),h))return!1;return!0}(o,cn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,c=o-Math.floor(o),h=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*c}}}class Pt{constructor(o,c){this.property=o,this.value=c,this.expression=function(h,g){if(wn(h))return new Ln(h,g);if(fl(h)){const v=id(h,g);if("error"===v.result)throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=h;return"color"===g.type&&"string"==typeof h?v=vt.parse(h):"padding"!==g.type||"number"!=typeof h&&!Array.isArray(h)||(v=zr.parse(h)),{kind:"constant",evaluate:()=>v}}}(void 0===c?o.specification.default:c,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,c,h){return this.property.possiblyEvaluate(this,o,c,h)}}class Nn{constructor(o){this.property=o,this.value=new Pt(o,void 0)}transitioned(o,c){return new Is(this.property,this.value,c,Ci({},o.transition,this.transition),o.now)}untransitioned(){return new Is(this.property,this.value,null,{},0)}}class mo{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return We(this._values[o].value.value)}setValue(o,c){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new Nn(this._values[o].property)),this._values[o].value=new Pt(this._values[o].property,null===c?void 0:We(c))}getTransition(o){return We(this._values[o].transition)}setTransition(o,c){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new Nn(this._values[o].property)),this._values[o].transition=We(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const h=this.getValue(c);void 0!==h&&(o[c]=h);const g=this.getTransition(c);void 0!==g&&(o[`${c}-transition`]=g)}return o}transitioned(o,c){const h=new Ji(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(o,c._values[g]);return h}untransitioned(){const o=new Ji(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class Is{constructor(o,c,h,g,v){this.property=o,this.value=c,this.begin=v+g.delay||0,this.end=this.begin+g.duration||0,o.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(o,c,h){const g=o.now||0,v=this.value.possiblyEvaluate(o,c,h),x=this.prior;if(x){if(g>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(g<this.begin)return x.possiblyEvaluate(o,c,h);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(o,c,h),v,function(S){if(S<=0)return 0;if(S>=1)return 1;const A=S*S,R=A*S;return 4*(S<.5?R:3*(S-A)+R-.75)}(C))}}return v}}class Ji{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,h){const g=new No(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(o,c,h);return g}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class ra{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return We(this._values[o].value)}setValue(o,c){this._values[o]=new Pt(this._values[o].property,null===c?void 0:We(c))}serialize(){const o={};for(const c of Object.keys(this._values)){const h=this.getValue(c);void 0!==h&&(o[c]=h)}return o}possiblyEvaluate(o,c,h){const g=new No(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(o,c,h);return g}}class vn{constructor(o,c,h){this.property=o,this.value=c,this.parameters=h}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,c,h,g){return this.property.evaluate(this.value,this.parameters,o,c,h,g)}}class No{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class et{constructor(o){this.specification=o}possiblyEvaluate(o,c){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(c)}interpolate(o,c,h){const g=po[this.specification.type];return g?g(o,c,h):o}}class Fe{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,h,g){return new vn(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(c,null,{},h,g)}:o.expression,c)}interpolate(o,c,h){if("constant"!==o.value.kind||"constant"!==c.value.kind)return o;if(void 0===o.value.value||void 0===c.value.value)return new vn(this,{kind:"constant",value:void 0},o.parameters);const g=po[this.specification.type];if(g){const v=g(o.value.value,c.value.value,h);return new vn(this,{kind:"constant",value:v},o.parameters)}return o}evaluate(o,c,h,g,v,x){return"constant"===o.kind?o.value:o.evaluate(c,h,g,v,x)}}class Ms extends Fe{possiblyEvaluate(o,c,h,g){if(void 0===o.value)return new vn(this,{kind:"constant",value:void 0},c);if("constant"===o.expression.kind){const v=o.expression.evaluate(c,null,{},h,g),x="resolvedImage"===o.property.specification.type&&"string"!=typeof v?v.name:v,C=this._calculate(x,x,x,c);return new vn(this,{kind:"constant",value:C},c)}if("camera"===o.expression.kind){const v=this._calculate(o.expression.evaluate({zoom:c.zoom-1}),o.expression.evaluate({zoom:c.zoom}),o.expression.evaluate({zoom:c.zoom+1}),c);return new vn(this,{kind:"constant",value:v},c)}return new vn(this,o.expression,c)}evaluate(o,c,h,g,v,x){if("source"===o.kind){const C=o.evaluate(c,h,g,v,x);return this._calculate(C,C,C,c)}return"composite"===o.kind?this._calculate(o.evaluate({zoom:Math.floor(c.zoom)-1},h,g),o.evaluate({zoom:Math.floor(c.zoom)},h,g),o.evaluate({zoom:Math.floor(c.zoom)+1},h,g),c):o.value}_calculate(o,c,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:o,to:c}:{from:h,to:c}}interpolate(o){return o}}class nu{constructor(o){this.specification=o}possiblyEvaluate(o,c,h,g){if(void 0!==o.value){if("constant"===o.expression.kind){const v=o.expression.evaluate(c,null,{},h,g);return this._calculate(v,v,v,c)}return this._calculate(o.expression.evaluate(new Le(Math.floor(c.zoom-1),c)),o.expression.evaluate(new Le(Math.floor(c.zoom),c)),o.expression.evaluate(new Le(Math.floor(c.zoom+1),c)),c)}}_calculate(o,c,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:o,to:c}:{from:h,to:c}}interpolate(o){return o}}class oa{constructor(o){this.specification=o}possiblyEvaluate(o,c,h,g){return!!o.expression.evaluate(c,null,{},h,g)}interpolate(){return!1}}class sn{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in o){const h=o[c];h.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new Pt(h,void 0),v=this.defaultTransitionablePropertyValues[c]=new Nn(h);this.defaultTransitioningPropertyValues[c]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate({})}}}Je("DataDrivenProperty",Fe),Je("DataConstantProperty",et),Je("CrossFadedDataDrivenProperty",Ms),Je("CrossFadedProperty",nu),Je("ColorRampProperty",oa);const xl="-transition";class Mr extends ol{constructor(o,c){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),c.layout&&(this._unevaluatedLayout=new ra(c.layout)),c.paint)){this._transitionablePaint=new mo(c.paint);for(const h in o.paint)this.setPaintProperty(h,o.paint[h],{validate:!1});for(const h in o.layout)this.setLayoutProperty(h,o.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new No(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c,h={}){null!=c&&this._validate(Hp,`layers.${this.id}.layout.${o}`,o,c,h)||("visibility"!==o?this._unevaluatedLayout.setValue(o,c):this.visibility=c)}getPaintProperty(o){return o.endsWith(xl)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c,h={}){if(null!=c&&this._validate(Lo,`layers.${this.id}.paint.${o}`,o,c,h))return!1;if(o.endsWith(xl))return this._transitionablePaint.setTransition(o.slice(0,-11),c||void 0),!1;{const g=this._transitionablePaint._values[o],v="cross-faded-data-driven"===g.property.specification["property-type"],x=g.value.isDataDriven(),C=g.value;this._transitionablePaint.setValue(o,c),this._handleSpecialPaintPropertyUpdate(o);const S=this._transitionablePaint._values[o].value;return S.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(o,C,S)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,c,h){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),ze(o,(c,h)=>!(void 0===c||"layout"===h&&!Object.keys(c).length||"paint"===h&&!Object.keys(c).length))}_validate(o,c,h,g,v={}){return(!v||!1!==v.validate)&&za(this,o.call(ia,{key:c,layerType:this.type,objectKey:h,value:g,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof vn&&Ba(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}}const ns={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Jr{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function An(a,o=1){let c=0,h=0;return{members:a.map(g=>{const v=ns[g.type].BYTES_PER_ELEMENT,x=c=is(c,Math.max(o,v)),C=g.components||1;return h=Math.max(h,v),c+=v*C,{name:g.name,type:g.type,components:C,offset:x}}),size:is(c,Math.max(h,o)),alignment:o}}function is(a,o){return Math.ceil(a/o)*o}class rs extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const g=2*o;return this.int16[g+0]=c,this.int16[g+1]=h,o}}rs.prototype.bytesPerElement=4,Je("StructArrayLayout2i4",rs);class sa extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const v=3*o;return this.int16[v+0]=c,this.int16[v+1]=h,this.int16[v+2]=g,o}}sa.prototype.bytesPerElement=6,Je("StructArrayLayout3i6",sa);class Gt extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,g)}emplace(o,c,h,g,v){const x=4*o;return this.int16[x+0]=c,this.int16[x+1]=h,this.int16[x+2]=g,this.int16[x+3]=v,o}}Gt.prototype.bytesPerElement=8,Je("StructArrayLayout4i8",Gt);class Ts extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,c,h,g,v,x)}emplace(o,c,h,g,v,x,C){const S=6*o;return this.int16[S+0]=c,this.int16[S+1]=h,this.int16[S+2]=g,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=C,o}}Ts.prototype.bytesPerElement=12,Je("StructArrayLayout2i4i12",Ts);class wl extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,c,h,g,v,x)}emplace(o,c,h,g,v,x,C){const S=4*o,A=8*o;return this.int16[S+0]=c,this.int16[S+1]=h,this.uint8[A+4]=g,this.uint8[A+5]=v,this.uint8[A+6]=x,this.uint8[A+7]=C,o}}wl.prototype.bytesPerElement=8,Je("StructArrayLayout2i4ub8",wl);class aa extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const g=2*o;return this.float32[g+0]=c,this.float32[g+1]=h,o}}aa.prototype.bytesPerElement=8,Je("StructArrayLayout2f8",aa);class eo extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x,C,S,A,R){const L=this.length;return this.resize(L+1),this.emplace(L,o,c,h,g,v,x,C,S,A,R)}emplace(o,c,h,g,v,x,C,S,A,R,L){const B=10*o;return this.uint16[B+0]=c,this.uint16[B+1]=h,this.uint16[B+2]=g,this.uint16[B+3]=v,this.uint16[B+4]=x,this.uint16[B+5]=C,this.uint16[B+6]=S,this.uint16[B+7]=A,this.uint16[B+8]=R,this.uint16[B+9]=L,o}}eo.prototype.bytesPerElement=20,Je("StructArrayLayout10ui20",eo);class la extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x,C,S,A,R,L,B){const V=this.length;return this.resize(V+1),this.emplace(V,o,c,h,g,v,x,C,S,A,R,L,B)}emplace(o,c,h,g,v,x,C,S,A,R,L,B,V){const H=12*o;return this.int16[H+0]=c,this.int16[H+1]=h,this.int16[H+2]=g,this.int16[H+3]=v,this.uint16[H+4]=x,this.uint16[H+5]=C,this.uint16[H+6]=S,this.uint16[H+7]=A,this.int16[H+8]=R,this.int16[H+9]=L,this.int16[H+10]=B,this.int16[H+11]=V,o}}la.prototype.bytesPerElement=24,Je("StructArrayLayout4i4ui4i24",la);class ca extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const v=3*o;return this.float32[v+0]=c,this.float32[v+1]=h,this.float32[v+2]=g,o}}ca.prototype.bytesPerElement=12,Je("StructArrayLayout3f12",ca);class os extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}os.prototype.bytesPerElement=4,Je("StructArrayLayout1ul4",os);class Qn extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x,C,S,A){const R=this.length;return this.resize(R+1),this.emplace(R,o,c,h,g,v,x,C,S,A)}emplace(o,c,h,g,v,x,C,S,A,R){const L=10*o,B=5*o;return this.int16[L+0]=c,this.int16[L+1]=h,this.int16[L+2]=g,this.int16[L+3]=v,this.int16[L+4]=x,this.int16[L+5]=C,this.uint32[B+3]=S,this.uint16[L+8]=A,this.uint16[L+9]=R,o}}Qn.prototype.bytesPerElement=20,Je("StructArrayLayout6i1ul2ui20",Qn);class Dh extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,c,h,g,v,x)}emplace(o,c,h,g,v,x,C){const S=6*o;return this.int16[S+0]=c,this.int16[S+1]=h,this.int16[S+2]=g,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=C,o}}Dh.prototype.bytesPerElement=12,Je("StructArrayLayout2i2i2i12",Dh);class er extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v){const x=this.length;return this.resize(x+1),this.emplace(x,o,c,h,g,v)}emplace(o,c,h,g,v,x){const C=4*o,S=8*o;return this.float32[C+0]=c,this.float32[C+1]=h,this.float32[C+2]=g,this.int16[S+6]=v,this.int16[S+7]=x,o}}er.prototype.bytesPerElement=16,Je("StructArrayLayout2f1f2i16",er);class hi extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,g)}emplace(o,c,h,g,v){const x=12*o,C=3*o;return this.uint8[x+0]=c,this.uint8[x+1]=h,this.float32[C+1]=g,this.float32[C+2]=v,o}}hi.prototype.bytesPerElement=12,Je("StructArrayLayout2ub2f12",hi);class El extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const v=3*o;return this.uint16[v+0]=c,this.uint16[v+1]=h,this.uint16[v+2]=g,o}}El.prototype.bytesPerElement=6,Je("StructArrayLayout3ui6",El);class As extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x,C,S,A,R,L,B,V,H,K,W,se){const ue=this.length;return this.resize(ue+1),this.emplace(ue,o,c,h,g,v,x,C,S,A,R,L,B,V,H,K,W,se)}emplace(o,c,h,g,v,x,C,S,A,R,L,B,V,H,K,W,se,ue){const re=24*o,he=12*o,me=48*o;return this.int16[re+0]=c,this.int16[re+1]=h,this.uint16[re+2]=g,this.uint16[re+3]=v,this.uint32[he+2]=x,this.uint32[he+3]=C,this.uint32[he+4]=S,this.uint16[re+10]=A,this.uint16[re+11]=R,this.uint16[re+12]=L,this.float32[he+7]=B,this.float32[he+8]=V,this.uint8[me+36]=H,this.uint8[me+37]=K,this.uint8[me+38]=W,this.uint32[he+10]=se,this.int16[re+22]=ue,o}}As.prototype.bytesPerElement=48,Je("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",As);class Ua extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g,v,x,C,S,A,R,L,B,V,H,K,W,se,ue,re,he,me,Ce,Qe,nt,Ke,Ge,Ue,Ze){const qe=this.length;return this.resize(qe+1),this.emplace(qe,o,c,h,g,v,x,C,S,A,R,L,B,V,H,K,W,se,ue,re,he,me,Ce,Qe,nt,Ke,Ge,Ue,Ze)}emplace(o,c,h,g,v,x,C,S,A,R,L,B,V,H,K,W,se,ue,re,he,me,Ce,Qe,nt,Ke,Ge,Ue,Ze,qe){const Re=34*o,ht=17*o;return this.int16[Re+0]=c,this.int16[Re+1]=h,this.int16[Re+2]=g,this.int16[Re+3]=v,this.int16[Re+4]=x,this.int16[Re+5]=C,this.int16[Re+6]=S,this.int16[Re+7]=A,this.uint16[Re+8]=R,this.uint16[Re+9]=L,this.uint16[Re+10]=B,this.uint16[Re+11]=V,this.uint16[Re+12]=H,this.uint16[Re+13]=K,this.uint16[Re+14]=W,this.uint16[Re+15]=se,this.uint16[Re+16]=ue,this.uint16[Re+17]=re,this.uint16[Re+18]=he,this.uint16[Re+19]=me,this.uint16[Re+20]=Ce,this.uint16[Re+21]=Qe,this.uint16[Re+22]=nt,this.uint32[ht+12]=Ke,this.float32[ht+13]=Ge,this.float32[ht+14]=Ue,this.float32[ht+15]=Ze,this.float32[ht+16]=qe,o}}Ua.prototype.bytesPerElement=68,Je("StructArrayLayout8i15ui1ul4f68",Ua);class Ur extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}Ur.prototype.bytesPerElement=4,Je("StructArrayLayout1f4",Ur);class Cl extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,c,h)}emplace(o,c,h,g){const v=4*o;return this.uint32[2*o+0]=c,this.uint16[v+2]=h,this.uint16[v+3]=g,o}}Cl.prototype.bytesPerElement=8,Je("StructArrayLayout1ul2ui8",Cl);class m extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const h=this.length;return this.resize(h+1),this.emplace(h,o,c)}emplace(o,c,h){const g=2*o;return this.uint16[g+0]=c,this.uint16[g+1]=h,o}}m.prototype.bytesPerElement=4,Je("StructArrayLayout2ui4",m);class s extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}s.prototype.bytesPerElement=2,Je("StructArrayLayout1ui2",s);class u extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,h,g){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,h,g)}emplace(o,c,h,g,v){const x=4*o;return this.float32[x+0]=c,this.float32[x+1]=h,this.float32[x+2]=g,this.float32[x+3]=v,o}}u.prototype.bytesPerElement=16,Je("StructArrayLayout4f16",u);class p extends Jr{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new lt(this.anchorPointX,this.anchorPointY)}}p.prototype.size=20;class _ extends Qn{get(o){return new p(this,o)}}Je("CollisionBoxArray",_);class w extends Jr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class D extends As{get(o){return new w(this,o)}}Je("PlacedSymbolArray",D);class M extends Jr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}M.prototype.size=68;class I extends Ua{get(o){return new M(this,o)}}Je("SymbolInstanceArray",I);class k extends Ur{getoffsetX(o){return this.float32[1*o+0]}}Je("GlyphOffsetArray",k);class O extends sa{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}Je("SymbolLineVertexArray",O);class F extends Jr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}F.prototype.size=8;class j extends Cl{get(o){return new F(this,o)}}Je("FeatureIndexArray",j);class X extends rs{}class q extends rs{}class Z extends rs{}class te extends Ts{}class le extends wl{}class fe extends aa{}class J extends eo{}class pe extends la{}class ye extends ca{}class De extends os{}class Ae extends Dh{}class Ne extends hi{}class ke extends El{}class Be extends m{}const ot=An([{name:"a_pos",components:2,type:"Int16"}],4),{members:gt}=ot;class He{constructor(o=[]){this.segments=o}prepareSegment(o,c,h,g){let v=this.segments[this.segments.length-1];return o>He.MAX_VERTEX_ARRAY_LENGTH&&pt(`Max vertices per segment is ${He.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!v||v.vertexLength+o>He.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==g)&&(v={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},void 0!==g&&(v.sortKey=g),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,h,g){return new He([{vertexOffset:o,primitiveOffset:c,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function yt(a,o){return 256*(a=zn(Math.floor(a),0,255))+zn(Math.floor(o),0,255)}He.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Je("SegmentVector",He);const Ye=An([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var tn={exports:{}},Wn=function(a,o){var c,h,g,v,x,C,S,A;for(h=a.length-(c=3&a.length),g=o,x=3432918353,C=461845907,A=0;A<h;)S=255&a.charCodeAt(A)|(255&a.charCodeAt(++A))<<8|(255&a.charCodeAt(++A))<<16|(255&a.charCodeAt(++A))<<24,++A,g=27492+(65535&(v=5*(65535&(g=(g^=S=(65535&(S=(S=(65535&S)*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*C+(((S>>>16)*C&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(S=0,c){case 3:S^=(255&a.charCodeAt(A+2))<<16;case 2:S^=(255&a.charCodeAt(A+1))<<8;case 1:g^=S=(65535&(S=(S=(65535&(S^=255&a.charCodeAt(A)))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*C+(((S>>>16)*C&65535)<<16)&4294967295}return g^=a.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0},pr=function(a,o){for(var c,h=a.length,g=o^h,v=0;h>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(v)|(255&a.charCodeAt(++v))<<8|(255&a.charCodeAt(++v))<<16|(255&a.charCodeAt(++v))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),h-=4,++v;switch(h){case 3:g^=(255&a.charCodeAt(v+2))<<16;case 2:g^=(255&a.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&a.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};tn.exports=Wn,tn.exports.murmur3=Wn,tn.exports.murmur2=pr;var ii=Qt(tn.exports);class Mi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,c,h,g){this.ids.push(fr(o)),this.positions.push(c,h,g)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=fr(o);let h=0,g=this.ids.length-1;for(;h<g;){const x=h+g>>1;this.ids[x]>=c?g=x:h=x+1}const v=[];for(;this.ids[h]===c;)v.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return v}static serialize(o,c){const h=new Float64Array(o.ids),g=new Uint32Array(o.positions);return Tr(h,g,0,h.length-1),c&&c.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(o){const c=new Mi;return c.ids=o.ids,c.positions=o.positions,c.indexed=!0,c}}function fr(a){const o=+a;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:ii(String(a))}function Tr(a,o,c,h){for(;c<h;){const g=a[c+h>>1];let v=c-1,x=h+1;for(;;){do{v++}while(a[v]<g);do{x--}while(a[x]>g);if(v>=x)break;mr(a,v,x),mr(o,3*v,3*x),mr(o,3*v+1,3*x+1),mr(o,3*v+2,3*x+2)}x-c<h-x?(Tr(a,o,c,x),c=x+1):(Tr(a,o,x+1,h),h=x)}}function mr(a,o,c){const h=a[o];a[o]=a[c],a[c]=h}Je("FeaturePositionMap",Mi);class gr{constructor(o,c){this.gl=o.gl,this.location=c}}class ks extends gr{constructor(o,c){super(o,c),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class iu extends gr{constructor(o,c){super(o,c),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class Ar extends gr{constructor(o,c){super(o,c),this.current=vt.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const zi=new Float32Array(16);function un(a){return[yt(255*a.r,255*a.g),yt(255*a.b,255*a.a)]}class Vi{constructor(o,c,h){this.value=o,this.uniformNames=c.map(g=>`u_${g}`),this.type=h}setUniform(o,c,h){o.set(h.constantOr(this.value))}getBinding(o,c,h){return"color"===this.type?new Ar(o,c):new ks(o,c)}}class Ti{constructor(o,c){this.uniformNames=c.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=o.tlbr}setUniform(o,c,h,g){const v="u_pattern_to"===g?this.patternTo:"u_pattern_from"===g?this.patternFrom:"u_pixel_ratio_to"===g?this.pixelRatioTo:"u_pixel_ratio_from"===g?this.pixelRatioFrom:null;v&&o.set(v)}getBinding(o,c,h){return"u_pattern"===h.substr(0,9)?new iu(o,c):new ks(o,c)}}class an{constructor(o,c,h,g){this.expression=o,this.type=h,this.maxValue=0,this.paintVertexAttributes=c.map(v=>({name:`a_${v}`,type:"Float32",components:"color"===h?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(o,c,h,g,v){const x=this.paintVertexArray.length,C=this.expression.evaluate(new Le(0),c,{},g,[],v);this.paintVertexArray.resize(o),this._setPaintValue(x,o,C)}updatePaintArray(o,c,h,g){const v=this.expression.evaluate({zoom:0},h,g);this._setPaintValue(o,c,v)}_setPaintValue(o,c,h){if("color"===this.type){const g=un(h);for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,g[0],g[1])}else{for(let g=o;g<c;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ai{constructor(o,c,h,g,v,x){this.expression=o,this.uniformNames=c.map(C=>`u_${C}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=c.map(C=>({name:`a_${C}`,type:"Float32",components:"color"===h?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(o,c,h,g,v){const x=this.expression.evaluate(new Le(this.zoom),c,{},g,[],v),C=this.expression.evaluate(new Le(this.zoom+1),c,{},g,[],v),S=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(S,o,x,C)}updatePaintArray(o,c,h,g){const v=this.expression.evaluate({zoom:this.zoom},h,g),x=this.expression.evaluate({zoom:this.zoom+1},h,g);this._setPaintValue(o,c,v,x)}_setPaintValue(o,c,h,g){if("color"===this.type){const v=un(h),x=un(g);for(let C=o;C<c;C++)this.paintVertexArray.emplace(C,v[0],v[1],x[0],x[1])}else{for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c){const h=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,g=zn(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);o.set(g)}getBinding(o,c,h){return new ks(o,c)}}class kr{constructor(o,c,h,g,v,x){this.expression=o,this.type=c,this.useIntegerZoom=h,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(o,c,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(g,o,c.patterns&&c.patterns[this.layerId],h)}updatePaintArray(o,c,h,g,v){this._setPaintValues(o,c,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(o,c,h,g){if(!g||!h)return;const{min:v,mid:x,max:C}=h,S=g[v],A=g[x],R=g[C];if(S&&A&&R)for(let L=o;L<c;L++)this.zoomInPaintVertexArray.emplace(L,A.tl[0],A.tl[1],A.br[0],A.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],A.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,A.tl[0],A.tl[1],A.br[0],A.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],A.pixelRatio,R.pixelRatio)}upload(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,Ye.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,Ye.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class hd{constructor(o,c,h){this.binders={},this._buffers=[];const g=[];for(const v in o.paint._values){if(!h(v))continue;const x=o.paint.get(v);if(!(x instanceof vn&&Ba(x.property.specification)))continue;const C=$p(v,o.type),S=x.value,A=x.property.specification.type,R=x.property.useIntegerZoom,L=x.property.specification["property-type"],B="cross-faded"===L||"cross-faded-data-driven"===L;if("constant"===S.kind)this.binders[v]=B?new Ti(S.value,C):new Vi(S.value,C,A),g.push(`/u_${v}`);else if("source"===S.kind||B){const V=pd(v,A,"source");this.binders[v]=B?new kr(S,A,R,c,V,o.id):new an(S,C,A,V),g.push(`/a_${v}`)}else{const V=pd(v,A,"composite");this.binders[v]=new Ai(S,C,A,R,c,V),g.push(`/z_${v}`)}}this.cacheKey=g.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof an||c instanceof Ai?c.maxValue:0}populatePaintArrays(o,c,h,g,v){for(const x in this.binders){const C=this.binders[x];(C instanceof an||C instanceof Ai||C instanceof kr)&&C.populatePaintArray(o,c,h,g,v)}}setConstantPatternPositions(o,c){for(const h in this.binders){const g=this.binders[h];g instanceof Ti&&g.setConstantPatternPositions(o,c)}}updatePaintArrays(o,c,h,g,v){let x=!1;for(const C in o){const S=c.getPositions(C);for(const A of S){const R=h.feature(A.index);for(const L in this.binders){const B=this.binders[L];if((B instanceof an||B instanceof Ai||B instanceof kr)&&!0===B.expression.isStateDependent){const V=g.paint.get(L);B.expression=V.value,B.updatePaintArray(A.start,A.end,R,o[C],v),x=!0}}}}return x}defines(){const o=[];for(const c in this.binders){const h=this.binders[c];(h instanceof Vi||h instanceof Ti)&&o.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof an||h instanceof Ai)for(let g=0;g<h.paintVertexAttributes.length;g++)o.push(h.paintVertexAttributes[g].name);else if(h instanceof kr)for(let g=0;g<Ye.members.length;g++)o.push(Ye.members[g].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Vi||h instanceof Ti||h instanceof Ai)for(const g of h.uniformNames)o.push(g)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,c){const h=[];for(const g in this.binders){const v=this.binders[g];if(v instanceof Vi||v instanceof Ti||v instanceof Ai)for(const x of v.uniformNames)if(c[x]){const C=v.getBinding(o,c[x],x);h.push({name:x,property:g,binding:C})}}return h}setUniforms(o,c,h,g){for(const{name:v,property:x,binding:C}of c)this.binders[x].setUniform(C,g,h.get(x),v)}updatePaintBuffers(o){this._buffers=[];for(const c in this.binders){const h=this.binders[c];if(o&&h instanceof kr){const g=2===o.fromScale?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof an||h instanceof Ai)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(o){for(const c in this.binders){const h=this.binders[c];(h instanceof an||h instanceof Ai||h instanceof kr)&&h.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof an||c instanceof Ai||c instanceof kr)&&c.destroy()}}}class ua{constructor(o,c,h=(()=>!0)){this.programConfigurations={};for(const g of o)this.programConfigurations[g.id]=new hd(g,c,h);this.needsUpload=!1,this._featureMap=new Mi,this._bufferOffset=0}populatePaintArrays(o,c,h,g,v,x){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(o,c,g,v,x);void 0!==c.id&&this._featureMap.add(c.id,h,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,h,g){for(const v of h)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(o,this._featureMap,c,v,g)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function $p(a,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${o}-`,"").replace(/-/g,"_")]}function pd(a,o,c){const g={"line-pattern":{source:J,composite:J},"fill-pattern":{source:J,composite:J},"fill-extrusion-pattern":{source:J,composite:J}}[a];return g&&g[c]||{color:{source:aa,composite:u},number:{source:Ur,composite:aa}}[o][c]}Je("ConstantBinder",Vi),Je("CrossFadedConstantBinder",Ti),Je("SourceExpressionBinder",an),Je("CrossFadedCompositeBinder",kr),Je("CompositeExpressionBinder",Ai),Je("ProgramConfiguration",hd,{omit:["_buffers"]}),Je("ProgramConfigurationSet",ua);var kn=8192;const fd=Math.pow(2,14)-1,oc=-fd-1;function Ps(a){const o=kn/a.extent,c=a.loadGeometry();for(let h=0;h<c.length;h++){const g=c[h];for(let v=0;v<g.length;v++){const x=g[v],C=Math.round(x.x*o),S=Math.round(x.y*o);x.x=zn(C,oc,fd),x.y=zn(S,oc,fd),(C<x.x||C>x.x+1||S<x.y||S>x.y+1)&&pt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Dl(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?Ps(a):[]}}function Sh(a,o,c,h,g){a.emplaceBack(2*o+(h+1)/2,2*c+(g+1)/2)}class Ih{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new q,this.indexArray=new ke,this.segments=new He,this.programConfigurations=new ua(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){const g=this.layers[0],v=[];let x=null,C=!1;"circle"===g.type&&(x=g.layout.get("circle-sort-key"),C=!x.isConstant());for(const{feature:S,id:A,index:R,sourceLayerIndex:L}of o){const B=this.layers[0]._featureFilter.needGeometry,V=Dl(S,B);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),V,h))continue;const H=C?x.evaluate(V,{},h):void 0,K={id:A,properties:S.properties,type:S.type,sourceLayerIndex:L,index:R,geometry:B?V.geometry:Ps(S),patterns:{},sortKey:H};v.push(K)}C&&v.sort((S,A)=>S.sortKey-A.sortKey);for(const S of v){const{geometry:A,index:R,sourceLayerIndex:L}=S,B=o[R].feature;this.addFeature(S,A,R,h),c.featureIndex.insert(B,A,R,L,this.index)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,gt),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,h,g){for(const v of c)for(const x of v){const C=x.x,S=x.y;if(C<0||C>=kn||S<0||S>=kn)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),R=A.vertexLength;Sh(this.layoutVertexArray,C,S,-1,-1),Sh(this.layoutVertexArray,C,S,1,-1),Sh(this.layoutVertexArray,C,S,1,1),Sh(this.layoutVertexArray,C,S,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,{},g)}}function eg(a,o){for(let c=0;c<a.length;c++)if(ru(o,a[c]))return!0;for(let c=0;c<o.length;c++)if(ru(a,o[c]))return!0;return!!Mh(a,o)}function l1(a,o,c){return!!ru(a,o)||!!Gp(o,a,c)}function tg(a,o){if(1===a.length)return Wp(o,a[0]);for(let c=0;c<o.length;c++){const h=o[c];for(let g=0;g<h.length;g++)if(ru(a,h[g]))return!0}for(let c=0;c<a.length;c++)if(Wp(o,a[c]))return!0;for(let c=0;c<o.length;c++)if(Mh(a,o[c]))return!0;return!1}function da(a,o,c){if(a.length>1){if(Mh(a,o))return!0;for(let h=0;h<o.length;h++)if(Gp(o[h],a,c))return!0}for(let h=0;h<a.length;h++)if(Gp(a[h],o,c))return!0;return!1}function Mh(a,o){if(0===a.length||0===o.length)return!1;for(let c=0;c<a.length-1;c++){const h=a[c],g=a[c+1];for(let v=0;v<o.length-1;v++)if(iv(h,g,o[v],o[v+1]))return!0}return!1}function iv(a,o,c,h){return ut(a,c,h)!==ut(o,c,h)&&ut(a,o,c)!==ut(a,o,h)}function Gp(a,o,c){const h=c*c;if(1===o.length)return a.distSqr(o[0])<h;for(let g=1;g<o.length;g++)if(qp(a,o[g-1],o[g])<h)return!0;return!1}function qp(a,o,c){const h=o.distSqr(c);if(0===h)return a.distSqr(o);const g=((a.x-o.x)*(c.x-o.x)+(a.y-o.y)*(c.y-o.y))/h;return a.distSqr(g<0?o:g>1?c:c.sub(o)._mult(g)._add(o))}function Wp(a,o){let c,h,g,v=!1;for(let x=0;x<a.length;x++){c=a[x];for(let C=0,S=c.length-1;C<c.length;S=C++)h=c[C],g=c[S],h.y>o.y!=g.y>o.y&&o.x<(g.x-h.x)*(o.y-h.y)/(g.y-h.y)+h.x&&(v=!v)}return v}function ru(a,o){let c=!1;for(let h=0,g=a.length-1;h<a.length;g=h++){const v=a[h],x=a[g];v.y>o.y!=x.y>o.y&&o.x<(x.x-v.x)*(o.y-v.y)/(x.y-v.y)+v.x&&(c=!c)}return c}function Zp(a,o,c){const h=c[0],g=c[2];if(a.x<h.x&&o.x<h.x||a.x>g.x&&o.x>g.x||a.y<h.y&&o.y<h.y||a.y>g.y&&o.y>g.y)return!1;const v=ut(a,o,c[0]);return v!==ut(a,o,c[1])||v!==ut(a,o,c[2])||v!==ut(a,o,c[3])}function md(a,o,c){const h=o.paint.get(a).value;return"constant"===h.kind?h.value:c.programConfigurations.get(o.id).getMaxValue(a)}function Bo(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function gd(a,o,c,h,g){if(!o[0]&&!o[1])return a;const v=lt.convert(o)._mult(g);"viewport"===c&&v._rotate(-h);const x=[];for(let C=0;C<a.length;C++)x.push(a[C].sub(v));return x}let Xp,Hn;Je("CircleBucket",Ih,{omit:["layers"]});var Kp={get paint(){return Hn=Hn||new sn({"circle-radius":new Fe(xe.paint_circle["circle-radius"]),"circle-color":new Fe(xe.paint_circle["circle-color"]),"circle-blur":new Fe(xe.paint_circle["circle-blur"]),"circle-opacity":new Fe(xe.paint_circle["circle-opacity"]),"circle-translate":new et(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new et(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new et(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new et(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fe(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fe(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fe(xe.paint_circle["circle-stroke-opacity"])})},get layout(){return Xp=Xp||new sn({"circle-sort-key":new Fe(xe.layout_circle["circle-sort-key"])})}},tr=1e-6,nr=typeof Float32Array<"u"?Float32Array:Array;function Yp(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Qp(a,o,c){var h=o[0],g=o[1],v=o[2],x=o[3],C=o[4],S=o[5],A=o[6],R=o[7],L=o[8],B=o[9],V=o[10],H=o[11],K=o[12],W=o[13],se=o[14],ue=o[15],re=c[0],he=c[1],me=c[2],Ce=c[3];return a[0]=re*h+he*C+me*L+Ce*K,a[1]=re*g+he*S+me*B+Ce*W,a[2]=re*v+he*A+me*V+Ce*se,a[3]=re*x+he*R+me*H+Ce*ue,a[4]=(re=c[4])*h+(he=c[5])*C+(me=c[6])*L+(Ce=c[7])*K,a[5]=re*g+he*S+me*B+Ce*W,a[6]=re*v+he*A+me*V+Ce*se,a[7]=re*x+he*R+me*H+Ce*ue,a[8]=(re=c[8])*h+(he=c[9])*C+(me=c[10])*L+(Ce=c[11])*K,a[9]=re*g+he*S+me*B+Ce*W,a[10]=re*v+he*A+me*V+Ce*se,a[11]=re*x+he*R+me*H+Ce*ue,a[12]=(re=c[12])*h+(he=c[13])*C+(me=c[14])*L+(Ce=c[15])*K,a[13]=re*g+he*S+me*B+Ce*W,a[14]=re*v+he*A+me*V+Ce*se,a[15]=re*x+he*R+me*H+Ce*ue,a}Math.hypot||(Math.hypot=function(){for(var a=0,o=arguments.length;o--;)a+=arguments[o]*arguments[o];return Math.sqrt(a)});var ha,zo=Qp;function Th(a,o,c){var h=o[0],g=o[1],v=o[2],x=o[3];return a[0]=c[0]*h+c[4]*g+c[8]*v+c[12]*x,a[1]=c[1]*h+c[5]*g+c[9]*v+c[13]*x,a[2]=c[2]*h+c[6]*g+c[10]*v+c[14]*x,a[3]=c[3]*h+c[7]*g+c[11]*v+c[15]*x,a}function ng(a,o){const c=Th([],[a.x,a.y,0,1],o);return new lt(c[0]/c[3],c[1]/c[3])}ha=new nr(4),nr!=Float32Array&&(ha[0]=0,ha[1]=0,ha[2]=0,ha[3]=0);class ig extends Ih{}let ja;Je("HeatmapBucket",ig,{omit:["layers"]});var rg={get paint(){return ja=ja||new sn({"heatmap-radius":new Fe(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fe(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new et(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new oa(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new et(xe.paint_heatmap["heatmap-opacity"])})}};function Jp(a,{width:o,height:c},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==o*c*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${o*c*h}`)}else g=new Uint8Array(o*c*h);return a.width=o,a.height=c,a.data=g,a}function ef(a,{width:o,height:c},h){if(o===a.width&&c===a.height)return;const g=Jp({},{width:o,height:c},h);Ah(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,o),height:Math.min(a.height,c)},h),a.width=o,a.height=c,a.data=g.data}function Ah(a,o,c,h,g,v){if(0===g.width||0===g.height)return o;if(g.width>a.width||g.height>a.height||c.x>a.width-g.width||c.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>o.width||g.height>o.height||h.x>o.width-g.width||h.y>o.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,C=o.data;if(x===C)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<g.height;S++){const A=((c.y+S)*a.width+c.x)*v,R=((h.y+S)*o.width+h.x)*v;for(let L=0;L<g.width*v;L++)C[R+L]=x[A+L]}return o}class ou{constructor(o,c){Jp(this,o,1,c)}resize(o){ef(this,o,1)}clone(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,h,g,v){Ah(o,c,h,g,v,1)}}class Vo{constructor(o,c){Jp(this,o,4,c)}resize(o){ef(this,o,4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Vo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,h,g,v){Ah(o,c,h,g,v,4)}}function kt(a){const o={},c=a.resolution||256,h=a.clips?a.clips.length:1,g=a.image||new Vo({width:c,height:h});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const v=(x,C,S)=>{o[a.evaluationKey]=S;const A=a.expression.evaluate(o);g.data[x+C+0]=Math.floor(255*A.r/A.a),g.data[x+C+1]=Math.floor(255*A.g/A.a),g.data[x+C+2]=Math.floor(255*A.b/A.a),g.data[x+C+3]=Math.floor(255*A.a)};if(a.clips)for(let x=0,C=0;x<h;++x,C+=4*c)for(let S=0,A=0;S<c;S++,A+=4){const R=S/(c-1),{start:L,end:B}=a.clips[x];v(C,A,L*(1-R)+B*R)}else for(let x=0,C=0;x<c;x++,C+=4)v(0,C,x/(c-1));return g}let tf;Je("AlphaImage",ou),Je("RGBAImage",Vo);var c1={get paint(){return tf=tf||new sn({"hillshade-illumination-direction":new et(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new et(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new et(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new et(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new et(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new et(xe.paint_hillshade["hillshade-accent-color"])})}};const rv=An([{name:"a_pos",components:2,type:"Int16"}],4),{members:ov}=rv;var nf={exports:{}};function _d(a,o,c){c=c||2;var h,g,v,x,C,S,A,R=o&&o.length,L=R?o[0]*c:a.length,B=sc(a,0,L,c,!0),V=[];if(!B||B.next===B.prev)return V;if(R&&(B=function(K,W,se,ue){var re,he,me,Ce=[];for(re=0,he=W.length;re<he;re++)(me=sc(K,W[re]*ue,re<he-1?W[re+1]*ue:K.length,ue,!1))===me.next&&(me.steiner=!0),Ce.push(og(me));for(Ce.sort(hn),re=0;re<Ce.length;re++)se=vd(Ce[re],se);return se}(a,o,B,c)),a.length>80*c){h=v=a[0],g=x=a[1];for(var H=c;H<L;H+=c)(C=a[H])<h&&(h=C),(S=a[H+1])<g&&(g=S),C>v&&(v=C),S>x&&(x=S);A=0!==(A=Math.max(v-h,x-g))?32767/A:0}return yd(B,V,c,h,g,A,0),V}function sc(a,o,c,h,g){var v,x;if(g===af(a,o,c,h)>0)for(v=o;v<c;v+=h)x=sf(v,a[v],a[v+1],x);else for(v=c-h;v>=o;v-=h)x=sf(v,a[v],a[v+1],x);return x&&su(x,x.next)&&(ga(x),x=x.next),x}function ac(a,o){if(!a)return a;o||(o=a);var c,h=a;do{if(c=!1,h.steiner||!su(h,h.next)&&0!==ei(h.prev,h,h.next))h=h.next;else{if(ga(h),(h=o=h.prev)===h.next)break;c=!0}}while(c||h!==o);return o}function yd(a,o,c,h,g,v,x){if(a){!x&&v&&function(R,L,B,V){var H=R;do{0===H.z&&(H.z=ir(H.x,H.y,L,B,V)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next}while(H!==R);H.prevZ.nextZ=null,H.prevZ=null,function(K){var W,se,ue,re,he,me,Ce,Qe,nt=1;do{for(se=K,K=null,he=null,me=0;se;){for(me++,ue=se,Ce=0,W=0;W<nt&&(Ce++,ue=ue.nextZ);W++);for(Qe=nt;Ce>0||Qe>0&&ue;)0!==Ce&&(0===Qe||!ue||se.z<=ue.z)?(re=se,se=se.nextZ,Ce--):(re=ue,ue=ue.nextZ,Qe--),he?he.nextZ=re:K=re,re.prevZ=he,he=re;se=ue}he.nextZ=null,nt*=2}while(me>1)}(H)}(a,h,g,v);for(var C,S,A=a;a.prev!==a.next;)if(C=a.prev,S=a.next,v?av(a,h,g,v):sv(a))o.push(C.i/c|0),o.push(a.i/c|0),o.push(S.i/c|0),ga(a),a=S.next,A=S.next;else if((a=S)===A){x?1===x?yd(a=lv(ac(a),o,c),o,c,h,g,v,2):2===x&&Pe(a,o,c,h,g,v):yd(ac(a),o,c,h,g,v,1);break}}}function sv(a){var o=a.prev,c=a,h=a.next;if(ei(o,c,h)>=0)return!1;for(var g=o.x,v=c.x,x=h.x,C=o.y,S=c.y,A=h.y,R=g<v?g<x?g:x:v<x?v:x,L=C<S?C<A?C:A:S<A?S:A,B=g>v?g>x?g:x:v>x?v:x,V=C>S?C>A?C:A:S>A?S:A,H=h.next;H!==o;){if(H.x>=R&&H.x<=B&&H.y>=L&&H.y<=V&&pa(g,C,v,S,x,A,H.x,H.y)&&ei(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function av(a,o,c,h){var g=a.prev,v=a,x=a.next;if(ei(g,v,x)>=0)return!1;for(var C=g.x,S=v.x,A=x.x,R=g.y,L=v.y,B=x.y,V=C<S?C<A?C:A:S<A?S:A,H=R<L?R<B?R:B:L<B?L:B,K=C>S?C>A?C:A:S>A?S:A,W=R>L?R>B?R:B:L>B?L:B,se=ir(V,H,o,c,h),ue=ir(K,W,o,c,h),re=a.prevZ,he=a.nextZ;re&&re.z>=se&&he&&he.z<=ue;){if(re.x>=V&&re.x<=K&&re.y>=H&&re.y<=W&&re!==g&&re!==x&&pa(C,R,S,L,A,B,re.x,re.y)&&ei(re.prev,re,re.next)>=0||(re=re.prevZ,he.x>=V&&he.x<=K&&he.y>=H&&he.y<=W&&he!==g&&he!==x&&pa(C,R,S,L,A,B,he.x,he.y)&&ei(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;re&&re.z>=se;){if(re.x>=V&&re.x<=K&&re.y>=H&&re.y<=W&&re!==g&&re!==x&&pa(C,R,S,L,A,B,re.x,re.y)&&ei(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;he&&he.z<=ue;){if(he.x>=V&&he.x<=K&&he.y>=H&&he.y<=W&&he!==g&&he!==x&&pa(C,R,S,L,A,B,he.x,he.y)&&ei(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function lv(a,o,c){var h=a;do{var g=h.prev,v=h.next.next;!su(g,v)&&sg(g,h,h.next,v)&&rr(g,v)&&rr(v,g)&&(o.push(g.i/c|0),o.push(h.i/c|0),o.push(v.i/c|0),ga(h),ga(h.next),h=a=v),h=h.next}while(h!==a);return ac(h)}function Pe(a,o,c,h,g,v){var x=a;do{for(var C=x.next.next;C!==x.prev;){if(x.i!==C.i&&fa(x,C)){var S=ma(x,C);return x=ac(x,x.next),S=ac(S,S.next),yd(x,o,c,h,g,v,0),void yd(S,o,c,h,g,v,0)}C=C.next}x=x.next}while(x!==a)}function hn(a,o){return a.x-o.x}function vd(a,o){var c=function(g,v){var x,C=v,S=g.x,A=g.y,R=-1/0;do{if(A<=C.y&&A>=C.next.y&&C.next.y!==C.y){var L=C.x+(A-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(L<=S&&L>R&&(R=L,x=C.x<C.next.x?C:C.next,L===S))return x}C=C.next}while(C!==v);if(!x)return null;var B,V=x,H=x.x,K=x.y,W=1/0;C=x;do{S>=C.x&&C.x>=H&&S!==C.x&&pa(A<K?S:R,A,H,K,A<K?R:S,A,C.x,C.y)&&(B=Math.abs(A-C.y)/(S-C.x),rr(C,g)&&(B<W||B===W&&(C.x>x.x||C.x===x.x&&bd(x,C)))&&(x=C,W=B)),C=C.next}while(C!==V);return x}(a,o);if(!c)return o;var h=ma(c,a);return ac(h,h.next),ac(c,c.next)}function bd(a,o){return ei(a.prev,a,o.prev)<0&&ei(o.next,a,a.next)<0}function ir(a,o,c,h,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-h)*g|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function og(a){var o=a,c=a;do{(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next}while(o!==a);return c}function pa(a,o,c,h,g,v,x,C){return(g-x)*(o-C)>=(a-x)*(v-C)&&(a-x)*(h-C)>=(c-x)*(o-C)&&(c-x)*(v-C)>=(g-x)*(h-C)}function fa(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(c,h){var g=c;do{if(g.i!==c.i&&g.next.i!==c.i&&g.i!==h.i&&g.next.i!==h.i&&sg(g,g.next,c,h))return!0;g=g.next}while(g!==c);return!1}(a,o)&&(rr(a,o)&&rr(o,a)&&function(c,h){var g=c,v=!1,x=(c.x+h.x)/2,C=(c.y+h.y)/2;do{g.y>C!=g.next.y>C&&g.next.y!==g.y&&x<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(v=!v),g=g.next}while(g!==c);return v}(a,o)&&(ei(a.prev,a,o.prev)||ei(a,o.prev,o))||su(a,o)&&ei(a.prev,a,a.next)>0&&ei(o.prev,o,o.next)>0)}function ei(a,o,c){return(o.y-a.y)*(c.x-o.x)-(o.x-a.x)*(c.y-o.y)}function su(a,o){return a.x===o.x&&a.y===o.y}function sg(a,o,c,h){var g=xd(ei(a,o,c)),v=xd(ei(a,o,h)),x=xd(ei(c,h,a)),C=xd(ei(c,h,o));return g!==v&&x!==C||!(0!==g||!rf(a,c,o))||!(0!==v||!rf(a,h,o))||!(0!==x||!rf(c,a,h))||!(0!==C||!rf(c,o,h))}function rf(a,o,c){return o.x<=Math.max(a.x,c.x)&&o.x>=Math.min(a.x,c.x)&&o.y<=Math.max(a.y,c.y)&&o.y>=Math.min(a.y,c.y)}function xd(a){return a>0?1:a<0?-1:0}function rr(a,o){return ei(a.prev,a,a.next)<0?ei(a,o,a.next)>=0&&ei(a,a.prev,o)>=0:ei(a,o,a.prev)<0||ei(a,a.next,o)<0}function ma(a,o){var c=new Rs(a.i,a.x,a.y),h=new Rs(o.i,o.x,o.y),g=a.next,v=o.prev;return a.next=o,o.prev=a,c.next=g,g.prev=c,h.next=c,c.prev=h,v.next=h,h.prev=v,h}function sf(a,o,c,h){var g=new Rs(a,o,c);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function ga(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Rs(a,o,c){this.i=a,this.x=o,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function af(a,o,c,h){for(var g=0,v=o,x=c-h;v<c;v+=h)g+=(a[x]-a[v])*(a[v+1]+a[x+1]),x=v;return g}nf.exports=_d,nf.exports.default=_d,_d.deviation=function(a,o,c,h){var g=o&&o.length,v=Math.abs(af(a,0,g?o[0]*c:a.length,c));if(g)for(var x=0,C=o.length;x<C;x++)v-=Math.abs(af(a,o[x]*c,x<C-1?o[x+1]*c:a.length,c));var S=0;for(x=0;x<h.length;x+=3){var A=h[x]*c,R=h[x+1]*c,L=h[x+2]*c;S+=Math.abs((a[A]-a[L])*(a[R+1]-a[A+1])-(a[A]-a[R])*(a[L+1]-a[A+1]))}return 0===v&&0===S?0:Math.abs((S-v)/v)},_d.flatten=function(a){for(var o=a[0][0].length,c={vertices:[],holes:[],dimensions:o},h=0,g=0;g<a.length;g++){for(var v=0;v<a[g].length;v++)for(var x=0;x<o;x++)c.vertices.push(a[g][v][x]);g>0&&c.holes.push(h+=a[g-1].length)}return c};var lf=Qt(nf.exports);function cv(a,o,c,h,g){ag(a,o,c||0,h||a.length-1,g||cf)}function ag(a,o,c,h,g){for(;h>c;){if(h-c>600){var v=h-c+1,x=o-c+1,C=Math.log(v),S=.5*Math.exp(2*C/3),A=.5*Math.sqrt(C*S*(v-S)/v)*(x-v/2<0?-1:1);ag(a,o,Math.max(c,Math.floor(o-x*S/v+A)),Math.min(h,Math.floor(o+(v-x)*S/v+A)),g)}var R=a[o],L=c,B=h;for(lc(a,c,o),g(a[h],R)>0&&lc(a,c,h);L<B;){for(lc(a,L,B),L++,B--;g(a[L],R)<0;)L++;for(;g(a[B],R)>0;)B--}0===g(a[c],R)?lc(a,c,B):lc(a,++B,h),B<=o&&(c=B+1),o<=B&&(h=B-1)}}function lc(a,o,c){var h=a[o];a[o]=a[c],a[c]=h}function cf(a,o){return a<o?-1:a>o?1:0}function kh(a,o){const c=a.length;if(c<=1)return[a];const h=[];let g,v;for(let x=0;x<c;x++){const C=Lt(a[x]);0!==C&&(a[x].area=Math.abs(C),void 0===v&&(v=C<0),v===C<0?(g&&h.push(g),g=[a[x]]):g.push(a[x]))}if(g&&h.push(g),o>1)for(let x=0;x<h.length;x++)h[x].length<=o||(cv(h[x],o,1,h[x].length-1,uf),h[x]=h[x].slice(0,o));return h}function uf(a,o){return o.area-a.area}function df(a,o,c){const h=c.patternDependencies;let g=!1;for(const v of o){const x=v.paint.get(`${a}-pattern`);x.isConstant()||(g=!0);const C=x.constantOr(null);C&&(g=!0,h[C.to]=!0,h[C.from]=!0)}return g}function Ph(a,o,c,h,g){const v=g.patternDependencies;for(const x of o){const C=x.paint.get(`${a}-pattern`).value;if("constant"!==C.kind){let S=C.evaluate({zoom:h-1},c,{},g.availableImages),A=C.evaluate({zoom:h},c,{},g.availableImages),R=C.evaluate({zoom:h+1},c,{},g.availableImages);S=S&&S.name?S.name:S,A=A&&A.name?A.name:A,R=R&&R.name?R.name:R,v[S]=!0,v[A]=!0,v[R]=!0,c.patterns[x.id]={min:S,mid:A,max:R}}}return c}class wd{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Z,this.indexArray=new ke,this.indexArray2=new Be,this.programConfigurations=new ua(o.layers,o.zoom),this.segments=new He,this.segments2=new He,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){this.hasPattern=df("fill",this.layers,c);const g=this.layers[0].layout.get("fill-sort-key"),v=!g.isConstant(),x=[];for(const{feature:C,id:S,index:A,sourceLayerIndex:R}of o){const L=this.layers[0]._featureFilter.needGeometry,B=Dl(C,L);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),B,h))continue;const V=v?g.evaluate(B,{},h,c.availableImages):void 0,H={id:S,properties:C.properties,type:C.type,sourceLayerIndex:R,index:A,geometry:L?B.geometry:Ps(C),patterns:{},sortKey:V};x.push(H)}v&&x.sort((C,S)=>C.sortKey-S.sortKey);for(const C of x){const{geometry:S,index:A,sourceLayerIndex:R}=C;if(this.hasPattern){const L=Ph("fill",this.layers,C,this.zoom,c);this.patternFeatures.push(L)}else this.addFeature(C,S,A,h,{});c.featureIndex.insert(o[A].feature,S,A,R,this.index)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}addFeatures(o,c,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,ov),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,c,h,g,v){for(const x of kh(c,500)){let C=0;for(const V of x)C+=V.length;const S=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),A=S.vertexLength,R=[],L=[];for(const V of x){if(0===V.length)continue;V!==x[0]&&L.push(R.length/2);const H=this.segments2.prepareSegment(V.length,this.layoutVertexArray,this.indexArray2),K=H.vertexLength;this.layoutVertexArray.emplaceBack(V[0].x,V[0].y),this.indexArray2.emplaceBack(K+V.length-1,K),R.push(V[0].x),R.push(V[0].y);for(let W=1;W<V.length;W++)this.layoutVertexArray.emplaceBack(V[W].x,V[W].y),this.indexArray2.emplaceBack(K+W-1,K+W),R.push(V[W].x),R.push(V[W].y);H.vertexLength+=V.length,H.primitiveLength+=V.length}const B=lf(R,L);for(let V=0;V<B.length;V+=3)this.indexArray.emplaceBack(A+B[V],A+B[V+1],A+B[V+2]);S.vertexLength+=C,S.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,v,g)}}let hf,pf;Je("FillBucket",wd,{omit:["layers","patternFeatures"]});var lg={get paint(){return pf=pf||new sn({"fill-antialias":new et(xe.paint_fill["fill-antialias"]),"fill-opacity":new Fe(xe.paint_fill["fill-opacity"]),"fill-color":new Fe(xe.paint_fill["fill-color"]),"fill-outline-color":new Fe(xe.paint_fill["fill-outline-color"]),"fill-translate":new et(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new et(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ms(xe.paint_fill["fill-pattern"])})},get layout(){return hf=hf||new sn({"fill-sort-key":new Fe(xe.layout_fill["fill-sort-key"])})}};const cg=An([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ff=An([{name:"a_centroid",components:2,type:"Int16"}],4),{members:uv}=cg;var Sl={},to=be,Il=Bn;function Bn(a,o,c,h,g){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=h,this._values=g,a.readFields(mf,this,o)}function mf(a,o,c){1==a?o.id=c.readVarint():2==a?function(h,g){for(var v=h.readVarint()+h.pos;h.pos<v;){var x=g._keys[h.readVarint()],C=g._values[h.readVarint()];g.properties[x]=C}}(c,o):3==a?o.type=c.readVarint():4==a&&(o._geometry=c.pos)}function dv(a){for(var o,c,h=0,g=0,v=a.length,x=v-1;g<v;x=g++)h+=((c=a[x]).x-(o=a[g]).x)*(o.y+c.y);return h}Bn.types=["Unknown","Point","LineString","Polygon"],Bn.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,c=a.readVarint()+a.pos,h=1,g=0,v=0,x=0,C=[];a.pos<c;){if(g<=0){var S=a.readVarint();h=7&S,g=S>>3}if(g--,1===h||2===h)v+=a.readSVarint(),x+=a.readSVarint(),1===h&&(o&&C.push(o),o=[]),o.push(new to(v,x));else{if(7!==h)throw new Error("unknown command "+h);o&&o.push(o[0].clone())}}return o&&C.push(o),C},Bn.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,c=1,h=0,g=0,v=0,x=1/0,C=-1/0,S=1/0,A=-1/0;a.pos<o;){if(h<=0){var R=a.readVarint();c=7&R,h=R>>3}if(h--,1===c||2===c)(g+=a.readSVarint())<x&&(x=g),g>C&&(C=g),(v+=a.readSVarint())<S&&(S=v),v>A&&(A=v);else if(7!==c)throw new Error("unknown command "+c)}return[x,S,C,A]},Bn.prototype.toGeoJSON=function(a,o,c){var h,g,v=this.extent*Math.pow(2,c),x=this.extent*a,C=this.extent*o,S=this.loadGeometry(),A=Bn.types[this.type];function R(V){for(var H=0;H<V.length;H++){var K=V[H];V[H]=[360*(K.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+C)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(h=0;h<S.length;h++)L[h]=S[h][0];R(S=L);break;case 2:for(h=0;h<S.length;h++)R(S[h]);break;case 3:for(S=function(V){var H=V.length;if(H<=1)return[V];for(var K,W,se=[],ue=0;ue<H;ue++){var re=dv(V[ue]);0!==re&&(void 0===W&&(W=re<0),W===re<0?(K&&se.push(K),K=[V[ue]]):K.push(V[ue]))}return K&&se.push(K),se}(S),h=0;h<S.length;h++)for(g=0;g<S[h].length;g++)R(S[h][g])}1===S.length?S=S[0]:A="Multi"+A;var B={type:"Feature",geometry:{type:A,coordinates:S},properties:this.properties};return"id"in this&&(B.id=this.id),B};var hv=Il,ug=gf;function gf(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(dg,this,o),this.length=this._features.length}function dg(a,o,c){15===a?o.version=c.readVarint():1===a?o.name=c.readString():5===a?o.extent=c.readVarint():2===a?o._features.push(c.pos):3===a?o._keys.push(c.readString()):4===a&&o._values.push(function(h){for(var g=null,v=h.readVarint()+h.pos;h.pos<v;){var x=h.readVarint()>>3;g=1===x?h.readString():2===x?h.readFloat():3===x?h.readDouble():4===x?h.readVarint64():5===x?h.readVarint():6===x?h.readSVarint():7===x?h.readBoolean():null}return g}(c))}gf.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new hv(this._pbf,o,this.extent,this._keys,this._values)};var Rh=ug;function Ml(a,o,c){if(3===a){var h=new Rh(c,c.readVarint()+c.pos);h.length&&(o[h.name]=h)}}Sl.VectorTile=function(a,o){this.layers=a.readFields(Ml,{},o)},Sl.VectorTileFeature=Il,Sl.VectorTileLayer=ug;const pv=Sl.VectorTileFeature.types,au=Math.pow(2,13);function Tl(a,o,c,h,g,v,x,C){a.emplaceBack(o,c,2*Math.floor(h*au)+x,g*au*2,v*au*2,Math.round(C))}class lu{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new te,this.centroidVertexArray=new X,this.indexArray=new ke,this.programConfigurations=new ua(o.layers,o.zoom),this.segments=new He,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){this.features=[],this.hasPattern=df("fill-extrusion",this.layers,c);for(const{feature:g,id:v,index:x,sourceLayerIndex:C}of o){const S=this.layers[0]._featureFilter.needGeometry,A=Dl(g,S);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),A,h))continue;const R={id:v,sourceLayerIndex:C,index:x,geometry:S?A.geometry:Ps(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Ph("fill-extrusion",this.layers,R,this.zoom,c)):this.addFeature(R,R.geometry,x,h,{}),c.featureIndex.insert(g,R.geometry,x,C,this.index,!0)}}addFeatures(o,c,h){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,c,h)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,uv),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,ff.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,c,h,g,v){const x={x:0,y:0,vertexCount:0};for(const C of kh(c,500)){let S=0;for(const H of C)S+=H.length;let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const H of C){if(0===H.length||((a=H).every(o=>o.x<0)||a.every(o=>o.x>kn)||a.every(o=>o.y<0)||a.every(o=>o.y>kn)))continue;let K=0;for(let W=0;W<H.length;W++){const se=H[W];if(W>=1){const ue=H[W-1];if(!_f(se,ue)){A.vertexLength+4>He.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const re=se.sub(ue)._perp()._unit(),he=ue.dist(se);K+he>32768&&(K=0),Tl(this.layoutVertexArray,se.x,se.y,re.x,re.y,0,0,K),Tl(this.layoutVertexArray,se.x,se.y,re.x,re.y,0,1,K),x.x+=2*se.x,x.y+=2*se.y,x.vertexCount+=2,K+=he,Tl(this.layoutVertexArray,ue.x,ue.y,re.x,re.y,0,0,K),Tl(this.layoutVertexArray,ue.x,ue.y,re.x,re.y,0,1,K),x.x+=2*ue.x,x.y+=2*ue.y,x.vertexCount+=2;const me=A.vertexLength;this.indexArray.emplaceBack(me,me+2,me+1),this.indexArray.emplaceBack(me+1,me+2,me+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+S>He.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),"Polygon"!==pv[o.type])continue;const R=[],L=[],B=A.vertexLength;for(const H of C)if(0!==H.length){H!==C[0]&&L.push(R.length/2);for(let K=0;K<H.length;K++){const W=H[K];Tl(this.layoutVertexArray,W.x,W.y,0,0,1,1,0),x.x+=W.x,x.y+=W.y,x.vertexCount+=1,R.push(W.x),R.push(W.y)}}const V=lf(R,L);for(let H=0;H<V.length;H+=3)this.indexArray.emplaceBack(B+V[H],B+V[H+2],B+V[H+1]);A.primitiveLength+=V.length/3,A.vertexLength+=S}var a;for(let C=0;C<x.vertexCount;C++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,v,g)}}function _f(a,o){return a.x===o.x&&(a.x<0||a.x>kn)||a.y===o.y&&(a.y<0||a.y>kn)}let yf;Je("FillExtrusionBucket",lu,{omit:["layers","features"]});var fv={get paint(){return yf=yf||new sn({"fill-extrusion-opacity":new et(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fe(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new et(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new et(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ms(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fe(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fe(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new et(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function _a(a,o){return a.x*o.x+a.y*o.y}function cu(a,o){if(1===a.length){let c=0;const h=o[c++];let g;for(;!g||h.equals(g);)if(g=o[c++],!g)return 1/0;for(;c<o.length;c++){const v=o[c],x=a[0],C=g.sub(h),S=v.sub(h),A=x.sub(h),R=_a(C,C),L=_a(C,S),B=_a(S,S),V=_a(A,C),H=_a(A,S),K=R*B-L*L,W=(B*V-L*H)/K,se=(R*H-L*V)/K,ue=h.z*(1-W-se)+g.z*W+v.z*se;if(isFinite(ue))return ue}return 1/0}{let c=1/0;for(const h of o)c=Math.min(c,h.z);return c}}const mv=An([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:u1}=mv,vf=An([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:d1}=vf,gv=Sl.VectorTileFeature.types,_v=Math.cos(Math.PI/180*37.5),yv=Math.pow(2,14)/.5;class pg{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new le,this.layoutVertexArray2=new fe,this.indexArray=new ke,this.programConfigurations=new ua(o.layers,o.zoom),this.segments=new He,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,h){this.hasPattern=df("line",this.layers,c);const g=this.layers[0].layout.get("line-sort-key"),v=!g.isConstant(),x=[];for(const{feature:C,id:S,index:A,sourceLayerIndex:R}of o){const L=this.layers[0]._featureFilter.needGeometry,B=Dl(C,L);if(!this.layers[0]._featureFilter.filter(new Le(this.zoom),B,h))continue;const V=v?g.evaluate(B,{},h):void 0,H={id:S,properties:C.properties,type:C.type,sourceLayerIndex:R,index:A,geometry:L?B.geometry:Ps(C),patterns:{},sortKey:V};x.push(H)}v&&x.sort((C,S)=>C.sortKey-S.sortKey);for(const C of x){const{geometry:S,index:A,sourceLayerIndex:R}=C;if(this.hasPattern){const L=Ph("line",this.layers,C,this.zoom,c);this.patternFeatures.push(L)}else this.addFeature(C,S,A,h,{});c.featureIndex.insert(o[A].feature,S,A,R,this.index)}}update(o,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,h)}addFeatures(o,c,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,c,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,d1)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,u1),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,h,g,v){const x=this.layers[0].layout,C=x.get("line-join").evaluate(o,{}),S=x.get("line-cap"),A=x.get("line-miter-limit"),R=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const L of c)this.addLine(L,o,C,S,A,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,v,g)}addLine(o,c,h,g,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<o.length-1;se++)this.totalDistance+=o[se].dist(o[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C="Polygon"===gv[c.type];let S=o.length;for(;S>=2&&o[S-1].equals(o[S-2]);)S--;let A=0;for(;A<S-1&&o[A].equals(o[A+1]);)A++;if(S<(C?3:2))return;"bevel"===h&&(v=1.05);const R=this.overscaling<=16?15*kn/(512*this.overscaling):0,L=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let B,V,H,K,W;this.e1=this.e2=-1,C&&(B=o[S-2],W=o[A].sub(B)._unit()._perp());for(let se=A;se<S;se++){if(H=se===S-1?C?o[A+1]:void 0:o[se+1],H&&o[se].equals(H))continue;W&&(K=W),B&&(V=B),B=o[se],W=H?H.sub(B)._unit()._perp():K,K=K||W;let ue=K.add(W);0===ue.x&&0===ue.y||ue._unit();const re=K.x*W.x+K.y*W.y,he=ue.x*W.x+ue.y*W.y,me=0!==he?1/he:1/0,Ce=2*Math.sqrt(2-2*he),Qe=he<_v&&V&&H,nt=K.x*W.y-K.y*W.x>0;if(Qe&&se>A){const Ue=B.dist(V);if(Ue>2*R){const Ze=B.sub(B.sub(V)._mult(R/Ue)._round());this.updateDistance(V,Ze),this.addCurrentVertex(Ze,K,0,0,L),V=Ze}}const Ke=V&&H;let Ge=Ke?h:C?"butt":g;if(Ke&&"round"===Ge&&(me<x?Ge="miter":me<=2&&(Ge="fakeround")),"miter"===Ge&&me>v&&(Ge="bevel"),"bevel"===Ge&&(me>2&&(Ge="flipbevel"),me<v&&(Ge="miter")),V&&this.updateDistance(V,B),"miter"===Ge)ue._mult(me),this.addCurrentVertex(B,ue,0,0,L);else if("flipbevel"===Ge){if(me>100)ue=W.mult(-1);else{const Ue=me*K.add(W).mag()/K.sub(W).mag();ue._perp()._mult(Ue*(nt?-1:1))}this.addCurrentVertex(B,ue,0,0,L),this.addCurrentVertex(B,ue.mult(-1),0,0,L)}else if("bevel"===Ge||"fakeround"===Ge){const Ue=-Math.sqrt(me*me-1),Ze=nt?Ue:0,qe=nt?0:Ue;if(V&&this.addCurrentVertex(B,K,Ze,qe,L),"fakeround"===Ge){const Re=Math.round(180*Ce/Math.PI/20);for(let ht=1;ht<Re;ht++){let rt=ht/Re;if(.5!==rt){const Pn=rt-.5;rt+=rt*Pn*(rt-1)*((1.0904+re*(re*(3.55645-1.43519*re)-3.2452))*Pn*Pn+(.848013+re*(.215638*re-1.06021)))}const zt=W.sub(K)._mult(rt)._add(K)._unit()._mult(nt?-1:1);this.addHalfVertex(B,zt.x,zt.y,!1,nt,0,L)}}H&&this.addCurrentVertex(B,W,-Ze,-qe,L)}else if("butt"===Ge)this.addCurrentVertex(B,ue,0,0,L);else if("square"===Ge){const Ue=V?1:-1;this.addCurrentVertex(B,ue,Ue,Ue,L)}else"round"===Ge&&(V&&(this.addCurrentVertex(B,K,0,0,L),this.addCurrentVertex(B,K,1,1,L,!0)),H&&(this.addCurrentVertex(B,W,-1,-1,L,!0),this.addCurrentVertex(B,W,0,0,L)));if(Qe&&se<S-1){const Ue=B.dist(H);if(Ue>2*R){const Ze=B.add(H.sub(B)._mult(R/Ue)._round());this.updateDistance(B,Ze),this.addCurrentVertex(Ze,W,0,0,L),B=Ze}}}}addCurrentVertex(o,c,h,g,v,x=!1){const C=c.y*g-c.x,S=-c.y-c.x*g;this.addHalfVertex(o,c.x+c.y*h,c.y-c.x*h,x,!1,h,v),this.addHalfVertex(o,C,S,x,!0,-g,v),this.distance>yv/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(o,c,h,g,v,x))}addHalfVertex({x:o,y:c},h,g,v,x,C,S){const A=.5*(this.lineClips?this.scaledDistance*(yv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(v?1:0),(c<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(0===C?0:C<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),S.primitiveLength++),x?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,c){this.distance+=o.dist(c),this.updateScaledDistance()}}let Fh,uu;Je("LineBucket",pg,{omit:["layers","patternFeatures"]});var fg={get paint(){return uu=uu||new sn({"line-opacity":new Fe(xe.paint_line["line-opacity"]),"line-color":new Fe(xe.paint_line["line-color"]),"line-translate":new et(xe.paint_line["line-translate"]),"line-translate-anchor":new et(xe.paint_line["line-translate-anchor"]),"line-width":new Fe(xe.paint_line["line-width"]),"line-gap-width":new Fe(xe.paint_line["line-gap-width"]),"line-offset":new Fe(xe.paint_line["line-offset"]),"line-blur":new Fe(xe.paint_line["line-blur"]),"line-dasharray":new nu(xe.paint_line["line-dasharray"]),"line-pattern":new Ms(xe.paint_line["line-pattern"]),"line-gradient":new oa(xe.paint_line["line-gradient"])})},get layout(){return Fh=Fh||new sn({"line-cap":new et(xe.layout_line["line-cap"]),"line-join":new Fe(xe.layout_line["line-join"]),"line-miter-limit":new et(xe.layout_line["line-miter-limit"]),"line-round-limit":new et(xe.layout_line["line-round-limit"]),"line-sort-key":new Fe(xe.layout_line["line-sort-key"])})}};class Ed extends Fe{possiblyEvaluate(o,c){return c=new Le(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(o,c)}evaluate(o,c,h,g){return c=Ci({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(o,c,h,g)}}let du;function Cd(a,o){return o>0?o+2*a:a}const h1=An([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mg=An([{name:"a_projected_pos",components:3,type:"Float32"}],4);An([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gg=An([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);An([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _g=An([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ya=An([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function vv(a,o,c){return a.sections.forEach(h=>{h.text=function(g,v,x){const C=v.layout.get("text-transform").evaluate(x,{});return"uppercase"===C?g=g.toLocaleUpperCase():"lowercase"===C&&(g=g.toLocaleLowerCase()),cn.applyArabicShaping&&(g=cn.applyArabicShaping(g)),g}(h.text,o,c)}),a}An([{name:"triangle",components:3,type:"Uint16"}]),An([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),An([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),An([{type:"Float32",name:"offsetX"}]),An([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Al={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var bi=24,bf=En,Dd=function(a,o,c,h,g){var v,x,C=8*g-h-1,S=(1<<C)-1,A=S>>1,R=-7,L=c?g-1:0,B=c?-1:1,V=a[o+L];for(L+=B,v=V&(1<<-R)-1,V>>=-R,R+=C;R>0;v=256*v+a[o+L],L+=B,R-=8);for(x=v&(1<<-R)-1,v>>=-R,R+=h;R>0;x=256*x+a[o+L],L+=B,R-=8);if(0===v)v=1-A;else{if(v===S)return x?NaN:1/0*(V?-1:1);x+=Math.pow(2,h),v-=A}return(V?-1:1)*x*Math.pow(2,v-h)},Oh=function(a,o,c,h,g,v){var x,C,S,A=8*v-g-1,R=(1<<A)-1,L=R>>1,B=23===g?Math.pow(2,-24)-Math.pow(2,-77):0,V=h?0:v-1,H=h?1:-1,K=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(C=isNaN(o)?1:0,x=R):(x=Math.floor(Math.log(o)/Math.LN2),o*(S=Math.pow(2,-x))<1&&(x--,S*=2),(o+=x+L>=1?B/S:B*Math.pow(2,1-L))*S>=2&&(x++,S/=2),x+L>=R?(C=0,x=R):x+L>=1?(C=(o*S-1)*Math.pow(2,g),x+=L):(C=o*Math.pow(2,L-1)*Math.pow(2,g),x=0));g>=8;a[c+V]=255&C,V+=H,C/=256,g-=8);for(x=x<<g|C,A+=g;A>0;a[c+V]=255&x,V+=H,x/=256,A-=8);a[c+V-H]|=128*K};function En(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}En.Varint=0,En.Fixed64=1,En.Bytes=2,En.Fixed32=5;var Lh=4294967296,xf=1/Lh,wf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function va(a){return a.type===En.Bytes?a.readVarint()+a.pos:a.pos+1}function Sd(a,o,c){var h=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));c.realloc(h);for(var g=c.pos-1;g>=a;g--)c.buf[g+h]=c.buf[g]}function cc(a,o){for(var c=0;c<a.length;c++)o.writeVarint(a[c])}function bv(a,o){for(var c=0;c<a.length;c++)o.writeSVarint(a[c])}function yg(a,o){for(var c=0;c<a.length;c++)o.writeFloat(a[c])}function vg(a,o){for(var c=0;c<a.length;c++)o.writeDouble(a[c])}function Id(a,o){for(var c=0;c<a.length;c++)o.writeBoolean(a[c])}function xv(a,o){for(var c=0;c<a.length;c++)o.writeFixed32(a[c])}function no(a,o){for(var c=0;c<a.length;c++)o.writeSFixed32(a[c])}function wv(a,o){for(var c=0;c<a.length;c++)o.writeFixed64(a[c])}function ki(a,o){for(var c=0;c<a.length;c++)o.writeSFixed64(a[c])}function pu(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function fu(a,o,c){a[c]=o,a[c+1]=o>>>8,a[c+2]=o>>>16,a[c+3]=o>>>24}function Ef(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}En.prototype={destroy:function(){this.buf=null},readFields:function(a,o,c){for(c=c||this.length;this.pos<c;){var h=this.readVarint(),g=h>>3,v=this.pos;this.type=7&h,a(g,o,this),this.pos===v&&this.skip(h)}return o},readMessage:function(a,o){return this.readFields(a,o,this.readVarint()+this.pos)},readFixed32:function(){var a=pu(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Ef(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=pu(this.buf,this.pos)+pu(this.buf,this.pos+4)*Lh;return this.pos+=8,a},readSFixed64:function(){var a=pu(this.buf,this.pos)+Ef(this.buf,this.pos+4)*Lh;return this.pos+=8,a},readFloat:function(){var a=Dd(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Dd(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var o,c,h=this.buf;return o=127&(c=h[this.pos++]),c<128?o:(o|=(127&(c=h[this.pos++]))<<7,c<128?o:(o|=(127&(c=h[this.pos++]))<<14,c<128?o:(o|=(127&(c=h[this.pos++]))<<21,c<128?o:function(g,v,x){var C,S,A=x.buf;if(C=(112&(S=A[x.pos++]))>>4,S<128||(C|=(127&(S=A[x.pos++]))<<3,S<128)||(C|=(127&(S=A[x.pos++]))<<10,S<128)||(C|=(127&(S=A[x.pos++]))<<17,S<128)||(C|=(127&(S=A[x.pos++]))<<24,S<128)||(C|=(1&(S=A[x.pos++]))<<31,S<128))return function hu(a,o,c){return c?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}(g,C,v);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(c=h[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,o=this.pos;return this.pos=a,a-o>=12&&wf?wf.decode(this.buf.subarray(o,a)):function(c,h,g){for(var v="",x=h;x<g;){var C,S,A,R=c[x],L=null,B=R>239?4:R>223?3:R>191?2:1;if(x+B>g)break;1===B?R<128&&(L=R):2===B?128==(192&(C=c[x+1]))&&(L=(31&R)<<6|63&C)<=127&&(L=null):3===B?(S=c[x+2],128==(192&(C=c[x+1]))&&128==(192&S)&&((L=(15&R)<<12|(63&C)<<6|63&S)<=2047||L>=55296&&L<=57343)&&(L=null)):4===B&&(S=c[x+2],A=c[x+3],128==(192&(C=c[x+1]))&&128==(192&S)&&128==(192&A)&&((L=(15&R)<<18|(63&C)<<12|(63&S)<<6|63&A)<=65535||L>=1114112)&&(L=null)),null===L?(L=65533,B=1):L>65535&&(L-=65536,v+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),v+=String.fromCharCode(L),x+=B}return v}(this.buf,o,a)},readBytes:function(){var a=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,a);return this.pos=a,o},readPackedVarint:function(a,o){if(this.type!==En.Bytes)return a.push(this.readVarint(o));var c=va(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==En.Bytes)return a.push(this.readSVarint());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==En.Bytes)return a.push(this.readBoolean());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==En.Bytes)return a.push(this.readFloat());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==En.Bytes)return a.push(this.readDouble());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==En.Bytes)return a.push(this.readFixed32());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==En.Bytes)return a.push(this.readSFixed32());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==En.Bytes)return a.push(this.readFixed64());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==En.Bytes)return a.push(this.readSFixed64());var o=va(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var o=7&a;if(o===En.Varint)for(;this.buf[this.pos++]>127;);else if(o===En.Bytes)this.pos=this.readVarint()+this.pos;else if(o===En.Fixed32)this.pos+=4;else{if(o!==En.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(a,o){this.writeVarint(a<<3|o)},realloc:function(a){for(var o=this.length||16;o<this.pos+a;)o*=2;if(o!==this.length){var c=new Uint8Array(o);c.set(this.buf),this.buf=c,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),fu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),fu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),fu(this.buf,-1&a,this.pos),fu(this.buf,Math.floor(a*xf),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),fu(this.buf,-1&a,this.pos),fu(this.buf,Math.floor(a*xf),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(o,c){var h,g,v,C;if(o>=0?(h=o%4294967296|0,g=o/4294967296|0):(g=~(-o/4294967296),4294967295^(h=~(-o%4294967296))?h=h+1|0:(h=0,g=g+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),v=h,(C=c).buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,C.buf[C.pos]=127&(v>>>=7),function(v,x){var C=(7&v)<<4;x.buf[x.pos++]|=C|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(g,c)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(h,g,v){for(var x,C,S=0;S<g.length;S++){if((x=g.charCodeAt(S))>55295&&x<57344){if(!C){x>56319||S+1===g.length?(h[v++]=239,h[v++]=191,h[v++]=189):C=x;continue}if(x<56320){h[v++]=239,h[v++]=191,h[v++]=189,C=x;continue}x=C-55296<<10|x-56320|65536,C=null}else C&&(h[v++]=239,h[v++]=191,h[v++]=189,C=null);x<128?h[v++]=x:(x<2048?h[v++]=x>>6|192:(x<65536?h[v++]=x>>12|224:(h[v++]=x>>18|240,h[v++]=x>>12&63|128),h[v++]=x>>6&63|128),h[v++]=63&x|128)}return v}(this.buf,a,this.pos);var c=this.pos-o;c>=128&&Sd(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),Oh(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Oh(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var o=a.length;this.writeVarint(o),this.realloc(o);for(var c=0;c<o;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,o){this.pos++;var c=this.pos;a(o,this);var h=this.pos-c;h>=128&&Sd(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeMessage:function(a,o,c){this.writeTag(a,En.Bytes),this.writeRawMessage(o,c)},writePackedVarint:function(a,o){o.length&&this.writeMessage(a,cc,o)},writePackedSVarint:function(a,o){o.length&&this.writeMessage(a,bv,o)},writePackedBoolean:function(a,o){o.length&&this.writeMessage(a,Id,o)},writePackedFloat:function(a,o){o.length&&this.writeMessage(a,yg,o)},writePackedDouble:function(a,o){o.length&&this.writeMessage(a,vg,o)},writePackedFixed32:function(a,o){o.length&&this.writeMessage(a,xv,o)},writePackedSFixed32:function(a,o){o.length&&this.writeMessage(a,no,o)},writePackedFixed64:function(a,o){o.length&&this.writeMessage(a,wv,o)},writePackedSFixed64:function(a,o){o.length&&this.writeMessage(a,ki,o)},writeBytesField:function(a,o){this.writeTag(a,En.Bytes),this.writeBytes(o)},writeFixed32Field:function(a,o){this.writeTag(a,En.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(a,o){this.writeTag(a,En.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(a,o){this.writeTag(a,En.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(a,o){this.writeTag(a,En.Fixed64),this.writeSFixed64(o)},writeVarintField:function(a,o){this.writeTag(a,En.Varint),this.writeVarint(o)},writeSVarintField:function(a,o){this.writeTag(a,En.Varint),this.writeSVarint(o)},writeStringField:function(a,o){this.writeTag(a,En.Bytes),this.writeString(o)},writeFloatField:function(a,o){this.writeTag(a,En.Fixed32),this.writeFloat(o)},writeDoubleField:function(a,o){this.writeTag(a,En.Fixed64),this.writeDouble(o)},writeBooleanField:function(a,o){this.writeVarintField(a,!!o)}};var kl=Qt(bf);const Pl=3;function mu(a,o,c){1===a&&c.readMessage(gu,o)}function gu(a,o,c){if(3===a){const{id:h,bitmap:g,width:v,height:x,left:C,top:S,advance:A}=c.readMessage(bg,{});o.push({id:h,bitmap:new ou({width:v+2*Pl,height:x+2*Pl},g),metrics:{width:v,height:x,left:C,top:S,advance:A}})}}function bg(a,o,c){1===a?o.id=c.readVarint():2===a?o.bitmap=c.readBytes():3===a?o.width=c.readVarint():4===a?o.height=c.readVarint():5===a?o.left=c.readSVarint():6===a?o.top=c.readSVarint():7===a&&(o.advance=c.readVarint())}const Nh=Pl;function uc(a){let o=0,c=0;for(const x of a)o+=x.w*x.h,c=Math.max(c,x.w);a.sort((x,C)=>C.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let g=0,v=0;for(const x of a)for(let C=h.length-1;C>=0;C--){const S=h[C];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,v=Math.max(v,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===S.w&&x.h===S.h){const A=h.pop();C<h.length&&(h[C]=A)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(h.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:g,h:v,fill:o/(g*v)||0}}const go=1;class Cf{constructor(o,{pixelRatio:c,version:h,stretchX:g,stretchY:v,content:x}){this.paddedRect=o,this.pixelRatio=c,this.stretchX=g,this.stretchY=v,this.content=x,this.version=h}get tl(){return[this.paddedRect.x+go,this.paddedRect.y+go]}get br(){return[this.paddedRect.x+this.paddedRect.w-go,this.paddedRect.y+this.paddedRect.h-go]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*go)/this.pixelRatio,(this.paddedRect.h-2*go)/this.pixelRatio]}}class Ev{constructor(o,c){const h={},g={};this.haveRenderCallbacks=[];const v=[];this.addImages(o,h,v),this.addImages(c,g,v);const{w:x,h:C}=uc(v),S=new Vo({width:x||1,height:C||1});for(const A in o){const R=o[A],L=h[A].paddedRect;Vo.copy(R.data,S,{x:0,y:0},{x:L.x+go,y:L.y+go},R.data)}for(const A in c){const R=c[A],L=g[A].paddedRect,B=L.x+go,V=L.y+go,H=R.data.width,K=R.data.height;Vo.copy(R.data,S,{x:0,y:0},{x:B,y:V},R.data),Vo.copy(R.data,S,{x:0,y:K-1},{x:B,y:V-1},{width:H,height:1}),Vo.copy(R.data,S,{x:0,y:0},{x:B,y:V+K},{width:H,height:1}),Vo.copy(R.data,S,{x:H-1,y:0},{x:B-1,y:V},{width:1,height:K}),Vo.copy(R.data,S,{x:0,y:0},{x:B+H,y:V},{width:1,height:K})}this.image=S,this.iconPositions=h,this.patternPositions=g}addImages(o,c,h){for(const g in o){const v=o[g],x={x:0,y:0,w:v.data.width+2*go,h:v.data.height+2*go};h.push(x),c[g]=new Cf(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(o,c){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in o.updatedImages)this.patchUpdatedImage(this.iconPositions[h],o.getImage(h),c),this.patchUpdatedImage(this.patternPositions[h],o.getImage(h),c)}patchUpdatedImage(o,c,h){if(!o||!c||o.version===c.version)return;o.version=c.version;const[g,v]=o.tl;h.update(c.data,void 0,{x:g,y:v})}}var dc;Je("ImagePosition",Cf),Je("ImageAtlas",Ev),y.WritingMode=void 0,(dc=y.WritingMode||(y.WritingMode={}))[dc.none=0]="none",dc[dc.horizontal=1]="horizontal",dc[dc.vertical=2]="vertical",dc[dc.horizontalOnly=3]="horizontalOnly";const Bh=-17;class zh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,c){const h=new zh;return h.scale=o||1,h.fontStack=c,h}static forImage(o){const c=new zh;return c.imageName=o,c}}class Md{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c){const h=new Md;for(let g=0;g<o.sections.length;g++){const v=o.sections[g];v.image?h.addImageSection(v):h.addTextSection(v,c)}return h}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let c="";for(let h=0;h<o.length;h++){const g=o.charCodeAt(h+1)||null,v=o.charCodeAt(h-1)||null;c+=g&&di(g)&&!Al[o[h+1]]||v&&di(v)&&!Al[o[h-1]]||!Al[o[h]]?o[h]:Al[o[h]]}return c}(this.text)}trim(){let o=0;for(let h=0;h<this.text.length&&Ha[this.text.charCodeAt(h)];h++)o++;let c=this.text.length;for(let h=this.text.length-1;h>=0&&h>=o&&Ha[this.text.charCodeAt(h)];h--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const h=new Md;return h.text=this.text.substring(o,c),h.sectionIndex=this.sectionIndex.slice(o,c),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(zh.forText(o.scale,o.fontStack||c));const h=this.sections.length-1;for(let g=0;g<o.text.length;++g)this.sectionIndex.push(h)}addImageSection(o){const c=o.image?o.image.name:"";if(0===c.length)return void pt("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(zh.forImage(c)),this.sectionIndex.push(this.sections.length-1)):pt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Df(a,o,c,h,g,v,x,C,S,A,R,L,B,V,H,K){const W=Md.fromFeature(a,g);let se;L===y.WritingMode.vertical&&W.verticalizePunctuation();const{processBidirectionalText:ue,processStyledBidirectionalText:re}=cn;if(ue&&1===W.sections.length){se=[];const Ce=ue(W.toString(),_o(W,A,v,o,h,V,H));for(const Qe of Ce){const nt=new Md;nt.text=Qe,nt.sections=W.sections;for(let Ke=0;Ke<Qe.length;Ke++)nt.sectionIndex.push(0);se.push(nt)}}else if(re){se=[];const Ce=re(W.text,W.sectionIndex,_o(W,A,v,o,h,V,H));for(const Qe of Ce){const nt=new Md;nt.text=Qe[0],nt.sectionIndex=Qe[1],nt.sections=W.sections,se.push(nt)}}else se=function(Ce,Qe){const nt=[],Ke=Ce.text;let Ge=0;for(const Ue of Qe)nt.push(Ce.substring(Ge,Ue)),Ge=Ue;return Ge<Ke.length&&nt.push(Ce.substring(Ge,Ke.length)),nt}(W,_o(W,A,v,o,h,V,H));const he=[],me={positionedLines:he,text:W.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Ce,Qe,nt,Ke,Ge,Ue,Ze,qe,Re,ht,rt,zt){let Pn=0,gn=Bh,xi=0,yo=0;const _r="right"===qe?1:"left"===qe?0:.5;let Pi=0;for(const fi of Ge){fi.trim();const Hi=fi.getMaxScale(),br=(Hi-1)*bi,or={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[Pi]=or;const sr=or.positionedGlyphs;let $r=0;if(!fi.length()){gn+=Ue,++Pi;continue}for(let Ri=0;Ri<fi.length();Ri++){const Ut=fi.getSection(Ri),Gr=fi.getSectionIndex(Ri),wi=fi.getCharCode(Ri);let Pr=0,jo=null,Fs=null,Os=null,qa=bi;const Ho=!(Re===y.WritingMode.horizontal||!rt&&!Jc(wi)||rt&&(Ha[wi]||(pi=wi,Xe.Arabic(pi)||Xe["Arabic Supplement"](pi)||Xe["Arabic Extended-A"](pi)||Xe["Arabic Presentation Forms-A"](pi)||Xe["Arabic Presentation Forms-B"](pi))));if(Ut.imageName){const vo=Ke[Ut.imageName];if(!vo)continue;Os=Ut.imageName,Ce.iconsInText=Ce.iconsInText||!0,Fs=vo.paddedRect;const xr=vo.displaySize;Ut.scale=Ut.scale*bi/zt,jo={width:xr[0],height:xr[1],left:go,top:-Nh,advance:Ho?xr[1]:xr[0]},Pr=br+(bi-xr[1]*Ut.scale),qa=jo.advance;const Ls=Ho?xr[0]*Ut.scale-bi*Hi:xr[1]*Ut.scale-bi*Hi;Ls>0&&Ls>$r&&($r=Ls)}else{const vo=nt[Ut.fontStack],xr=vo&&vo[wi];if(xr&&xr.rect)Fs=xr.rect,jo=xr.metrics;else{const Ls=Qe[Ut.fontStack],wa=Ls&&Ls[wi];if(!wa)continue;jo=wa.metrics}Pr=(Hi-Ut.scale)*bi}Ho?(Ce.verticalizable=!0,sr.push({glyph:wi,imageName:Os,x:Pn,y:gn+Pr,vertical:Ho,scale:Ut.scale,fontStack:Ut.fontStack,sectionIndex:Gr,metrics:jo,rect:Fs}),Pn+=qa*Ut.scale+ht):(sr.push({glyph:wi,imageName:Os,x:Pn,y:gn+Pr,vertical:Ho,scale:Ut.scale,fontStack:Ut.fontStack,sectionIndex:Gr,metrics:jo,rect:Fs}),Pn+=jo.advance*Ut.scale+ht)}0!==sr.length&&(xi=Math.max(Pn-ht,xi),Eg(sr,0,sr.length-1,_r,$r)),Pn=0;const Zn=Ue*Hi+$r;or.lineOffset=Math.max($r,br),gn+=Zn,yo=Math.max(Zn,yo),++Pi}var pi;const yr=gn-Bh,{horizontalAlign:vr,verticalAlign:Hr}=Rl(Ze);(function(fi,Hi,br,or,sr,$r,Zn,Ri,Ut){const Gr=(Hi-br)*sr;let wi=0;wi=$r!==Zn?-Ri*or-Bh:(-or*Ut+.5)*Zn;for(const Pr of fi)for(const jo of Pr.positionedGlyphs)jo.x+=Gr,jo.y+=wi})(Ce.positionedLines,_r,vr,Hr,xi,yo,Ue,yr,Ge.length),Ce.top+=-Hr*yr,Ce.bottom=Ce.top+yr,Ce.left+=-vr*xi,Ce.right=Ce.left+xi}(me,o,c,h,se,x,C,S,L,A,B,K),!function(Ce){for(const Qe of Ce)if(0!==Qe.positionedGlyphs.length)return!1;return!0}(he)&&me}const Ha={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Cv={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xg(a,o,c,h,g,v){if(o.imageName){const x=h[o.imageName];return x?x.displaySize[0]*o.scale*bi/v+g:0}{const x=c[o.fontStack],C=x&&x[a];return C?C.metrics.advance*o.scale+g:0}}function Ui(a,o,c,h){const g=Math.pow(a-o,2);return h?a<o?g/2:2*g:g+Math.abs(c)*c}function Dv(a,o,c){let h=0;return 10===a&&(h-=1e4),c&&(h+=150),40!==a&&65288!==a||(h+=50),41!==o&&65289!==o||(h+=50),h}function _u(a,o,c,h,g,v){let x=null,C=Ui(o,c,g,v);for(const S of h){const A=Ui(o-S.x,c,g,v)+S.badness;A<=C&&(x=S,C=A)}return{index:a,x:o,priorBreak:x,badness:C}}function wg(a){return a?wg(a.priorBreak).concat(a.index):[]}function _o(a,o,c,h,g,v,x){if("point"!==v)return[];if(!a)return[];const C=[],S=function(B,V,H,K,W,se){let ue=0;for(let re=0;re<B.length();re++){const he=B.getSection(re);ue+=xg(B.getCharCode(re),he,K,W,V,se)}return ue/Math.max(1,Math.ceil(ue/H))}(a,o,c,h,g,x),A=a.text.indexOf("\u200b")>=0;let R=0;for(let B=0;B<a.length();B++){const V=a.getSection(B),H=a.getCharCode(B);if(Ha[H]||(R+=xg(H,V,h,g,o,x)),B<a.length()-1){const K=!((L=H)<11904||!(Xe["Bopomofo Extended"](L)||Xe.Bopomofo(L)||Xe["CJK Compatibility Forms"](L)||Xe["CJK Compatibility Ideographs"](L)||Xe["CJK Compatibility"](L)||Xe["CJK Radicals Supplement"](L)||Xe["CJK Strokes"](L)||Xe["CJK Symbols and Punctuation"](L)||Xe["CJK Unified Ideographs Extension A"](L)||Xe["CJK Unified Ideographs"](L)||Xe["Enclosed CJK Letters and Months"](L)||Xe["Halfwidth and Fullwidth Forms"](L)||Xe.Hiragana(L)||Xe["Ideographic Description Characters"](L)||Xe["Kangxi Radicals"](L)||Xe["Katakana Phonetic Extensions"](L)||Xe.Katakana(L)||Xe["Vertical Forms"](L)||Xe["Yi Radicals"](L)||Xe["Yi Syllables"](L)));(Cv[H]||K||V.imageName)&&C.push(_u(B+1,R,S,C,Dv(H,a.getCharCode(B+1),K&&A),!1))}}var L;return wg(_u(a.length(),R,S,C,0,!0))}function Rl(a){let o=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function Eg(a,o,c,h,g){if(!h&&!g)return;const v=a[c],x=(a[c].x+v.metrics.advance*v.scale)*h;for(let C=o;C<=c;C++)a[C].x-=x,a[C].y+=g}function Vh(a,o,c){const{horizontalAlign:h,verticalAlign:g}=Rl(c),v=o[0]-a.displaySize[0]*h,x=o[1]-a.displaySize[1]*g;return{image:a,top:x,bottom:x+a.displaySize[1],left:v,right:v+a.displaySize[0]}}function yu(a,o,c,h,g,v){const x=a.image;let C;if(x.content){const W=x.content,se=x.pixelRatio||1;C=[W[0]/se,W[1]/se,x.displaySize[0]-W[2]/se,x.displaySize[1]-W[3]/se]}const S=o.left*v,A=o.right*v;let R,L,B,V;"width"===c||"both"===c?(V=g[0]+S-h[3],L=g[0]+A+h[1]):(V=g[0]+(S+A-x.displaySize[0])/2,L=V+x.displaySize[0]);const H=o.top*v,K=o.bottom*v;return"height"===c||"both"===c?(R=g[1]+H-h[0],B=g[1]+K+h[2]):(R=g[1]+(H+K-x.displaySize[1])/2,B=R+x.displaySize[1]),{image:x,top:R,right:L,bottom:B,left:V,collisionPadding:C}}const Td=255,$a=128,Fl=Td*$a;function Sv(a,o){const{expression:c}=o;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new Le(a+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:h,interpolationType:g}=c;let v=0;for(;v<h.length&&h[v]<=a;)v++;v=Math.max(0,v-1);let x=v;for(;x<h.length&&h[x]<a+1;)x++;x=Math.min(h.length-1,x);const C=h[v],S=h[x];return"composite"===c.kind?{kind:"composite",minZoom:C,maxZoom:S,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:S,minSize:c.evaluate(new Le(C)),maxSize:c.evaluate(new Le(S)),interpolationType:g}}}function io(a,o,c){let h="never";const g=a.get(o);return g?h=g:a.get(c)&&(h="always"),h}const Sf=Sl.VectorTileFeature.types,vu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function If(a,o,c,h,g,v,x,C,S,A,R,L,B){const V=C?Math.min(Fl,Math.round(C[0])):0,H=C?Math.min(Fl,Math.round(C[1])):0;a.emplaceBack(o,c,Math.round(32*h),Math.round(32*g),v,x,(V<<1)+(S?1:0),H,16*A,16*R,256*L,256*B)}function Uh(a,o,c){a.emplaceBack(o.x,o.y,c),a.emplaceBack(o.x,o.y,c),a.emplaceBack(o.x,o.y,c),a.emplaceBack(o.x,o.y,c)}function Iv(a){for(const o of a.sections)if(mt(o.text))return!0;return!1}class Mf{constructor(o){this.layoutVertexArray=new pe,this.indexArray=new ke,this.programConfigurations=o,this.segments=new He,this.dynamicLayoutVertexArray=new ye,this.opacityVertexArray=new De,this.hasVisibleVertices=!1,this.placedSymbolArray=new D}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,c,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,h1.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,mg.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,vu,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Je("SymbolBuffers",Mf);class Tf{constructor(o,c,h){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new h,this.segments=new He,this.collisionVertexArray=new Ne}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,gg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Je("CollisionBuffers",Tf);class bu{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(x=>x.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Yp([]),this.placementViewportMatrix=Yp([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sv(this.zoom,c["text-size"]),this.iconSizeData=Sv(this.zoom,c["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),v=h.get("symbol-z-order");this.canOverlap="never"!==io(h,"text-overlap","text-allow-overlap")||"never"!==io(h,"icon-overlap","icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==v&&!g.isConstant(),this.sortFeaturesByY=("viewport-y"===v||"auto"===v&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===h.get("symbol-placement")&&(this.writingModes=h.get("text-writing-mode").map(x=>y.WritingMode[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=o.sourceID}createArrays(){this.text=new Mf(new ua(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new Mf(new ua(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new k,this.lineVertexArray=new O,this.symbolInstances=new I}calculateGlyphDependencies(o,c,h,g,v){for(let x=0;x<o.length;x++)if(c[o.charCodeAt(x)]=!0,(h||g)&&v){const C=Al[o.charAt(x)];C&&(c[C.charCodeAt(0)]=!0)}}populate(o,c,h){const g=this.layers[0],v=g.layout,x=v.get("text-font"),C=v.get("text-field"),S=v.get("icon-image"),A=("constant"!==C.value.kind||C.value.value instanceof Yi&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),R="constant"!==S.value.kind||!!S.value.value||Object.keys(S.parameters).length>0,L=v.get("symbol-sort-key");if(this.features=[],!A&&!R)return;const B=c.iconDependencies,V=c.glyphDependencies,H=c.availableImages,K=new Le(this.zoom);for(const{feature:W,id:se,index:ue,sourceLayerIndex:re}of o){const he=g._featureFilter.needGeometry,me=Dl(W,he);if(!g._featureFilter.filter(K,me,h))continue;let Ce,Qe;if(he||(me.geometry=Ps(W)),A){const Ke=g.getValueAndResolveTokens("text-field",me,h,H),Ge=Yi.factory(Ke);Iv(Ge)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===dd()||this.hasRTLText&&cn.isParsed())&&(Ce=vv(Ge,g,me))}if(R){const Ke=g.getValueAndResolveTokens("icon-image",me,h,H);Qe=Ke instanceof Vr?Ke:Vr.fromString(Ke)}if(!Ce&&!Qe)continue;const nt=this.sortFeaturesByKey?L.evaluate(me,{},h):void 0;if(this.features.push({id:se,text:Ce,icon:Qe,index:ue,sourceLayerIndex:re,geometry:me.geometry,properties:W.properties,type:Sf[W.type],sortKey:nt}),Qe&&(B[Qe.name]=!0),Ce){const Ke=x.evaluate(me,{},h).join(","),Ge="viewport"!==v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.WritingMode.vertical)>=0;for(const Ue of Ce.sections)if(Ue.image)B[Ue.image.name]=!0;else{const Ze=Di(Ce.toString()),qe=Ue.fontStack||Ke,Re=V[qe]=V[qe]||{};this.calculateGlyphDependencies(Ue.text,Re,Ge,this.allowVerticalPlacement,Ze)}}}"line"===v.get("symbol-placement")&&(this.features=function(W){const se={},ue={},re=[];let he=0;function me(Ke){re.push(W[Ke]),he++}function Ce(Ke,Ge,Ue){const Ze=ue[Ke];return delete ue[Ke],ue[Ge]=Ze,re[Ze].geometry[0].pop(),re[Ze].geometry[0]=re[Ze].geometry[0].concat(Ue[0]),Ze}function Qe(Ke,Ge,Ue){const Ze=se[Ge];return delete se[Ge],se[Ke]=Ze,re[Ze].geometry[0].shift(),re[Ze].geometry[0]=Ue[0].concat(re[Ze].geometry[0]),Ze}function nt(Ke,Ge,Ue){const Ze=Ue?Ge[0][Ge[0].length-1]:Ge[0][0];return`${Ke}:${Ze.x}:${Ze.y}`}for(let Ke=0;Ke<W.length;Ke++){const Ge=W[Ke],Ue=Ge.geometry,Ze=Ge.text?Ge.text.toString():null;if(!Ze){me(Ke);continue}const qe=nt(Ze,Ue),Re=nt(Ze,Ue,!0);if(qe in ue&&Re in se&&ue[qe]!==se[Re]){const ht=Qe(qe,Re,Ue),rt=Ce(qe,Re,re[ht].geometry);delete se[qe],delete ue[Re],ue[nt(Ze,re[rt].geometry,!0)]=rt,re[ht].geometry=null}else qe in ue?Ce(qe,Re,Ue):Re in se?Qe(qe,Re,Ue):(me(Ke),se[qe]=he-1,ue[Re]=he-1)}return re.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,se)=>W.sortKey-se.sortKey)}update(o,c,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,c,this.layers,h),this.icon.programConfigurations.updatePaintArrays(o,c,this.layers,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const h=this.lineVertexArray.length;if(void 0!==o.segment){let g=o.dist(c[o.segment+1]),v=o.dist(c[o.segment]);const x={};for(let C=o.segment+1;C<c.length;C++)x[C]={x:c[C].x,y:c[C].y,tileUnitDistanceFromAnchor:g},C<c.length-1&&(g+=c[C+1].dist(c[C]));for(let C=o.segment||0;C>=0;C--)x[C]={x:c[C].x,y:c[C].y,tileUnitDistanceFromAnchor:v},C>0&&(v+=c[C-1].dist(c[C]));for(let C=0;C<c.length;C++){const S=x[C];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(o,c,h,g,v,x,C,S,A,R,L,B){const V=o.indexArray,H=o.layoutVertexArray,K=o.segments.prepareSegment(4*c.length,H,V,this.canOverlap?x.sortKey:void 0),W=this.glyphOffsetArray.length,se=K.vertexLength,ue=this.allowVerticalPlacement&&C===y.WritingMode.vertical?Math.PI/2:0,re=x.text&&x.text.sections;for(let he=0;he<c.length;he++){const{tl:me,tr:Ce,bl:Qe,br:nt,tex:Ke,pixelOffsetTL:Ge,pixelOffsetBR:Ue,minFontScaleX:Ze,minFontScaleY:qe,glyphOffset:Re,isSDF:ht,sectionIndex:rt}=c[he],zt=K.vertexLength,Pn=Re[1];If(H,S.x,S.y,me.x,Pn+me.y,Ke.x,Ke.y,h,ht,Ge.x,Ge.y,Ze,qe),If(H,S.x,S.y,Ce.x,Pn+Ce.y,Ke.x+Ke.w,Ke.y,h,ht,Ue.x,Ge.y,Ze,qe),If(H,S.x,S.y,Qe.x,Pn+Qe.y,Ke.x,Ke.y+Ke.h,h,ht,Ge.x,Ue.y,Ze,qe),If(H,S.x,S.y,nt.x,Pn+nt.y,Ke.x+Ke.w,Ke.y+Ke.h,h,ht,Ue.x,Ue.y,Ze,qe),Uh(o.dynamicLayoutVertexArray,S,ue),V.emplaceBack(zt,zt+1,zt+2),V.emplaceBack(zt+1,zt+2,zt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Re[0]),he!==c.length-1&&rt===c[he+1].sectionIndex||o.programConfigurations.populatePaintArrays(H.length,x,x.index,{},B,re&&re[rt])}o.placedSymbolArray.emplaceBack(S.x,S.y,W,this.glyphOffsetArray.length-W,se,A,R,S.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],C,0,!1,0,L)}_addCollisionDebugVertex(o,c,h,g,v,x){return c.emplaceBack(0,0),o.emplaceBack(h.x,h.y,g,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(o,c,h,g,v,x,C){const S=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),A=S.vertexLength,R=v.layoutVertexArray,L=v.collisionVertexArray,B=C.anchorX,V=C.anchorY;this._addCollisionDebugVertex(R,L,x,B,V,new lt(o,c)),this._addCollisionDebugVertex(R,L,x,B,V,new lt(h,c)),this._addCollisionDebugVertex(R,L,x,B,V,new lt(h,g)),this._addCollisionDebugVertex(R,L,x,B,V,new lt(o,g)),S.vertexLength+=4;const H=v.indexArray;H.emplaceBack(A,A+1),H.emplaceBack(A+1,A+2),H.emplaceBack(A+2,A+3),H.emplaceBack(A+3,A),S.primitiveLength+=4}addDebugCollisionBoxes(o,c,h,g){for(let v=o;v<c;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Tf(Ae,_g.members,Be),this.iconCollisionBox=new Tf(Ae,_g.members,Be);for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(o,c,h,g,v,x,C,S,A){const R={};for(let L=c;L<h;L++){const B=o.get(L);R.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},R.textFeatureIndex=B.featureIndex;break}for(let L=g;L<v;L++){const B=o.get(L);R.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},R.verticalTextFeatureIndex=B.featureIndex;break}for(let L=x;L<C;L++){const B=o.get(L);R.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},R.iconFeatureIndex=B.featureIndex;break}for(let L=S;L<A;L++){const B=o.get(L);R.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},R.verticalIconFeatureIndex=B.featureIndex;break}return R}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,c){const h=o.placedSymbolArray.get(c),g=h.vertexStartIndex+4*h.numGlyphs;for(let v=h.vertexStartIndex;v<g;v+=4)o.indexArray.emplaceBack(v,v+1,v+2),o.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(o),h=Math.cos(o),g=[],v=[],x=[];for(let C=0;C<this.symbolInstances.length;++C){x.push(C);const S=this.symbolInstances.get(C);g.push(0|Math.round(c*S.anchorX+h*S.anchorY)),v.push(S.featureIndex)}return x.sort((C,S)=>g[C]-g[S]||v[S]-v[C]),x}addToSortKeyRanges(o,c){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===c?h.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const h=this.symbolInstances.get(c);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,v,x)=>{g>=0&&x.indexOf(g)===v&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Cg,Dg;Je("SymbolBucket",bu,{omit:["layers","collisionBoxArray","features","compareText"]}),bu.MAX_GLYPHS=65535,bu.addDynamicAttributes=Uh;var Ad={get paint(){return Dg=Dg||new sn({"icon-opacity":new Fe(xe.paint_symbol["icon-opacity"]),"icon-color":new Fe(xe.paint_symbol["icon-color"]),"icon-halo-color":new Fe(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fe(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fe(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new et(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new et(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fe(xe.paint_symbol["text-opacity"]),"text-color":new Fe(xe.paint_symbol["text-color"],{runtimeType:Br,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Fe(xe.paint_symbol["text-halo-color"]),"text-halo-width":new Fe(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new Fe(xe.paint_symbol["text-halo-blur"]),"text-translate":new et(xe.paint_symbol["text-translate"]),"text-translate-anchor":new et(xe.paint_symbol["text-translate-anchor"])})},get layout(){return Cg=Cg||new sn({"symbol-placement":new et(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new et(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new et(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fe(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new et(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new et(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new et(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new et(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new et(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new et(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fe(xe.layout_symbol["icon-size"]),"icon-text-fit":new et(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new et(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fe(xe.layout_symbol["icon-image"]),"icon-rotate":new Fe(xe.layout_symbol["icon-rotate"]),"icon-padding":new Fe(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new et(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new Fe(xe.layout_symbol["icon-offset"]),"icon-anchor":new Fe(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new et(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new et(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new et(xe.layout_symbol["text-rotation-alignment"]),"text-field":new Fe(xe.layout_symbol["text-field"]),"text-font":new Fe(xe.layout_symbol["text-font"]),"text-size":new Fe(xe.layout_symbol["text-size"]),"text-max-width":new Fe(xe.layout_symbol["text-max-width"]),"text-line-height":new et(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new Fe(xe.layout_symbol["text-letter-spacing"]),"text-justify":new Fe(xe.layout_symbol["text-justify"]),"text-radial-offset":new Fe(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new et(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new Fe(xe.layout_symbol["text-anchor"]),"text-max-angle":new et(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new et(xe.layout_symbol["text-writing-mode"]),"text-rotate":new Fe(xe.layout_symbol["text-rotate"]),"text-padding":new et(xe.layout_symbol["text-padding"]),"text-keep-upright":new et(xe.layout_symbol["text-keep-upright"]),"text-transform":new Fe(xe.layout_symbol["text-transform"]),"text-offset":new Fe(xe.layout_symbol["text-offset"]),"text-allow-overlap":new et(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new et(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new et(xe.layout_symbol["text-ignore-placement"]),"text-optional":new et(xe.layout_symbol["text-optional"])})}};class kd{constructor(o){if(void 0===o.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:Xs,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Je("FormatSectionOverride",kd,{omit:["defaultValue"]});class jh extends Mr{constructor(o){super(o,Ad)}recalculate(o,c){if(super.recalculate(o,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const v of h)g.indexOf(v)<0&&g.push(v);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,c,h,g){const v=this.layout.get(o).evaluate(c,{},h,g),x=this._unevaluatedLayout._values[o];return x.isDataDriven()||fl(x.value)||!v?v:(C=c.properties,v.replace(/{([^{}]+)}/g,(A,R)=>R in C?String(C[R]):""));var C}createBucket(o){return new bu(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of Ad.paint.overridableProperties){if(!jh.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),h=new kd(c),g=new nd(h,c.property.specification);let v=null;v="constant"===c.value.kind||"source"===c.value.kind?new _h("source",g):new Wt("composite",g,c.value.zoomStops),this.paint._values[o]=new vn(c.property,v,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,h){return!(!this.layout||c.isDataDriven()||h.isDataDriven())&&jh.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const h=o.get("text-field"),g=Ad.paint.properties[c];let v=!1;const x=C=>{for(const S of C)if(g.overrides&&g.overrides.hasOverride(S))return void(v=!0)};if("constant"===h.value.kind&&h.value.value instanceof Yi)x(h.value.value.sections);else if("source"===h.value.kind){const C=A=>{v||(A instanceof bs&&_i(A.value)===ys?x(A.value.sections):A instanceof Yu?x(A.sections):A.eachChild(C))},S=h.value;S._styleExpression&&C(S._styleExpression.expression)}return v}}let hc;var Mv={get paint(){return hc=hc||new sn({"background-color":new et(xe.paint_background["background-color"]),"background-pattern":new nu(xe.paint_background["background-pattern"]),"background-opacity":new et(xe.paint_background["background-opacity"])})}};let Pd;var Tv={get paint(){return Pd=Pd||new sn({"raster-opacity":new et(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new et(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new et(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new et(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new et(xe.paint_raster["raster-saturation"]),"raster-contrast":new et(xe.paint_raster["raster-contrast"]),"raster-resampling":new et(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new et(xe.paint_raster["raster-fade-duration"])})}};class Sg extends Mr{constructor(o){super(o,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Af={circle:class extends Mr{constructor(a){super(a,Kp)}createBucket(a){return new Ih(a)}queryRadius(a){const o=a;return md("circle-radius",this,o)+md("circle-stroke-width",this,o)+Bo(this.paint.get("circle-translate"))}queryIntersectsFeature(a,o,c,h,g,v,x,C){const S=gd(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,x),A=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c),R="map"===this.paint.get("circle-pitch-alignment"),L=R?S:(H=C,S.map(K=>ng(K,H))),B=R?A*x:A;var H;for(const V of h)for(const H of V){const K=R?H:ng(H,C);let W=B;const se=Th([],[H.x,H.y,0,1],C);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?W*=se[3]/v.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(W*=v.cameraToCenterDistance/se[3]),l1(L,K,W))return!0}return!1}},heatmap:class extends Mr{createBucket(a){return new ig(a)}constructor(a){super(a,rg),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kt({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends Mr{constructor(a){super(a,c1)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends Mr{constructor(a){super(a,lg)}recalculate(a,o){super.recalculate(a,o);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new wd(a)}queryRadius(){return Bo(this.paint.get("fill-translate"))}queryIntersectsFeature(a,o,c,h,g,v,x){return tg(gd(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,x),h)}isTileClipped(){return!0}},"fill-extrusion":class extends Mr{constructor(a){super(a,fv)}createBucket(a){return new lu(a)}queryRadius(){return Bo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,o,c,h,g,v,x,C){const S=gd(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,x),A=this.paint.get("fill-extrusion-height").evaluate(o,c),R=this.paint.get("fill-extrusion-base").evaluate(o,c),L=function(V,H,K,W){const se=[];for(const ue of V){const re=[ue.x,ue.y,0,1];Th(re,re,H),se.push(new lt(re[0]/re[3],re[1]/re[3]))}return se}(S,C),B=function(V,H,K,W){const se=[],ue=[],re=W[8]*H,he=W[9]*H,me=W[10]*H,Ce=W[11]*H,Qe=W[8]*K,nt=W[9]*K,Ke=W[10]*K,Ge=W[11]*K;for(const Ue of V){const Ze=[],qe=[];for(const Re of Ue){const ht=Re.x,rt=Re.y,zt=W[0]*ht+W[4]*rt+W[12],Pn=W[1]*ht+W[5]*rt+W[13],gn=W[2]*ht+W[6]*rt+W[14],xi=W[3]*ht+W[7]*rt+W[15],yo=gn+me,_r=xi+Ce,Pi=zt+Qe,pi=Pn+nt,yr=gn+Ke,vr=xi+Ge,Hr=new lt((zt+re)/_r,(Pn+he)/_r);Hr.z=yo/_r,Ze.push(Hr);const fi=new lt(Pi/vr,pi/vr);fi.z=yr/vr,qe.push(fi)}se.push(Ze),ue.push(qe)}return[se,ue]}(h,R,A,C);return function(V,H,K){let W=1/0;tg(K,H)&&(W=cu(K,H[0]));for(let se=0;se<H.length;se++){const ue=H[se],re=V[se];for(let he=0;he<ue.length-1;he++){const me=ue[he],Ce=[me,ue[he+1],re[he+1],re[he],me];eg(K,Ce)&&(W=Math.min(W,cu(K,Ce)))}}return W!==1/0&&W}(B[0],B[1],L)}},line:class extends Mr{constructor(a){super(a,fg),this.gradientVersion=0,du||(du=new Ed(fg.paint.properties["line-width"].specification),du.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){"line-gradient"===a&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof dl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,o){super.recalculate(a,o),this.paint._values["line-floorwidth"]=du.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new pg(a)}queryRadius(a){const o=a,c=Cd(md("line-width",this,o),md("line-gap-width",this,o)),h=md("line-offset",this,o);return c/2+Math.abs(h)+Bo(this.paint.get("line-translate"))}queryIntersectsFeature(a,o,c,h,g,v,x){const C=gd(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,x),S=x/2*Cd(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),A=this.paint.get("line-offset").evaluate(o,c);return A&&(h=function(R,L){const B=[];for(let V=0;V<R.length;V++){const H=R[V],K=[];for(let W=0;W<H.length;W++){const se=H[W-1],ue=H[W],re=H[W+1],he=0===W?new lt(0,0):ue.sub(se)._unit()._perp(),me=W===H.length-1?new lt(0,0):re.sub(ue)._unit()._perp(),Ce=he._add(me)._unit(),Qe=Ce.x*me.x+Ce.y*me.y;0!==Qe&&Ce._mult(1/Qe),K.push(Ce._mult(L)._add(ue))}B.push(K)}return B}(h,A*x)),function(R,L,B){for(let V=0;V<L.length;V++){const H=L[V];if(R.length>=3)for(let K=0;K<H.length;K++)if(ru(R,H[K]))return!0;if(da(R,H,B))return!0}return!1}(C,h,S)}isTileClipped(){return!0}},symbol:jh,background:class extends Mr{constructor(a){super(a,Mv)}},raster:class extends Mr{constructor(a){super(a,Tv)}}};class Hh{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const $h=6371008.8;class Ol{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ol(co(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,h=this.lat*c,g=o.lat*c,v=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((o.lng-this.lng)*c);return $h*Math.acos(Math.min(v,1))}static convert(o){if(o instanceof Ol)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new Ol(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new Ol(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ig=2*Math.PI*$h;function pc(a){return Ig*Math.cos(a*Math.PI/180)}function xu(a){return(180+a)/360}function Mg(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Av(a,o){return a/pc(o)}function Gh(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class qh{constructor(o,c,h=0){this.x=+o,this.y=+c,this.z=+h}static fromLngLat(o,c=0){const h=Ol.convert(o);return new qh(xu(h.lng),Mg(h.lat),Av(c,h.lat))}toLngLat(){return new Ol(360*this.x-180,Gh(this.y))}toAltitude(){return this.z*pc(Gh(this.y))}meterInMercatorCoordinateUnits(){return 1/Ig*(o=Gh(this.y),1/Math.cos(o*Math.PI/180));var o}}function kv(a,o,c){var h=2*Math.PI*6378137/256/Math.pow(2,c);return[a*h-2*Math.PI*6378137/2,o*h-2*Math.PI*6378137/2]}class kf{constructor(o,c,h){if(o<0||o>25||h<0||h>=Math.pow(2,o)||c<0||c>=Math.pow(2,o))throw new Error(`x=${c}, y=${h}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=c,this.y=h,this.key=Ll(0,o,o,c,h)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c,h){const g=(x=this.y,C=this.z,S=kv(256*(v=this.x),256*(x=Math.pow(2,C)-x-1),C),A=kv(256*(v+1),256*(x+1),C),S[0]+","+S[1]+","+A[0]+","+A[1]);var v,x,C,S,A;const R=function(L,B,V){let H,K="";for(let W=L;W>0;W--)H=1<<W-1,K+=(B&H?1:0)+(V&H?2:0);return K}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===h?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,g)}isChildOf(o){const c=this.z-o.z;return c>0&&o.x===this.x>>c&&o.y===this.y>>c}getTilePoint(o){const c=Math.pow(2,this.z);return new lt((o.x*c-this.x)*kn,(o.y*c-this.y)*kn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Tg{constructor(o,c){this.wrap=o,this.canonical=c,this.key=Ll(o,c.z,c.z,c.x,c.y)}}class Uo{constructor(o,c,h,g,v){if(o<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${h}`);this.overscaledZ=o,this.wrap=c,this.canonical=new kf(h,+g,+v),this.key=Ll(c,o,h,g,v)}clone(){return new Uo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-o;return o>this.canonical.z?new Uo(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uo(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-o;return o>this.canonical.z?Ll(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y):Ll(this.wrap*+c,o,o,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new Uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new Uo(c,this.wrap,c,h,g),new Uo(c,this.wrap,c,h+1,g),new Uo(c,this.wrap,c,h,g+1),new Uo(c,this.wrap,c,h+1,g+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Uo(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Tg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new qh(o.x-this.wrap,o.y))}}function Ll(a,o,c,h,g){(a*=2)<0&&(a=-1*a-1);const v=1<<c;return(v*v*a+v*g+h).toString(36)+c.toString(36)+o.toString(36)}Je("CanonicalTileID",kf),Je("OverscaledTileID",Uo,{omit:["posMatrix"]});class Pf{constructor(o,c,h){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(h&&"mapbox"!==h&&"terrarium"!==h)return void pt(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const g=this.dim=c.height-2;this.data=new Uint32Array(c.data.buffer),this.encoding=h||"mapbox";for(let v=0;v<g;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(g,v)]=this.data[this._idx(g-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,g)]=this.data[this._idx(v,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let v=0;v<g;v++)for(let x=0;x<g;x++){const C=this.get(v,x);C>this.max&&(this.max=C),C<this.min&&(this.min=C)}}get(o,c){const h=new Uint8Array(this.data.buffer),g=4*this._idx(o,c);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(h[g],h[g+1],h[g+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}_unpackMapbox(o,c,h){return(256*o*256+256*c+h)/10-1e4}_unpackTerrarium(o,c,h){return 256*o+c+h/256-32768}getPixels(){return new Vo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,c,h){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let g=c*this.dim,v=c*this.dim+this.dim,x=h*this.dim,C=h*this.dim+this.dim;switch(c){case-1:g=v-1;break;case 1:v=g+1}switch(h){case-1:x=C-1;break;case 1:C=x+1}const S=-c*this.dim,A=-h*this.dim;for(let R=x;R<C;R++)for(let L=g;L<v;L++)this.data[this._idx(L,R)]=o.data[this._idx(L+S,R+A)]}}Je("DEMData",Pf);class Ag{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const h=o[c];this._stringToNumber[h]=c,this._numberToString[c]=h}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class Rf{constructor(o,c,h,g,v){this.type="Feature",this._vectorTileFeature=o,o._z=c,o._x=h,o._y=g,this.properties=o.properties,this.id=v}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const c in this)"_geometry"!==c&&"_vectorTileFeature"!==c&&(o[c]=this[c]);return o}}class Pv{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new ic(kn,16,0),this.grid3D=new ic(kn,16,0),this.featureIndexArray=new j,this.promoteId=c}insert(o,c,h,g,v,x){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,v);const S=x?this.grid3D:this.grid;for(let A=0;A<c.length;A++){const R=c[A],L=[1/0,1/0,-1/0,-1/0];for(let B=0;B<R.length;B++){const V=R[B];L[0]=Math.min(L[0],V.x),L[1]=Math.min(L[1],V.y),L[2]=Math.max(L[2],V.x),L[3]=Math.max(L[3],V.y)}L[0]<kn&&L[1]<kn&&L[2]>=0&&L[3]>=0&&S.insert(C,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Sl.VectorTile(new kl(this.rawTileData)).layers,this.sourceLayerCoder=new Ag(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,c,h,g){this.loadVTLayers();const v=o.params||{},x=kn/o.tileSize/o.scale,C=rd(v.filter),S=o.queryGeometry,A=o.queryPadding*x,R=Rv(S),L=this.grid.query(R.minX-A,R.minY-A,R.maxX+A,R.maxY+A),B=Rv(o.cameraQueryGeometry),V=this.grid3D.query(B.minX-A,B.minY-A,B.maxX+A,B.maxY+A,(W,se,ue,re)=>function(he,me,Ce,Qe,nt){for(const Ge of he)if(me<=Ge.x&&Ce<=Ge.y&&Qe>=Ge.x&&nt>=Ge.y)return!0;const Ke=[new lt(me,Ce),new lt(me,nt),new lt(Qe,nt),new lt(Qe,Ce)];if(he.length>2)for(const Ge of Ke)if(ru(he,Ge))return!0;for(let Ge=0;Ge<he.length-1;Ge++)if(Zp(he[Ge],he[Ge+1],Ke))return!0;return!1}(o.cameraQueryGeometry,W-A,se-A,ue+A,re+A));for(const W of V)L.push(W);L.sort(Fv);const H={};let K;for(let W=0;W<L.length;W++){const se=L[W];if(se===K)continue;K=se;const ue=this.featureIndexArray.get(se);let re=null;this.loadMatchingFeature(H,ue.bucketIndex,ue.sourceLayerIndex,ue.featureIndex,C,v.layers,v.availableImages,c,h,g,(he,me,Ce)=>(re||(re=Ps(he)),me.queryIntersectsFeature(S,he,Ce,re,this.z,o.transform,x,o.pixelPosMatrix)))}return H}loadMatchingFeature(o,c,h,g,v,x,C,S,A,R,L){const B=this.bucketLayerIDs[c];if(x&&!function(W,se){for(let ue=0;ue<W.length;ue++)if(se.indexOf(W[ue])>=0)return!0;return!1}(x,B))return;const V=this.sourceLayerCoder.decode(h),H=this.vtLayers[V].feature(g);if(v.needGeometry){const W=Dl(H,!0);if(!v.filter(new Le(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!v.filter(new Le(this.tileID.overscaledZ),H))return;const K=this.getId(H,V);for(let W=0;W<B.length;W++){const se=B[W];if(x&&x.indexOf(se)<0)continue;const ue=S[se];if(!ue)continue;let re={};K&&R&&(re=R.getState(ue.sourceLayer||"_geojsonTileLayer",K));const he=Ci({},A[se]);he.paint=Ff(he.paint,ue.paint,H,re,C),he.layout=Ff(he.layout,ue.layout,H,re,C);const me=!L||L(H,ue,re);if(!me)continue;const Ce=new Rf(H,this.z,this.x,this.y,K);Ce.layer=he;let Qe=o[se];void 0===Qe&&(Qe=o[se]=[]),Qe.push({featureIndex:g,feature:Ce,intersectionZ:me})}}lookupSymbolFeatures(o,c,h,g,v,x,C,S){const A={};this.loadVTLayers();const R=rd(v);for(const L of o)this.loadMatchingFeature(A,h,g,L,R,x,C,S,c);return A}hasLayer(o){for(const c of this.bucketLayerIDs)for(const h of c)if(o===h)return!0;return!1}getId(o,c){let h=o.id;return this.promoteId&&(h=o.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[c]],"boolean"==typeof h&&(h=Number(h))),h}}function Ff(a,o,c,h,g){return $e(a,(v,x)=>{const C=o instanceof No?o.get(x):null;return C&&C.evaluate?C.evaluate(c,h,g):C})}function Rv(a){let o=1/0,c=1/0,h=-1/0,g=-1/0;for(const v of a)o=Math.min(o,v.x),c=Math.min(c,v.y),h=Math.max(h,v.x),g=Math.max(g,v.y);return{minX:o,minY:c,maxX:h,maxY:g}}function Fv(a,o){return o-a}function kg(a,o,c,h,g){const v=[];for(let x=0;x<a.length;x++){const C=a[x];let S;for(let A=0;A<C.length-1;A++){let R=C[A],L=C[A+1];R.x<o&&L.x<o||(R.x<o?R=new lt(o,R.y+(o-R.x)/(L.x-R.x)*(L.y-R.y))._round():L.x<o&&(L=new lt(o,R.y+(o-R.x)/(L.x-R.x)*(L.y-R.y))._round()),R.y<c&&L.y<c||(R.y<c?R=new lt(R.x+(c-R.y)/(L.y-R.y)*(L.x-R.x),c)._round():L.y<c&&(L=new lt(R.x+(c-R.y)/(L.y-R.y)*(L.x-R.x),c)._round()),R.x>=h&&L.x>=h||(R.x>=h?R=new lt(h,R.y+(h-R.x)/(L.x-R.x)*(L.y-R.y))._round():L.x>=h&&(L=new lt(h,R.y+(h-R.x)/(L.x-R.x)*(L.y-R.y))._round()),R.y>=g&&L.y>=g||(R.y>=g?R=new lt(R.x+(g-R.y)/(L.y-R.y)*(L.x-R.x),g)._round():L.y>=g&&(L=new lt(R.x+(g-R.y)/(L.y-R.y)*(L.x-R.x),g)._round()),S&&R.equals(S[S.length-1])||(S=[R],v.push(S)),S.push(L)))))}}return v}Je("FeatureIndex",Pv,{omit:["rawTileData","sourceLayerCoder"]});class ba extends lt{constructor(o,c,h,g){super(o,c),this.angle=h,void 0!==g&&(this.segment=g)}clone(){return new ba(this.x,this.y,this.angle,this.segment)}}function Ov(a,o,c,h,g){if(void 0===o.segment)return!0;let v=o,x=o.segment+1,C=0;for(;C>-c/2;){if(x--,x<0)return!1;C-=a[x].dist(v),v=a[x]}C+=a[x].dist(a[x+1]),x++;const S=[];let A=0;for(;C<c/2;){const R=a[x],L=a[x+1];if(!L)return!1;let B=a[x-1].angleTo(R)-R.angleTo(L);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:C,angleDelta:B}),A+=B;C-S[0].distance>h;)A-=S.shift().angleDelta;if(A>g)return!1;x++,C+=R.dist(L)}return!0}function Lv(a){let o=0;for(let c=0;c<a.length-1;c++)o+=a[c].dist(a[c+1]);return o}function Wh(a,o,c){return a?.6*o*c:0}function Nv(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function p1(a,o,c,h,g,v){const x=Wh(c,g,v),C=Nv(c,h)*v;let S=0;const A=Lv(a)/2;for(let R=0;R<a.length-1;R++){const L=a[R],B=a[R+1],V=L.dist(B);if(S+V>A){const H=(A-S)/V,K=po.number(L.x,B.x,H),W=po.number(L.y,B.y,H),se=new ba(K,W,B.angleTo(L),R);return se._round(),!x||Ov(a,se,C,x,o)?se:void 0}S+=V}}function f1(a,o,c,h,g,v,x,C,S){const A=Wh(h,v,x),R=Nv(h,g),L=R*x,B=0===a[0].x||a[0].x===S||0===a[0].y||a[0].y===S;return o-L<o/4&&(o=L+o/4),Bv(a,B?o/2*C%o:(R/2+2*v)*x*C%o,o,A,c,L,B,!1,S)}function Bv(a,o,c,h,g,v,x,C,S){const A=v/2,R=Lv(a);let L=0,B=o-c,V=[];for(let H=0;H<a.length-1;H++){const K=a[H],W=a[H+1],se=K.dist(W),ue=W.angleTo(K);for(;B+c<L+se;){B+=c;const re=(B-L)/se,he=po.number(K.x,W.x,re),me=po.number(K.y,W.y,re);if(he>=0&&he<S&&me>=0&&me<S&&B-A>=0&&B+A<=R){const Ce=new ba(he,me,ue,H);Ce._round(),h&&!Ov(a,Ce,v,h,g)||V.push(Ce)}}L+=se}return C||V.length||x||(V=Bv(a,L/2,c,h,g,v,x,!0,S)),V}Je("Anchor",ba);const Rd=go;function Pg(a,o,c,h){const g=[],v=a.image,x=v.pixelRatio,C=v.paddedRect.w-2*Rd,S=v.paddedRect.h-2*Rd,A=a.right-a.left,R=a.bottom-a.top,L=v.stretchX||[[0,C]],B=v.stretchY||[[0,S]],V=(Ue,Ze)=>Ue+Ze[1]-Ze[0],H=L.reduce(V,0),K=B.reduce(V,0),W=C-H,se=S-K;let ue=0,re=H,he=0,me=K,Ce=0,Qe=W,nt=0,Ke=se;if(v.content&&h){const Ue=v.content;ue=fc(L,0,Ue[0]),he=fc(B,0,Ue[1]),re=fc(L,Ue[0],Ue[2]),me=fc(B,Ue[1],Ue[3]),Ce=Ue[0]-ue,nt=Ue[1]-he,Qe=Ue[2]-Ue[0]-re,Ke=Ue[3]-Ue[1]-me}const Ge=(Ue,Ze,qe,Re)=>{const ht=Od(Ue.stretch-ue,re,A,a.left),rt=Ld(Ue.fixed-Ce,Qe,Ue.stretch,H),zt=Od(Ze.stretch-he,me,R,a.top),Pn=Ld(Ze.fixed-nt,Ke,Ze.stretch,K),gn=Od(qe.stretch-ue,re,A,a.left),xi=Ld(qe.fixed-Ce,Qe,qe.stretch,H),yo=Od(Re.stretch-he,me,R,a.top),_r=Ld(Re.fixed-nt,Ke,Re.stretch,K),Pi=new lt(ht,zt),pi=new lt(gn,zt),yr=new lt(gn,yo),vr=new lt(ht,yo),Hr=new lt(rt/x,Pn/x),fi=new lt(xi/x,_r/x),Hi=o*Math.PI/180;if(Hi){const sr=Math.sin(Hi),$r=Math.cos(Hi),Zn=[$r,-sr,sr,$r];Pi._matMult(Zn),pi._matMult(Zn),vr._matMult(Zn),yr._matMult(Zn)}const br=Ue.stretch+Ue.fixed,or=Ze.stretch+Ze.fixed;return{tl:Pi,tr:pi,bl:vr,br:yr,tex:{x:v.paddedRect.x+Rd+br,y:v.paddedRect.y+Rd+or,w:qe.stretch+qe.fixed-br,h:Re.stretch+Re.fixed-or},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Hr,pixelOffsetBR:fi,minFontScaleX:Qe/x/A,minFontScaleY:Ke/x/R,isSDF:c}};if(h&&(v.stretchX||v.stretchY)){const Ue=Fd(L,W,H),Ze=Fd(B,se,K);for(let qe=0;qe<Ue.length-1;qe++){const Re=Ue[qe],ht=Ue[qe+1];for(let rt=0;rt<Ze.length-1;rt++)g.push(Ge(Re,Ze[rt],ht,Ze[rt+1]))}}else g.push(Ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:S+1}));return g}function fc(a,o,c){let h=0;for(const g of a)h+=Math.max(o,Math.min(c,g[1]))-Math.max(o,Math.min(c,g[0]));return h}function Fd(a,o,c){const h=[{fixed:-Rd,stretch:0}];for(const[g,v]of a){const x=h[h.length-1];h.push({fixed:g-x.stretch,stretch:x.stretch}),h.push({fixed:g-x.stretch,stretch:x.stretch+(v-g)})}return h.push({fixed:o+Rd,stretch:c}),h}function Od(a,o,c,h){return a/o*c+h}function Ld(a,o,c,h){return a-o*c/h}class Nd{constructor(o,c,h,g,v,x,C,S,A,R){if(this.boxStartIndex=o.length,A){let L=x.top,B=x.bottom;const V=x.collisionPadding;V&&(L-=V[1],B+=V[3]);let H=B-L;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{let L=x.top*C-S[0],B=x.bottom*C+S[2],V=x.left*C-S[3],H=x.right*C+S[1];const K=x.collisionPadding;if(K&&(V-=K[0]*C,L-=K[1]*C,H+=K[2]*C,B+=K[3]*C),R){const W=new lt(V,L),se=new lt(H,L),ue=new lt(V,B),re=new lt(H,B),he=R*Math.PI/180;W._rotate(he),se._rotate(he),ue._rotate(he),re._rotate(he),V=Math.min(W.x,se.x,ue.x,re.x),H=Math.max(W.x,se.x,ue.x,re.x),L=Math.min(W.y,se.y,ue.y,re.y),B=Math.max(W.y,se.y,ue.y,re.y)}o.emplaceBack(c.x,c.y,V,L,H,B,h,g,v)}this.boxEndIndex=o.length}}class wu{constructor(o=[],c=Rg){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:h}=this,g=c[o];for(;o>0;){const v=o-1>>1,x=c[v];if(h(g,x)>=0)break;c[o]=x,o=v}c[o]=g}_down(o){const{data:c,compare:h}=this,g=this.length>>1,v=c[o];for(;o<g;){let x=1+(o<<1),C=c[x];const S=x+1;if(S<this.length&&h(c[S],C)<0&&(x=S,C=c[S]),h(C,v)>=0)break;c[o]=C,o=x}c[o]=v}}function Rg(a,o){return a<o?-1:a>o?1:0}function Fg(a,o=1,c=!1){let h=1/0,g=1/0,v=-1/0,x=-1/0;const C=a[0];for(let V=0;V<C.length;V++){const H=C[V];(!V||H.x<h)&&(h=H.x),(!V||H.y<g)&&(g=H.y),(!V||H.x>v)&&(v=H.x),(!V||H.y>x)&&(x=H.y)}const S=Math.min(v-h,x-g);let A=S/2;const R=new wu([],Zh);if(0===S)return new lt(h,g);for(let V=h;V<v;V+=S)for(let H=g;H<x;H+=S)R.push(new Ga(V+A,H+A,A,a));let L=function(V){let H=0,K=0,W=0;const se=V[0];for(let ue=0,re=se.length,he=re-1;ue<re;he=ue++){const me=se[ue],Ce=se[he],Qe=me.x*Ce.y-Ce.x*me.y;K+=(me.x+Ce.x)*Qe,W+=(me.y+Ce.y)*Qe,H+=3*Qe}return new Ga(K/H,W/H,0,V)}(a),B=R.length;for(;R.length;){const V=R.pop();(V.d>L.d||!L.d)&&(L=V,c&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,B)),V.max-L.d<=o||(A=V.h/2,R.push(new Ga(V.p.x-A,V.p.y-A,A,a)),R.push(new Ga(V.p.x+A,V.p.y-A,A,a)),R.push(new Ga(V.p.x-A,V.p.y+A,A,a)),R.push(new Ga(V.p.x+A,V.p.y+A,A,a)),B+=4)}return c&&(console.log(`num probes: ${B}`),console.log(`best distance: ${L.d}`)),L.p}function Zh(a,o){return o.max-a.max}function Ga(a,o,c,h){this.p=new lt(a,o),this.h=c,this.d=function(g,v){let x=!1,C=1/0;for(let S=0;S<v.length;S++){const A=v[S];for(let R=0,L=A.length,B=L-1;R<L;B=R++){const V=A[R],H=A[B];V.y>g.y!=H.y>g.y&&g.x<(H.x-V.x)*(g.y-V.y)/(H.y-V.y)+V.x&&(x=!x),C=Math.min(C,qp(g,V,H))}}return(x?1:-1)*Math.sqrt(C)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const xa=Number.POSITIVE_INFINITY;function Og(a,o){return o[1]!==xa?function(c,h,g){let v=0,x=0;switch(h=Math.abs(h),g=Math.abs(g),c){case"top-right":case"top-left":case"top":x=g-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-g}switch(c){case"top-right":case"bottom-right":case"right":v=-h;break;case"top-left":case"bottom-left":case"left":v=h}return[v,x]}(a,o[0],o[1]):function(c,h){let g=0,v=0;h<0&&(h=0);const x=h/Math.sqrt(2);switch(c){case"top-right":case"top-left":v=x-7;break;case"bottom-right":case"bottom-left":v=7-x;break;case"bottom":v=7-h;break;case"top":v=h-7}switch(c){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=h;break;case"right":g=-h}return[g,v]}(a,o[0])}function Of(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zv(a,o,c,h,g,v,x,C,S,A,R){let L=v.textMaxSize.evaluate(o,{});void 0===L&&(L=x);const B=a.layers[0].layout,V=B.get("icon-offset").evaluate(o,{},R),H=Xh(c.horizontal),K=x/24,W=a.tilePixelRatio*K,se=a.tilePixelRatio*L/24,ue=a.tilePixelRatio*C,re=a.tilePixelRatio*B.get("symbol-spacing"),he=B.get("text-padding")*a.tilePixelRatio,me=function(Re,ht,rt,zt=1){const Pn=Re.get("icon-padding").evaluate(ht,{},rt),gn=Pn&&Pn.values;return[gn[0]*zt,gn[1]*zt,gn[2]*zt,gn[3]*zt]}(B,o,R,a.tilePixelRatio),Ce=B.get("text-max-angle")/180*Math.PI,Qe="viewport"!==B.get("text-rotation-alignment")&&"point"!==B.get("symbol-placement"),nt="map"===B.get("icon-rotation-alignment")&&"point"!==B.get("symbol-placement"),Ke=B.get("symbol-placement"),Ge=re/2,Ue=B.get("icon-text-fit");let Ze;h&&"none"!==Ue&&(a.allowVerticalPlacement&&c.vertical&&(Ze=yu(h,c.vertical,Ue,B.get("icon-text-fit-padding"),V,K)),H&&(h=yu(h,H,Ue,B.get("icon-text-fit-padding"),V,K)));const qe=(Re,ht)=>{ht.x<0||ht.x>=kn||ht.y<0||ht.y>=kn||function(rt,zt,Pn,gn,xi,yo,_r,Pi,pi,yr,vr,Hr,fi,Hi,br,or,sr,$r,Zn,Ri,Ut,Gr,wi,Pr,jo){const Fs=rt.addToLineVertexArray(zt,Pn);let Os,qa,Ho,vo,xr=0,Ls=0,wa=0,Bg=0,Bf=-1,zg=-1;const Wa={};let tp=ii(""),zf=0,Nl=0;if(void 0===Pi._unevaluatedLayout.getValue("text-radial-offset")?[zf,Nl]=Pi.layout.get("text-offset").evaluate(Ut,{},Pr).map(ri=>ri*bi):(zf=Pi.layout.get("text-radial-offset").evaluate(Ut,{},Pr)*bi,Nl=xa),rt.allowVerticalPlacement&&gn.vertical){const ri=Pi.layout.get("text-rotate").evaluate(Ut,{},Pr)+90;Ho=new Nd(pi,zt,yr,vr,Hr,gn.vertical,fi,Hi,br,ri),_r&&(vo=new Nd(pi,zt,yr,vr,Hr,_r,sr,$r,br,ri))}if(xi){const ri=Pi.layout.get("icon-rotate").evaluate(Ut,{}),Ea="none"!==Pi.layout.get("icon-text-fit"),Vd=Pg(xi,ri,wi,Ea),Ud=_r?Pg(_r,ri,wi,Ea):void 0;qa=new Nd(pi,zt,yr,vr,Hr,xi,sr,$r,!1,ri),xr=4*Vd.length;const Hg=rt.iconSizeData;let _c=null;"source"===Hg.kind?(_c=[$a*Pi.layout.get("icon-size").evaluate(Ut,{})],_c[0]>Fl&&pt(`${rt.layerIds[0]}: Value for "icon-size" is >= ${Td}. Reduce your "icon-size".`)):"composite"===Hg.kind&&(_c=[$a*Gr.compositeIconSizes[0].evaluate(Ut,{},Pr),$a*Gr.compositeIconSizes[1].evaluate(Ut,{},Pr)],(_c[0]>Fl||_c[1]>Fl)&&pt(`${rt.layerIds[0]}: Value for "icon-size" is >= ${Td}. Reduce your "icon-size".`)),rt.addSymbols(rt.icon,Vd,_c,Ri,Zn,Ut,y.WritingMode.none,zt,Fs.lineStartIndex,Fs.lineLength,-1,Pr),Bf=rt.icon.placedSymbolArray.length-1,Ud&&(Ls=4*Ud.length,rt.addSymbols(rt.icon,Ud,_c,Ri,Zn,Ut,y.WritingMode.vertical,zt,Fs.lineStartIndex,Fs.lineLength,-1,Pr),zg=rt.icon.placedSymbolArray.length-1)}const zd=Object.keys(gn.horizontal);for(const ri of zd){const Ea=gn.horizontal[ri];if(!Os){tp=ii(Ea.text);const Ud=Pi.layout.get("text-rotate").evaluate(Ut,{},Pr);Os=new Nd(pi,zt,yr,vr,Hr,Ea,fi,Hi,br,Ud)}const Vd=1===Ea.positionedLines.length;if(wa+=Lf(rt,zt,Ea,yo,Pi,br,Ut,or,Fs,gn.vertical?y.WritingMode.horizontal:y.WritingMode.horizontalOnly,Vd?zd:[ri],Wa,Bf,Gr,Pr),Vd)break}gn.vertical&&(Bg+=Lf(rt,zt,gn.vertical,yo,Pi,br,Ut,or,Fs,y.WritingMode.vertical,["vertical"],Wa,zg,Gr,Pr));const Vf=Os?Os.boxStartIndex:rt.collisionBoxArray.length,Vg=Os?Os.boxEndIndex:rt.collisionBoxArray.length,Ug=Ho?Ho.boxStartIndex:rt.collisionBoxArray.length,jg=Ho?Ho.boxEndIndex:rt.collisionBoxArray.length,gc=qa?qa.boxStartIndex:rt.collisionBoxArray.length,jv=qa?qa.boxEndIndex:rt.collisionBoxArray.length,Hv=vo?vo.boxStartIndex:rt.collisionBoxArray.length,$v=vo?vo.boxEndIndex:rt.collisionBoxArray.length;let Ns=-1;const np=(ri,Ea)=>ri&&ri.circleDiameter?Math.max(ri.circleDiameter,Ea):Ea;Ns=np(Os,Ns),Ns=np(Ho,Ns),Ns=np(qa,Ns),Ns=np(vo,Ns);const bo=Ns>-1?1:0;bo&&(Ns*=jo/bi),rt.glyphOffsetArray.length>=bu.MAX_GLYPHS&&pt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ut.sortKey&&rt.addToSortKeyRanges(rt.symbolInstances.length,Ut.sortKey),rt.symbolInstances.emplaceBack(zt.x,zt.y,Wa.right>=0?Wa.right:-1,Wa.center>=0?Wa.center:-1,Wa.left>=0?Wa.left:-1,Wa.vertical||-1,Bf,zg,tp,Vf,Vg,Ug,jg,gc,jv,Hv,$v,yr,wa,Bg,xr,Ls,bo,0,fi,zf,Nl,Ns)}(a,ht,Re,c,h,g,Ze,a.layers[0],a.collisionBoxArray,o.index,o.sourceLayerIndex,a.index,W,[he,he,he,he],Qe,S,ue,me,nt,V,o,v,A,R,x)};if("line"===Ke)for(const Re of kg(o.geometry,0,0,kn,kn)){const ht=f1(Re,re,Ce,c.vertical||H,h,24,se,a.overscaling,kn);for(const rt of ht)H&&Vv(a,H.text,Ge,rt)||qe(Re,rt)}else if("line-center"===Ke){for(const Re of o.geometry)if(Re.length>1){const ht=p1(Re,Ce,c.vertical||H,h,24,se);ht&&qe(Re,ht)}}else if("Polygon"===o.type)for(const Re of kh(o.geometry,0)){const ht=Fg(Re,16);qe(Re[0],new ba(ht.x,ht.y,0))}else if("LineString"===o.type)for(const Re of o.geometry)qe(Re,new ba(Re[0].x,Re[0].y,0));else if("Point"===o.type)for(const Re of o.geometry)for(const ht of Re)qe([ht],new ba(ht.x,ht.y,0))}function Lf(a,o,c,h,g,v,x,C,S,A,R,L,B,V,H){const K=function(ue,re,he,me,Ce,Qe,nt,Ke){const Ge=me.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,Ue=[];for(const Ze of re.positionedLines)for(const qe of Ze.positionedGlyphs){if(!qe.rect)continue;const Re=qe.rect||{};let ht=Nh+1,rt=!0,zt=1,Pn=0;const gn=(Ce||Ke)&&qe.vertical,xi=qe.metrics.advance*qe.scale/2;if(Ke&&re.verticalizable&&(Pn=Ze.lineOffset/2-(qe.imageName?-(bi-qe.metrics.width*qe.scale)/2:(qe.scale-1)*bi)),qe.imageName){const Zn=nt[qe.imageName];rt=Zn.sdf,zt=Zn.pixelRatio,ht=go/zt}const yo=Ce?[qe.x+xi,qe.y]:[0,0];let _r=Ce?[0,0]:[qe.x+xi+he[0],qe.y+he[1]-Pn],Pi=[0,0];gn&&(Pi=_r,_r=[0,0]);const pi=(qe.metrics.left-ht)*qe.scale-xi+_r[0],yr=(-qe.metrics.top-ht)*qe.scale+_r[1],vr=pi+Re.w*qe.scale/zt,Hr=yr+Re.h*qe.scale/zt,fi=new lt(pi,yr),Hi=new lt(vr,yr),br=new lt(pi,Hr),or=new lt(vr,Hr);if(gn){const Zn=new lt(-xi,xi-Bh),Ri=-Math.PI/2,Ut=bi/2-xi,Gr=new lt(5-Bh-Ut,-(qe.imageName?Ut:0)),wi=new lt(...Pi);fi._rotateAround(Ri,Zn)._add(Gr)._add(wi),Hi._rotateAround(Ri,Zn)._add(Gr)._add(wi),br._rotateAround(Ri,Zn)._add(Gr)._add(wi),or._rotateAround(Ri,Zn)._add(Gr)._add(wi)}if(Ge){const Zn=Math.sin(Ge),Ri=Math.cos(Ge),Ut=[Ri,-Zn,Zn,Ri];fi._matMult(Ut),Hi._matMult(Ut),br._matMult(Ut),or._matMult(Ut)}const sr=new lt(0,0),$r=new lt(0,0);Ue.push({tl:fi,tr:Hi,bl:br,br:or,tex:Re,writingMode:re.writingMode,glyphOffset:yo,sectionIndex:qe.sectionIndex,isSDF:rt,pixelOffsetTL:sr,pixelOffsetBR:$r,minFontScaleX:0,minFontScaleY:0})}return Ue}(0,c,C,g,v,x,h,a.allowVerticalPlacement),W=a.textSizeData;let se=null;"source"===W.kind?(se=[$a*g.layout.get("text-size").evaluate(x,{})],se[0]>Fl&&pt(`${a.layerIds[0]}: Value for "text-size" is >= ${Td}. Reduce your "text-size".`)):"composite"===W.kind&&(se=[$a*V.compositeTextSizes[0].evaluate(x,{},H),$a*V.compositeTextSizes[1].evaluate(x,{},H)],(se[0]>Fl||se[1]>Fl)&&pt(`${a.layerIds[0]}: Value for "text-size" is >= ${Td}. Reduce your "text-size".`)),a.addSymbols(a.text,K,se,C,v,x,A,o,S.lineStartIndex,S.lineLength,B,H);for(const ue of R)L[ue]=a.text.placedSymbolArray.length-1;return 4*K.length}function Xh(a){for(const o in a)return a[o];return null}function Vv(a,o,c,h){const g=a.compareText;if(o in g){const v=g[o];for(let x=v.length-1;x>=0;x--)if(h.dist(v[x])<c)return!0}else g[o]=[];return g[o].push(h),!1}const Lg=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Nf{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,h]=new Uint8Array(o,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(1!==g)throw new Error(`Got v${g} data when expected v1.`);const v=Lg[15&h];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(o,2,1),[C]=new Uint32Array(o,4,1);return new Nf(C,x,v,o)}constructor(o,c=64,h=Float64Array,g){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=h,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const v=Lg.indexOf(this.ArrayType),x=2*o*this.ArrayType.BYTES_PER_ELEMENT,C=o*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-C%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+C+S,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+x+C+S),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+C+S,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=o)}add(o,c){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=o,this.coords[this._pos++]=c,h}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return Kh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,c,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:C}=this,S=[0,v.length-1,0],A=[];for(;S.length;){const R=S.pop()||0,L=S.pop()||0,B=S.pop()||0;if(L-B<=C){for(let W=B;W<=L;W++){const se=x[2*W],ue=x[2*W+1];se>=o&&se<=h&&ue>=c&&ue<=g&&A.push(v[W])}continue}const V=B+L>>1,H=x[2*V],K=x[2*V+1];H>=o&&H<=h&&K>=c&&K<=g&&A.push(v[V]),(0===R?o<=H:c<=K)&&(S.push(B),S.push(V-1),S.push(1-R)),(0===R?h>=H:g>=K)&&(S.push(V+1),S.push(L),S.push(1-R))}return A}within(o,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:v,nodeSize:x}=this,C=[0,g.length-1,0],S=[],A=h*h;for(;C.length;){const R=C.pop()||0,L=C.pop()||0,B=C.pop()||0;if(L-B<=x){for(let W=B;W<=L;W++)Yh(v[2*W],v[2*W+1],o,c)<=A&&S.push(g[W]);continue}const V=B+L>>1,H=v[2*V],K=v[2*V+1];Yh(H,K,o,c)<=A&&S.push(g[V]),(0===R?o-h<=H:c-h<=K)&&(C.push(B),C.push(V-1),C.push(1-R)),(0===R?o+h>=H:c+h>=K)&&(C.push(V+1),C.push(L),C.push(1-R))}return S}}function Kh(a,o,c,h,g,v){if(g-h<=c)return;const x=h+g>>1;Ng(a,o,x,h,g,v),Kh(a,o,c,h,x-1,1-v),Kh(a,o,c,x+1,g,1-v)}function Ng(a,o,c,h,g,v){for(;g>h;){if(g-h>600){const A=g-h+1,R=c-h+1,L=Math.log(A),B=.5*Math.exp(2*L/3),V=.5*Math.sqrt(L*B*(A-B)/A)*(R-A/2<0?-1:1);Ng(a,o,c,Math.max(h,Math.floor(c-R*B/A+V)),Math.min(g,Math.floor(c+(A-R)*B/A+V)),v)}const x=o[2*c+v];let C=h,S=g;for(Bd(a,o,h,c),o[2*g+v]>x&&Bd(a,o,h,g);C<S;){for(Bd(a,o,C,S),C++,S--;o[2*C+v]<x;)C++;for(;o[2*S+v]>x;)S--}o[2*h+v]===x?Bd(a,o,h,S):(S++,Bd(a,o,S,g)),S<=c&&(h=S+1),c<=S&&(g=S-1)}}function Bd(a,o,c,h){jr(a,c,h),jr(o,2*c,2*h),jr(o,2*c+1,2*h+1)}function jr(a,o,c){const h=a[o];a[o]=a[c],a[c]=h}function Yh(a,o,c,h){const g=a-c,v=o-h;return g*g+v*v}var Qh;y.PerformanceMarkers=void 0,(Qh=y.PerformanceMarkers||(y.PerformanceMarkers={})).create="create",Qh.load="load",Qh.fullLoad="fullLoad";let Eu=null,ji=[];const mc=1e3/60,Jh="loadTime",ep="fullLoadTime",Uv={mark(a){performance.mark(a)},frame(a){const o=a;null!=Eu&&ji.push(o-Eu),Eu=o},clearMetrics(){Eu=null,ji=[],performance.clearMeasures(Jh),performance.clearMeasures(ep);for(const a in y.PerformanceMarkers)performance.clearMarks(y.PerformanceMarkers[a])},getPerformanceMetrics(){performance.measure(Jh,y.PerformanceMarkers.create,y.PerformanceMarkers.load),performance.measure(ep,y.PerformanceMarkers.create,y.PerformanceMarkers.fullLoad);const a=performance.getEntriesByName(Jh)[0].duration,o=performance.getEntriesByName(ep)[0].duration,c=ji.length,h=1/(ji.reduce((v,x)=>v+x,0)/c/1e3),g=ji.filter(v=>v>mc).reduce((v,x)=>v+(x-mc)/mc,0);return{loadTime:a,fullLoadTime:o,fps:h,percentDroppedFrames:g/(c+g)*100,totalFrames:c}}};y.AJAXError=qs,y.ARRAY_TYPE=nr,y.Actor=class{constructor(a,o,c){this.target=a,this.parent=o,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Mo(["receive","process"],this),this.invoker=new Hh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Gn()?a:window}send(a,o,c,h,g=!1){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[v]=c);const x=To(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:a,hasCallback:!!c,targetMapId:h,mustQueue:g,sourceMapId:this.mapId,data:bl(o,x)},x),{cancel:()=>{c&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(a){const o=a.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){delete this.tasks[c];const h=this.cancelCallbacks[c];delete this.cancelCallbacks[c],h&&h()}else Gn()||o.mustQueue?(this.tasks[c]=o,this.taskQueue.push(c),this.invoker.trigger()):this.processTask(c,o)}process(){if(!this.taskQueue.length)return;const a=this.taskQueue.shift(),o=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(a,o)}processTask(a,o){if("<response>"===o.type){const c=this.callbacks[a];delete this.callbacks[a],c&&(o.error?c(Ss(o.error)):c(null,Ss(o.data)))}else{let c=!1;const h=To(this.globalScope)?void 0:[],g=o.hasCallback?(C,S)=>{c=!0,delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:C?bl(C):null,data:bl(S,h)},h)}:C=>{c=!0};let v=null;const x=Ss(o.data);if(this.parent[o.type])v=this.parent[o.type](o.sourceMapId,x,g);else if(this.parent.getWorkerSource){const C=o.type.split(".");v=this.parent.getWorkerSource(o.sourceMapId,C[0],x.source)[C[1]](x,g)}else g(new Error(`Could not find function ${o.type}`));!c&&v&&v.cancel&&(this.cancelCallbacks[a]=v.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},y.AlphaImage=ou,y.CanonicalTileID=kf,y.CollisionBoxArray=_,y.CollisionCircleLayoutArray=class extends er{},y.Color=vt,y.DEMData=Pf,y.DataConstantProperty=et,y.DictionaryCoder=Ag,y.EXTENT=kn,y.ErrorEvent=Nr,y.EvaluationParameters=Le,y.Event=fn,y.Evented=ol,y.FeatureIndex=Pv,y.FillBucket=wd,y.FillExtrusionBucket=lu,y.GeoJSONFeature=Rf,y.ImageAtlas=Ev,y.ImagePosition=Cf,y.KDBush=Nf,y.LineBucket=pg,y.LineStripIndexArray=class extends s{},y.LngLat=Ol,y.MercatorCoordinate=qh,y.ONE_EM=bi,y.OverscaledTileID=Uo,y.PerformanceUtils=Uv,y.Point=lt,y.Pos3dArray=class extends sa{},y.PosArray=X,y.Properties=sn,y.Protobuf=kl,y.QuadTriangleArray=class extends El{},y.RGBAImage=Vo,y.RasterBoundsArray=class extends Gt{},y.RequestPerformance=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return 0===a.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},y.SegmentVector=He,y.SymbolBucket=bu,y.Transitionable=mo,y.TriangleIndexArray=ke,y.Uniform1f=ks,y.Uniform1i=class extends gr{constructor(a,o){super(a,o),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},y.Uniform2f=class extends gr{constructor(a,o){super(a,o),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},y.Uniform3f=class extends gr{constructor(a,o){super(a,o),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},y.Uniform4f=iu,y.UniformColor=Ar,y.UniformMatrix4f=class extends gr{constructor(a,o){super(a,o),this.current=zi}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let o=1;o<16;o++)if(a[o]!==this.current[o]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},y.UnwrappedTileID=Tg,y.ValidationError=je,y.ZoomHistory=wh,y.addDynamicAttributes=Uh,y.arrayBufferToImage=function(a,o){const c=new Image;c.onload=()=>{o(null,c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=Lr})},c.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(a)],{type:"image/png"});c.src=a.byteLength?URL.createObjectURL(h):Lr},y.arrayBufferToImageBitmap=function(a,o){const c=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(c).then(h=>{o(null,h)}).catch(h=>{o(new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},y.asyncAll=function(a,o,c){if(!a.length)return c(null,[]);let h=a.length;const g=new Array(a.length);let v=null;a.forEach((x,C)=>{o(x,(S,A)=>{S&&(v=S),g[C]=A,0==--h&&c(v,g)})})},y.bezier=Zr,y.bindAll=Mo,y.clamp=zn,y.clipLine=kg,y.clone=function(a){var o=new nr(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},y.clone$1=We,y.collisionCircleLayout=ya,y.config=rl,y.copy=function(a,o){return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a},y.create=function(){var a=new nr(16);return nr!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},y.createExpression=Kn,y.createFilter=rd,y.createLayout=An,y.createStyleLayer=function(a){return"custom"===a.type?new Sg(a):new Af[a.type](a)},y.deepEqual=function a(o,c){if(Array.isArray(o)){if(!Array.isArray(c)||o.length!==c.length)return!1;for(let h=0;h<o.length;h++)if(!a(o[h],c[h]))return!1;return!0}if("object"==typeof o&&null!==o&&null!==c){if("object"!=typeof c||Object.keys(o).length!==Object.keys(c).length)return!1;for(const h in o)if(!a(o[h],c[h]))return!1;return!0}return o===c},y.derefLayers=function(a){a=a.slice();const o=Object.create(null);for(let c=0;c<a.length;c++)o[a[c].id]=a[c];for(let c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=Zl(a[c],o[a[c].ref]));return a},y.diffStyles=function(a,o){if(!a)return[{command:ln.setStyle,args:[o]}];let c=[];try{if(!Sn(a.version,o.version))return[{command:ln.setStyle,args:[o]}];Sn(a.center,o.center)||c.push({command:ln.setCenter,args:[o.center]}),Sn(a.zoom,o.zoom)||c.push({command:ln.setZoom,args:[o.zoom]}),Sn(a.bearing,o.bearing)||c.push({command:ln.setBearing,args:[o.bearing]}),Sn(a.pitch,o.pitch)||c.push({command:ln.setPitch,args:[o.pitch]}),Sn(a.sprite,o.sprite)||c.push({command:ln.setSprite,args:[o.sprite]}),Sn(a.glyphs,o.glyphs)||c.push({command:ln.setGlyphs,args:[o.glyphs]}),Sn(a.transition,o.transition)||c.push({command:ln.setTransition,args:[o.transition]}),Sn(a.light,o.light)||c.push({command:ln.setLight,args:[o.light]});const h={},g=[];!function(x,C,S,A){let R;for(R in C=C||{},x=x||{})Object.prototype.hasOwnProperty.call(x,R)&&(Object.prototype.hasOwnProperty.call(C,R)||Oc(R,S,A));for(R in C)Object.prototype.hasOwnProperty.call(C,R)&&(Object.prototype.hasOwnProperty.call(x,R)?Sn(x[R],C[R])||("geojson"===x[R].type&&"geojson"===C[R].type&&mi(x,C,R)?S.push({command:ln.setGeoJSONSourceData,args:[R,C[R].data]}):Gu(R,C,S,A)):sl(R,C,S))}(a.sources,o.sources,g,h);const v=[];a.layers&&a.layers.forEach(x=>{h[x.source]?c.push({command:ln.removeLayer,args:[x.id]}):v.push(x)}),c=c.concat(g),function(x,C,S){C=C||[];const A=(x=x||[]).map(al),R=C.map(al),L=x.reduce(gs,{}),B=C.reduce(gs,{}),V=A.slice(),H=Object.create(null);let K,W,se,ue,re,he,me;for(K=0,W=0;K<A.length;K++)se=A[K],Object.prototype.hasOwnProperty.call(B,se)?W++:(S.push({command:ln.removeLayer,args:[se]}),V.splice(V.indexOf(se,W),1));for(K=0,W=0;K<R.length;K++)se=R[R.length-1-K],V[V.length-1-K]!==se&&(Object.prototype.hasOwnProperty.call(L,se)?(S.push({command:ln.removeLayer,args:[se]}),V.splice(V.lastIndexOf(se,V.length-W),1)):W++,he=V[V.length-K],S.push({command:ln.addLayer,args:[B[se],he]}),V.splice(V.length-K,0,se),H[se]=!0);for(K=0;K<R.length;K++)if(se=R[K],ue=L[se],re=B[se],!H[se]&&!Sn(ue,re))if(Sn(ue.source,re.source)&&Sn(ue["source-layer"],re["source-layer"])&&Sn(ue.type,re.type)){for(me in Zs(ue.layout,re.layout,S,se,null,ln.setLayoutProperty),Zs(ue.paint,re.paint,S,se,null,ln.setPaintProperty),Sn(ue.filter,re.filter)||S.push({command:ln.setFilter,args:[se,re.filter]}),Sn(ue.minzoom,re.minzoom)&&Sn(ue.maxzoom,re.maxzoom)||S.push({command:ln.setLayerZoomRange,args:[se,re.minzoom,re.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,me)&&"layout"!==me&&"paint"!==me&&"filter"!==me&&"metadata"!==me&&"minzoom"!==me&&"maxzoom"!==me&&(0===me.indexOf("paint.")?Zs(ue[me],re[me],S,se,me.slice(6),ln.setPaintProperty):Sn(ue[me],re[me])||S.push({command:ln.setLayerProperty,args:[se,me,re[me]]}));for(me in re)Object.prototype.hasOwnProperty.call(re,me)&&!Object.prototype.hasOwnProperty.call(ue,me)&&"layout"!==me&&"paint"!==me&&"filter"!==me&&"metadata"!==me&&"minzoom"!==me&&"maxzoom"!==me&&(0===me.indexOf("paint.")?Zs(ue[me],re[me],S,se,me.slice(6),ln.setPaintProperty):Sn(ue[me],re[me])||S.push({command:ln.setLayerProperty,args:[se,me,re[me]]}))}else S.push({command:ln.removeLayer,args:[se]}),he=V[V.lastIndexOf(se)+1],S.push({command:ln.addLayer,args:[re,he]})}(v,o.layers,c)}catch(h){console.warn("Unable to compute style diff:",h),c=[{command:ln.setStyle,args:[o]}]}return c},y.dot=function(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]+a[3]*o[3]},y.earthRadius=$h,y.ease=Yo,y.emitValidationErrors=za,y.emptyStyle=function(){const a={},o=xe.$version;for(const c in xe.$root){const h=xe.$root[c];if(h.required){let g=null;g="version"===c?o:"array"===h.type?[]:{},null!=g&&(a[c]=g)}}return a},y.equals=function(a,o){var c=a[0],h=a[1],g=a[2],v=a[3],x=a[4],C=a[5],S=a[6],A=a[7],R=a[8],L=a[9],B=a[10],V=a[11],H=a[12],K=a[13],W=a[14],se=a[15],ue=o[0],re=o[1],he=o[2],me=o[3],Ce=o[4],Qe=o[5],nt=o[6],Ke=o[7],Ge=o[8],Ue=o[9],Ze=o[10],qe=o[11],Re=o[12],ht=o[13],rt=o[14],zt=o[15];return Math.abs(c-ue)<=tr*Math.max(1,Math.abs(c),Math.abs(ue))&&Math.abs(h-re)<=tr*Math.max(1,Math.abs(h),Math.abs(re))&&Math.abs(g-he)<=tr*Math.max(1,Math.abs(g),Math.abs(he))&&Math.abs(v-me)<=tr*Math.max(1,Math.abs(v),Math.abs(me))&&Math.abs(x-Ce)<=tr*Math.max(1,Math.abs(x),Math.abs(Ce))&&Math.abs(C-Qe)<=tr*Math.max(1,Math.abs(C),Math.abs(Qe))&&Math.abs(S-nt)<=tr*Math.max(1,Math.abs(S),Math.abs(nt))&&Math.abs(A-Ke)<=tr*Math.max(1,Math.abs(A),Math.abs(Ke))&&Math.abs(R-Ge)<=tr*Math.max(1,Math.abs(R),Math.abs(Ge))&&Math.abs(L-Ue)<=tr*Math.max(1,Math.abs(L),Math.abs(Ue))&&Math.abs(B-Ze)<=tr*Math.max(1,Math.abs(B),Math.abs(Ze))&&Math.abs(V-qe)<=tr*Math.max(1,Math.abs(V),Math.abs(qe))&&Math.abs(H-Re)<=tr*Math.max(1,Math.abs(H),Math.abs(Re))&&Math.abs(K-ht)<=tr*Math.max(1,Math.abs(K),Math.abs(ht))&&Math.abs(W-rt)<=tr*Math.max(1,Math.abs(W),Math.abs(rt))&&Math.abs(se-zt)<=tr*Math.max(1,Math.abs(se),Math.abs(zt))},y.evaluateSizeForFeature=function(a,{uSize:o,uSizeT:c},{lowerSize:h,upperSize:g}){return"source"===a.kind?h/$a:"composite"===a.kind?po.number(h/$a,g/$a,c):o},y.evaluateSizeForZoom=function(a,o){let c=0,h=0;if("constant"===a.kind)h=a.layoutSize;else if("source"!==a.kind){const{interpolationType:g,minZoom:v,maxZoom:x}=a,C=g?zn(Kr.interpolationFactor(g,o,v,x),0,1):0;"camera"===a.kind?h=po.number(a.minSize,a.maxSize,C):c=C}return{uSizeT:c,uSize:h}},y.evaluateVariableOffset=Og,y.evented=Va,y.exported=_n,y.extend=Ci,y.filterObject=ze,y.findLineIntersection=function(a,o,c,h){const g=o.y-a.y,v=o.x-a.x,x=h.y-c.y,C=h.x-c.x,S=x*v-C*g;if(0===S)return null;const A=(C*(a.y-c.y)-x*(a.x-c.x))/S;return new lt(a.x+A*v,a.y+A*g)},y.fromScaling=function(a,o){return a[0]=o[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=o[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},y.getAnchorAlignment=Rl,y.getAnchorJustification=Of,y.getArrayBuffer=Ra,y.getDefaultExportFromCjs=Qt,y.getJSON=function(a,o){return Pa(Ci(a,{type:"json"}),o)},y.getOverlapMode=io,y.getProtocolAction=uo,y.getRTLTextPluginStatus=dd,y.getReferrer=Dr,y.getVideo=function(a,o){const c=window.document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let h=0;h<a.length;h++){const g=window.document.createElement("source");Vn(a[h])||(c.crossOrigin="Anonymous"),g.src=a[h],c.appendChild(g)}return{cancel:()=>{}}},y.groupByLayout=function(a,o){const c={};for(let g=0;g<a.length;g++){const v=o&&o[a[g].id]||vh(a[g]);o&&(o[a[g].id]=v);let x=c[v];x||(x=c[v]=[]),x.push(a[g])}const h=[];for(const g in c)h.push(c[g]);return h},y.identity=Yp,y.interpolate=po,y.invert=function(a,o){var c=o[0],h=o[1],g=o[2],v=o[3],x=o[4],C=o[5],S=o[6],A=o[7],R=o[8],L=o[9],B=o[10],V=o[11],H=o[12],K=o[13],W=o[14],se=o[15],ue=c*C-h*x,re=c*S-g*x,he=c*A-v*x,me=h*S-g*C,Ce=h*A-v*C,Qe=g*A-v*S,nt=R*K-L*H,Ke=R*W-B*H,Ge=R*se-V*H,Ue=L*W-B*K,Ze=L*se-V*K,qe=B*se-V*W,Re=ue*qe-re*Ze+he*Ue+me*Ge-Ce*Ke+Qe*nt;return Re?(a[0]=(C*qe-S*Ze+A*Ue)*(Re=1/Re),a[1]=(g*Ze-h*qe-v*Ue)*Re,a[2]=(K*Qe-W*Ce+se*me)*Re,a[3]=(B*Ce-L*Qe-V*me)*Re,a[4]=(S*Ge-x*qe-A*Ke)*Re,a[5]=(c*qe-g*Ge+v*Ke)*Re,a[6]=(W*he-H*Qe-se*re)*Re,a[7]=(R*Qe-B*he+V*re)*Re,a[8]=(x*Ze-C*Ge+A*nt)*Re,a[9]=(h*Ge-c*Ze-v*nt)*Re,a[10]=(H*Ce-K*he+se*ue)*Re,a[11]=(L*he-R*Ce-V*ue)*Re,a[12]=(C*Ke-x*Ue-S*nt)*Re,a[13]=(c*Ue-h*Ke+g*nt)*Re,a[14]=(K*re-H*me-W*ue)*Re,a[15]=(R*me-L*re+B*ue)*Re,a):null},y.isImageBitmap=Ao,y.isSafari=To,y.isWorker=Gn,y.keysDifference=function(a,o){const c=[];for(const h in a)h in o||c.push(h);return c},y.lazyLoadRTLTextPlugin=function(){cn.isLoading()||cn.isLoaded()||"deferred"!==dd()||Ch()},y.makeRequest=Pa,y.mapObject=$e,y.mercatorXfromLng=xu,y.mercatorYfromLat=Mg,y.mercatorZfromAltitude=Av,y.mul=zo,y.mul$1=function(a,o,c){return a[0]=o[0]*c[0],a[1]=o[1]*c[1],a[2]=o[2]*c[2],a[3]=o[3]*c[3],a},y.multiply=Qp,y.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},y.operations=ln,y.ortho=function(a,o,c,h,g,v,x){var C=1/(o-c),S=1/(h-g),A=1/(v-x);return a[0]=-2*C,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*S,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*A,a[11]=0,a[12]=(o+c)*C,a[13]=(g+h)*S,a[14]=(x+v)*A,a[15]=1,a},y.parseCacheControl=function(a){const o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,h,g,v)=>{const x=g||v;return o[h]=!x||x.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o},y.parseGlyphPbf=function(a){return new kl(a).readFields(mu,[])},y.pbf=bf,y.performSymbolLayout=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=kn/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const o=a.bucket.layers[0].layout,c=a.bucket.layers[0]._unevaluatedLayout._values,h={layoutIconSize:c["icon-size"].possiblyEvaluate(new Le(a.bucket.zoom+1),a.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new Le(a.bucket.zoom+1),a.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new Le(18))};if("composite"===a.bucket.textSizeData.kind){const{minZoom:S,maxZoom:A}=a.bucket.textSizeData;h.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Le(S),a.canonical),c["text-size"].possiblyEvaluate(new Le(A),a.canonical)]}if("composite"===a.bucket.iconSizeData.kind){const{minZoom:S,maxZoom:A}=a.bucket.iconSizeData;h.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Le(S),a.canonical),c["icon-size"].possiblyEvaluate(new Le(A),a.canonical)]}const g=o.get("text-line-height")*bi,v="viewport"!==o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement"),x=o.get("text-keep-upright"),C=o.get("text-size");for(const S of a.bucket.features){const A=o.get("text-font").evaluate(S,{},a.canonical).join(","),R=C.evaluate(S,{},a.canonical),L=h.layoutTextSize.evaluate(S,{},a.canonical),B=h.layoutIconSize.evaluate(S,{},a.canonical),V={horizontal:{},vertical:void 0},H=S.text;let K,W=[0,0];if(H){const re=H.toString(),he=o.get("text-letter-spacing").evaluate(S,{},a.canonical)*bi,me=cd(re)?he:0,Ce=o.get("text-anchor").evaluate(S,{},a.canonical),Qe=o.get("text-variable-anchor");if(!Qe){const Ze=o.get("text-radial-offset").evaluate(S,{},a.canonical);W=Ze?Og(Ce,[Ze*bi,xa]):o.get("text-offset").evaluate(S,{},a.canonical).map(qe=>qe*bi)}let nt=v?"center":o.get("text-justify").evaluate(S,{},a.canonical);const Ke=o.get("symbol-placement"),Ge="point"===Ke?o.get("text-max-width").evaluate(S,{},a.canonical)*bi:0,Ue=()=>{a.bucket.allowVerticalPlacement&&Di(re)&&(V.vertical=Df(H,a.glyphMap,a.glyphPositions,a.imagePositions,A,Ge,g,Ce,"left",me,W,y.WritingMode.vertical,!0,Ke,L,R))};if(!v&&Qe){const Ze="auto"===nt?Qe.map(Re=>Of(Re)):[nt];let qe=!1;for(let Re=0;Re<Ze.length;Re++){const ht=Ze[Re];if(!V.horizontal[ht])if(qe)V.horizontal[ht]=V.horizontal[0];else{const rt=Df(H,a.glyphMap,a.glyphPositions,a.imagePositions,A,Ge,g,"center",ht,me,W,y.WritingMode.horizontal,!1,Ke,L,R);rt&&(V.horizontal[ht]=rt,qe=1===rt.positionedLines.length)}}Ue()}else{"auto"===nt&&(nt=Of(Ce));const Ze=Df(H,a.glyphMap,a.glyphPositions,a.imagePositions,A,Ge,g,Ce,nt,me,W,y.WritingMode.horizontal,!1,Ke,L,R);Ze&&(V.horizontal[nt]=Ze),Ue(),Di(re)&&v&&x&&(V.vertical=Df(H,a.glyphMap,a.glyphPositions,a.imagePositions,A,Ge,g,Ce,nt,me,W,y.WritingMode.vertical,!1,Ke,L,R))}}let se=!1;if(S.icon&&S.icon.name){const re=a.imageMap[S.icon.name];re&&(K=Vh(a.imagePositions[S.icon.name],o.get("icon-offset").evaluate(S,{},a.canonical),o.get("icon-anchor").evaluate(S,{},a.canonical)),se=!!re.sdf,void 0===a.bucket.sdfIcons?a.bucket.sdfIcons=se:a.bucket.sdfIcons!==se&&pt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(re.pixelRatio!==a.bucket.pixelRatio||0!==o.get("icon-rotate").constantOr(1))&&(a.bucket.iconsNeedLinear=!0))}const ue=Xh(V.horizontal)||V.vertical;a.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||K)&&zv(a.bucket,S,V,K,a.imageMap,h,L,B,W,se,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},y.perspective=function(a,o,c,h,g){var v,x=1/Math.tan(o/2);return a[0]=x/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=g&&g!==1/0?(a[10]=(g+h)*(v=1/(h-g)),a[14]=2*g*h*v):(a[10]=-1,a[14]=-2*h),a},y.pick=function(a,o){const c={};for(let h=0;h<o.length;h++){const g=o[h];g in a&&(c[g]=a[g])}return c},y.plugin=cn,y.pointGeometry=be,y.polygonIntersectsPolygon=eg,y.potpack=uc,y.register=Je,y.registerForPluginStateChange=function(a){return a({pluginStatus:Bi,pluginURL:vi}),Va.on("pluginStateChange",a),a},y.renderColorRamp=kt,y.rotateX=function(a,o,c){var h=Math.sin(c),g=Math.cos(c),v=o[4],x=o[5],C=o[6],S=o[7],A=o[8],R=o[9],L=o[10],B=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=v*g+A*h,a[5]=x*g+R*h,a[6]=C*g+L*h,a[7]=S*g+B*h,a[8]=A*g-v*h,a[9]=R*g-x*h,a[10]=L*g-C*h,a[11]=B*g-S*h,a},y.rotateZ=function(a,o,c){var h=Math.sin(c),g=Math.cos(c),v=o[0],x=o[1],C=o[2],S=o[3],A=o[4],R=o[5],L=o[6],B=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=v*g+A*h,a[1]=x*g+R*h,a[2]=C*g+L*h,a[3]=S*g+B*h,a[4]=A*g-v*h,a[5]=R*g-x*h,a[6]=L*g-C*h,a[7]=B*g-S*h,a},y.sameOrigin=Vn,y.scale=function(a,o,c){var h=c[0],g=c[1],v=c[2];return a[0]=o[0]*h,a[1]=o[1]*h,a[2]=o[2]*h,a[3]=o[3]*h,a[4]=o[4]*g,a[5]=o[5]*g,a[6]=o[6]*g,a[7]=o[7]*g,a[8]=o[8]*v,a[9]=o[9]*v,a[10]=o[10]*v,a[11]=o[11]*v,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a},y.setRTLTextPlugin=function(a,o,c=!1){if(Bi===hr||Bi===Kt||Bi===Si)throw new Error("setRTLTextPlugin cannot be called multiple times.");vi=_n.resolveURL(a),Bi=hr,Ii=o,tu(),c||Ch()},y.sphericalToCartesian=function([a,o,c]){return o+=90,o*=Math.PI/180,c*=Math.PI/180,{x:a*Math.cos(o)*Math.sin(c),y:a*Math.sin(o)*Math.sin(c),z:a*Math.cos(c)}},y.toEvaluationFeature=Dl,y.transformMat4=Th,y.translate=function(a,o,c){var h,g,v,x,C,S,A,R,L,B,V,H,K=c[0],W=c[1],se=c[2];return o===a?(a[12]=o[0]*K+o[4]*W+o[8]*se+o[12],a[13]=o[1]*K+o[5]*W+o[9]*se+o[13],a[14]=o[2]*K+o[6]*W+o[10]*se+o[14],a[15]=o[3]*K+o[7]*W+o[11]*se+o[15]):(g=o[1],v=o[2],x=o[3],C=o[4],S=o[5],A=o[6],R=o[7],L=o[8],B=o[9],V=o[10],H=o[11],a[0]=h=o[0],a[1]=g,a[2]=v,a[3]=x,a[4]=C,a[5]=S,a[6]=A,a[7]=R,a[8]=L,a[9]=B,a[10]=V,a[11]=H,a[12]=h*K+C*W+L*se+o[12],a[13]=g*K+S*W+B*se+o[13],a[14]=v*K+A*W+V*se+o[14],a[15]=x*K+R*W+H*se+o[15]),a},y.triggerPluginCompletionEvent=ud,y.unicodeBlockLookup=Xe,y.uniqueId=function(){return Io++},y.v8Spec=xe,y.validateCustomStyleLayer=function(a){const o=[],c=a.id;return void 0===c&&o.push({message:`layers.${c}: missing required property "id"`}),void 0===a.render&&o.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},y.validateLight=jp,y.validateStyle=ia,y.vectorTile=Sl,y.warnOnce=pt,y.wrap=co}),Rc(0,function(y){class Qt{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,z){for(const ee of N){this._layerConfigs[ee.id]=ee;const ne=this._layers[ee.id]=y.createStyleLayer(ee);ne._featureFilter=y.createFilter(ne.filter),this.keyCache[ee.id]&&delete this.keyCache[ee.id]}for(const ee of z)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const G=y.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ee of G){const ne=ee.map(Ie=>this._layers[Ie.id]),ce=ne[0];if("none"===ce.visibility)continue;const ae=ce.source||"";let ie=this.familiesBySource[ae];ie||(ie=this.familiesBySource[ae]={});const de=ce.sourceLayer||"_geojsonTileLayer";let Se=ie[de];Se||(Se=ie[de]=[]),Se.push(ne)}}}class be{constructor(N){const z={},G=[];for(const ae in N){const ie=N[ae],de=z[ae]={};for(const Se in ie){const Ie=ie[+Se];if(!Ie||0===Ie.bitmap.width||0===Ie.bitmap.height)continue;const we={x:0,y:0,w:Ie.bitmap.width+2,h:Ie.bitmap.height+2};G.push(we),de[Se]={rect:we,metrics:Ie.metrics}}}const{w:ee,h:ne}=y.potpack(G),ce=new y.AlphaImage({width:ee||1,height:ne||1});for(const ae in N){const ie=N[ae];for(const de in ie){const Se=ie[+de];if(!Se||0===Se.bitmap.width||0===Se.bitmap.height)continue;const Ie=z[ae][de].rect;y.AlphaImage.copy(Se.bitmap,ce,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Se.bitmap)}}this.image=ce,this.positions=z}}y.register("GlyphAtlas",be);class Wi{constructor(N){this.tileID=new y.OverscaledTileID(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId}parse(N,z,G,ee,ne){this.status="parsing",this.data=N,this.collisionBoxArray=new y.CollisionBoxArray;const ce=new y.DictionaryCoder(Object.keys(N.layers).sort()),ae=new y.FeatureIndex(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const ie={},de={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:G},Se=z.familiesBySource[this.source];for(const Nt in Se){const Bt=N.layers[Nt];if(!Bt)continue;1===Bt.version&&y.warnOnce(`Vector tile source "${this.source}" layer "${Nt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const In=ce.encode(Nt),Un=[];for(let vt=0;vt<Bt.length;vt++){const jn=Bt.feature(vt),Fa=ae.getId(jn,Nt);Un.push({feature:jn,id:Fa,index:vt,sourceLayerIndex:In})}for(const vt of Se[Nt]){const jn=vt[0];jn.source!==this.source&&y.warnOnce(`layer.source = ${jn.source} does not equal this.source = ${this.source}`),jn.minzoom&&this.zoom<Math.floor(jn.minzoom)||jn.maxzoom&&this.zoom>=jn.maxzoom||"none"!==jn.visibility&&(lt(vt,this.zoom,G),(ie[jn.id]=jn.createBucket({index:ae.bucketLayerIDs.length,layers:vt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:In,sourceID:this.source})).populate(Un,de,this.tileID.canonical),ae.bucketLayerIDs.push(vt.map(Fa=>Fa.id)))}}let Ie,we,ft,Et;const tt=y.mapObject(de.glyphDependencies,Nt=>Object.keys(Nt).map(Number));Object.keys(tt).length?ee.send("getGlyphs",{uid:this.uid,stacks:tt,source:this.source,tileID:this.tileID,type:"glyphs"},(Nt,Bt)=>{Ie||(Ie=Nt,we=Bt,Xt.call(this))}):we={};const dt=Object.keys(de.iconDependencies);dt.length?ee.send("getImages",{icons:dt,source:this.source,tileID:this.tileID,type:"icons"},(Nt,Bt)=>{Ie||(Ie=Nt,ft=Bt,Xt.call(this))}):ft={};const xt=Object.keys(de.patternDependencies);function Xt(){if(Ie)return ne(Ie);if(we&&ft&&Et){const Nt=new be(we),Bt=new y.ImageAtlas(ft,Et);for(const In in ie){const Un=ie[In];Un instanceof y.SymbolBucket?(lt(Un.layers,this.zoom,G),y.performSymbolLayout({bucket:Un,glyphMap:we,glyphPositions:Nt.positions,imageMap:ft,imagePositions:Bt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Un.hasPattern&&(Un instanceof y.LineBucket||Un instanceof y.FillBucket||Un instanceof y.FillExtrusionBucket)&&(lt(Un.layers,this.zoom,G),Un.addFeatures(de,this.tileID.canonical,Bt.patternPositions))}this.status="done",ne(null,{buckets:Object.values(ie).filter(In=>!In.isEmpty()),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Nt.image,imageAtlas:Bt,glyphMap:this.returnDependencies?we:null,iconMap:this.returnDependencies?ft:null,glyphPositions:this.returnDependencies?Nt.positions:null})}}xt.length?ee.send("getImages",{icons:xt,source:this.source,tileID:this.tileID,type:"patterns"},(Nt,Bt)=>{Ie||(Ie=Nt,Et=Bt,Xt.call(this))}):Et={},Xt.call(this)}}function lt(Y,N,z){const G=new y.EvaluationParameters(N);for(const ee of Y)ee.recalculate(G,z)}function cr(Y,N){const z=y.getArrayBuffer(Y.request,(G,ee,ne,ce)=>{G?N(G):ee&&N(null,{vectorTile:new y.vectorTile.VectorTile(new y.Protobuf(ee)),rawData:ee,cacheControl:ne,expires:ce})});return()=>{z.cancel(),N()}}class Wr{constructor(N,z,G,ee){this.actor=N,this.layerIndex=z,this.availableImages=G,this.loadVectorData=ee||cr,this.loading={},this.loaded={}}loadTile(N,z){const G=N.uid;this.loading||(this.loading={});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new y.RequestPerformance(N.request),ne=this.loading[G]=new Wi(N);ne.abort=this.loadVectorData(N,(ce,ae)=>{if(delete this.loading[G],ce||!ae)return ne.status="done",this.loaded[G]=ne,z(ce);const ie=ae.rawData,de={};ae.expires&&(de.expires=ae.expires),ae.cacheControl&&(de.cacheControl=ae.cacheControl);const Se={};if(ee){const Ie=ee.finish();Ie&&(Se.resourceTiming=JSON.parse(JSON.stringify(Ie)))}ne.vectorTile=ae.vectorTile,ne.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ie,we)=>{if(Ie||!we)return z(Ie);z(null,y.extend({rawTileData:ie.slice(0)},we,de,Se))}),this.loaded=this.loaded||{},this.loaded[G]=ne})}reloadTile(N,z){const G=this.loaded,ee=N.uid,ne=this;if(G&&G[ee]){const ce=G[ee];ce.showCollisionBoxes=N.showCollisionBoxes;const ae=(ie,de)=>{const Se=ce.reloadCallback;Se&&(delete ce.reloadCallback,ce.parse(ce.vectorTile,ne.layerIndex,this.availableImages,ne.actor,Se)),z(ie,de)};"parsing"===ce.status?ce.reloadCallback=ae:"done"===ce.status&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,ae):ae())}}abortTile(N,z){const G=this.loading,ee=N.uid;G&&G[ee]&&G[ee].abort&&(G[ee].abort(),delete G[ee]),z()}removeTile(N,z){const G=this.loaded,ee=N.uid;G&&G[ee]&&delete G[ee],z()}}class fs{constructor(){this.loaded={}}loadTile(N,z){const{uid:G,encoding:ee,rawImageData:ne}=N,ce=y.isImageBitmap(ne)?this.getImageData(ne):ne,ae=new y.DEMData(G,ce,ee);this.loaded=this.loaded||{},this.loaded[G]=ae,z(null,ae)}getImageData(N){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(N.width,N.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=N.width,this.offscreenCanvas.height=N.height,this.offscreenCanvasContext.drawImage(N,0,0,N.width,N.height);const z=this.offscreenCanvasContext.getImageData(-1,-1,N.width+2,N.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new y.RGBAImage({width:z.width,height:z.height},z.data)}removeTile(N){const z=this.loaded,G=N.uid;z&&z[G]&&delete z[G]}}function Zr(Y,N){if(0!==Y.length){Yo(Y[0],N);for(var z=1;z<Y.length;z++)Yo(Y[z],!N)}}function Yo(Y,N){for(var z=0,G=0,ee=0,ne=Y.length,ce=ne-1;ee<ne;ce=ee++){var ae=(Y[ee][0]-Y[ce][0])*(Y[ce][1]+Y[ee][1]),ie=z+ae;G+=Math.abs(z)>=Math.abs(ae)?z-ie+ae:ae-ie+z,z=ie}z+G>=0!=!!N&&Y.reverse()}var zn=y.getDefaultExportFromCjs(function Y(N,z){var G,ee=N&&N.type;if("FeatureCollection"===ee)for(G=0;G<N.features.length;G++)Y(N.features[G],z);else if("GeometryCollection"===ee)for(G=0;G<N.geometries.length;G++)Y(N.geometries[G],z);else if("Feature"===ee)Y(N.geometry,z);else if("Polygon"===ee)Zr(N.coordinates,z);else if("MultiPolygon"===ee)for(G=0;G<N.coordinates.length;G++)Zr(N.coordinates[G],z);return N});const co=y.vectorTile.VectorTileFeature.prototype.toGeoJSON;var Ci={exports:{}},Io=y.pointGeometry,Mo=y.vectorTile.VectorTileFeature,$e=ze;function ze(Y,N){this.options=N||{},this.features=Y,this.length=Y.length}function We(Y,N){this.id="number"==typeof Y.id?Y.id:void 0,this.type=Y.type,this.rawGeometry=1===Y.type?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=N||4096}ze.prototype.feature=function(Y){return new We(this.features[Y],this.options.extent)},We.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var N=0;N<Y.length;N++){for(var z=Y[N],G=[],ee=0;ee<z.length;ee++)G.push(new Io(z[ee][0],z[ee][1]));this.geometry.push(G)}return this.geometry},We.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,N=1/0,z=-1/0,G=1/0,ee=-1/0,ne=0;ne<Y.length;ne++)for(var ce=Y[ne],ae=0;ae<ce.length;ae++){var ie=ce[ae];N=Math.min(N,ie.x),z=Math.max(z,ie.x),G=Math.min(G,ie.y),ee=Math.max(ee,ie.y)}return[N,G,z,ee]},We.prototype.toGeoJSON=Mo.prototype.toGeoJSON;var ct=y.pbf,pt=$e;function ut(Y){var N=new ct;return function(z,G){for(var ee in z.layers)G.writeMessage(3,Lt,z.layers[ee])}(Y,N),N.finish()}function Lt(Y,N){var z;N.writeVarintField(15,Y.version||1),N.writeStringField(1,Y.name||""),N.writeVarintField(5,Y.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(z=0;z<Y.length;z++)G.feature=Y.feature(z),N.writeMessage(2,Gn,G);var ee=G.keys;for(z=0;z<ee.length;z++)N.writeStringField(3,ee[z]);var ne=G.values;for(z=0;z<ne.length;z++)N.writeMessage(4,Wl,ne[z])}function Gn(Y,N){var z=Y.feature;void 0!==z.id&&N.writeVarintField(1,z.id),N.writeMessage(2,Zi,Y),N.writeVarintField(3,z.type),N.writeMessage(4,Lr,z)}function Zi(Y,N){var z=Y.feature,G=Y.keys,ee=Y.values,ne=Y.keycache,ce=Y.valuecache;for(var ae in z.properties){var ie=z.properties[ae],de=ne[ae];if(null!==ie){void 0===de&&(G.push(ae),ne[ae]=de=G.length-1),N.writeVarint(de);var Se=typeof ie;"string"!==Se&&"boolean"!==Se&&"number"!==Se&&(ie=JSON.stringify(ie));var Ie=Se+":"+ie,we=ce[Ie];void 0===we&&(ee.push(ie),ce[Ie]=we=ee.length-1),N.writeVarint(we)}}}function To(Y,N){return(N<<3)+(7&Y)}function Ao(Y){return Y<<1^Y>>31}function Lr(Y,N){for(var z=Y.loadGeometry(),G=Y.type,ee=0,ne=0,ce=z.length,ae=0;ae<ce;ae++){var ie=z[ae],de=1;1===G&&(de=ie.length),N.writeVarint(To(1,de));for(var Se=3===G?ie.length-1:ie.length,Ie=0;Ie<Se;Ie++){1===Ie&&1!==G&&N.writeVarint(To(2,Se-1));var we=ie[Ie].x-ee,ft=ie[Ie].y-ne;N.writeVarint(Ao(we)),N.writeVarint(Ao(ft)),ee+=we,ne+=ft}3===G&&N.writeVarint(To(7,1))}}function Wl(Y,N){var z=typeof Y;"string"===z?N.writeStringField(1,Y):"boolean"===z?N.writeBooleanField(7,Y):"number"===z&&(Y%1!=0?N.writeDoubleField(3,Y):Y<0?N.writeSVarintField(6,Y):N.writeVarintField(5,Y))}Ci.exports=ut,Ci.exports.fromVectorTileJs=ut,Ci.exports.fromGeojsonVt=function(Y,N){N=N||{};var z={};for(var G in Y)z[G]=new pt(Y[G].features,N),z[G].name=G,z[G].version=N.version,z[G].extent=N.extent;return ut({layers:z})},Ci.exports.GeoJSONWrapper=pt;var Gs=y.getDefaultExportFromCjs(Ci.exports);const _n={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Y=>Y},rl=Math.fround||(qs=new Float32Array(1),Y=>(qs[0]=+Y,qs[0]));var qs;const Dr=3,uo=5,Ft=6;class Pa{constructor(N){this.options=Object.assign(Object.create(_n),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:z,minZoom:G,maxZoom:ee}=this.options;z&&console.time("total time");const ne=`prepare ${N.length} points`;z&&console.time(ne),this.points=N;const ce=[];for(let ie=0;ie<N.length;ie++){const de=N[ie];if(!de.geometry)continue;const[Se,Ie]=de.geometry.coordinates,we=rl(Mn(Se)),ft=rl(ms(Ie));ce.push(we,ft,1/0,ie,-1,1),this.options.reduce&&ce.push(0)}let ae=this.trees[ee+1]=this._createTree(ce);z&&console.timeEnd(ne);for(let ie=ee;ie>=G;ie--){const de=+Date.now();ae=this.trees[ie]=this._createTree(this._cluster(ae,ie)),z&&console.log("z%d: %d clusters in %dms",ie,ae.numItems,+Date.now()-de)}return z&&console.timeEnd("total time"),this}getClusters(N,z){let G=((N[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,N[1]));let ne=180===N[2]?180:((N[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)G=-180,ne=180;else if(G>ne){const Ie=this.getClusters([G,ee,180,ce],z),we=this.getClusters([-180,ee,ne,ce],z);return Ie.concat(we)}const ae=this.trees[this._limitZoom(z)],ie=ae.range(Mn(G),ms(ce),Mn(ne),ms(ee)),de=ae.data,Se=[];for(const Ie of ie){const we=this.stride*Ie;Se.push(de[we+uo]>1?Ra(de,we,this.clusterProps):this.points[de[we+Dr]])}return Se}getChildren(N){const z=this._getOriginId(N),G=this._getOriginZoom(N),ee="No cluster with the specified id.",ne=this.trees[G];if(!ne)throw new Error(ee);const ce=ne.data;if(z*this.stride>=ce.length)throw new Error(ee);const ae=this.options.radius/(this.options.extent*Math.pow(2,G-1)),ie=ne.within(ce[z*this.stride],ce[z*this.stride+1],ae),de=[];for(const Se of ie){const Ie=Se*this.stride;ce[Ie+4]===N&&de.push(ce[Ie+uo]>1?Ra(ce,Ie,this.clusterProps):this.points[ce[Ie+Dr]])}if(0===de.length)throw new Error(ee);return de}getLeaves(N,z,G){const ee=[];return this._appendLeaves(ee,N,z=z||10,G=G||0,0),ee}getTile(N,z,G){const ee=this.trees[this._limitZoom(N)],ne=Math.pow(2,N),{extent:ce,radius:ae}=this.options,ie=ae/ce,de=(G-ie)/ne,Se=(G+1+ie)/ne,Ie={features:[]};return this._addTileFeatures(ee.range((z-ie)/ne,de,(z+1+ie)/ne,Se),ee.data,z,G,ne,Ie),0===z&&this._addTileFeatures(ee.range(1-ie/ne,de,1,Se),ee.data,ne,G,ne,Ie),z===ne-1&&this._addTileFeatures(ee.range(0,de,ie/ne,Se),ee.data,-1,G,ne,Ie),Ie.features.length?Ie:null}getClusterExpansionZoom(N){let z=this._getOriginZoom(N)-1;for(;z<=this.options.maxZoom;){const G=this.getChildren(N);if(z++,1!==G.length)break;N=G[0].properties.cluster_id}return z}_appendLeaves(N,z,G,ee,ne){const ce=this.getChildren(z);for(const ae of ce){const ie=ae.properties;if(ie&&ie.cluster?ne+ie.point_count<=ee?ne+=ie.point_count:ne=this._appendLeaves(N,ie.cluster_id,G,ee,ne):ne<ee?ne++:N.push(ae),N.length===G)break}return ne}_createTree(N){const z=new y.KDBush(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let G=0;G<N.length;G+=this.stride)z.add(N[G],N[G+1]);return z.finish(),z.data=N,z}_addTileFeatures(N,z,G,ee,ne,ce){for(const ae of N){const ie=ae*this.stride,de=z[ie+uo]>1;let Se,Ie,we;if(de)Se=Vn(z,ie,this.clusterProps),Ie=z[ie],we=z[ie+1];else{const tt=this.points[z[ie+Dr]];Se=tt.properties;const[dt,xt]=tt.geometry.coordinates;Ie=Mn(dt),we=ms(xt)}const ft={type:1,geometry:[[Math.round(this.options.extent*(Ie*ne-G)),Math.round(this.options.extent*(we*ne-ee))]],tags:Se};let Et;Et=de||this.options.generateId?z[ie+Dr]:this.points[z[ie+Dr]].id,void 0!==Et&&(ft.id=Et),ce.features.push(ft)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,z){const{radius:G,extent:ee,reduce:ne,minPoints:ce}=this.options,ae=G/(ee*Math.pow(2,z)),ie=N.data,de=[],Se=this.stride;for(let Ie=0;Ie<ie.length;Ie+=Se){if(ie[Ie+2]<=z)continue;ie[Ie+2]=z;const we=ie[Ie],ft=ie[Ie+1],Et=N.within(ie[Ie],ie[Ie+1],ae),tt=ie[Ie+uo];let dt=tt;for(const xt of Et){const Xt=xt*Se;ie[Xt+2]>z&&(dt+=ie[Xt+uo])}if(dt>tt&&dt>=ce){let xt,Xt=we*tt,Nt=ft*tt,Bt=-1;const In=((Ie/Se|0)<<5)+(z+1)+this.points.length;for(const Un of Et){const vt=Un*Se;if(ie[vt+2]<=z)continue;ie[vt+2]=z;const jn=ie[vt+uo];Xt+=ie[vt]*jn,Nt+=ie[vt+1]*jn,ie[vt+4]=In,ne&&(xt||(xt=this._map(ie,Ie,!0),Bt=this.clusterProps.length,this.clusterProps.push(xt)),ne(xt,this._map(ie,vt)))}ie[Ie+4]=In,de.push(Xt/dt,Nt/dt,1/0,In,-1,dt),ne&&de.push(Bt)}else{for(let xt=0;xt<Se;xt++)de.push(ie[Ie+xt]);if(dt>1)for(const xt of Et){const Xt=xt*Se;if(!(ie[Xt+2]<=z)){ie[Xt+2]=z;for(let Nt=0;Nt<Se;Nt++)de.push(ie[Xt+Nt])}}}}return de}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,z,G){if(N[z+uo]>1){const ce=this.clusterProps[N[z+Ft]];return G?Object.assign({},ce):ce}const ee=this.points[N[z+Dr]].properties,ne=this.options.map(ee);return G&&ne===ee?Object.assign({},ne):ne}}function Ra(Y,N,z){return{type:"Feature",id:Y[N+Dr],properties:Vn(Y,N,z),geometry:{type:"Point",coordinates:[(G=Y[N],360*(G-.5)),fn(Y[N+1])]}};var G}function Vn(Y,N,z){const G=Y[N+uo],ee=G>=1e4?`${Math.round(G/1e3)}k`:G>=1e3?Math.round(G/100)/10+"k":G,ne=Y[N+Ft],ce=-1===ne?{}:Object.assign({},z[ne]);return Object.assign(ce,{cluster:!0,cluster_id:Y[N+Dr],point_count:G,point_count_abbreviated:ee})}function Mn(Y){return Y/360+.5}function ms(Y){const N=Math.sin(Y*Math.PI/180),z=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return z<0?0:z>1?1:z}function fn(Y){const N=(180-360*Y)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Nr(Y,N,z,G){for(var ee,ne=G,ce=z-N>>1,ae=z-N,ie=Y[N],de=Y[N+1],Se=Y[z],Ie=Y[z+1],we=N+3;we<z;we+=3){var ft=ol(Y[we],Y[we+1],ie,de,Se,Ie);if(ft>ne)ee=we,ne=ft;else if(ft===ne){var Et=Math.abs(we-ce);Et<ae&&(ee=we,ae=Et)}}ne>G&&(ee-N>3&&Nr(Y,N,ee,G),Y[ee+2]=ne,z-ee>3&&Nr(Y,ee,z,G))}function ol(Y,N,z,G,ee,ne){var ce=ee-z,ae=ne-G;if(0!==ce||0!==ae){var ie=((Y-z)*ce+(N-G)*ae)/(ce*ce+ae*ae);ie>1?(z=ee,G=ne):ie>0&&(z+=ce*ie,G+=ae*ie)}return(ce=Y-z)*ce+(ae=N-G)*ae}function xe(Y,N,z,G){var ee={id:void 0===Y?null:Y,type:N,geometry:z,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ne){var ce=ne.geometry,ae=ne.type;if("Point"===ae||"MultiPoint"===ae||"LineString"===ae)Ws(ne,ce);else if("Polygon"===ae||"MultiLineString"===ae)for(var ie=0;ie<ce.length;ie++)Ws(ne,ce[ie]);else if("MultiPolygon"===ae)for(ie=0;ie<ce.length;ie++)for(var de=0;de<ce[ie].length;de++)Ws(ne,ce[ie][de])}(ee),ee}function Ws(Y,N){for(var z=0;z<N.length;z+=3)Y.minX=Math.min(Y.minX,N[z]),Y.minY=Math.min(Y.minY,N[z+1]),Y.maxX=Math.max(Y.maxX,N[z]),Y.maxY=Math.max(Y.maxY,N[z+1])}function Zl(Y,N,z,G){if(N.geometry){var ee=N.geometry.coordinates,ne=N.geometry.type,ce=Math.pow(z.tolerance/((1<<z.maxZoom)*z.extent),2),ae=[],ie=N.id;if(z.promoteId?ie=N.properties[z.promoteId]:z.generateId&&(ie=G||0),"Point"===ne)Sn(ee,ae);else if("MultiPoint"===ne)for(var de=0;de<ee.length;de++)Sn(ee[de],ae);else if("LineString"===ne)ln(ee,ae,ce,!1);else if("MultiLineString"===ne){if(z.lineMetrics){for(de=0;de<ee.length;de++)ln(ee[de],ae=[],ce,!1),Y.push(xe(ie,"LineString",ae,N.properties));return}sl(ee,ae,ce,!1)}else if("Polygon"===ne)sl(ee,ae,ce,!0);else{if("MultiPolygon"!==ne){if("GeometryCollection"===ne){for(de=0;de<N.geometry.geometries.length;de++)Zl(Y,{id:ie,geometry:N.geometry.geometries[de],properties:N.properties},z,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(de=0;de<ee.length;de++){var Se=[];sl(ee[de],Se,ce,!0),ae.push(Se)}}Y.push(xe(ie,ne,ae,N.properties))}}function Sn(Y,N){N.push(Oc(Y[0])),N.push(Gu(Y[1])),N.push(0)}function ln(Y,N,z,G){for(var ee,ne,ce=0,ae=0;ae<Y.length;ae++){var ie=Oc(Y[ae][0]),de=Gu(Y[ae][1]);N.push(ie),N.push(de),N.push(0),ae>0&&(ce+=G?(ee*de-ie*ne)/2:Math.sqrt(Math.pow(ie-ee,2)+Math.pow(de-ne,2))),ee=ie,ne=de}var Se=N.length-3;N[2]=1,Nr(N,0,Se,z),N[Se+2]=1,N.size=Math.abs(ce),N.start=0,N.end=N.size}function sl(Y,N,z,G){for(var ee=0;ee<Y.length;ee++){var ne=[];ln(Y[ee],ne,z,G),N.push(ne)}}function Oc(Y){return Y/360+.5}function Gu(Y){var N=Math.sin(Y*Math.PI/180),z=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return z<0?0:z>1?1:z}function mi(Y,N,z,G,ee,ne,ce,ae){if(G/=N,ne>=(z/=N)&&ce<G)return Y;if(ce<z||ne>=G)return null;for(var ie=[],de=0;de<Y.length;de++){var Se=Y[de],Ie=Se.geometry,we=Se.type,ft=0===ee?Se.minX:Se.minY,Et=0===ee?Se.maxX:Se.maxY;if(ft>=z&&Et<G)ie.push(Se);else if(!(Et<z||ft>=G)){var tt=[];if("Point"===we||"MultiPoint"===we)Zs(Ie,tt,z,G,ee);else if("LineString"===we)al(Ie,tt,z,G,ee,!1,ae.lineMetrics);else if("MultiLineString"===we)je(Ie,tt,z,G,ee,!1);else if("Polygon"===we)je(Ie,tt,z,G,ee,!0);else if("MultiPolygon"===we)for(var dt=0;dt<Ie.length;dt++){var xt=[];je(Ie[dt],xt,z,G,ee,!0),xt.length&&tt.push(xt)}if(tt.length){if(ae.lineMetrics&&"LineString"===we){for(dt=0;dt<tt.length;dt++)ie.push(xe(Se.id,we,tt[dt],Se.tags));continue}"LineString"!==we&&"MultiLineString"!==we||(1===tt.length?(we="LineString",tt=tt[0]):we="MultiLineString"),"Point"!==we&&"MultiPoint"!==we||(we=3===tt.length?"Point":"MultiPoint"),ie.push(xe(Se.id,we,tt,Se.tags))}}}return ie.length?ie:null}function Zs(Y,N,z,G,ee){for(var ne=0;ne<Y.length;ne+=3){var ce=Y[ne+ee];ce>=z&&ce<=G&&(N.push(Y[ne]),N.push(Y[ne+1]),N.push(Y[ne+2]))}}function al(Y,N,z,G,ee,ne,ce){for(var ae,ie,de=gs(Y),Se=0===ee?Xi:ll,Ie=Y.start,we=0;we<Y.length-3;we+=3){var ft=Y[we],Et=Y[we+1],tt=Y[we+2],dt=Y[we+3],xt=Y[we+4],Xt=0===ee?ft:Et,Nt=0===ee?dt:xt,Bt=!1;ce&&(ae=Math.sqrt(Math.pow(ft-dt,2)+Math.pow(Et-xt,2))),Xt<z?Nt>z&&(ie=Se(de,ft,Et,dt,xt,z),ce&&(de.start=Ie+ae*ie)):Xt>G?Nt<G&&(ie=Se(de,ft,Et,dt,xt,G),ce&&(de.start=Ie+ae*ie)):ho(de,ft,Et,tt),Nt<z&&Xt>=z&&(ie=Se(de,ft,Et,dt,xt,z),Bt=!0),Nt>G&&Xt<=G&&(ie=Se(de,ft,Et,dt,xt,G),Bt=!0),!ne&&Bt&&(ce&&(de.end=Ie+ae*ie),N.push(de),de=gs(Y)),ce&&(Ie+=ae)}var In=Y.length-3;ft=Y[In],Et=Y[In+1],tt=Y[In+2],(Xt=0===ee?ft:Et)>=z&&Xt<=G&&ho(de,ft,Et,tt),In=de.length-3,ne&&In>=3&&(de[In]!==de[0]||de[In+1]!==de[1])&&ho(de,de[0],de[1],de[2]),de.length&&N.push(de)}function gs(Y){var N=[];return N.size=Y.size,N.start=Y.start,N.end=Y.end,N}function je(Y,N,z,G,ee,ne){for(var ce=0;ce<Y.length;ce++)al(Y[ce],N,z,G,ee,ne,!1)}function ho(Y,N,z,G){Y.push(N),Y.push(z),Y.push(G)}function Xi(Y,N,z,G,ee,ne){var ce=(ne-N)/(G-N);return Y.push(ne),Y.push(z+(ee-z)*ce),Y.push(1),ce}function ll(Y,N,z,G,ee,ne){var ce=(ne-z)/(ee-z);return Y.push(N+(G-N)*ce),Y.push(ne),Y.push(1),ce}function Xs(Y,N){for(var z=[],G=0;G<Y.length;G++){var ee,ne=Y[G],ce=ne.type;if("Point"===ce||"MultiPoint"===ce||"LineString"===ce)ee=Ve(ne.geometry,N);else if("MultiLineString"===ce||"Polygon"===ce){ee=[];for(var ae=0;ae<ne.geometry.length;ae++)ee.push(Ve(ne.geometry[ae],N))}else if("MultiPolygon"===ce)for(ee=[],ae=0;ae<ne.geometry.length;ae++){for(var ie=[],de=0;de<ne.geometry[ae].length;de++)ie.push(Ve(ne.geometry[ae][de],N));ee.push(ie)}z.push(xe(ne.id,ce,ee,ne.tags))}return z}function Ve(Y,N){var z=[];z.size=Y.size,void 0!==Y.start&&(z.start=Y.start,z.end=Y.end);for(var G=0;G<Y.length;G+=3)z.push(Y[G]+N,Y[G+1],Y[G+2]);return z}function wt(Y,N){if(Y.transformed)return Y;var z,G,ee,ne=1<<Y.z,ce=Y.x,ae=Y.y;for(z=0;z<Y.features.length;z++){var ie=Y.features[z],de=ie.geometry,Se=ie.type;if(ie.geometry=[],1===Se)for(G=0;G<de.length;G+=2)ie.geometry.push(Tt(de[G],de[G+1],N,ne,ce,ae));else for(G=0;G<de.length;G++){var Ie=[];for(ee=0;ee<de[G].length;ee+=2)Ie.push(Tt(de[G][ee],de[G][ee+1],N,ne,ce,ae));ie.geometry.push(Ie)}}return Y.transformed=!0,Y}function Tt(Y,N,z,G,ee,ne){return[Math.round(z*(Y*G-ee)),Math.round(z*(N*G-ne))]}function Br(Y,N,z,G,ee){for(var ne=N===ee.maxZoom?0:ee.tolerance/((1<<N)*ee.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:z,y:G,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ae=0;ae<Y.length;ae++){ce.numFeatures++,gi(ce,Y[ae],ne,ee);var ie=Y[ae].minX,de=Y[ae].minY,Se=Y[ae].maxX,Ie=Y[ae].maxY;ie<ce.minX&&(ce.minX=ie),de<ce.minY&&(ce.minY=de),Se>ce.maxX&&(ce.maxX=Se),Ie>ce.maxY&&(ce.maxY=Ie)}return ce}function gi(Y,N,z,G){var ee=N.geometry,ne=N.type,ce=[];if("Point"===ne||"MultiPoint"===ne)for(var ae=0;ae<ee.length;ae+=3)ce.push(ee[ae]),ce.push(ee[ae+1]),Y.numPoints++,Y.numSimplified++;else if("LineString"===ne)At(ce,ee,Y,z,!1,!1);else if("MultiLineString"===ne||"Polygon"===ne)for(ae=0;ae<ee.length;ae++)At(ce,ee[ae],Y,z,"Polygon"===ne,0===ae);else if("MultiPolygon"===ne)for(var ie=0;ie<ee.length;ie++){var de=ee[ie];for(ae=0;ae<de.length;ae++)At(ce,de[ae],Y,z,!0,0===ae)}if(ce.length){var Se=N.tags||null;if("LineString"===ne&&G.lineMetrics){for(var Ie in Se={},N.tags)Se[Ie]=N.tags[Ie];Se.mapbox_clip_start=ee.start/ee.size,Se.mapbox_clip_end=ee.end/ee.size}var we={geometry:ce,type:"Polygon"===ne||"MultiPolygon"===ne?3:"LineString"===ne||"MultiLineString"===ne?2:1,tags:Se};null!==N.id&&(we.id=N.id),Y.features.push(we)}}function At(Y,N,z,G,ee,ne){var ce=G*G;if(G>0&&N.size<(ee?ce:G))z.numPoints+=N.length/3;else{for(var ae=[],ie=0;ie<N.length;ie+=3)(0===G||N[ie+2]>ce)&&(z.numSimplified++,ae.push(N[ie]),ae.push(N[ie+1])),z.numPoints++;ee&&function(de,Se){for(var Ie=0,we=0,ft=de.length,Et=ft-2;we<ft;Et=we,we+=2)Ie+=(de[we]-de[Et])*(de[we+1]+de[Et+1]);if(Ie>0===Se)for(we=0,ft=de.length;we<ft/2;we+=2){var tt=de[we],dt=de[we+1];de[we]=de[ft-2-we],de[we+1]=de[ft-1-we],de[ft-2-we]=tt,de[ft-1-we]=dt}}(ae,ne),Y.push(ae)}}function _s(Y,N){var z=(N=this.options=function(ee,ne){for(var ce in ne)ee[ce]=ne[ce];return ee}(Object.create(this.options),N)).debug;if(z&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var ee,ne,ce,ae,ie,de,G=function(ee,ne){var ce=[];if("FeatureCollection"===ee.type)for(var ae=0;ae<ee.features.length;ae++)Zl(ce,ee.features[ae],ne,ae);else Zl(ce,"Feature"===ee.type?ee:{geometry:ee},ne);return ce}(Y,N);this.tiles={},this.tileCoords=[],z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ae=ee=G,ie=mi(ee,1,-1-(ce=(ne=N).buffer/ne.extent),ce,0,-1,2,ne),de=mi(ee,1,1-ce,2+ce,0,-1,2,ne),(ie||de)&&(ae=mi(ee,1,-ce,1+ce,0,-1,2,ne)||[],ie&&(ae=Xs(ie,1).concat(ae)),de&&(ae=ae.concat(Xs(de,-1)))),(G=ae).length&&this.splitTile(G,0,0,0),z&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ys(Y,N,z){return 32*((1<<Y)*z+N)+Y}function ko(Y,N){return N?Y.properties[N]:Y.id}function vs(Y,N){if(null==Y)return!0;if("Feature"===Y.type)return null!=ko(Y,N);if("FeatureCollection"===Y.type){const z=new Set;for(const G of Y.features){const ee=ko(G,N);if(null==ee||z.has(ee))return!1;z.add(ee)}return!0}return!1}function Ki(Y,N){const z=new Map;if(null!=Y)if("Feature"===Y.type)z.set(ko(Y,N),Y);else for(const G of Y.features)z.set(ko(G,N),G);return z}function Tn(Y,N){const z=Y.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);const G=this._geoJSONIndex.getTile(z.z,z.x,z.y);if(!G)return N(null,null);const ee=new class{constructor(ce){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.EXTENT,this.length=ce.length,this._features=ce}feature(ce){return new class{constructor(ae){this._feature=ae,this.extent=y.EXTENT,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(1===this._feature.type){const ae=[];for(const ie of this._feature.geometry)ae.push([new y.Point(ie[0],ie[1])]);return ae}{const ae=[];for(const ie of this._feature.geometry){const de=[];for(const Se of ie)de.push(new y.Point(Se[0],Se[1]));ae.push(de)}return ae}}toGeoJSON(ae,ie,de){return co.call(this,ae,ie,de)}}(this._features[ce])}}(G.features);let ne=Gs(ee);0===ne.byteOffset&&ne.byteLength===ne.buffer.byteLength||(ne=new Uint8Array(ne)),N(null,{vectorTile:ee,rawData:ne.buffer})}_s.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_s.prototype.splitTile=function(Y,N,z,G,ee,ne,ce){for(var ae=[Y,N,z,G],ie=this.options,de=ie.debug;ae.length;){G=ae.pop(),z=ae.pop(),N=ae.pop(),Y=ae.pop();var Se=1<<N,Ie=ys(N,z,G),we=this.tiles[Ie];if(!we&&(de>1&&console.time("creation"),we=this.tiles[Ie]=Br(Y,N,z,G,ie),this.tileCoords.push({z:N,x:z,y:G}),de)){de>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,z,G,we.numFeatures,we.numPoints,we.numSimplified),console.timeEnd("creation"));var ft="z"+N;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if(we.source=Y,ee){if(N===ie.maxZoom||N===ee)continue;var Et=1<<ee-N;if(z!==Math.floor(ne/Et)||G!==Math.floor(ce/Et))continue}else if(N===ie.indexMaxZoom||we.numPoints<=ie.indexMaxPoints)continue;if(we.source=null,0!==Y.length){de>1&&console.time("clipping");var tt,dt,xt,Xt,Nt,Bt,In=.5*ie.buffer/ie.extent,Un=.5-In,vt=.5+In,jn=1+In;tt=dt=xt=Xt=null,Nt=mi(Y,Se,z-In,z+vt,0,we.minX,we.maxX,ie),Bt=mi(Y,Se,z+Un,z+jn,0,we.minX,we.maxX,ie),Y=null,Nt&&(tt=mi(Nt,Se,G-In,G+vt,1,we.minY,we.maxY,ie),dt=mi(Nt,Se,G+Un,G+jn,1,we.minY,we.maxY,ie),Nt=null),Bt&&(xt=mi(Bt,Se,G-In,G+vt,1,we.minY,we.maxY,ie),Xt=mi(Bt,Se,G+Un,G+jn,1,we.minY,we.maxY,ie),Bt=null),de>1&&console.timeEnd("clipping"),ae.push(tt||[],N+1,2*z,2*G),ae.push(dt||[],N+1,2*z,2*G+1),ae.push(xt||[],N+1,2*z+1,2*G),ae.push(Xt||[],N+1,2*z+1,2*G+1)}}},_s.prototype.getTile=function(Y,N,z){var G=this.options,ee=G.extent,ne=G.debug;if(Y<0||Y>24)return null;var ce=1<<Y,ae=ys(Y,N=(N%ce+ce)%ce,z);if(this.tiles[ae])return wt(this.tiles[ae],ee);ne>1&&console.log("drilling down to z%d-%d-%d",Y,N,z);for(var ie,de=Y,Se=N,Ie=z;!ie&&de>0;)de--,Se=Math.floor(Se/2),Ie=Math.floor(Ie/2),ie=this.tiles[ys(de,Se,Ie)];return ie&&ie.source?(ne>1&&console.log("found parent tile z%d-%d-%d",de,Se,Ie),ne>1&&console.time("drilling down"),this.splitTile(ie.source,de,Se,Ie,Y,N,z),ne>1&&console.timeEnd("drilling down"),this.tiles[ae]?wt(this.tiles[ae],ee):null):null};class Xl extends Wr{constructor(N,z,G,ee){super(N,z,G,Tn),this._dataUpdateable=new Map,this.loadGeoJSON=(ne,ce)=>{const{promoteId:ae}=ne;if(ne.request)return y.getJSON(ne.request,(ie,de,Se,Ie)=>{this._dataUpdateable=vs(de,ae)?Ki(de,ae):void 0,ce(ie,de,Se,Ie)});if("string"==typeof ne.data)try{const ie=JSON.parse(ne.data);this._dataUpdateable=vs(ie,ae)?Ki(ie,ae):void 0,ce(null,ie)}catch{ce(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}else ne.dataDiff?this._dataUpdateable?(function(ie,de,Se){var Ie,we,ft,Et;if(de.removeAll&&ie.clear(),de.remove)for(const tt of de.remove)ie.delete(tt);if(de.add)for(const tt of de.add){const dt=ko(tt,Se);null!=dt&&ie.set(dt,tt)}if(de.update)for(const tt of de.update){let dt=ie.get(tt.id);if(null==dt)continue;const xt=!tt.removeAllProperties&&((null===(Ie=tt.removeProperties)||void 0===Ie?void 0:Ie.length)>0||(null===(we=tt.addOrUpdateProperties)||void 0===we?void 0:we.length)>0);if((tt.newGeometry||tt.removeAllProperties||xt)&&(dt={...dt},ie.set(tt.id,dt),xt&&(dt.properties={...dt.properties})),tt.newGeometry&&(dt.geometry=tt.newGeometry),tt.removeAllProperties)dt.properties={};else if((null===(ft=tt.removeProperties)||void 0===ft?void 0:ft.length)>0)for(const Xt of tt.removeProperties)Object.prototype.hasOwnProperty.call(dt.properties,Xt)&&delete dt.properties[Xt];if((null===(Et=tt.addOrUpdateProperties)||void 0===Et?void 0:Et.length)>0)for(const{key:Xt,value:Nt}of tt.addOrUpdateProperties)dt.properties[Xt]=Nt}}(this._dataUpdateable,ne.dataDiff,ae),ce(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):ce(new Error(`Cannot update existing geojson data in ${ne.source}`)):ce(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ee&&(this.loadGeoJSON=ee)}loadData(N,z){var G;null===(G=this._pendingRequest)||void 0===G||G.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new y.RequestPerformance(N.request);this._pendingCallback=z,this._pendingRequest=this.loadGeoJSON(N,(ne,ce)=>{if(delete this._pendingCallback,delete this._pendingRequest,ne||!ce)return z(ne);if("object"!=typeof ce)return z(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{zn(ce,!0);try{if(N.filter){const ie=y.createExpression(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ie.result)throw new Error(ie.value.map(Se=>`${Se.key}: ${Se.message}`).join(", "));ce={type:"FeatureCollection",features:ce.features.filter(Se=>ie.value.evaluate({zoom:0},Se))}}this._geoJSONIndex=N.cluster?new Pa(function({superclusterOptions:ie,clusterProperties:de}){if(!de||!ie)return ie;const Se={},Ie={},we={accumulated:null,zoom:0},ft={properties:null},Et=Object.keys(de);for(const tt of Et){const[dt,xt]=de[tt],Xt=y.createExpression(xt),Nt=y.createExpression("string"==typeof dt?[dt,["accumulated"],["get",tt]]:dt);Se[tt]=Xt.value,Ie[tt]=Nt.value}return ie.map=tt=>{ft.properties=tt;const dt={};for(const xt of Et)dt[xt]=Se[xt].evaluate(we,ft);return dt},ie.reduce=(tt,dt)=>{ft.properties=dt;for(const xt of Et)we.accumulated=tt[xt],tt[xt]=Ie[xt].evaluate(we,ft)},ie}(N)).load(ce.features):new _s(ie=ce,N.geojsonVtOptions)}catch(ie){return z(ie)}this.loaded={};const ae={};if(ee){const ie=ee.finish();ie&&(ae.resourceTiming={},ae.resourceTiming[N.source]=JSON.parse(JSON.stringify(ie)))}z(null,ae)}var ie})}reloadTile(N,z){const G=this.loaded;return G&&G[N.uid]?super.reloadTile(N,z):this.loadTile(N,z)}removeSource(N,z){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),z()}getClusterExpansionZoom(N,z){try{z(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(G){z(G)}}getClusterChildren(N,z){try{z(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(G){z(G)}}getClusterLeaves(N,z){try{z(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(G){z(G)}}}class Qo{constructor(N){this.self=N,this.actor=new y.Actor(N,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Wr,geojson:Xl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(z,G)=>{if(this.workerSourceTypes[z])throw new Error(`Worker source with name "${z}" already registered.`);this.workerSourceTypes[z]=G},this.self.registerRTLTextPlugin=z=>{if(y.plugin.isParsed())throw new Error("RTL text plugin already registered.");y.plugin.applyArabicShaping=z.applyArabicShaping,y.plugin.processBidirectionalText=z.processBidirectionalText,y.plugin.processStyledBidirectionalText=z.processStyledBidirectionalText}}setReferrer(N,z){this.referrer=z}setImages(N,z,G){this.availableImages[N]=z;for(const ee in this.workerSources[N]){const ne=this.workerSources[N][ee];for(const ce in ne)ne[ce].availableImages=z}G()}setLayers(N,z,G){this.getLayerIndex(N).replace(z),G()}updateLayers(N,z,G){this.getLayerIndex(N).update(z.layers,z.removedIds),G()}loadTile(N,z,G){this.getWorkerSource(N,z.type,z.source).loadTile(z,G)}loadDEMTile(N,z,G){this.getDEMWorkerSource(N,z.source).loadTile(z,G)}reloadTile(N,z,G){this.getWorkerSource(N,z.type,z.source).reloadTile(z,G)}abortTile(N,z,G){this.getWorkerSource(N,z.type,z.source).abortTile(z,G)}removeTile(N,z,G){this.getWorkerSource(N,z.type,z.source).removeTile(z,G)}removeDEMTile(N,z){this.getDEMWorkerSource(N,z.source).removeTile(z)}removeSource(N,z,G){if(!this.workerSources[N]||!this.workerSources[N][z.type]||!this.workerSources[N][z.type][z.source])return;const ee=this.workerSources[N][z.type][z.source];delete this.workerSources[N][z.type][z.source],void 0!==ee.removeSource?ee.removeSource(z,G):G()}loadWorkerSource(N,z,G){try{this.self.importScripts(z.url),G()}catch(ee){G(ee.toString())}}syncRTLPluginState(N,z,G){try{y.plugin.setState(z);const ee=y.plugin.getPluginURL();if(y.plugin.isLoaded()&&!y.plugin.isParsed()&&null!=ee){this.self.importScripts(ee);const ne=y.plugin.isParsed();G(ne?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ee}`),ne)}}catch(ee){G(ee.toString())}}getAvailableImages(N){let z=this.availableImages[N];return z||(z=[]),z}getLayerIndex(N){let z=this.layerIndexes[N];return z||(z=this.layerIndexes[N]=new Qt),z}getWorkerSource(N,z,G){return this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][z]||(this.workerSources[N][z]={}),this.workerSources[N][z][G]||(this.workerSources[N][z][G]=new this.workerSourceTypes[z]({send:(ne,ce,ae)=>{this.actor.send(ne,ce,ae,N)}},this.getLayerIndex(N),this.getAvailableImages(N))),this.workerSources[N][z][G]}getDEMWorkerSource(N,z){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][z]||(this.demWorkerSources[N][z]=new fs),this.demWorkerSources[N][z]}}return y.isWorker()&&(self.worker=new Qo(self)),Qo}),Rc(0,function(y){class be{static testProp(s){if(!be.docStyle)return s[0];for(let u=0;u<s.length;u++)if(s[u]in be.docStyle)return s[u];return s[0]}static create(s,u,p){const _=window.document.createElement(s);return void 0!==u&&(_.className=u),p&&p.appendChild(_),_}static createNS(s,u){return window.document.createElementNS(s,u)}static disableDrag(){be.docStyle&&be.selectProp&&(be.userSelect=be.docStyle[be.selectProp],be.docStyle[be.selectProp]="none")}static enableDrag(){be.docStyle&&be.selectProp&&(be.docStyle[be.selectProp]=be.userSelect)}static setTransform(s,u){s.style[be.transformProp]=u}static addEventListener(s,u,p,_={}){s.addEventListener(u,p,"passive"in _?_:_.capture)}static removeEventListener(s,u,p,_={}){s.removeEventListener(u,p,"passive"in _?_:_.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",be.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",be.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",be.suppressClickInternal,!0)},0)}static mousePos(s,u){const p=s.getBoundingClientRect();return new y.Point(u.clientX-p.left-s.clientLeft,u.clientY-p.top-s.clientTop)}static touchPos(s,u){const p=s.getBoundingClientRect(),_=[];for(let w=0;w<u.length;w++)_.push(new y.Point(u[w].clientX-p.left-s.clientLeft,u[w].clientY-p.top-s.clientTop));return _}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}be.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,be.selectProp=be.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),be.transformProp=be.testProp(["transform","WebkitTransform"]);const Wi={supported:!1,testSupport:function(m){!Wr&&cr&&(fs?Zr(m):lt=m)}};let lt,cr,Wr=!1,fs=!1;function Zr(m){const s=m.createTexture();m.bindTexture(m.TEXTURE_2D,s);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,cr),m.isContextLost())return;Wi.supported=!0}catch{}m.deleteTexture(s),Wr=!0}var Yo;typeof document<"u"&&(cr=document.createElement("img"),cr.onload=function(){lt&&Zr(lt),lt=null,fs=!0},cr.onerror=function(){Wr=!0,lt=null},cr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let s,u,p,_;m.resetRequestQueue=()=>{s=[],u=0,p=0,_={}},m.addThrottleControl=k=>{const O=p++;return _[O]=k,O},m.removeThrottleControl=k=>{delete _[k],M()},m.getImage=(k,O,F=!0)=>{Wi.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*");const j={requestParameters:k,supportImageRefresh:F,callback:O,cancelled:!1,completed:!1,cancel:()=>{j.completed||j.cancelled||(j.cancelled=!0,j.innerRequest&&(j.innerRequest.cancel(),u--),M())}};return s.push(j),M(),j};const w=k=>{const{requestParameters:O,supportImageRefresh:F,callback:j}=k;return y.extend(O,{type:"image"}),(!1!==F||y.isWorker()||y.getProtocolAction(O.url)||O.headers&&!Object.keys(O.headers).reduce((X,q)=>X&&"accept"===q,!0)?y.makeRequest:I)(O,(X,q,Z,te)=>{D(k,j,X,q,Z,te)})},D=(k,O,F,j,X,q)=>{var Z,te;F?O(F):j instanceof HTMLImageElement||j instanceof ImageBitmap?O(null,j):j&&(Z=j,te=(Z,te)=>{null!=Z?O(Z):null!=te&&O(null,te,{cacheControl:X,expires:q})},"function"==typeof createImageBitmap?y.arrayBufferToImageBitmap(Z,te):y.arrayBufferToImage(Z,te)),k.cancelled||(k.completed=!0,u--,M())},M=()=>{const k=(()=>{const O=Object.keys(_);let F=!1;if(O.length>0)for(const j of O)if(F=_[j](),F)break;return F})()?y.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:y.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=u;O<k&&s.length>0;O++){const F=s.shift();if(F.cancelled){O--;continue}const j=w(F);u++,F.innerRequest=j}},I=(k,O)=>{const F=new Image,j=k.url;let X=!1;const q=k.credentials;return q&&"include"===q?F.crossOrigin="use-credentials":(q&&"same-origin"===q||!y.sameOrigin(j))&&(F.crossOrigin="anonymous"),F.fetchPriority="high",F.onload=()=>{O(null,F),F.onerror=F.onload=null},F.onerror=()=>{X||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),F.onerror=F.onload=null},F.src=j,{cancel:()=>{X=!0,F.src=""}}}}(Yo||(Yo={})),Yo.resetRequestQueue();var zn,m,co=Yo;(m=zn||(zn={})).Glyphs="Glyphs",m.Image="Image",m.Source="Source",m.SpriteImage="SpriteImage",m.SpriteJSON="SpriteJSON",m.Style="Style",m.Tile="Tile",m.Unknown="Unknown";class Ci{constructor(s){this._transformRequestFn=s}transformRequest(s,u){return this._transformRequestFn&&this._transformRequestFn(s,u)||{url:s}}normalizeSpriteURL(s,u,p){const _=function(w){const D=w.match(Io);if(!D)throw new Error(`Unable to parse URL "${w}"`);return{protocol:D[1],authority:D[2],path:D[3]||"/",params:D[4]?D[4].split("&"):[]}}(s);return _.path+=`${u}${p}`,function(w){const D=w.params.length?`?${w.params.join("&")}`:"";return`${w.protocol}://${w.authority}${w.path}${D}`}(_)}setTransformRequest(s){this._transformRequestFn=s}}const Io=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Mo(m){var s=new y.ARRAY_TYPE(3);return s[0]=m[0],s[1]=m[1],s[2]=m[2],s}var $e,ze=function(m,s,u){return m[0]=s[0]-u[0],m[1]=s[1]-u[1],m[2]=s[2]-u[2],m};$e=new y.ARRAY_TYPE(3),y.ARRAY_TYPE!=Float32Array&&($e[0]=0,$e[1]=0,$e[2]=0);var We=function(m){var s=m[0],u=m[1];return s*s+u*u};function ct(m){const s=[];if("string"==typeof m)s.push({id:"default",url:m});else if(m&&m.length>0){const u=[];for(const{id:p,url:_}of m){const w=`${p}${_}`;-1===u.indexOf(w)&&(u.push(w),s.push({id:p,url:_}))}}return s}function pt(m,s,u,p,_){if(p)return void m(p);if(_!==Object.values(s).length||_!==Object.values(u).length)return;const w={};for(const D in s){w[D]={};const M=y.exported.getImageCanvasContext(u[D]),I=s[D];for(const k in I){const{width:O,height:F,x:j,y:X,sdf:q,pixelRatio:Z,stretchX:te,stretchY:le,content:fe}=I[k];w[D][k]={data:null,pixelRatio:Z,sdf:q,stretchX:te,stretchY:le,content:fe,spriteData:{width:O,height:F,x:j,y:X,context:M}}}}m(null,w)}!function(){var m=new y.ARRAY_TYPE(2);y.ARRAY_TYPE!=Float32Array&&(m[0]=0,m[1]=0)}();class ut{constructor(s,u,p,_){this.context=s,this.format=p,this.texture=s.gl.createTexture(),this.update(u,_)}update(s,u,p){const{width:_,height:w}=s,D=!(this.size&&this.size[0]===_&&this.size[1]===w||p),{context:M}=this,{gl:I}=M;if(this.useMipmap=!(!u||!u.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!u||!1!==u.premultiply)),D)this.size=[_,w],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||y.isImageBitmap(s)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,s):I.texImage2D(I.TEXTURE_2D,0,this.format,_,w,0,this.format,I.UNSIGNED_BYTE,s.data);else{const{x:k,y:O}=p||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||y.isImageBitmap(s)?I.texSubImage2D(I.TEXTURE_2D,0,k,O,I.RGBA,I.UNSIGNED_BYTE,s):I.texSubImage2D(I.TEXTURE_2D,0,k,O,_,w,I.RGBA,I.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(s,u,p){const{context:_}=this,{gl:w}=_;w.bindTexture(w.TEXTURE_2D,this.texture),p!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=w.LINEAR),s!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,s),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,p||s),this.filter=s),u!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,u),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function Lt(m){const{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class Gn extends y.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new y.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:u,callback:p}of this.requestors)this._notify(u,p);this.requestors=[]}}getImage(s){const u=this.images[s];if(u&&!u.data&&u.spriteData){const p=u.spriteData;u.data=new y.RGBAImage({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),u.spriteData=null}return u}addImage(s,u){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,u)&&(this.images[s]=u)}_validate(s,u){let p=!0;const _=u.data||u.spriteData;return this._validateStretch(u.stretchX,_&&_.width)||(this.fire(new y.ErrorEvent(new Error(`Image "${s}" has invalid "stretchX" value`))),p=!1),this._validateStretch(u.stretchY,_&&_.height)||(this.fire(new y.ErrorEvent(new Error(`Image "${s}" has invalid "stretchY" value`))),p=!1),this._validateContent(u.content,u)||(this.fire(new y.ErrorEvent(new Error(`Image "${s}" has invalid "content" value`))),p=!1),p}_validateStretch(s,u){if(!s)return!0;let p=0;for(const _ of s){if(_[0]<p||_[1]<_[0]||u<_[1])return!1;p=_[1]}return!0}_validateContent(s,u){if(!s)return!0;if(4!==s.length)return!1;const p=u.spriteData,_=p&&p.width||u.data.width,w=p&&p.height||u.data.height;return!(s[0]<0||_<s[0]||s[1]<0||w<s[1]||s[2]<0||_<s[2]||s[3]<0||w<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,u,p=!0){const _=this.getImage(s);if(p&&(_.data.width!==u.data.width||_.data.height!==u.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=_.version+1,this.images[s]=u,this.updatedImages[s]=!0}removeImage(s){const u=this.images[s];delete this.images[s],delete this.patterns[s],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,u){let p=!0;if(!this.isLoaded())for(const _ of s)this.images[_]||(p=!1);this.isLoaded()||p?this._notify(s,u):this.requestors.push({ids:s,callback:u})}_notify(s,u){const p={};for(const _ of s){let w=this.getImage(_);w||(this.fire(new y.Event("styleimagemissing",{id:_})),w=this.getImage(_)),w?p[_]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!(!w.userImage||!w.userImage.render)}:y.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,p)}getPixelSize(){const{width:s,height:u}=this.atlasImage;return{width:s,height:u}}getPattern(s){const u=this.patterns[s],p=this.getImage(s);if(!p)return null;if(u&&u.position.version===p.version)return u.position;if(u)u.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},w=new y.ImagePosition(_,p);this.patterns[s]={bin:_,position:w}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const u=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ut(s,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const w in this.patterns)s.push(this.patterns[w].bin);const{w:u,h:p}=y.potpack(s),_=this.atlasImage;_.resize({width:u||1,height:p||1});for(const w in this.patterns){const{bin:D}=this.patterns[w],M=D.x+1,I=D.y+1,k=this.getImage(w).data,O=k.width,F=k.height;y.RGBAImage.copy(k,_,{x:0,y:0},{x:M,y:I},{width:O,height:F}),y.RGBAImage.copy(k,_,{x:0,y:F-1},{x:M,y:I-1},{width:O,height:1}),y.RGBAImage.copy(k,_,{x:0,y:0},{x:M,y:I+F},{width:O,height:1}),y.RGBAImage.copy(k,_,{x:O-1,y:0},{x:M-1,y:I},{width:1,height:F}),y.RGBAImage.copy(k,_,{x:0,y:0},{x:M+O,y:I},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const u of s){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const p=this.getImage(u);p||y.warnOnce(`Image with ID: "${u}" was not found`),Lt(p)&&this.updateImage(u,p)}}}const Zi=1e20;function To(m,s,u,p,_,w,D,M,I){for(let k=s;k<s+p;k++)Ao(m,u*w+k,w,_,D,M,I);for(let k=u;k<u+_;k++)Ao(m,k*w+s,1,p,D,M,I)}function Ao(m,s,u,p,_,w,D){w[0]=0,D[0]=-Zi,D[1]=Zi,_[0]=m[s];for(let M=1,I=0,k=0;M<p;M++){_[M]=m[s+M*u];const O=M*M;do{const F=w[I];k=(_[M]-_[F]+O-F*F)/(M-F)/2}while(k<=D[I]&&--I>-1);I++,w[I]=M,D[I]=k,D[I+1]=Zi}for(let M=0,I=0;M<p;M++){for(;D[I+1]<M;)I++;const k=w[I],O=M-k;m[s+M*u]=_[k]+O*O}}class Lr{constructor(s,u){this.requestManager=s,this.localIdeographFontFamily=u,this.entries={}}setURL(s){this.url=s}getGlyphs(s,u){const p=[];for(const _ in s)for(const w of s[_])p.push({stack:_,id:w});y.asyncAll(p,({stack:_,id:w},D)=>{let M=this.entries[_];M||(M=this.entries[_]={glyphs:{},requests:{},ranges:{}});let I=M.glyphs[w];if(void 0!==I)return void D(null,{stack:_,id:w,glyph:I});if(I=this._tinySDF(M,_,w),I)return M.glyphs[w]=I,void D(null,{stack:_,id:w,glyph:I});const k=Math.floor(w/256);if(256*k>65535)return void D(new Error("glyphs > 65535 not supported"));if(M.ranges[k])return void D(null,{stack:_,id:w,glyph:I});if(!this.url)return void D(new Error("glyphsUrl is not set"));let O=M.requests[k];O||(O=M.requests[k]=[],Lr.loadGlyphRange(_,k,this.url,this.requestManager,(F,j)=>{if(j){for(const X in j)this._doesCharSupportLocalGlyph(+X)||(M.glyphs[+X]=j[+X]);M.ranges[k]=!0}for(const X of O)X(F,j);delete M.requests[k]})),O.push((F,j)=>{F?D(F):j&&D(null,{stack:_,id:w,glyph:j[w]||null})})},(_,w)=>{if(_)u(_);else if(w){const D={};for(const{stack:M,id:I,glyph:k}of w)(D[M]||(D[M]={}))[I]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};u(null,D)}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(y.unicodeBlockLookup["CJK Unified Ideographs"](s)||y.unicodeBlockLookup["Hangul Syllables"](s)||y.unicodeBlockLookup.Hiragana(s)||y.unicodeBlockLookup.Katakana(s))}_tinySDF(s,u,p){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let w=s.tinySDF;if(!w){let M="400";/bold/i.test(u)?M="900":/medium/i.test(u)?M="500":/light/i.test(u)&&(M="200"),w=s.tinySDF=new Lr.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:_,fontWeight:M})}const D=w.draw(String.fromCharCode(p));return{id:p,bitmap:new y.AlphaImage({width:D.width||30,height:D.height||30},D.data),metrics:{width:D.glyphWidth||24,height:D.glyphHeight||24,left:D.glyphLeft||0,top:D.glyphTop-27||-8,advance:D.glyphAdvance||24}}}}Lr.loadGlyphRange=function(m,s,u,p,_){const w=256*s,D=w+255,M=p.transformRequest(u.replace("{fontstack}",m).replace("{range}",`${w}-${D}`),zn.Glyphs);y.getArrayBuffer(M,(I,k)=>{if(I)_(I);else if(k){const O={};for(const F of y.parseGlyphPbf(k))O[F.id]=F;_(null,O)}})},Lr.TinySDF=class{constructor({fontSize:m=24,buffer:s=3,radius:u=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:w="normal",fontStyle:D="normal"}={}){this.buffer=s,this.cutoff=p,this.radius=u;const M=this.size=m+4*s,I=this._createCanvas(M),k=this.ctx=I.getContext("2d",{willReadFrequently:!0});k.font=`${D} ${w} ${m}px ${_}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(m){const s=document.createElement("canvas");return s.width=s.height=m,s}draw(m){const{width:s,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:w}=this.ctx.measureText(m),D=Math.ceil(u),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-_))),I=Math.min(this.size-this.buffer,D+Math.ceil(p)),k=M+2*this.buffer,O=I+2*this.buffer,F=Math.max(k*O,0),j=new Uint8ClampedArray(F),X={data:j,width:k,height:O,glyphWidth:M,glyphHeight:I,glyphTop:D,glyphLeft:0,glyphAdvance:s};if(0===M||0===I)return X;const{ctx:q,buffer:Z,gridInner:te,gridOuter:le}=this;q.clearRect(Z,Z,M,I),q.fillText(m,Z,Z+D);const fe=q.getImageData(Z,Z,M,I);le.fill(Zi,0,F),te.fill(0,0,F);for(let J=0;J<I;J++)for(let pe=0;pe<M;pe++){const ye=fe.data[4*(J*M+pe)+3]/255;if(0===ye)continue;const De=(J+Z)*k+pe+Z;if(1===ye)le[De]=0,te[De]=Zi;else{const Ae=.5-ye;le[De]=Ae>0?Ae*Ae:0,te[De]=Ae<0?Ae*Ae:0}}To(le,0,0,k,O,k,this.f,this.v,this.z),To(te,Z,Z,M,I,k,this.f,this.v,this.z);for(let J=0;J<F;J++){const pe=Math.sqrt(le[J])-Math.sqrt(te[J]);j[J]=Math.round(255-255*(pe/this.radius+this.cutoff))}return X}};class Wl{constructor(){this.specification=y.v8Spec.light.position}possiblyEvaluate(s,u){return y.sphericalToCartesian(s.expression.evaluate(u))}interpolate(s,u,p){return{x:y.interpolate.number(s.x,u.x,p),y:y.interpolate.number(s.y,u.y,p),z:y.interpolate.number(s.z,u.z,p)}}}let Gs,_n;class rl extends y.Evented{constructor(s){super(),Gs=Gs||new y.Properties({anchor:new y.DataConstantProperty(y.v8Spec.light.anchor),position:new Wl,color:new y.DataConstantProperty(y.v8Spec.light.color),intensity:new y.DataConstantProperty(y.v8Spec.light.intensity)}),this._transitionable=new y.Transitionable(Gs),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u={}){if(!this._validate(y.validateLight,s,u))for(const p in s){const _=s[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,p){return(!p||!1!==p.validate)&&y.emitValidationErrors(this,s.call(y.validateStyle,y.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:y.v8Spec})))}}class qs{constructor(s,u){this.width=s,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,u){const p=s.join(",")+String(u);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(s,u)),this.dashEntry[p]}getDashRanges(s,u,p){const _=[];let w=s.length%2==1?-s[s.length-1]*p:0,D=s[0]*p,M=!0;_.push({left:w,right:D,isDash:M,zeroLength:0===s[0]});let I=s[0];for(let k=1;k<s.length;k++){M=!M;const O=s[k];w=I*p,I+=O,D=I*p,_.push({left:w,right:D,isDash:M,zeroLength:0===O})}return _}addRoundDash(s,u,p){const _=u/2;for(let w=-p;w<=p;w++){const D=this.width*(this.nextRow+p+w);let M=0,I=s[M];for(let k=0;k<this.width;k++){k/I.right>1&&(I=s[++M]);const O=Math.abs(k-I.left),F=Math.abs(k-I.right),j=Math.min(O,F);let X;const q=w/p*(_+1);if(I.isDash){const Z=_-Math.abs(q);X=Math.sqrt(j*j+Z*Z)}else X=_-Math.sqrt(j*j+q*q);this.data[D+k]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(s){for(let M=s.length-1;M>=0;--M){const I=s[M],k=s[M+1];I.zeroLength?s.splice(M,1):k&&k.isDash===I.isDash&&(k.left=I.left,s.splice(M,1))}const u=s[0],p=s[s.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const _=this.width*this.nextRow;let w=0,D=s[w];for(let M=0;M<this.width;M++){M/D.right>1&&(D=s[++w]);const I=Math.abs(M-D.left),k=Math.abs(M-D.right),O=Math.min(I,k);this.data[_+M]=Math.max(0,Math.min(255,(D.isDash?O:-O)+128))}}addDash(s,u){const p=u?7:0,_=2*p+1;if(this.nextRow+_>this.height)return y.warnOnce("LineAtlas out of space"),null;let w=0;for(let M=0;M<s.length;M++)w+=s[M];if(0!==w){const M=this.width/w,I=this.getDashRanges(s,this.width,M);u?this.addRoundDash(I,M,p):this.addRegularDash(I)}const D={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:w};return this.nextRow+=_,this.dirty=!0,D}bind(s){const u=s.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}class Dr{constructor(s,u,p){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=p;const _=this.workerPool.acquire(p);for(let w=0;w<_.length;w++){const D=new Dr.Actor(_[w],u,p);D.name=`Worker ${w}`,this.actors.push(D)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,u,p){y.asyncAll(this.actors,(_,w)=>{_.send(s,u,w)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}}function uo(m,s,u){const p=function(_,w){if(_)return u(_);if(w){const D=y.pick(y.extend(w,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(D.vectorLayers=w.vector_layers,D.vectorLayerIds=D.vectorLayers.map(M=>M.id)),u(null,D)}};return m.url?y.getJSON(s.transformRequest(m.url,zn.Source),p):y.exported.frame(()=>p(null,m))}Dr.Actor=y.Actor;class Ft{constructor(s,u){s&&(u?this.setSouthWest(s).setNorthEast(u):Array.isArray(s)&&(4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof y.LngLat?new y.LngLat(s.lng,s.lat):y.LngLat.convert(s),this}setSouthWest(s){return this._sw=s instanceof y.LngLat?new y.LngLat(s.lng,s.lat):y.LngLat.convert(s),this}extend(s){const u=this._sw,p=this._ne;let _,w;if(s instanceof y.LngLat)_=s,w=s;else{if(!(s instanceof Ft))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(Ft.convert(s)):this.extend(y.LngLat.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(y.LngLat.convert(s)):this;if(_=s._sw,w=s._ne,!_||!w)return this}return u||p?(u.lng=Math.min(_.lng,u.lng),u.lat=Math.min(_.lat,u.lat),p.lng=Math.max(w.lng,p.lng),p.lat=Math.max(w.lat,p.lat)):(this._sw=new y.LngLat(_.lng,_.lat),this._ne=new y.LngLat(w.lng,w.lat)),this}getCenter(){return new y.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new y.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new y.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:u,lat:p}=y.LngLat.convert(s);let _=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(s){return s instanceof Ft?s:s&&new Ft(s)}static fromLngLat(s,u=0){const p=360*u/40075017,_=p/Math.cos(Math.PI/180*s.lat);return new Ft(new y.LngLat(s.lng-_,s.lat-p),new y.LngLat(s.lng+_,s.lat+p))}}class Pa{constructor(s,u,p){this.bounds=Ft.convert(this.validateBounds(s)),this.minzoom=u||0,this.maxzoom=p||24}validateBounds(s){return Array.isArray(s)&&4===s.length?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const u=Math.pow(2,s.z),p=Math.floor(y.mercatorXfromLng(this.bounds.getWest())*u),_=Math.floor(y.mercatorYfromLat(this.bounds.getNorth())*u),w=Math.ceil(y.mercatorXfromLng(this.bounds.getEast())*u),D=Math.ceil(y.mercatorYfromLat(this.bounds.getSouth())*u);return s.x>=p&&s.x<w&&s.y>=_&&s.y<D}}class Ra extends y.Evented{constructor(s,u,p,_){if(super(),this.id=s,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,y.extend(this,y.pick(u,["url","scheme","tileSize","promoteId"])),this._options=y.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=uo(this._options,this.map._requestManager,(s,u)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s?this.fire(new y.ErrorEvent(s)):u&&(y.extend(this,u),u.bounds&&(this.tileBounds=new Pa(u.bounds,this.minzoom,this.maxzoom)),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.cancel(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return y.extend({},this._options)}loadTile(s,u){const p=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(p,zn.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function w(D,M){return delete s.request,s.aborted?u(null):D&&404!==D.status?u(D):(M&&M.resourceTiming&&(s.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&s.setExpiryData(M),s.loadVectorData(M,this.map.painter),u(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,s.actor&&"expired"!==s.state?"loading"===s.state?s.reloadCallback=u:s.request=s.actor.send("reloadTile",_,w.bind(this)):(s.actor=this.dispatcher.getActor(),s.request=s.actor.send("loadTile",_,w.bind(this)))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id},void 0)}unloadTile(s){s.unloadVectorData(),s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Vn extends y.Evented{constructor(s,u,p,_){super(),this.id=s,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=y.extend({type:"raster"},u),y.extend(this,y.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=uo(this._options,this.map._requestManager,(s,u)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new y.ErrorEvent(s)):u&&(y.extend(this,u),u.bounds&&(this.tileBounds=new Pa(u.bounds,this.minzoom,this.maxzoom)),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return y.extend({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,u){const p=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.request=co.getImage(this.map._requestManager.transformRequest(p,zn.Tile),(_,w,D)=>{if(delete s.request,s.aborted)s.state="unloaded",u(null);else if(_)s.state="errored",u(_);else if(w){this.map._refreshExpiredTiles&&D&&s.setExpiryData(D);const M=this.map.painter.context,I=M.gl;s.texture=this.map.painter.getTileTexture(w.width),s.texture?s.texture.update(w,{useMipmap:!0}):(s.texture=new ut(M,w,I.RGBA,{useMipmap:!0}),s.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),M.extTextureFilterAnisotropic&&I.texParameterf(I.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax)),s.state="loaded",u(null)}},this.map._refreshExpiredTiles)}abortTile(s,u){s.request&&(s.request.cancel(),delete s.request),u()}unloadTile(s,u){s.texture&&this.map.painter.saveTileTexture(s.texture),u()}hasTransition(){return!1}}class Mn extends Vn{constructor(s,u,p,_){super(s,u,p,_),this.type="raster-dem",this.maxzoom=22,this._options=y.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(s,u){const p=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function _(w,D){w&&(s.state="errored",u(w)),D&&(s.dem=D,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded",u(null))}s.request=co.getImage(this.map._requestManager.transformRequest(p,zn.Tile),function(w,D){if(delete s.request,s.aborted)s.state="unloaded",u(null);else if(w)s.state="errored",u(w);else if(D){this.map._refreshExpiredTiles&&s.setExpiryData(D),delete D.cacheControl,delete D.expires;const M=y.isImageBitmap(D)&&(null==_n&&(_n=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),_n)?D:y.exported.getImageData(D,1),I={uid:s.uid,coord:s.tileID,source:this.id,rawImageData:M,encoding:this.encoding};s.actor&&"expired"!==s.state||(s.actor=this.dispatcher.getActor(),s.actor.send("loadDEMTile",I,_.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),s.neighboringTiles=this._getNeighboringTiles(s.tileID)}_getNeighboringTiles(s){const u=s.canonical,p=Math.pow(2,u.z),_=(u.x-1+p)%p,w=0===u.x?s.wrap-1:s.wrap,D=(u.x+1+p)%p,M=u.x+1===p?s.wrap+1:s.wrap,I={};return I[new y.OverscaledTileID(s.overscaledZ,w,u.z,_,u.y).key]={backfilled:!1},I[new y.OverscaledTileID(s.overscaledZ,M,u.z,D,u.y).key]={backfilled:!1},u.y>0&&(I[new y.OverscaledTileID(s.overscaledZ,w,u.z,_,u.y-1).key]={backfilled:!1},I[new y.OverscaledTileID(s.overscaledZ,s.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},I[new y.OverscaledTileID(s.overscaledZ,M,u.z,D,u.y-1).key]={backfilled:!1}),u.y+1<p&&(I[new y.OverscaledTileID(s.overscaledZ,w,u.z,_,u.y+1).key]={backfilled:!1},I[new y.OverscaledTileID(s.overscaledZ,s.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},I[new y.OverscaledTileID(s.overscaledZ,M,u.z,D,u.y+1).key]={backfilled:!1}),I}unloadTile(s){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&s.actor.send("removeDEMTile",{uid:s.uid,source:this.id})}}class ms extends y.Evented{constructor(s,u,p,_){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(_),this._data=u.data,this._options=y.extend({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const w=y.EXTENT/this.tileSize;this.workerOptions=y.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*w,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*w,extent:y.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:y.EXTENT,radius:(u.clusterRadius||50)*w,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(void 0!==s.clusterRadius&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),void 0!==s.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:s,source:this.id},u),this}getClusterChildren(s,u){return this.actor.send("geojson.getClusterChildren",{clusterId:s,source:this.id},u),this}getClusterLeaves(s,u,p,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:s,limit:u,offset:p},_),this}_updateWorkerData(s){const u=y.extend({},this.workerOptions);s?u.dataDiff=s:"string"==typeof this._data?(u.request=this.map._requestManager.transformRequest(y.exported.resolveURL(this._data),zn.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new y.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,u,(p,_)=>{if(this._pendingLoads--,this._removed||_&&_.abandoned)return void this.fire(new y.Event("dataabort",{dataType:"source"}));let w=null;if(_&&_.resourceTiming&&_.resourceTiming[this.id]&&(w=_.resourceTiming[this.id].slice(0)),p)return void this.fire(new y.ErrorEvent(p));const D={dataType:"source"};this._collectResourceTiming&&w&&w.length>0&&y.extend(D,{resourceTiming:w}),this.fire(new y.Event("data",{...D,sourceDataType:"metadata"})),this.fire(new y.Event("data",{...D,sourceDataType:"content"}))})}loaded(){return 0===this._pendingLoads}loadTile(s,u){const p=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const _={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.request=this.actor.send(p,_,(w,D)=>(delete s.request,s.unloadVectorData(),s.aborted?u(null):w?u(w):(s.loadVectorData(D,this.map.painter,"reloadTile"===p),u(null))))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.aborted=!0}unloadTile(s){s.unloadVectorData(),this.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return y.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var fn=y.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Nr extends y.Evented{constructor(s,u,p,_){super(),this.id=s,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u}load(s,u){this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=co.getImage(this.map._requestManager.transformRequest(this.url,zn.Image),(p,_)=>{this._request=null,this._loaded=!0,p?this.fire(new y.ErrorEvent(p)):_&&(this.image=_,s&&(this.coordinates=s),u&&u(),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=s.url,this.load(s.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(s){this.coordinates=s;const u=s.map(y.MercatorCoordinate.fromLngLat);this.tileID=function(_){let w=1/0,D=1/0,M=-1/0,I=-1/0;for(const j of _)w=Math.min(w,j.x),D=Math.min(D,j.y),M=Math.max(M,j.x),I=Math.max(I,j.y);const k=Math.max(M-w,I-D),O=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),F=Math.pow(2,O);return new y.CanonicalTileID(O,Math.floor((w+M)/2*F),Math.floor((D+I)/2*F))}(u),this.minzoom=this.maxzoom=this.tileID.z;const p=u.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new y.RasterBoundsArray,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,y.EXTENT,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,y.EXTENT),this._boundsArray.emplaceBack(p[2].x,p[2].y,y.EXTENT,y.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const s=this.map.painter.context,u=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,fn.members)),this.boundsSegments||(this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ut(s,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new y.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s,u){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},u(null)):(s.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ol extends Nr{constructor(s,u,p,_){super(s,u,p,_),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const s=this.options;this.urls=[];for(const u of s.urls)this.urls.push(this.map._requestManager.transformRequest(u,zn.Source).url);y.getVideo(this.urls,(u,p)=>{this._loaded=!0,u?this.fire(new y.ErrorEvent(u)):p&&(this.video=p,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const u=this.video.seekable;s<u.start(0)||s>u.end(0)?this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const s=this.map.painter.context,u=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,fn.members)),this.boundsSegments||(this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new ut(s,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new y.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class xe extends Nr{constructor(s,u,p,_){super(s,u,p,_),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(D=>"number"!=typeof D))||this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${s}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof HTMLCanvasElement||this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${s}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new y.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const u=this.map.painter.context,p=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,fn.members)),this.boundsSegments||(this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ut(u,this.canvas,p.RGBA,{premultiply:!0});let _=!1;for(const w in this.tiles){const D=this.tiles[w];"loaded"!==D.state&&(D.state="loaded",D.texture=this.texture,_=!0)}_&&this.fire(new y.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const Ws={vector:Ra,raster:Vn,"raster-dem":Mn,geojson:ms,video:ol,image:Nr,canvas:xe};function Zl(m,s){const u=y.create();return y.translate(u,u,[1,1,0]),y.scale(u,u,[.5*m.width,.5*m.height,1]),y.multiply(u,u,m.calculatePosMatrix(s.toUnwrapped()))}function Sn(m,s,u,p,_,w){const D=function(F,j,X){if(F)for(const q of F){const Z=j[q];if(Z&&Z.source===X&&"fill-extrusion"===Z.type)return!0}else for(const q in j){const Z=j[q];if(Z.source===X&&"fill-extrusion"===Z.type)return!0}return!1}(_&&_.layers,s,m.id),M=w.maxPitchScaleFactor(),I=m.tilesIn(p,M,D);I.sort(ln);const k=[];for(const F of I)k.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(s,u,m._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,_,w,M,Zl(m.transform,F.tileID))});const O=function(F){const j={},X={};for(const q of F){const Z=q.queryResults,te=q.wrappedTileID,le=X[te]=X[te]||{};for(const fe in Z){const J=Z[fe],pe=le[fe]=le[fe]||{},ye=j[fe]=j[fe]||[];for(const De of J)pe[De.featureIndex]||(pe[De.featureIndex]=!0,ye.push(De))}}return j}(k);for(const F in O)O[F].forEach(j=>{const X=j.feature,q=m.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=q});return O}function ln(m,s){const u=m.tileID,p=s.tileID;return u.overscaledZ-p.overscaledZ||u.canonical.y-p.canonical.y||u.wrap-p.wrap||u.canonical.x-p.canonical.x}class sl{constructor(s,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=y.uniqueId(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const u=s+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,u,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(_,w){const D={};if(!w)return D;for(const M of _){const I=M.layerIds.map(k=>w.getLayer(k)).filter(Boolean);if(0!==I.length){M.layers=I,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(k=>I.filter(O=>O.id===k)[0]));for(const k of I)D[k.id]=M}}return D}(s.buckets,u.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof y.SymbolBucket){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof y.SymbolBucket&&w.hasRTLText){this.hasRTLText=!0,y.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const _ in this.buckets){const w=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(_).queryRadius(w))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new y.CollisionBoxArray}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(s)}const u=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ut(s,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ut(s,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,u,p,_,w,D,M,I,k,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:w,scale:D,tileSize:this.tileSize,pixelPosMatrix:O,transform:I,params:M,queryPadding:this.queryPadding*k},s,u,p):{}}querySourceFeatures(s,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),w=u&&u.sourceLayer?u.sourceLayer:"",D=_._geojsonTileLayer||_[w];if(!D)return;const M=y.createFilter(u&&u.filter),{z:I,x:k,y:O}=this.tileID.canonical,F={z:I,x:k,y:O};for(let j=0;j<D.length;j++){const X=D.feature(j);if(M.needGeometry){const te=y.toEvaluationFeature(X,!0);if(!M.filter(new y.EvaluationParameters(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!M.filter(new y.EvaluationParameters(this.tileID.overscaledZ),X))continue;const q=p.getId(X,w),Z=new y.GeoJSONFeature(X,I,k,O,q);Z.tile=F,s.push(Z)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const u=this.expirationTime;if(s.cacheControl){const p=y.parseCacheControl(s.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(u)if(this.expirationTime<u)_=!0;else{const w=this.expirationTime-u;w?this.expirationTime=p+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(s,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(s).length)return;const p=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!u.style.hasLayer(_))continue;const w=this.buckets[_],D=w.layers[0].sourceLayer||"_geojsonTileLayer",M=p[D],I=s[D];if(!M||!I||0===Object.keys(I).length)continue;w.update(I,M,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=u&&u.style&&u.style.getLayer(_);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(w)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<y.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=y.exported.now()+s}setDependencies(s,u){const p={};for(const _ of u)p[_]=!0;this.dependencies[s]=p}hasDependency(s,u){for(const p of s){const _=this.dependencies[p];if(_)for(const w of u)if(_[w])return!0}return!1}}class Oc{constructor(s,u){this.max=s,this.onRemove=u,this.reset()}reset(){for(const s in this.data)for(const u of this.data[s])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(s,u,p){const _=s.wrapped().key;void 0===this.data[_]&&(this.data[_]=[]);const w={value:u,timeout:void 0};if(void 0!==p&&(w.timeout=setTimeout(()=>{this.remove(s,w)},p)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){const D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const u=this.data[s].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),u.value}getByKey(s){const u=this.data[s];return u?u[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,u){if(!this.has(s))return this;const p=s.wrapped().key,_=void 0===u?0:this.data[p].indexOf(u),w=this.data[p][_];return this.data[p].splice(_,1),w.timeout&&clearTimeout(w.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(s){const u=[];for(const p in this.data)for(const _ of this.data[p])s(_.value)||u.push(_);for(const p of u)this.remove(p.value.tileID,p)}}class Gu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,u,p){const _=String(u);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][_]=this.stateChanges[s][_]||{},y.extend(this.stateChanges[s][_],p),null===this.deletedStates[s]){this.deletedStates[s]={};for(const w in this.state[s])w!==_&&(this.deletedStates[s][w]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][_]){this.deletedStates[s][_]={};for(const w in this.state[s][_])p[w]||(this.deletedStates[s][_][w]=null)}else for(const w in p)this.deletedStates[s]&&this.deletedStates[s][_]&&null===this.deletedStates[s][_][w]&&delete this.deletedStates[s][_][w]}removeFeatureState(s,u,p){if(null===this.deletedStates[s])return;const _=String(u);if(this.deletedStates[s]=this.deletedStates[s]||{},p&&void 0!==u)null!==this.deletedStates[s][_]&&(this.deletedStates[s][_]=this.deletedStates[s][_]||{},this.deletedStates[s][_][p]=null);else if(void 0!==u)if(this.stateChanges[s]&&this.stateChanges[s][_])for(p in this.deletedStates[s][_]={},this.stateChanges[s][_])this.deletedStates[s][_][p]=null;else this.deletedStates[s][_]=null;else this.deletedStates[s]=null}getState(s,u){const p=String(u),_=y.extend({},(this.state[s]||{})[p],(this.stateChanges[s]||{})[p]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){const w=this.deletedStates[s][u];if(null===w)return{};for(const D in w)delete _[D]}return _}initializeTileState(s,u){s.setFeatureState(this.state,u)}coalesceChanges(s,u){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const w={};for(const D in this.stateChanges[_])this.state[_][D]||(this.state[_][D]={}),y.extend(this.state[_][D],this.stateChanges[_][D]),w[D]=this.state[_][D];p[_]=w}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const w={};if(null===this.deletedStates[_])for(const D in this.state[_])w[D]={},this.state[_][D]={};else for(const D in this.deletedStates[_]){if(null===this.deletedStates[_][D])this.state[_][D]={};else for(const M of Object.keys(this.deletedStates[_][D]))delete this.state[_][D][M];w[D]=this.state[_][D]}p[_]=p[_]||{},y.extend(p[_],w)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const _ in s)s[_].setFeatureState(p,u)}}class mi extends y.Evented{constructor(s,u,p){super(),this.id=s,this.dispatcher=p,this.on("data",_=>{"source"===_.dataType&&"metadata"===_.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===_.dataType&&"content"===_.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(_,w,D,M){const I=new Ws[w.type](_,w,D,M);if(I.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${I.id}`);return y.bindAll(["load","abort","unload","serialize","prepare"],I),I}(s,u,p,this),this._tiles={},this._cache=new Oc(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Gu,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const u=this._tiles[s];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,u){return this._source.loadTile(s,u)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){this._source.abortTile&&this._source.abortTile(s,()=>{}),this._source.fire(new y.Event("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(s),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Zs).map(s=>s.key)}getRenderableIds(s){const u=[];for(const p in this._tiles)this._isIdRenderable(p,s)&&u.push(this._tiles[p]);return s?u.sort((p,_)=>{const w=p.tileID,D=_.tileID,M=new y.Point(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),I=new y.Point(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-D.overscaledZ||I.y-M.y||I.x-M.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(Zs).map(p=>p.key)}hasRenderableParent(s){const u=this.findLoadedParent(s,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(s,u){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(u||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(s,"reloading")}}_reloadTile(s,u){const p=this._tiles[s];p&&("loading"!==p.state&&(p.state=u),this._loadTile(p,this._tileLoaded.bind(this,p,s,u)))}_tileLoaded(s,u,p,_){if(_)return s.state="errored",void(404!==_.status?this._source.fire(new y.ErrorEvent(_,{tile:s})):this.update(this.transform,this.terrain));s.timeAdded=y.exported.now(),"expired"===p&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(u,s),"raster-dem"===this.getSource().type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new y.Event("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const u=this.getRenderableIds();for(let _=0;_<u.length;_++){const w=u[_];if(s.neighboringTiles&&s.neighboringTiles[w]){const D=this.getTileByID(w);p(s,D),p(D,s)}}function p(_,w){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let D=w.tileID.canonical.x-_.tileID.canonical.x;const M=w.tileID.canonical.y-_.tileID.canonical.y,I=Math.pow(2,_.tileID.canonical.z),k=w.tileID.key;0===D&&0===M||Math.abs(M)>1||(Math.abs(D)>1&&(1===Math.abs(D+I)?D+=I:1===Math.abs(D-I)&&(D-=I)),w.dem&&_.dem&&(_.dem.backfillBorder(w.dem,D,M),_.neighboringTiles&&_.neighboringTiles[k]&&(_.neighboringTiles[k].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,u,p,_){for(const w in this._tiles){let D=this._tiles[w];if(_[w]||!D.hasData()||D.tileID.overscaledZ<=u||D.tileID.overscaledZ>p)continue;let M=D.tileID;for(;D&&D.tileID.overscaledZ>u+1;){const k=D.tileID.scaledTo(D.tileID.overscaledZ-1);D=this._tiles[k.key],D&&D.hasData()&&(M=k)}let I=M;for(;I.overscaledZ>u;)if(I=I.scaledTo(I.overscaledZ-1),s[I.key]){_[M.key]=M;break}}}findLoadedParent(s,u){if(s.key in this._loadedParentTiles){const p=this._loadedParentTiles[s.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=s.overscaledZ-1;p>=u;p--){const _=s.scaledTo(p),w=this._getLoadedTile(_);if(w)return w}}_getLoadedTile(s){const u=this._tiles[s.key];return u&&u.hasData()?u:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const u=Math.ceil(s.width/this._source.tileSize)+1,p=Math.ceil(s.height/this._source.tileSize)+1,_=Math.floor(u*p*(null===this._maxTileCacheZoomLevels?y.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(s){const u=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,u){const p={};for(const _ in this._tiles){const w=this._tiles[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+u),p[w.tileID.key]=w}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(s,u){if(this.transform=s,this.terrain=u,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new y.OverscaledTileID(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(p=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(p=p.filter(O=>this._source.hasTile(O)))):p=[];const _=s.coveringZoomLevel(this._source),w=Math.max(_-mi.maxOverzooming,this._source.minzoom),D=Math.max(_+mi.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const O={};for(const F of p)if(F.canonical.z>this._source.minzoom){const j=F.scaledTo(F.canonical.z-1);O[j.key]=j;const X=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));O[X.key]=X}p=p.concat(Object.values(O))}const M=0===p.length&&!this._updated&&this._didEmitContent;this._updated=!0,M&&this.fire(new y.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(p,_);if(al(this._source.type)){const O={},F={},j=Object.keys(I),X=y.exported.now();for(const q of j){const Z=I[q],te=this._tiles[q];if(!te||0!==te.fadeEndTime&&te.fadeEndTime<=X)continue;const le=this.findLoadedParent(Z,w);le&&(this._addTile(le.tileID),O[le.tileID.key]=le.tileID),F[q]=Z}this._retainLoadedChildren(F,_,D,I);for(const q in O)I[q]||(this._coveredTiles[q]=!0,I[q]=O[q]);if(u){const q={},Z={};for(const te of p)this._tiles[te.key].hasData()?q[te.key]=te:Z[te.key]=te;for(const te in Z){const le=Z[te].children(this._source.maxzoom);this._tiles[le[0].key]&&this._tiles[le[1].key]&&this._tiles[le[2].key]&&this._tiles[le[3].key]&&(q[le[0].key]=I[le[0].key]=le[0],q[le[1].key]=I[le[1].key]=le[1],q[le[2].key]=I[le[2].key]=le[2],q[le[3].key]=I[le[3].key]=le[3],delete Z[te])}for(const te in Z){const le=this.findLoadedParent(Z[te],this._source.minzoom);if(le){q[le.tileID.key]=I[le.tileID.key]=le.tileID;for(const fe in q)q[fe].isChildOf(le.tileID)&&delete q[fe]}}for(const te in this._tiles)q[te]||(this._coveredTiles[te]=!0)}}for(const O in I)this._tiles[O].clearFadeHold();const k=y.keysDifference(this._tiles,I);for(const O of k){const F=this._tiles[O];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(O)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,u){const p={},_={},w=Math.max(u-mi.maxOverzooming,this._source.minzoom),D=Math.max(u+mi.maxUnderzooming,this._source.minzoom),M={};for(const I of s){const k=this._addTile(I);p[I.key]=I,k.hasData()||u<this._source.maxzoom&&(M[I.key]=I)}this._retainLoadedChildren(M,u,D,p);for(const I of s){let k=this._tiles[I.key];if(k.hasData())continue;if(u+1>this._source.maxzoom){const F=I.children(this._source.maxzoom)[0],j=this.getTile(F);if(j&&j.hasData()){p[F.key]=F;continue}}else{const F=I.children(this._source.maxzoom);if(p[F[0].key]&&p[F[1].key]&&p[F[2].key]&&p[F[3].key])continue}let O=k.wasRequested();for(let F=I.overscaledZ-1;F>=w;--F){const j=I.scaledTo(F);if(_[j.key])break;if(_[j.key]=!0,k=this.getTile(j),!k&&O&&(k=this._addTile(j)),k){const X=k.hasData();if((O||X)&&(p[j.key]=j),O=k.wasRequested(),X)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const u=[];let p,_=this._tiles[s].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}u.push(_.key);const w=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;_=w}for(const w of u)this._loadedParentTiles[w]=p}}_addTile(s){let u=this._tiles[s.key];if(u)return u;u=this._cache.getAndRemove(s),u&&(this._setTileReloadTimer(s.key,u),u.tileID=s,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,u)));const p=u;return u||(u=new sl(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,s.key,u.state))),u.uses++,this._tiles[s.key]=u,p||this._source.fire(new y.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(s,u){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const p=u.getExpiryTimeout();p&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},p))}_removeTile(s){const u=this._tiles[s];u&&(u.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,u,p){const _=[],w=this.transform;if(!w)return _;const D=p?w.getCameraQueryGeometry(s):s,M=s.map(q=>w.pointCoordinate(q,this.terrain)),I=D.map(q=>w.pointCoordinate(q,this.terrain)),k=this.getIds();let O=1/0,F=1/0,j=-1/0,X=-1/0;for(const q of I)O=Math.min(O,q.x),F=Math.min(F,q.y),j=Math.max(j,q.x),X=Math.max(X,q.y);for(let q=0;q<k.length;q++){const Z=this._tiles[k[q]];if(Z.holdingForFade())continue;const te=Z.tileID,le=Math.pow(2,w.zoom-Z.tileID.overscaledZ),fe=u*Z.queryPadding*y.EXTENT/Z.tileSize/le,J=[te.getTilePoint(new y.MercatorCoordinate(O,F)),te.getTilePoint(new y.MercatorCoordinate(j,X))];if(J[0].x-fe<y.EXTENT&&J[0].y-fe<y.EXTENT&&J[1].x+fe>=0&&J[1].y+fe>=0){const pe=M.map(De=>te.getTilePoint(De)),ye=I.map(De=>te.getTilePoint(De));_.push({tile:Z,tileID:te,queryGeometry:pe,cameraQueryGeometry:ye,scale:le})}}return _}getVisibleCoordinates(s){const u=this.getRenderableIds(s).map(p=>this._tiles[p].tileID);for(const p of u)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(al(this._source.type)){const s=y.exported.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=s)return!0}return!1}setFeatureState(s,u,p){this._state.updateState(s=s||"_geojsonTileLayer",u,p)}removeFeatureState(s,u,p){this._state.removeFeatureState(s=s||"_geojsonTileLayer",u,p)}getFeatureState(s,u){return this._state.getState(s=s||"_geojsonTileLayer",u)}setDependencies(s,u,p){const _=this._tiles[s];_&&_.setDependencies(u,p)}reloadTilesForDependencies(s,u){for(const p in this._tiles)this._tiles[p].hasDependency(s,u)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(s,u))}}function Zs(m,s){const u=Math.abs(2*m.wrap)-+(m.wrap<0),p=Math.abs(2*s.wrap)-+(s.wrap<0);return m.overscaledZ-s.overscaledZ||p-u||s.canonical.y-m.canonical.y||s.canonical.x-m.canonical.x}function al(m){return"raster"===m||"image"===m||"video"===m}mi.maxOverzooming=10,mi.maxUnderzooming=3;const gs="mapboxgl_preloaded_worker_pool";class je{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<je.workerCount;)this.workers.push(new Worker(y.config.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[gs]}numActive(){return Object.keys(this.active).length}}const ho=Math.floor(y.exported.hardwareConcurrency/2);let Xi;function ll(){return Xi||(Xi=new je),Xi}je.workerCount=y.isSafari(globalThis)?Math.max(Math.min(ho,3),1):1;class Xs{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(1===this.points.length)return this.points[0];s=y.clamp(s,0,1);let u=1,p=this._distances[u];const _=s*this.paddedLength+this.padding;for(;p<_&&u<this._distances.length;)p=this._distances[++u];const w=u-1,D=this._distances[w],M=p-D,I=M>0?(_-D)/M:0;return this.points[w].mult(1-I).add(this.points[u].mult(I))}}function Ve(m,s){let u=!0;return"always"===m||"never"!==m&&"never"!==s||(u=!1),u}class wt{constructor(s,u,p){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(s/p),this.yCellCount=Math.ceil(u/p);for(let D=0;D<this.xCellCount*this.yCellCount;D++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,p,_,w){this._forEachCell(u,p,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(s,u,p,_){this._forEachCell(u-_,p-_,u+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(p),this.circles.push(_)}_insertBoxCell(s,u,p,_,w,D){this.boxCells[w].push(D)}_insertCircleCell(s,u,p,_,w,D){this.circleCells[w].push(D)}_query(s,u,p,_,w,D,M){if(p<0||s>this.width||_<0||u>this.height)return[];const I=[];if(s<=0&&u<=0&&this.width<=p&&this.height<=_){if(w)return[{key:null,x1:s,y1:u,x2:p,y2:_}];for(let k=0;k<this.boxKeys.length;k++)I.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const O=this.circles[3*k],F=this.circles[3*k+1],j=this.circles[3*k+2];I.push({key:this.circleKeys[k],x1:O-j,y1:F-j,x2:O+j,y2:F+j})}}else this._forEachCell(s,u,p,_,this._queryCell,I,{hitTest:w,overlapMode:D,seenUids:{box:{},circle:{}}},M);return I}query(s,u,p,_){return this._query(s,u,p,_,!1,null)}hitTest(s,u,p,_,w,D){return this._query(s,u,p,_,!0,w,D).length>0}hitTestCircle(s,u,p,_,w){const D=s-p,M=s+p,I=u-p,k=u+p;if(M<0||D>this.width||k<0||I>this.height)return!1;const O=[];return this._forEachCell(D,I,M,k,this._queryCellCircle,O,{hitTest:!0,overlapMode:_,circle:{x:s,y:u,radius:p},seenUids:{box:{},circle:{}}},w),O.length>0}_queryCell(s,u,p,_,w,D,M,I){const{seenUids:k,hitTest:O,overlapMode:F}=M,j=this.boxCells[w];if(null!==j){const q=this.bboxes;for(const Z of j)if(!k.box[Z]){k.box[Z]=!0;const te=4*Z,le=this.boxKeys[Z];if(s<=q[te+2]&&u<=q[te+3]&&p>=q[te+0]&&_>=q[te+1]&&(!I||I(le))&&(!O||!Ve(F,le.overlapMode))&&(D.push({key:le,x1:q[te],y1:q[te+1],x2:q[te+2],y2:q[te+3]}),O))return!0}}const X=this.circleCells[w];if(null!==X){const q=this.circles;for(const Z of X)if(!k.circle[Z]){k.circle[Z]=!0;const te=3*Z,le=this.circleKeys[Z];if(this._circleAndRectCollide(q[te],q[te+1],q[te+2],s,u,p,_)&&(!I||I(le))&&(!O||!Ve(F,le.overlapMode))){const fe=q[te],J=q[te+1],pe=q[te+2];if(D.push({key:le,x1:fe-pe,y1:J-pe,x2:fe+pe,y2:J+pe}),O)return!0}}}return!1}_queryCellCircle(s,u,p,_,w,D,M,I){const{circle:k,seenUids:O,overlapMode:F}=M,j=this.boxCells[w];if(null!==j){const q=this.bboxes;for(const Z of j)if(!O.box[Z]){O.box[Z]=!0;const te=4*Z,le=this.boxKeys[Z];if(this._circleAndRectCollide(k.x,k.y,k.radius,q[te+0],q[te+1],q[te+2],q[te+3])&&(!I||I(le))&&!Ve(F,le.overlapMode))return D.push(!0),!0}}const X=this.circleCells[w];if(null!==X){const q=this.circles;for(const Z of X)if(!O.circle[Z]){O.circle[Z]=!0;const te=3*Z,le=this.circleKeys[Z];if(this._circlesCollide(q[te],q[te+1],q[te+2],k.x,k.y,k.radius)&&(!I||I(le))&&!Ve(F,le.overlapMode))return D.push(!0),!0}}}_forEachCell(s,u,p,_,w,D,M,I){const k=this._convertToXCellCoord(s),O=this._convertToYCellCoord(u),F=this._convertToXCellCoord(p),j=this._convertToYCellCoord(_);for(let X=k;X<=F;X++)for(let q=O;q<=j;q++)if(w.call(this,s,u,p,_,this.xCellCount*q+X,D,M,I))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,p,_,w,D){const M=_-s,I=w-u,k=p+D;return k*k>M*M+I*I}_circleAndRectCollide(s,u,p,_,w,D,M){const I=(D-_)/2,k=Math.abs(s-(_+I));if(k>I+p)return!1;const O=(M-w)/2,F=Math.abs(u-(w+O));if(F>O+p)return!1;if(k<=I||F<=O)return!0;const j=k-I,X=F-O;return j*j+X*X<=p*p}}function Tt(m,s,u,p,_){const w=y.create();return s?(y.scale(w,w,[1/_,1/_,1]),u||y.rotateZ(w,w,p.angle)):y.multiply(w,p.labelPlaneMatrix,m),w}function Br(m,s,u,p,_){if(s){const w=y.clone(m);return y.scale(w,w,[_,_,1]),u||y.rotateZ(w,w,-p.angle),w}return p.glCoordMatrix}function gi(m,s,u){let p;u?(p=[m.x,m.y,u(m.x,m.y),1],y.transformMat4(p,p,s)):(p=[m.x,m.y,0,1],ee(p,p,s));const _=p[3];return{point:new y.Point(p[0]/_,p[1]/_),signedDistanceFromCamera:_}}function At(m,s){return.5+m/s*.5}function _s(m,s){const u=m[0]/m[3],p=m[1]/m[3];return u>=-s[0]&&u<=s[0]&&p>=-s[1]&&p<=s[1]}function ys(m,s,u,p,_,w,D,M,I,k){const O=p?m.textSizeData:m.iconSizeData,F=y.evaluateSizeForZoom(O,u.transform.zoom),j=[256/u.width*2+1,256/u.height*2+1],X=p?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;X.clear();const q=m.lineVertexArray,Z=p?m.text.placedSymbolArray:m.icon.placedSymbolArray,te=u.transform.width/u.transform.height;let le=!1;for(let fe=0;fe<Z.length;fe++){const J=Z.get(fe);if(J.hidden||J.writingMode===y.WritingMode.vertical&&!le){G(J.numGlyphs,X);continue}let pe;if(le=!1,k?(pe=[J.anchorX,J.anchorY,k(J.anchorX,J.anchorY),1],y.transformMat4(pe,pe,s)):(pe=[J.anchorX,J.anchorY,0,1],ee(pe,pe,s)),!_s(pe,j)){G(J.numGlyphs,X);continue}const ye=At(u.transform.cameraToCenterDistance,pe[3]),De=y.evaluateSizeForFeature(O,F,J),Ae=D?De/ye:De*ye,Ne=new y.Point(J.anchorX,J.anchorY),ke=gi(Ne,_,k).point,Be={projections:{},offsets:{}},ot=Ki(J,Ae,!1,M,s,_,w,m.glyphOffsetArray,q,X,ke,Ne,Be,te,I,k);le=ot.useVertical,(ot.notEnoughRoom||le||ot.needsFlipping&&Ki(J,Ae,!0,M,s,_,w,m.glyphOffsetArray,q,X,ke,Ne,Be,te,I,k).notEnoughRoom)&&G(J.numGlyphs,X)}p?m.text.dynamicLayoutVertexBuffer.updateData(X):m.icon.dynamicLayoutVertexBuffer.updateData(X)}function ko(m,s,u,p,_,w,D,M,I,k,O,F,j){const X=M.glyphStartIndex+M.numGlyphs,q=M.lineStartIndex,Z=M.lineStartIndex+M.lineLength,te=s.getoffsetX(M.glyphStartIndex),le=s.getoffsetX(X-1),fe=N(m*te,u,p,_,w,D,M.segment,q,Z,I,k,O,F,j);if(!fe)return null;const J=N(m*le,u,p,_,w,D,M.segment,q,Z,I,k,O,F,j);return J?{first:fe,last:J}:null}function vs(m,s,u,p){return m===y.WritingMode.horizontal&&Math.abs(u.y-s.y)>Math.abs(u.x-s.x)*p?{useVertical:!0}:(m===y.WritingMode.vertical?s.y<u.y:s.x>u.x)?{needsFlipping:!0}:null}function Ki(m,s,u,p,_,w,D,M,I,k,O,F,j,X,q,Z){const te=s/24,le=m.lineOffsetX*te,fe=m.lineOffsetY*te;let J;if(m.numGlyphs>1){const pe=m.glyphStartIndex+m.numGlyphs,ye=m.lineStartIndex,De=m.lineStartIndex+m.lineLength,Ae=ko(te,M,le,fe,u,O,F,m,I,w,j,q,Z);if(!Ae)return{notEnoughRoom:!0};const Ne=gi(Ae.first.point,D,Z).point,ke=gi(Ae.last.point,D,Z).point;if(p&&!u){const Be=vs(m.writingMode,Ne,ke,X);if(Be)return Be}J=[Ae.first];for(let Be=m.glyphStartIndex+1;Be<pe-1;Be++)J.push(N(te*M.getoffsetX(Be),le,fe,u,O,F,m.segment,ye,De,I,w,j,q,Z));J.push(Ae.last)}else{if(p&&!u){const ye=gi(F,_,Z).point,De=m.lineStartIndex+m.segment+1,Ae=new y.Point(I.getx(De),I.gety(De)),Ne=gi(Ae,_,Z),ke=Ne.signedDistanceFromCamera>0?Ne.point:Tn(F,Ae,ye,1,_,Z),Be=vs(m.writingMode,ye,ke,X);if(Be)return Be}const pe=N(te*M.getoffsetX(m.glyphStartIndex),le,fe,u,O,F,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,I,w,j,q,Z);if(!pe)return{notEnoughRoom:!0};J=[pe]}for(const pe of J)y.addDynamicAttributes(k,pe.point,pe.angle);return{}}function Tn(m,s,u,p,_,w){const D=gi(m.add(m.sub(s)._unit()),_,w).point,M=u.sub(D);return u.add(M._mult(p/M.mag()))}function Xl(m,s){const{projectionCache:u,lineVertexArray:p,labelPlaneMatrix:_,tileAnchorPoint:w,distanceFromAnchor:D,getElevation:M,previousVertex:I,direction:k,absOffsetX:O}=s;if(u.projections[m])return u.projections[m];const F=new y.Point(p.getx(m),p.gety(m)),j=gi(F,_,M);if(j.signedDistanceFromCamera>0)return u.projections[m]=j.point,j.point;const X=m-k;return Tn(0===D?w:new y.Point(p.getx(X),p.gety(X)),F,I,O-D+1,_,M)}function Qo(m,s,u){return m._unit()._perp()._mult(s*u)}function Y(m,s,u,p,_,w,D,M){const{projectionCache:I,direction:k}=M;if(I.offsets[m])return I.offsets[m];const O=u.add(s);if(m+k<p||m+k>=_)return I.offsets[m]=O,O;const F=Xl(m+k,M),j=Qo(F.sub(u),D,k),X=u.add(j),q=F.add(j);return I.offsets[m]=y.findLineIntersection(w,O,X,q)||O,I.offsets[m]}function N(m,s,u,p,_,w,D,M,I,k,O,F,j,X){const q=p?m-s:m+s;let Z=q>0?1:-1,te=0;p&&(Z*=-1,te=Math.PI),Z<0&&(te+=Math.PI);let le,fe,J=Z>0?M+D:M+D+1,pe=_,ye=_,De=0,Ae=0;const Ne=Math.abs(q),ke=[];let Be;for(;De+Ae<=Ne;){if(J+=Z,J<M||J>=I)return null;De+=Ae,ye=pe,fe=le;const He={projectionCache:F,lineVertexArray:k,labelPlaneMatrix:O,tileAnchorPoint:w,distanceFromAnchor:De,getElevation:X,previousVertex:ye,direction:Z,absOffsetX:Ne};if(pe=Xl(J,He),0===u)ke.push(ye),Be=pe.sub(ye);else{let yt;const Ye=pe.sub(ye);yt=0===Ye.mag()?Qo(Xl(J+Z,He).sub(pe),u,Z):Qo(Ye,u,Z),fe||(fe=ye.add(yt)),le=Y(J,yt,pe,M,I,fe,u,He),ke.push(fe),Be=le.sub(fe)}Ae=Be.mag()}const ot=Be._mult((Ne-De)/Ae)._add(fe||ye),gt=te+Math.atan2(pe.y-ye.y,pe.x-ye.x);return ke.push(ot),{point:ot,angle:j?gt:0,path:ke}}const z=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function G(m,s){for(let u=0;u<m;u++){const p=s.length;s.resize(p+4),s.float32.set(z,3*p)}}function ee(m,s,u){const p=s[0],_=s[1];return m[0]=u[0]*p+u[4]*_+u[12],m[1]=u[1]*p+u[5]*_+u[13],m[3]=u[3]*p+u[7]*_+u[15],m}const ne=100;class ce{constructor(s,u=new wt(s.width+200,s.height+200,25),p=new wt(s.width+200,s.height+200,25)){this.transform=s,this.grid=u,this.ignoredGrid=p,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+ne,this.screenBottomBoundary=s.height+ne,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,u,p,_,w,D){const M=this.projectAndGetPerspectiveRatio(_,s.anchorPointX,s.anchorPointY,D),I=p*M.perspectiveRatio,k=s.x1*I+M.point.x,O=s.y1*I+M.point.y,F=s.x2*I+M.point.x,j=s.y2*I+M.point.y;return!this.isInsideGrid(k,O,F,j)||"always"!==u&&this.grid.hitTest(k,O,F,j,u,w)||M.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,O,F,j],offscreen:this.isOffscreen(k,O,F,j)}}placeCollisionCircles(s,u,p,_,w,D,M,I,k,O,F,j,X,q){const Z=[],te=new y.Point(u.anchorX,u.anchorY),le=gi(te,D,q),fe=At(this.transform.cameraToCenterDistance,le.signedDistanceFromCamera),J=(O?w/fe:w*fe)/y.ONE_EM,pe=gi(te,M,q).point,ye=ko(J,_,u.lineOffsetX*J,u.lineOffsetY*J,!1,pe,te,u,p,M,{projections:{},offsets:{}},!1,q);let De=!1,Ae=!1,Ne=!0;if(ye){const ke=.5*j*fe+X,Be=new y.Point(-100,-100),ot=new y.Point(this.screenRightBoundary,this.screenBottomBoundary),gt=new Xs,He=ye.first,yt=ye.last;let Ye=[];for(let nn=He.path.length-1;nn>=1;nn--)Ye.push(He.path[nn]);for(let nn=1;nn<yt.path.length;nn++)Ye.push(yt.path[nn]);const tn=2.5*ke;if(I){const nn=Ye.map(It=>gi(It,I,q));Ye=nn.some(It=>It.signedDistanceFromCamera<=0)?[]:nn.map(It=>It.point)}let Jn=[];if(Ye.length>0){const nn=Ye[0].clone(),It=Ye[0].clone();for(let Wn=1;Wn<Ye.length;Wn++)nn.x=Math.min(nn.x,Ye[Wn].x),nn.y=Math.min(nn.y,Ye[Wn].y),It.x=Math.max(It.x,Ye[Wn].x),It.y=Math.max(It.y,Ye[Wn].y);Jn=nn.x>=Be.x&&It.x<=ot.x&&nn.y>=Be.y&&It.y<=ot.y?[Ye]:It.x<Be.x||nn.x>ot.x||It.y<Be.y||nn.y>ot.y?[]:y.clipLine([Ye],Be.x,Be.y,ot.x,ot.y)}for(const nn of Jn){gt.reset(nn,.25*ke);let It=0;It=gt.length<=.5*ke?1:Math.ceil(gt.paddedLength/tn)+1;for(let Wn=0;Wn<It;Wn++){const pr=Wn/Math.max(It-1,1),ii=gt.lerp(pr),Mi=ii.x+ne,fr=ii.y+ne;Z.push(Mi,fr,ke,0);const Tr=Mi-ke,mr=fr-ke,gr=Mi+ke,ks=fr+ke;if(Ne=Ne&&this.isOffscreen(Tr,mr,gr,ks),Ae=Ae||this.isInsideGrid(Tr,mr,gr,ks),"always"!==s&&this.grid.hitTestCircle(Mi,fr,ke,s,F)&&(De=!0,!k))return{circles:[],offscreen:!1,collisionDetected:De}}}}return{circles:!k&&De||!Ae||fe<this.perspectiveRatioCutoff?[]:Z,offscreen:Ne,collisionDetected:De}}queryRenderedSymbols(s){if(0===s.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let p=1/0,_=1/0,w=-1/0,D=-1/0;for(const O of s){const F=new y.Point(O.x+ne,O.y+ne);p=Math.min(p,F.x),_=Math.min(_,F.y),w=Math.max(w,F.x),D=Math.max(D,F.y),u.push(F)}const M=this.grid.query(p,_,w,D).concat(this.ignoredGrid.query(p,_,w,D)),I={},k={};for(const O of M){const F=O.key;if(void 0===I[F.bucketInstanceId]&&(I[F.bucketInstanceId]={}),I[F.bucketInstanceId][F.featureIndex])continue;const j=[new y.Point(O.x1,O.y1),new y.Point(O.x2,O.y1),new y.Point(O.x2,O.y2),new y.Point(O.x1,O.y2)];y.polygonIntersectsPolygon(u,j)&&(I[F.bucketInstanceId][F.featureIndex]=!0,void 0===k[F.bucketInstanceId]&&(k[F.bucketInstanceId]=[]),k[F.bucketInstanceId].push(F.featureIndex))}return k}insertCollisionBox(s,u,p,_,w,D){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:D,overlapMode:u},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,p,_,w,D){const M=p?this.ignoredGrid:this.grid,I={bucketInstanceId:_,featureIndex:w,collisionGroupID:D,overlapMode:u};for(let k=0;k<s.length;k+=4)M.insertCircle(I,s[k],s[k+1],s[k+2])}projectAndGetPerspectiveRatio(s,u,p,_){let w;return _?(w=[u,p,_(u,p),1],y.transformMat4(w,w,s)):(w=[u,p,0,1],ee(w,w,s)),{point:new y.Point((w[0]/w[3]+1)/2*this.transform.width+ne,(-w[1]/w[3]+1)/2*this.transform.height+ne),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w[3]*.5}}isOffscreen(s,u,p,_){return p<ne||s>=this.screenRightBoundary||_<ne||u>this.screenBottomBoundary}isInsideGrid(s,u,p,_){return p>=0&&s<this.gridRightBoundary&&_>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=y.identity([]);return y.translate(s,s,[-100,-100,0]),s}}function ae(m,s,u){return s*(y.EXTENT/(m.tileSize*Math.pow(2,u-m.tileID.overscaledZ)))}class ie{constructor(s,u,p,_){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):_&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class de{constructor(s,u,p,_,w){this.text=new ie(s?s.text:null,u,p,w),this.icon=new ie(s?s.icon:null,u,_,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Se{constructor(s,u,p){this.text=s,this.icon=u,this.skipFade=p}}class Ie{constructor(){this.invProjMatrix=y.create(),this.viewportMatrix=y.create(),this.circles=[]}}class we{constructor(s,u,p,_,w){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=w}}class ft{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:p=>p.collisionGroupID===u}}return this.collisionGroups[s]}}function Et(m,s,u,p,_){const{horizontalAlign:w,verticalAlign:D}=y.getAnchorAlignment(m),M=-(w-.5)*s,I=-(D-.5)*u,k=y.evaluateVariableOffset(m,p);return new y.Point(M+k[0]*_,I+k[1]*_)}function tt(m,s,u,p,_,w){const{x1:D,x2:M,y1:I,y2:k,anchorPointX:O,anchorPointY:F}=m,j=new y.Point(s,u);return p&&j._rotate(_?w:-w),{x1:D+j.x,y1:I+j.y,x2:M+j.x,y2:k+j.y,anchorPointX:O,anchorPointY:F}}class dt{constructor(s,u,p,_,w){this.transform=s.clone(),this.terrain=u,this.collisionIndex=new ce(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new ft(_),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,u,p,_){const w=p.getBucket(u),D=p.latestFeatureIndex;if(!w||!D||u.id!==w.layerIds[0])return;const M=p.collisionBoxArray,I=w.layers[0].layout,k=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),O=p.tileSize/y.EXTENT,F=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),j="map"===I.get("text-pitch-alignment"),X="map"===I.get("text-rotation-alignment"),q=ae(p,1,this.transform.zoom),Z=Tt(F,j,X,this.transform,q);let te=null;if(j){const fe=Br(F,j,X,this.transform,q);te=y.multiply([],this.transform.labelPlaneMatrix,fe)}this.retainedQueryData[w.bucketInstanceId]=new we(w.bucketInstanceId,D,w.sourceLayerIndex,w.index,p.tileID);const le={bucket:w,layout:I,posMatrix:F,textLabelPlaneMatrix:Z,labelToScreenMatrix:te,scale:k,textPixelRatio:O,holdingForFade:p.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:y.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(_)for(const fe of w.sortKeyRanges){const{sortKey:J,symbolInstanceStart:pe,symbolInstanceEnd:ye}=fe;s.push({sortKey:J,symbolInstanceStart:pe,symbolInstanceEnd:ye,parameters:le})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:le})}attemptAnchorPlacement(s,u,p,_,w,D,M,I,k,O,F,j,X,q,Z,te){const le=[j.textOffset0,j.textOffset1],fe=Et(s,p,_,le,w),J=this.collisionIndex.placeCollisionBox(tt(u,fe.x,fe.y,D,M,this.transform.angle),F,I,k,O.predicate,te);if((!Z||0!==this.collisionIndex.placeCollisionBox(tt(Z,fe.x,fe.y,D,M,this.transform.angle),F,I,k,O.predicate,te).box.length)&&J.box.length>0){let pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(pe=this.prevPlacement.variableOffsets[j.crossTileID].anchor),0===j.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:le,width:p,height:_,anchor:s,textBoxScale:w,prevAnchor:pe},this.markUsedJustification(X,s,j,q),X.allowVerticalPlacement&&(this.markUsedOrientation(X,q,j),this.placedOrientations[j.crossTileID]=q),{shift:fe,placedGlyphBoxes:J}}}placeLayerBucketPart(s,u,p){const{bucket:_,layout:w,posMatrix:D,textLabelPlaneMatrix:M,labelToScreenMatrix:I,textPixelRatio:k,holdingForFade:O,collisionBoxArray:F,partiallyEvaluatedTextSize:j,collisionGroup:X}=s.parameters,q=w.get("text-optional"),Z=w.get("icon-optional"),te=y.getOverlapMode(w,"text-overlap","text-allow-overlap"),le="always"===te,fe=y.getOverlapMode(w,"icon-overlap","icon-allow-overlap"),J="always"===fe,pe="map"===w.get("text-rotation-alignment"),ye="map"===w.get("text-pitch-alignment"),De="none"!==w.get("icon-text-fit"),Ae="viewport-y"===w.get("symbol-z-order"),Ne=le&&(J||!_.hasIconData()||Z),ke=J&&(le||!_.hasTextData()||q);!_.collisionArrays&&F&&_.deserializeCollisionBoxes(F);const Be=this.retainedQueryData[_.bucketInstanceId].tileID,ot=this.terrain?(He,yt)=>this.terrain.getElevation(Be,He,yt):null,gt=(He,yt)=>{if(u[He.crossTileID])return;if(O)return void(this.placements[He.crossTileID]=new Se(!1,!1,!1));let Ye=!1,tn=!1,Jn=!0,nn=null,It={box:null,offscreen:null},Wn={box:null,offscreen:null},pr=null,ii=null,Mi=null,fr=0,Tr=0,mr=0;yt.textFeatureIndex?fr=yt.textFeatureIndex:He.useRuntimeCollisionCircles&&(fr=He.featureIndex),yt.verticalTextFeatureIndex&&(Tr=yt.verticalTextFeatureIndex);const gr=yt.textBox;if(gr){const Ar=un=>{let Vi=y.WritingMode.horizontal;if(_.allowVerticalPlacement&&!un&&this.prevPlacement){const Ti=this.prevPlacement.placedOrientations[He.crossTileID];Ti&&(this.placedOrientations[He.crossTileID]=Ti,Vi=Ti,this.markUsedOrientation(_,Vi,He))}return Vi},zi=(un,Vi)=>{if(_.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&yt.verticalTextBox){for(const Ti of _.writingModes)if(Ti===y.WritingMode.vertical?(It=Vi(),Wn=It):It=un(),It&&It.box&&It.box.length)break}else It=un()};if(w.get("text-variable-anchor")){let un=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[He.crossTileID]){const an=this.prevPlacement.variableOffsets[He.crossTileID];un.indexOf(an.anchor)>0&&(un=un.filter(Ai=>Ai!==an.anchor),un.unshift(an.anchor))}const Vi=(an,Ai,kr)=>{const hd=an.x2-an.x1,ua=an.y2-an.y1,$p=He.textBoxScale,pd=De&&"never"===fe?Ai:null;let kn={box:[],offscreen:!1};const fd="never"!==te?2*un.length:un.length;for(let oc=0;oc<fd;++oc){const Ps=this.attemptAnchorPlacement(un[oc%un.length],an,hd,ua,$p,pe,ye,k,D,X,oc>=un.length?te:"never",He,_,kr,pd,ot);if(Ps&&(kn=Ps.placedGlyphBoxes,kn&&kn.box&&kn.box.length)){Ye=!0,nn=Ps.shift;break}}return kn};zi(()=>Vi(gr,yt.iconBox,y.WritingMode.horizontal),()=>{const an=yt.verticalTextBox;return _.allowVerticalPlacement&&!(It&&It.box&&It.box.length)&&He.numVerticalGlyphVertices>0&&an?Vi(an,yt.verticalIconBox,y.WritingMode.vertical):{box:null,offscreen:null}}),It&&(Ye=It.box,Jn=It.offscreen);const Ti=Ar(It&&It.box);if(!Ye&&this.prevPlacement){const an=this.prevPlacement.variableOffsets[He.crossTileID];an&&(this.variableOffsets[He.crossTileID]=an,this.markUsedJustification(_,an.anchor,He,Ti))}}else{const un=(Vi,Ti)=>{const an=this.collisionIndex.placeCollisionBox(Vi,te,k,D,X.predicate,ot);return an&&an.box&&an.box.length&&(this.markUsedOrientation(_,Ti,He),this.placedOrientations[He.crossTileID]=Ti),an};zi(()=>un(gr,y.WritingMode.horizontal),()=>{const Vi=yt.verticalTextBox;return _.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Vi?un(Vi,y.WritingMode.vertical):{box:null,offscreen:null}}),Ar(It&&It.box&&It.box.length)}}if(pr=It,Ye=pr&&pr.box&&pr.box.length>0,Jn=pr&&pr.offscreen,He.useRuntimeCollisionCircles){const Ar=_.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),zi=y.evaluateSizeForFeature(_.textSizeData,j,Ar),un=w.get("text-padding");ii=this.collisionIndex.placeCollisionCircles(te,Ar,_.lineVertexArray,_.glyphOffsetArray,zi,D,M,I,p,ye,X.predicate,He.collisionCircleDiameter,un,ot),ii.circles.length&&ii.collisionDetected&&!p&&y.warnOnce("Collisions detected, but collision boxes are not shown"),Ye=le||ii.circles.length>0&&!ii.collisionDetected,Jn=Jn&&ii.offscreen}if(yt.iconFeatureIndex&&(mr=yt.iconFeatureIndex),yt.iconBox){const Ar=zi=>{const un=De&&nn?tt(zi,nn.x,nn.y,pe,ye,this.transform.angle):zi;return this.collisionIndex.placeCollisionBox(un,fe,k,D,X.predicate,ot)};Wn&&Wn.box&&Wn.box.length&&yt.verticalIconBox?(Mi=Ar(yt.verticalIconBox),tn=Mi.box.length>0):(Mi=Ar(yt.iconBox),tn=Mi.box.length>0),Jn=Jn&&Mi.offscreen}const ks=q||0===He.numHorizontalGlyphVertices&&0===He.numVerticalGlyphVertices,iu=Z||0===He.numIconVertices;if(ks||iu?iu?ks||(tn=tn&&Ye):Ye=tn&&Ye:tn=Ye=tn&&Ye,Ye&&pr&&pr.box&&this.collisionIndex.insertCollisionBox(pr.box,te,w.get("text-ignore-placement"),_.bucketInstanceId,Wn&&Wn.box&&Tr?Tr:fr,X.ID),tn&&Mi&&this.collisionIndex.insertCollisionBox(Mi.box,fe,w.get("icon-ignore-placement"),_.bucketInstanceId,mr,X.ID),ii&&(Ye&&this.collisionIndex.insertCollisionCircles(ii.circles,te,w.get("text-ignore-placement"),_.bucketInstanceId,fr,X.ID),p)){const Ar=_.bucketInstanceId;let zi=this.collisionCircleArrays[Ar];void 0===zi&&(zi=this.collisionCircleArrays[Ar]=new Ie);for(let un=0;un<ii.circles.length;un+=4)zi.circles.push(ii.circles[un+0]),zi.circles.push(ii.circles[un+1]),zi.circles.push(ii.circles[un+2]),zi.circles.push(ii.collisionDetected?1:0)}if(0===He.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===_.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new Se(Ye||Ne,tn||ke,Jn||_.justReloaded),u[He.crossTileID]=!0};if(Ae){if(0!==s.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const He=_.getSortedSymbolIndexes(this.transform.angle);for(let yt=He.length-1;yt>=0;--yt){const Ye=He[yt];gt(_.symbolInstances.get(Ye),_.collisionArrays[Ye])}}else for(let He=s.symbolInstanceStart;He<s.symbolInstanceEnd;He++)gt(_.symbolInstances.get(He),_.collisionArrays[He]);if(p&&_.bucketInstanceId in this.collisionCircleArrays){const He=this.collisionCircleArrays[_.bucketInstanceId];y.invert(He.invProjMatrix,D),He.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(s,u,p,_){let w;w=_===y.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[y.getAnchorJustification(u)];const D=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const M of D)M>=0&&(s.text.placedSymbolArray.get(M).crossTileID=w>=0&&M!==w?0:p.crossTileID)}markUsedOrientation(s,u,p){const _=u===y.WritingMode.horizontal||u===y.WritingMode.horizontalOnly?u:0,w=u===y.WritingMode.vertical?u:0,D=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const M of D)s.text.placedSymbolArray.get(M).placedOrientation=_;p.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let p=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const _=u?u.symbolFadeChange(s):1,w=u?u.opacities:{},D=u?u.variableOffsets:{},M=u?u.placedOrientations:{};for(const I in this.placements){const k=this.placements[I],O=w[I];O?(this.opacities[I]=new de(O,_,k.text,k.icon),p=p||k.text!==O.text.placed||k.icon!==O.icon.placed):(this.opacities[I]=new de(null,_,k.text,k.icon,k.skipFade),p=p||k.text||k.icon)}for(const I in w){const k=w[I];if(!this.opacities[I]){const O=new de(k,_,!1,!1);O.isHidden()||(this.opacities[I]=O,p=p||k.text.placed||k.icon.placed)}}for(const I in D)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=D[I]);for(const I in M)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=M[I]);if(u&&void 0===u.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=s:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u){const p={};for(const _ of u){const w=_.getBucket(s);w&&_.latestFeatureIndex&&s.id===w.layerIds[0]&&this.updateBucketOpacities(w,p,_.collisionBoxArray)}}updateBucketOpacities(s,u,p){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const _=s.layers[0].layout,w=new de(null,0,!1,!1,!0),D=_.get("text-allow-overlap"),M=_.get("icon-allow-overlap"),I=_.get("text-variable-anchor"),k="map"===_.get("text-rotation-alignment"),O="map"===_.get("text-pitch-alignment"),F="none"!==_.get("icon-text-fit"),j=new de(null,0,D&&(M||!s.hasIconData()||_.get("icon-optional")),M&&(D||!s.hasTextData()||_.get("text-optional")),!0);!s.collisionArrays&&p&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(p);const X=(q,Z,te)=>{for(let le=0;le<Z/4;le++)q.opacityVertexArray.emplaceBack(te);q.hasVisibleVertices=q.hasVisibleVertices||te!==Yi};for(let q=0;q<s.symbolInstances.length;q++){const Z=s.symbolInstances.get(q),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:le,crossTileID:fe}=Z;let J=this.opacities[fe];u[fe]?J=w:J||(J=j,this.opacities[fe]=J),u[fe]=!0;const pe=Z.numIconVertices>0,ye=this.placedOrientations[Z.crossTileID],De=ye===y.WritingMode.vertical,Ae=ye===y.WritingMode.horizontal||ye===y.WritingMode.horizontalOnly;if(te>0||le>0){const Ne=Fa(J.text);X(s.text,te,De?Yi:Ne),X(s.text,le,Ae?Yi:Ne);const ke=J.text.isHidden();[Z.rightJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.leftJustifiedTextSymbolIndex].forEach(gt=>{gt>=0&&(s.text.placedSymbolArray.get(gt).hidden=ke||De?1:0)}),Z.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).hidden=ke||Ae?1:0);const Be=this.variableOffsets[Z.crossTileID];Be&&this.markUsedJustification(s,Be.anchor,Z,ye);const ot=this.placedOrientations[Z.crossTileID];ot&&(this.markUsedJustification(s,"left",Z,ot),this.markUsedOrientation(s,ot,Z))}if(pe){const Ne=Fa(J.icon),ke=!(F&&Z.verticalPlacedIconSymbolIndex&&De);Z.placedIconSymbolIndex>=0&&(X(s.icon,Z.numIconVertices,ke?Ne:Yi),s.icon.placedSymbolArray.get(Z.placedIconSymbolIndex).hidden=J.icon.isHidden()),Z.verticalPlacedIconSymbolIndex>=0&&(X(s.icon,Z.numVerticalIconVertices,ke?Yi:Ne),s.icon.placedSymbolArray.get(Z.verticalPlacedIconSymbolIndex).hidden=J.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Ne=s.collisionArrays[q];if(Ne){let ke=new y.Point(0,0);if(Ne.textBox||Ne.verticalTextBox){let ot=!0;if(I){const gt=this.variableOffsets[fe];gt?(ke=Et(gt.anchor,gt.width,gt.height,gt.textOffset,gt.textBoxScale),k&&ke._rotate(O?this.transform.angle:-this.transform.angle)):ot=!1}Ne.textBox&&xt(s.textCollisionBox.collisionVertexArray,J.text.placed,!ot||De,ke.x,ke.y),Ne.verticalTextBox&&xt(s.textCollisionBox.collisionVertexArray,J.text.placed,!ot||Ae,ke.x,ke.y)}const Be=!(Ae||!Ne.verticalIconBox);Ne.iconBox&&xt(s.iconCollisionBox.collisionVertexArray,J.icon.placed,Be,F?ke.x:0,F?ke.y:0),Ne.verticalIconBox&&xt(s.iconCollisionBox.collisionVertexArray,J.icon.placed,!Be,F?ke.x:0,F?ke.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const q=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=q.invProjMatrix,s.placementViewportMatrix=q.viewportMatrix,s.collisionCircleArray=q.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return 0===this.fadeDuration?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const p=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*p>s}setStale(){this.stale=!0}}function xt(m,s,u,p,_){m.emplaceBack(s?1:0,u?1:0,p||0,_||0),m.emplaceBack(s?1:0,u?1:0,p||0,_||0),m.emplaceBack(s?1:0,u?1:0,p||0,_||0),m.emplaceBack(s?1:0,u?1:0,p||0,_||0)}const Xt=Math.pow(2,25),Nt=Math.pow(2,24),Bt=Math.pow(2,17),In=Math.pow(2,16),Un=Math.pow(2,9),vt=Math.pow(2,8),jn=Math.pow(2,1);function Fa(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const s=m.placed?1:0,u=Math.floor(127*m.opacity);return u*Xt+s*Nt+u*Bt+s*In+u*Un+s*vt+u*jn+s}const Yi=0;class zr{constructor(s){this._sortAcrossTiles="viewport-y"!==s.layout.get("symbol-z-order")&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,u,p,_,w){const D=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(D,_,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((M,I)=>M.sortKey-I.sortKey));this._currentPartIndex<D.length;)if(u.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,w())return!0;return!1}}class Vr{constructor(s,u,p,_,w,D,M,I){this.placement=new dt(s,u,D,M,I),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(s,u,p){const _=y.exported.now(),w=()=>!this._forceFullPlacement&&y.exported.now()-_>2;for(;this._currentPlacementIndex>=0;){const D=u[s[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if("symbol"===D.type&&(!D.minzoom||D.minzoom<=M)&&(!D.maxzoom||D.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new zr(D)),this._inProgressLayer.continuePlacement(p[D.source],this.placement,this._showCollisionBoxes,D,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Oa=512/y.EXTENT/2;class Ks{constructor(s,u,p){this.tileID=s,this.bucketInstanceId=p,this._symbolsByKey={};const _=new Map;for(let w=0;w<u.length;w++){const D=u.get(w),M=D.key,I=_.get(M);I?I.push(D):_.set(M,[D])}for(const[w,D]of _){const M={positions:D.map(I=>({x:Math.floor(I.anchorX*Oa),y:Math.floor(I.anchorY*Oa)})),crossTileIDs:D.map(I=>I.crossTileID)};if(M.positions.length>128){const I=new y.KDBush(M.positions.length,16,Uint16Array);for(const{x:k,y:O}of M.positions)I.add(k,O);I.finish(),delete M.positions,M.index=I}this._symbolsByKey[w]=M}}getScaledCoordinates(s,u){const{x:p,y:_,z:w}=this.tileID.canonical,{x:D,y:M,z:I}=u.canonical,k=Oa/Math.pow(2,I-w),O=(M*y.EXTENT+s.anchorY)*k,F=_*y.EXTENT*Oa;return{x:Math.floor((D*y.EXTENT+s.anchorX)*k-p*y.EXTENT*Oa),y:Math.floor(O-F)}}findMatches(s,u,p){const _=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let w=0;w<s.length;w++){const D=s.get(w);if(D.crossTileID)continue;const M=this._symbolsByKey[D.key];if(!M)continue;const I=this.getScaledCoordinates(D,u);if(M.index){const k=M.index.range(I.x-_,I.y-_,I.x+_,I.y+_).sort();for(const O of k){const F=M.crossTileIDs[O];if(!p[F]){p[F]=!0,D.crossTileID=F;break}}}else if(M.positions)for(let k=0;k<M.positions.length;k++){const O=M.positions[k],F=M.crossTileIDs[k];if(Math.abs(O.x-I.x)<=_&&Math.abs(O.y-I.y)<=_&&!p[F]){p[F]=!0,D.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class _i{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class cl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(0!==u)for(const p in this.indexes){const _=this.indexes[p],w={};for(const D in _){const M=_[D];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+u),w[M.tileID.key]=M}this.indexes[p]=w}this.lng=s}addBucket(s,u,p){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const _=this.usedCrossTileIDs[s.overscaledZ];for(const w in this.indexes){const D=this.indexes[w];if(Number(w)>s.overscaledZ)for(const M in D){const I=D[M];I.tileID.isChildOf(s)&&I.findMatches(u.symbolInstances,s,_)}else{const M=D[s.scaledTo(Number(w)).key];M&&M.findMatches(u.symbolInstances,s,_)}}for(let w=0;w<u.symbolInstances.length;w++){const D=u.symbolInstances.get(w);D.crossTileID||(D.crossTileID=p.generate(),_[D.crossTileID]=!0)}return void 0===this.indexes[s.overscaledZ]&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Ks(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const p of u.getCrossTileIDsLists())for(const _ of p)delete this.usedCrossTileIDs[s][_]}removeStaleBuckets(s){let u=!1;for(const p in this.indexes){const _=this.indexes[p];for(const w in _)s[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[w]),delete _[w],u=!0)}return u}}class bs{constructor(){this.layerIndexes={},this.crossTileIDs=new _i,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,p){let _=this.layerIndexes[s.id];void 0===_&&(_=this.layerIndexes[s.id]=new cl);let w=!1;const D={};_.handleWrapJump(p);for(const M of u){const I=M.getBucket(s);I&&s.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(M.tileID,I,this.crossTileIDs)&&(w=!0),D[I.bucketInstanceId]=!0)}return _.removeStaleBuckets(D)&&(w=!0),w}pruneUnusedLayers(s){const u={};s.forEach(p=>{u[p]=!0});for(const p in this.layerIndexes)u[p]||delete this.layerIndexes[p]}}const li=(m,s)=>y.emitValidationErrors(m,s&&s.filter(u=>"source.canvas"!==u.identifier)),Lc=y.pick(y.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Po=y.pick(y.operations,["setCenter","setZoom","setBearing","setPitch"]),hh=y.emptyStyle();class Li extends y.Evented{constructor(s,u={}){super(),this.map=s,this.dispatcher=new Dr(ll(),this,s._getMapId()),this.imageManager=new Gn,this.imageManager.setEventedParent(this),this.glyphManager=new Lr(s._requestManager,u.localIdeographFontFamily),this.lineAtlas=new qs(256,512),this.crossTileSymbolIndex=new bs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new y.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",y.getReferrer());const p=this;this._rtlTextPluginCallback=Li.registerForPluginStateChange(_=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(w,D)=>{if(y.triggerPluginCompletionEvent(w),D&&D.every(M=>M))for(const M in p.sourceCaches){const I=p.sourceCaches[M].getSource().type;"vector"!==I&&"geojson"!==I||p.sourceCaches[M].reload()}})}),this.on("data",_=>{if("source"!==_.dataType||"metadata"!==_.sourceDataType)return;const w=this.sourceCaches[_.sourceId];if(!w)return;const D=w.getSource();if(D&&D.vectorLayerIds)for(const M in this._layers){const I=this._layers[M];I.source===D.id&&this._validateLayer(I)}})}loadURL(s,u={},p){this.fire(new y.Event("dataloading",{dataType:"style"})),u.validate="boolean"!=typeof u.validate||u.validate;const _=this.map._requestManager.transformRequest(s,zn.Style);this._request=y.getJSON(_,(w,D)=>{this._request=null,w?this.fire(new y.ErrorEvent(w)):D&&this._load(D,u,p)})}loadJSON(s,u={},p){this.fire(new y.Event("dataloading",{dataType:"style"})),this._request=y.exported.frame(()=>{this._request=null,u.validate=!1!==u.validate,this._load(s,u,p)})}loadEmpty(){this.fire(new y.Event("dataloading",{dataType:"style"})),this._load(hh,{validate:!1})}_load(s,u,p){const _=u.transformStyle?u.transformStyle(p,s):s;if(!u.validate||!li(this,y.validateStyle(_))){this._loaded=!0,this.stylesheet=_;for(const w in _.sources)this.addSource(w,_.sources[w],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new rl(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new y.Event("data",{dataType:"style"})),this.fire(new y.Event("style.load"))}}_createLayers(){const s=y.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of s){const p=y.createStyleLayer(u);p.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=p}}_loadSprite(s,u=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(_,w,D,M){const I=ct(_),k=I.length,O=D>1?"@2x":"",F={},j={},X={};for(const{id:q,url:Z}of I){const te=w.transformRequest(w.normalizeSpriteURL(Z,O,".json"),zn.SpriteJSON),le=`${q}_${te.url}`;F[le]=y.getJSON(te,(pe,ye)=>{delete F[le],j[q]=ye,pt(M,j,X,pe,k)});const fe=w.transformRequest(w.normalizeSpriteURL(Z,O,".png"),zn.SpriteImage),J=`${q}_${fe.url}`;F[J]=co.getImage(fe,(pe,ye)=>{delete F[J],X[q]=ye,pt(M,j,X,pe,k)})}return{cancel(){for(const q of Object.values(F))q.cancel()}}}(s,this.map._requestManager,this.map.getPixelRatio(),(_,w)=>{if(this._spriteRequest=null,_)this.fire(new y.ErrorEvent(_));else if(w)for(const D in w){this._spritesImagesIds[D]=[];const M=this._spritesImagesIds[D]?this._spritesImagesIds[D].filter(I=>!(I in w)):[];for(const I of M)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in w[D]){const k="default"===D?I:`${D}:${I}`;this._spritesImagesIds[D].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,w[D][I],!1):this.imageManager.addImage(k,w[D][I]),u&&(this._changedImages[k]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.Event("data",{dataType:"style"})),p&&p(_)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.Event("data",{dataType:"style"}))}_validateLayer(s){const u=this.sourceCaches[s.source];if(!u)return;const p=s.sourceLayer;if(!p)return;const _=u.getSource();("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(p))&&this.fire(new y.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${_.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const u=this._serializedAllLayers();if(!s||0===s.length)return Object.values(u);const p=[];for(const _ of s)u[_]&&p.push(u[_]);return p}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const u=Object.keys(this._layers);for(const p of u){const _=this._layers[p];"custom"!==_.type&&(s[p]=_.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const u=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(_.length||w.length)&&this._updateWorkerLayers(_,w);for(const D in this._updatedSources){const M=this._updatedSources[D];if("reload"===M)this._reloadSource(D);else{if("clear"!==M)throw new Error(`Invalid action ${M}`);this._clearSource(D)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const p={};for(const _ in this.sourceCaches){const w=this.sourceCaches[_];p[_]=w.used,w.used=!1}for(const _ of this._order){const w=this._layers[_];w.recalculate(s,this._availableImages),!w.isHidden(s.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const _ in p){const w=this.sourceCaches[_];p[_]!==w.used&&w.fire(new y.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(s),this.z=s.zoom,u&&this.fire(new y.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,u={}){this._checkLoaded();const p=this.serialize();if(s=u.transformStyle?u.transformStyle(p,s):s,li(this,y.validateStyle(s)))return!1;(s=y.clone$1(s)).layers=y.derefLayers(s.layers);const _=y.diffStyles(p,s).filter(D=>!(D.command in Po));if(0===_.length)return!1;const w=_.filter(D=>!(D.command in Lc));if(w.length>0)throw new Error(`Unimplemented: ${w.map(D=>D.command).join(", ")}.`);for(const D of _)"setTransition"!==D.command&&this[D.command].apply(this,D.args);return this.stylesheet=s,!0}addImage(s,u){if(this.getImage(s))return this.fire(new y.ErrorEvent(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,u),this._afterImageUpdated(s)}updateImage(s,u){this.imageManager.updateImage(s,u)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new y.ErrorEvent(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,u,p={}){if(this._checkLoaded(),void 0!==this.sourceCaches[s])throw new Error(`Source "${s}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(y.validateStyle.source,`sources.${s}`,u,null,p))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const _=this.sourceCaches[s]=new mi(s,u,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:s})),_.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),void 0===this.sourceCaches[s])throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===s)return this.fire(new y.ErrorEvent(new Error(`Source "${s}" cannot be removed while layer "${p}" is using it.`)));const u=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],u.fire(new y.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,u){if(this._checkLoaded(),void 0===this.sourceCaches[s])throw new Error(`There is no source with this ID=${s}`);const p=this.sourceCaches[s].getSource();if("geojson"!==p.type)throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(u),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,u,p={}){this._checkLoaded();const _=s.id;if(this.getLayer(_))return void this.fire(new y.ErrorEvent(new Error(`Layer "${_}" already exists on this map.`)));let w;if("custom"===s.type){if(li(this,y.validateCustomStyleLayer(s)))return;w=y.createStyleLayer(s)}else{if("object"==typeof s.source&&(this.addSource(_,s.source),s=y.clone$1(s),s=y.extend(s,{source:_})),this._validate(y.validateStyle.layer,`layers.${_}`,s,{arrayIndex:-1},p))return;w=y.createStyleLayer(s),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}})}const D=u?this._order.indexOf(u):this._order.length;if(u&&-1===D)this.fire(new y.ErrorEvent(new Error(`Cannot add layer "${_}" before non-existing layer "${u}".`)));else{if(this._order.splice(D,0,_),this._layerOrderChanged=!0,this._layers[_]=w,this._removedLayers[_]&&w.source&&"custom"!==w.type){const M=this._removedLayers[_];delete this._removedLayers[_],M.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(s,u){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new y.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===u)return;const p=this._order.indexOf(s);this._order.splice(p,1);const _=u?this._order.indexOf(u):this._order.length;u&&-1===_?this.fire(new y.ErrorEvent(new Error(`Cannot move layer "${s}" before non-existing layer "${u}".`))):(this._order.splice(_,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const u=this._layers[s];if(!u)return void this.fire(new y.ErrorEvent(new Error(`Cannot remove non-existing layer "${s}".`)));u.setEventedParent(null);const p=this._order.indexOf(s);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=u,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],u.onRemove&&u.onRemove(this.map)}getLayer(s){return this._layers[s]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,u,p){this._checkLoaded();const _=this.getLayer(s);_?_.minzoom===u&&_.maxzoom===p||(null!=u&&(_.minzoom=u),null!=p&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new y.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,u,p={}){this._checkLoaded();const _=this.getLayer(s);if(_){if(!y.deepEqual(_.filter,u))return null==u?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(y.validateStyle.filter,`layers.${_.id}.filter`,u,null,p)||(_.filter=y.clone$1(u),this._updateLayer(_)))}else this.fire(new y.ErrorEvent(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return y.clone$1(this.getLayer(s).filter)}setLayoutProperty(s,u,p,_={}){this._checkLoaded();const w=this.getLayer(s);w?y.deepEqual(w.getLayoutProperty(u),p)||(w.setLayoutProperty(u,p,_),this._updateLayer(w)):this.fire(new y.ErrorEvent(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,u){const p=this.getLayer(s);if(p)return p.getLayoutProperty(u);this.fire(new y.ErrorEvent(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,u,p,_={}){this._checkLoaded();const w=this.getLayer(s);w?y.deepEqual(w.getPaintProperty(u),p)||(w.setPaintProperty(u,p,_)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new y.ErrorEvent(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,u){return this.getLayer(s).getPaintProperty(u)}setFeatureState(s,u){this._checkLoaded();const p=s.source,_=s.sourceLayer,w=this.sourceCaches[p];if(void 0===w)return void this.fire(new y.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const D=w.getSource().type;"geojson"===D&&_?this.fire(new y.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==D||_?(void 0===s.id&&this.fire(new y.ErrorEvent(new Error("The feature id parameter must be provided."))),w.setFeatureState(_,s.id,u)):this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,u){this._checkLoaded();const p=s.source,_=this.sourceCaches[p];if(void 0===_)return void this.fire(new y.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const w=_.getSource().type,D="vector"===w?s.sourceLayer:void 0;"vector"!==w||D?u&&"string"!=typeof s.id&&"number"!=typeof s.id?this.fire(new y.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(D,s.id,u):this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const u=s.source,p=s.sourceLayer,_=this.sourceCaches[u];if(void 0!==_)return"vector"!==_.getSource().type||p?(void 0===s.id&&this.fire(new y.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(p,s.id)):void this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new y.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return y.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const s=y.mapObject(this.sourceCaches,_=>_.serialize()),u=this._serializeByIds(this._order),p=this.stylesheet;return y.filterObject({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:s,layers:u},_=>void 0!==_)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&"raster"!==this.sourceCaches[s.source].getSource().type&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const u=D=>"fill-extrusion"===this._layers[D].type,p={},_=[];for(let D=this._order.length-1;D>=0;D--){const M=this._order[D];if(u(M)){p[M]=D;for(const I of s){const k=I[M];if(k)for(const O of k)_.push(O)}}}_.sort((D,M)=>M.intersectionZ-D.intersectionZ);const w=[];for(let D=this._order.length-1;D>=0;D--){const M=this._order[D];if(u(M))for(let I=_.length-1;I>=0;I--){const k=_[I].feature;if(p[k.layer.id]<D)break;w.push(k),_.pop()}else for(const I of s){const k=I[M];if(k)for(const O of k)w.push(O.feature)}}return w}queryRenderedFeatures(s,u,p){u&&u.filter&&this._validate(y.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const _={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new y.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const M of u.layers){const I=this._layers[M];if(!I)return this.fire(new y.ErrorEvent(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];_[I.source]=!0}}const w=[];u.availableImages=this._availableImages;const D=this._serializedAllLayers();for(const M in this.sourceCaches)u.layers&&!_[M]||w.push(Sn(this.sourceCaches[M],this._layers,D,s,u,p));return this.placement&&w.push(function(M,I,k,O,F,j,X){const q={},Z=j.queryRenderedSymbols(O),te=[];for(const le of Object.keys(Z).map(Number))te.push(X[le]);te.sort(ln);for(const le of te){const fe=le.featureIndex.lookupSymbolFeatures(Z[le.bucketInstanceId],I,le.bucketIndex,le.sourceLayerIndex,F.filter,F.layers,F.availableImages,M);for(const J in fe){const pe=q[J]=q[J]||[],ye=fe[J];ye.sort((De,Ae)=>{const Ne=le.featureSortOrder;if(Ne){const ke=Ne.indexOf(De.featureIndex);return Ne.indexOf(Ae.featureIndex)-ke}return Ae.featureIndex-De.featureIndex});for(const De of ye)pe.push(De)}}for(const le in q)q[le].forEach(fe=>{const J=fe.feature,pe=k[M[le].source].getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=pe});return q}(this._layers,D,this.sourceCaches,s,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(s,u){u&&u.filter&&this._validate(y.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const p=this.sourceCaches[s];return p?function(_,w){const D=_.getRenderableIds().map(k=>_.getTileByID(k)),M=[],I={};for(let k=0;k<D.length;k++){const O=D[k],F=O.tileID.canonical.key;I[F]||(I[F]=!0,O.querySourceFeatures(M,w))}return M}(p,u):[]}addSourceType(s,u,p){return Li.getSourceType(s)?p(new Error(`A source type called "${s}" already exists.`)):(Li.setSourceType(s,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:u.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(s,u={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const D in s)if(!y.deepEqual(s[D],p[D])){_=!0;break}if(!_)return;const w={now:y.exported.now(),transition:y.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,u),this.light.updateTransitions(w)}_validate(s,u,p,_,w={}){return(!w||!1!==w.validate)&&li(this,s.call(y.validateStyle,y.extend({key:u,style:this.serialize(),value:p,styleSpec:y.v8Spec},_)))}_remove(s=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),y.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const p=this.sourceCaches[u];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const u in this.sourceCaches)this.sourceCaches[u].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,u,p,_,w=!1){let D=!1,M=!1;const I={};for(const k of this._order){const O=this._layers[k];if("symbol"!==O.type)continue;if(!I[O.source]){const j=this.sourceCaches[O.source];I[O.source]=j.getRenderableIds(!0).map(X=>j.getTileByID(X)).sort((X,q)=>q.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(q.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(O,I[O.source],s.center.lng);D=D||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||0===p)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(y.exported.now(),s.zoom))&&(this.pauseablePlacement=new Vr(s,this.map.terrain,this._order,w,u,p,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(y.exported.now()),M=!0),D&&this.pauseablePlacement.placement.setStale()),M||D)for(const k of this._order){const O=this._layers[k];"symbol"===O.type&&this.placement.updateLayerOpacities(O,I[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(y.exported.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,u,p){this.imageManager.getImages(u.icons,p),this._updateTilesForChangedImages();const _=this.sourceCaches[u.source];_&&_.setDependencies(u.tileID.key,u.type,u.icons)}getGlyphs(s,u,p){this.glyphManager.getGlyphs(u.stacks,p);const _=this.sourceCaches[u.source];_&&_.setDependencies(u.tileID.key,u.type,[""])}getResource(s,u,p){return y.makeRequest(u,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,u={}){this._checkLoaded(),s&&this._validate(y.validateStyle.glyphs,"glyphs",s,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,u,p={},_){this._checkLoaded();const w=[{id:s,url:u}],D=[...ct(this.stylesheet.sprite),...w];this._validate(y.validateStyle.sprite,"sprite",D,null,p)||(this.stylesheet.sprite=D,this._loadSprite(w,!0,_))}removeSprite(s){this._checkLoaded();const u=ct(this.stylesheet.sprite);if(u.find(p=>p.id===s)){if(this._spritesImagesIds[s])for(const p of this._spritesImagesIds[s])this.imageManager.removeImage(p),this._changedImages[p]=!0;u.splice(u.findIndex(p=>p.id===s),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.Event("data",{dataType:"style"}))}else this.fire(new y.ErrorEvent(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return ct(this.stylesheet.sprite)}setSprite(s,u={},p){this._checkLoaded(),s&&this._validate(y.validateStyle.sprite,"sprite",s,null,u)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,p):(this._unloadSprite(),p&&p(null)))}}Li.getSourceType=function(m){return Ws[m]},Li.setSourceType=function(m,s){Ws[m]=s},Li.registerForPluginStateChange=y.registerForPluginStateChange;var qu=y.createLayout([{name:"a_pos",type:"Int16",components:2}]),Nc="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Xr={prelude:Vt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:Vt("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Vt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Vt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Vt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:Vt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Vt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Vt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Vt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Vt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:Vt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:Vt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:Vt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Vt("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Vt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Vt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Vt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Vt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Vt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Vt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:Vt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Vt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:Vt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Vt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:Vt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Nc),terrainDepth:Vt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Nc),terrainCoords:Vt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Nc)};function Vt(m,s){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=s.match(/attribute ([\w]+) ([\w]+)/g),_=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=w?w.concat(_):_,M={};return{fragmentSource:m=m.replace(u,(I,k,O,F,j)=>(M[j]=!0,"define"===k?`\n#ifndef HAS_UNIFORM_u_${j}\nvarying ${O} ${F} ${j};\n#else\nuniform ${O} ${F} u_${j};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${j}\n    ${O} ${F} ${j} = u_${j};\n#endif\n`)),vertexSource:s=s.replace(u,(I,k,O,F,j)=>{const X="float"===F?"vec2":"vec4",q=j.match(/color/)?"color":X;return M[j]?"define"===k?`\n#ifndef HAS_UNIFORM_u_${j}\nuniform lowp float u_${j}_t;\nattribute ${O} ${X} a_${j};\nvarying ${O} ${F} ${j};\n#else\nuniform ${O} ${F} u_${j};\n#endif\n`:"vec4"===q?`\n#ifndef HAS_UNIFORM_u_${j}\n    ${j} = a_${j};\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${j}\n    ${j} = unpack_mix_${q}(a_${j}, u_${j}_t);\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`:"define"===k?`\n#ifndef HAS_UNIFORM_u_${j}\nuniform lowp float u_${j}_t;\nattribute ${O} ${X} a_${j};\n#else\nuniform ${O} ${F} u_${j};\n#endif\n`:"vec4"===q?`\n#ifndef HAS_UNIFORM_u_${j}\n    ${O} ${F} ${j} = a_${j};\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${j}\n    ${O} ${F} ${j} = unpack_mix_${q}(a_${j}, u_${j}_t);\n#else\n    ${O} ${F} ${j} = u_${j};\n#endif\n`}),staticAttributes:p,staticUniforms:D}}class xs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,u,p,_,w,D,M,I,k){this.context=s;let O=this.boundPaintVertexBuffers.length!==_.length;for(let F=0;!O&&F<_.length;F++)this.boundPaintVertexBuffers[F]!==_[F]&&(O=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==p||O||this.boundIndexBuffer!==w||this.boundVertexOffset!==D||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==k?this.freshBind(u,p,_,w,D,M,I,k):(s.bindVertexArray.set(this.vao),M&&M.bind(),w&&w.dynamicDraw&&w.bind(),I&&I.bind(),k&&k.bind())}freshBind(s,u,p,_,w,D,M,I){const k=s.numAttributes,O=this.context,F=O.gl;this.vao&&this.destroy(),this.vao=O.createVertexArray(),O.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=I,u.enableAttributes(F,s);for(const j of p)j.enableAttributes(F,s);D&&D.enableAttributes(F,s),M&&M.enableAttributes(F,s),I&&I.enableAttributes(F,s),u.bind(),u.setVertexAttribPointers(F,s,w);for(const j of p)j.bind(),j.setVertexAttribPointers(F,s,w);D&&(D.bind(),D.setVertexAttribPointers(F,s,w)),_&&_.bind(),M&&(M.bind(),M.setVertexAttribPointers(F,s,w)),I&&(I.bind(),I.setVertexAttribPointers(F,s,w)),O.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Ni(m){const s=[];for(let u=0;u<m.length;u++){if(null===m[u])continue;const p=m[u].split(" ");s.push(p.pop())}return s}class ul{constructor(s,u,p,_,w,D,M){const I=s.gl;this.program=I.createProgram();const k=Ni(p.staticAttributes),O=_?_.getBinderAttributes():[],F=k.concat(O),j=Xr.prelude.staticUniforms?Ni(Xr.prelude.staticUniforms):[],X=p.staticUniforms?Ni(p.staticUniforms):[],q=_?_.getBinderUniforms():[],Z=j.concat(X).concat(q),te=[];for(const Ae of Z)te.indexOf(Ae)<0&&te.push(Ae);const le=_?_.defines():[];D&&le.push("#define OVERDRAW_INSPECTOR;"),M&&le.push("#define TERRAIN3D;");const fe=le.concat(Xr.prelude.fragmentSource,p.fragmentSource).join("\n"),J=le.concat(Xr.prelude.vertexSource,p.vertexSource).join("\n"),pe=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(pe,fe),I.compileShader(pe),I.attachShader(this.program,pe);const ye=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ye,J),I.compileShader(ye),I.attachShader(this.program,ye),this.attributes={};const De={};this.numAttributes=F.length;for(let Ae=0;Ae<this.numAttributes;Ae++)F[Ae]&&(I.bindAttribLocation(this.program,Ae,F[Ae]),this.attributes[F[Ae]]=Ae);I.linkProgram(this.program),I.deleteShader(ye),I.deleteShader(pe);for(let Ae=0;Ae<te.length;Ae++){const Ne=te[Ae];if(Ne&&!De[Ne]){const ke=I.getUniformLocation(this.program,Ne);ke&&(De[Ne]=ke)}}var Ae,Ne;this.fixedUniforms=w(s,De),this.terrainUniforms={u_depth:new y.Uniform1i(Ae=s,(Ne=De).u_depth),u_terrain:new y.Uniform1i(Ae,Ne.u_terrain),u_terrain_dim:new y.Uniform1f(Ae,Ne.u_terrain_dim),u_terrain_matrix:new y.UniformMatrix4f(Ae,Ne.u_terrain_matrix),u_terrain_unpack:new y.Uniform4f(Ae,Ne.u_terrain_unpack),u_terrain_exaggeration:new y.Uniform1f(Ae,Ne.u_terrain_exaggeration)},this.binderUniforms=_?_.getUniforms(s,De):[]}draw(s,u,p,_,w,D,M,I,k,O,F,j,X,q,Z,te,le,fe){const J=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(p),s.setStencilMode(_),s.setColorMode(w),s.setCullFace(D),I){s.activeTexture.set(J.TEXTURE2),J.bindTexture(J.TEXTURE_2D,I.depthTexture),s.activeTexture.set(J.TEXTURE3),J.bindTexture(J.TEXTURE_2D,I.texture);for(const ye in this.terrainUniforms)this.terrainUniforms[ye].set(I[ye])}for(const ye in this.fixedUniforms)this.fixedUniforms[ye].set(M[ye]);Z&&Z.setUniforms(s,this.binderUniforms,X,{zoom:q});let pe=0;switch(u){case J.LINES:pe=2;break;case J.TRIANGLES:pe=3;break;case J.LINE_STRIP:pe=1}for(const ye of j.get()){const De=ye.vaos||(ye.vaos={});(De[k]||(De[k]=new xs)).bind(s,this,O,Z?Z.getPaintVertexBuffers():[],F,ye.vertexOffset,te,le,fe),J.drawElements(u,ye.primitiveLength*pe,J.UNSIGNED_SHORT,ye.primitiveOffset*pe*2)}}}function Bc(m,s,u){const p=1/ae(u,1,s.transform.tileZoom),_=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,s.transform.tileZoom)/_,D=w*(u.tileID.canonical.x+u.tileID.wrap*_),M=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[p,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[D>>16,M>>16],u_pixel_coord_lower:[65535&D,65535&M]}}const ws=(m,s,u,p)=>{const _=s.style.light,w=_.properties.get("position"),D=[w.x,w.y,w.z],M=(k=new y.ARRAY_TYPE(9),y.ARRAY_TYPE!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k);var k;"viewport"===_.properties.get("anchor")&&function(k,O){var F=Math.sin(O),j=Math.cos(O);k[0]=j,k[1]=F,k[2]=0,k[3]=-F,k[4]=j,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(M,-s.transform.angle),function(k,O,F){var j=O[0],X=O[1],q=O[2];k[0]=j*F[0]+X*F[3]+q*F[6],k[1]=j*F[1]+X*F[4]+q*F[7],k[2]=j*F[2]+X*F[5]+q*F[8]}(D,D,M);const I=_.properties.get("color");return{u_matrix:m,u_lightpos:D,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+u,u_opacity:p}},zc=(m,s,u,p,_,w,D)=>y.extend(ws(m,s,u,p),Bc(w,s,D),{u_height_factor:-Math.pow(2,_.overscaledZ)/D.tileSize/8}),ph=m=>({u_matrix:m}),mn=(m,s,u,p)=>y.extend(ph(m),Bc(u,s,p)),Vc=(m,s)=>({u_matrix:m,u_world:s}),yi=(m,s,u,p,_)=>y.extend(mn(m,s,u,p),{u_world:_}),Wu=(m,s,u,p)=>{const _=m.transform;let w,D;if("map"===p.paint.get("circle-pitch-alignment")){const M=ae(u,1,_.zoom);w=!0,D=[M,M]}else w=!1,D=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+("map"===p.paint.get("circle-pitch-scale")),u_matrix:m.translatePosMatrix(s.posMatrix,u,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:D}},Zu=(m,s,u)=>{const p=ae(u,1,s.zoom),_=Math.pow(2,s.zoom-u.tileID.overscaledZ),w=u.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[s.pixelsToGLUnits[0]/(p*_),s.pixelsToGLUnits[1]/(p*_)],u_overscale_factor:w}},xn=(m,s,u=1)=>({u_matrix:m,u_color:s,u_overlay:0,u_overlay_scale:u}),Ct=m=>({u_matrix:m}),Uc=(m,s,u,p)=>({u_matrix:m,u_extrude_scale:ae(s,1,u),u_intensity:p});function jc(m,s){const u=Math.pow(2,s.canonical.z),p=s.canonical.y;return[new y.MercatorCoordinate(0,p/u).toLngLat().lat,new y.MercatorCoordinate(0,(p+1)/u).toLngLat().lat]}const Ys=(m,s,u,p)=>{const _=m.transform;return{u_matrix:en(m,s,u,p),u_ratio:1/ae(s,1,_.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Kl=(m,s,u,p,_)=>y.extend(Ys(m,s,u,_),{u_image:0,u_image_height:p}),Ee=(m,s,u,p,_)=>{const w=m.transform,D=Dt(s,w);return{u_matrix:en(m,s,u,_),u_texsize:s.imageAtlasTexture.size,u_ratio:1/ae(s,1,w.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[D,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},La=(m,s,u,p,_,w)=>{const D=m.lineAtlas,M=Dt(s,m.transform),I="round"===u.layout.get("line-cap"),k=D.getDash(p.from,I),O=D.getDash(p.to,I),F=k.width*_.fromScale,j=O.width*_.toScale;return y.extend(Ys(m,s,u,w),{u_patternscale_a:[M/F,-k.height/2],u_patternscale_b:[M/j,-O.height/2],u_sdfgamma:D.width/(256*Math.min(F,j)*m.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:O.y,u_mix:_.t})};function Dt(m,s){return 1/ae(m,1,s.tileZoom)}function en(m,s,u,p){return m.translatePosMatrix(p?p.posMatrix:s.tileID.posMatrix,s,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Hc=(m,s,u,p,_)=>{return{u_matrix:m,u_tl_parent:s,u_scale_parent:u,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(D=_.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Xu(_.paint.get("raster-hue-rotate"))};var w,D};function Xu(m){m*=Math.PI/180;const s=Math.sin(m),u=Math.cos(m);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const dl=(m,s,u,p,_,w,D,M,I,k)=>{const O=_.transform;return{u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:O.cameraToCenterDistance,u_pitch:O.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:O.width/O.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:D,u_coord_matrix:M,u_is_text:+I,u_pitch_with_map:+p,u_texsize:k,u_texture:0}},Qs=(m,s,u,p,_,w,D,M,I,k,O)=>{const F=_.transform;return y.extend(dl(m,s,u,p,_,w,D,M,I,k),{u_gamma_scale:p?Math.cos(F._pitch)*F.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+O})},ur=(m,s,u,p,_,w,D,M,I,k)=>y.extend(Qs(m,s,u,p,_,w,D,M,!0,I,!0),{u_texsize_icon:k,u_texture_icon:1}),po=(m,s,u)=>({u_matrix:m,u_opacity:s,u_color:u}),Kr=(m,s,u,p,_,w)=>y.extend(function(D,M,I,k){const O=I.imageManager.getPattern(D.from.toString()),F=I.imageManager.getPattern(D.to.toString()),{width:j,height:X}=I.imageManager.getPixelSize(),q=Math.pow(2,k.tileID.overscaledZ),Z=k.tileSize*Math.pow(2,I.transform.tileZoom)/q,te=Z*(k.tileID.canonical.x+k.tileID.wrap*q),le=Z*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[j,X],u_mix:M.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:M.fromScale,u_scale_b:M.toScale,u_tile_units_to_pixels:1/ae(k,1,I.transform.tileZoom),u_pixel_coord_upper:[te>>16,le>>16],u_pixel_coord_lower:[65535&te,65535&le]}}(p,w,u,_),{u_matrix:m,u_opacity:s}),fh={fillExtrusion:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_lightpos:new y.Uniform3f(m,s.u_lightpos),u_lightintensity:new y.Uniform1f(m,s.u_lightintensity),u_lightcolor:new y.Uniform3f(m,s.u_lightcolor),u_vertical_gradient:new y.Uniform1f(m,s.u_vertical_gradient),u_opacity:new y.Uniform1f(m,s.u_opacity)}),fillExtrusionPattern:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_lightpos:new y.Uniform3f(m,s.u_lightpos),u_lightintensity:new y.Uniform1f(m,s.u_lightintensity),u_lightcolor:new y.Uniform3f(m,s.u_lightcolor),u_vertical_gradient:new y.Uniform1f(m,s.u_vertical_gradient),u_height_factor:new y.Uniform1f(m,s.u_height_factor),u_image:new y.Uniform1i(m,s.u_image),u_texsize:new y.Uniform2f(m,s.u_texsize),u_pixel_coord_upper:new y.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(m,s.u_pixel_coord_lower),u_scale:new y.Uniform3f(m,s.u_scale),u_fade:new y.Uniform1f(m,s.u_fade),u_opacity:new y.Uniform1f(m,s.u_opacity)}),fill:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix)}),fillPattern:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_image:new y.Uniform1i(m,s.u_image),u_texsize:new y.Uniform2f(m,s.u_texsize),u_pixel_coord_upper:new y.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(m,s.u_pixel_coord_lower),u_scale:new y.Uniform3f(m,s.u_scale),u_fade:new y.Uniform1f(m,s.u_fade)}),fillOutline:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_world:new y.Uniform2f(m,s.u_world)}),fillOutlinePattern:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_world:new y.Uniform2f(m,s.u_world),u_image:new y.Uniform1i(m,s.u_image),u_texsize:new y.Uniform2f(m,s.u_texsize),u_pixel_coord_upper:new y.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(m,s.u_pixel_coord_lower),u_scale:new y.Uniform3f(m,s.u_scale),u_fade:new y.Uniform1f(m,s.u_fade)}),circle:(m,s)=>({u_camera_to_center_distance:new y.Uniform1f(m,s.u_camera_to_center_distance),u_scale_with_map:new y.Uniform1i(m,s.u_scale_with_map),u_pitch_with_map:new y.Uniform1i(m,s.u_pitch_with_map),u_extrude_scale:new y.Uniform2f(m,s.u_extrude_scale),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_matrix:new y.UniformMatrix4f(m,s.u_matrix)}),collisionBox:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_camera_to_center_distance:new y.Uniform1f(m,s.u_camera_to_center_distance),u_pixels_to_tile_units:new y.Uniform1f(m,s.u_pixels_to_tile_units),u_extrude_scale:new y.Uniform2f(m,s.u_extrude_scale),u_overscale_factor:new y.Uniform1f(m,s.u_overscale_factor)}),collisionCircle:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_inv_matrix:new y.UniformMatrix4f(m,s.u_inv_matrix),u_camera_to_center_distance:new y.Uniform1f(m,s.u_camera_to_center_distance),u_viewport_size:new y.Uniform2f(m,s.u_viewport_size)}),debug:(m,s)=>({u_color:new y.UniformColor(m,s.u_color),u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_overlay:new y.Uniform1i(m,s.u_overlay),u_overlay_scale:new y.Uniform1f(m,s.u_overlay_scale)}),clippingMask:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix)}),heatmap:(m,s)=>({u_extrude_scale:new y.Uniform1f(m,s.u_extrude_scale),u_intensity:new y.Uniform1f(m,s.u_intensity),u_matrix:new y.UniformMatrix4f(m,s.u_matrix)}),heatmapTexture:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_world:new y.Uniform2f(m,s.u_world),u_image:new y.Uniform1i(m,s.u_image),u_color_ramp:new y.Uniform1i(m,s.u_color_ramp),u_opacity:new y.Uniform1f(m,s.u_opacity)}),hillshade:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_image:new y.Uniform1i(m,s.u_image),u_latrange:new y.Uniform2f(m,s.u_latrange),u_light:new y.Uniform2f(m,s.u_light),u_shadow:new y.UniformColor(m,s.u_shadow),u_highlight:new y.UniformColor(m,s.u_highlight),u_accent:new y.UniformColor(m,s.u_accent)}),hillshadePrepare:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_image:new y.Uniform1i(m,s.u_image),u_dimension:new y.Uniform2f(m,s.u_dimension),u_zoom:new y.Uniform1f(m,s.u_zoom),u_unpack:new y.Uniform4f(m,s.u_unpack)}),line:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_ratio:new y.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_units_to_pixels:new y.Uniform2f(m,s.u_units_to_pixels)}),lineGradient:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_ratio:new y.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_units_to_pixels:new y.Uniform2f(m,s.u_units_to_pixels),u_image:new y.Uniform1i(m,s.u_image),u_image_height:new y.Uniform1f(m,s.u_image_height)}),linePattern:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_texsize:new y.Uniform2f(m,s.u_texsize),u_ratio:new y.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_image:new y.Uniform1i(m,s.u_image),u_units_to_pixels:new y.Uniform2f(m,s.u_units_to_pixels),u_scale:new y.Uniform3f(m,s.u_scale),u_fade:new y.Uniform1f(m,s.u_fade)}),lineSDF:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_ratio:new y.Uniform1f(m,s.u_ratio),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_units_to_pixels:new y.Uniform2f(m,s.u_units_to_pixels),u_patternscale_a:new y.Uniform2f(m,s.u_patternscale_a),u_patternscale_b:new y.Uniform2f(m,s.u_patternscale_b),u_sdfgamma:new y.Uniform1f(m,s.u_sdfgamma),u_image:new y.Uniform1i(m,s.u_image),u_tex_y_a:new y.Uniform1f(m,s.u_tex_y_a),u_tex_y_b:new y.Uniform1f(m,s.u_tex_y_b),u_mix:new y.Uniform1f(m,s.u_mix)}),raster:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_tl_parent:new y.Uniform2f(m,s.u_tl_parent),u_scale_parent:new y.Uniform1f(m,s.u_scale_parent),u_buffer_scale:new y.Uniform1f(m,s.u_buffer_scale),u_fade_t:new y.Uniform1f(m,s.u_fade_t),u_opacity:new y.Uniform1f(m,s.u_opacity),u_image0:new y.Uniform1i(m,s.u_image0),u_image1:new y.Uniform1i(m,s.u_image1),u_brightness_low:new y.Uniform1f(m,s.u_brightness_low),u_brightness_high:new y.Uniform1f(m,s.u_brightness_high),u_saturation_factor:new y.Uniform1f(m,s.u_saturation_factor),u_contrast_factor:new y.Uniform1f(m,s.u_contrast_factor),u_spin_weights:new y.Uniform3f(m,s.u_spin_weights)}),symbolIcon:(m,s)=>({u_is_size_zoom_constant:new y.Uniform1i(m,s.u_is_size_zoom_constant),u_is_size_feature_constant:new y.Uniform1i(m,s.u_is_size_feature_constant),u_size_t:new y.Uniform1f(m,s.u_size_t),u_size:new y.Uniform1f(m,s.u_size),u_camera_to_center_distance:new y.Uniform1f(m,s.u_camera_to_center_distance),u_pitch:new y.Uniform1f(m,s.u_pitch),u_rotate_symbol:new y.Uniform1i(m,s.u_rotate_symbol),u_aspect_ratio:new y.Uniform1f(m,s.u_aspect_ratio),u_fade_change:new y.Uniform1f(m,s.u_fade_change),u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_label_plane_matrix:new y.UniformMatrix4f(m,s.u_label_plane_matrix),u_coord_matrix:new y.UniformMatrix4f(m,s.u_coord_matrix),u_is_text:new y.Uniform1i(m,s.u_is_text),u_pitch_with_map:new y.Uniform1i(m,s.u_pitch_with_map),u_texsize:new y.Uniform2f(m,s.u_texsize),u_texture:new y.Uniform1i(m,s.u_texture)}),symbolSDF:(m,s)=>({u_is_size_zoom_constant:new y.Uniform1i(m,s.u_is_size_zoom_constant),u_is_size_feature_constant:new y.Uniform1i(m,s.u_is_size_feature_constant),u_size_t:new y.Uniform1f(m,s.u_size_t),u_size:new y.Uniform1f(m,s.u_size),u_camera_to_center_distance:new y.Uniform1f(m,s.u_camera_to_center_distance),u_pitch:new y.Uniform1f(m,s.u_pitch),u_rotate_symbol:new y.Uniform1i(m,s.u_rotate_symbol),u_aspect_ratio:new y.Uniform1f(m,s.u_aspect_ratio),u_fade_change:new y.Uniform1f(m,s.u_fade_change),u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_label_plane_matrix:new y.UniformMatrix4f(m,s.u_label_plane_matrix),u_coord_matrix:new y.UniformMatrix4f(m,s.u_coord_matrix),u_is_text:new y.Uniform1i(m,s.u_is_text),u_pitch_with_map:new y.Uniform1i(m,s.u_pitch_with_map),u_texsize:new y.Uniform2f(m,s.u_texsize),u_texture:new y.Uniform1i(m,s.u_texture),u_gamma_scale:new y.Uniform1f(m,s.u_gamma_scale),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_is_halo:new y.Uniform1i(m,s.u_is_halo)}),symbolTextAndIcon:(m,s)=>({u_is_size_zoom_constant:new y.Uniform1i(m,s.u_is_size_zoom_constant),u_is_size_feature_constant:new y.Uniform1i(m,s.u_is_size_feature_constant),u_size_t:new y.Uniform1f(m,s.u_size_t),u_size:new y.Uniform1f(m,s.u_size),u_camera_to_center_distance:new y.Uniform1f(m,s.u_camera_to_center_distance),u_pitch:new y.Uniform1f(m,s.u_pitch),u_rotate_symbol:new y.Uniform1i(m,s.u_rotate_symbol),u_aspect_ratio:new y.Uniform1f(m,s.u_aspect_ratio),u_fade_change:new y.Uniform1f(m,s.u_fade_change),u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_label_plane_matrix:new y.UniformMatrix4f(m,s.u_label_plane_matrix),u_coord_matrix:new y.UniformMatrix4f(m,s.u_coord_matrix),u_is_text:new y.Uniform1i(m,s.u_is_text),u_pitch_with_map:new y.Uniform1i(m,s.u_pitch_with_map),u_texsize:new y.Uniform2f(m,s.u_texsize),u_texsize_icon:new y.Uniform2f(m,s.u_texsize_icon),u_texture:new y.Uniform1i(m,s.u_texture),u_texture_icon:new y.Uniform1i(m,s.u_texture_icon),u_gamma_scale:new y.Uniform1f(m,s.u_gamma_scale),u_device_pixel_ratio:new y.Uniform1f(m,s.u_device_pixel_ratio),u_is_halo:new y.Uniform1i(m,s.u_is_halo)}),background:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_opacity:new y.Uniform1f(m,s.u_opacity),u_color:new y.UniformColor(m,s.u_color)}),backgroundPattern:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_opacity:new y.Uniform1f(m,s.u_opacity),u_image:new y.Uniform1i(m,s.u_image),u_pattern_tl_a:new y.Uniform2f(m,s.u_pattern_tl_a),u_pattern_br_a:new y.Uniform2f(m,s.u_pattern_br_a),u_pattern_tl_b:new y.Uniform2f(m,s.u_pattern_tl_b),u_pattern_br_b:new y.Uniform2f(m,s.u_pattern_br_b),u_texsize:new y.Uniform2f(m,s.u_texsize),u_mix:new y.Uniform1f(m,s.u_mix),u_pattern_size_a:new y.Uniform2f(m,s.u_pattern_size_a),u_pattern_size_b:new y.Uniform2f(m,s.u_pattern_size_b),u_scale_a:new y.Uniform1f(m,s.u_scale_a),u_scale_b:new y.Uniform1f(m,s.u_scale_b),u_pixel_coord_upper:new y.Uniform2f(m,s.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(m,s.u_pixel_coord_lower),u_tile_units_to_pixels:new y.Uniform1f(m,s.u_tile_units_to_pixels)}),terrain:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_texture:new y.Uniform1i(m,s.u_texture),u_ele_delta:new y.Uniform1f(m,s.u_ele_delta)}),terrainDepth:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_ele_delta:new y.Uniform1f(m,s.u_ele_delta)}),terrainCoords:(m,s)=>({u_matrix:new y.UniformMatrix4f(m,s.u_matrix),u_texture:new y.Uniform1i(m,s.u_texture),u_terrain_coords_id:new y.Uniform1f(m,s.u_terrain_coords_id),u_ele_delta:new y.Uniform1f(m,s.u_ele_delta)})};class Jo{constructor(s,u,p){this.context=s;const _=s.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ku={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class mh{constructor(s,u,p,_){this.length=u.length,this.attributes=p,this.itemSize=u.bytesPerElement,this.dynamicDraw=_,this.context=s;const w=s.gl;this.buffer=w.createBuffer(),s.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let p=0;p<this.attributes.length;p++){const _=u.attributes[this.attributes[p].name];void 0!==_&&s.enableVertexAttribArray(_)}}setVertexAttribPointers(s,u,p){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],D=u.attributes[w.name];void 0!==D&&s.vertexAttribPointer(D,w.components,s[Ku[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const $c=new WeakMap;function hl(m){if($c.has(m))return $c.get(m);{const s=m.getParameter(m.VERSION).startsWith("WebGL 2.0");return $c.set(m,s),s}}class rn{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class gh extends rn{getDefault(){return y.Color.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Gc extends rn{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class zp extends rn{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Yr extends rn{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class bt extends rn{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Xm extends rn{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Km extends rn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Ym extends rn{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class at extends rn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class Qm extends rn{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class ci extends rn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class pl extends rn{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Yu extends rn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class qc extends rn{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class Qu extends rn{getDefault(){return y.Color.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Es extends rn{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class Yl extends rn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class Wc extends rn{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Zc extends rn{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Na extends rn{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Jt extends rn{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Js extends rn{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ba extends rn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Sr extends rn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Xc extends rn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class yn extends rn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class wn extends rn{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Jm extends rn{getDefault(){return null}set(s){var u;if(s===this.current&&!this.dirty)return;const p=this.gl;hl(p)?p.bindVertexArray(s):null===(u=p.getExtension("OES_vertex_array_object"))||void 0===u||u.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class Vp extends rn{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Oe extends rn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Ju extends rn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Ql extends rn{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class ed extends Ql{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class td extends Ql{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class nd extends Ql{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class fl{constructor(s,u,p,_,w){this.context=s,this.width=u,this.height=p;const D=s.gl,M=this.framebuffer=D.createFramebuffer();if(this.colorAttachment=new ed(s,M),_)this.depthAttachment=w?new nd(s,M):new td(s,M);else if(w)throw new Error("Stencil cannot be setted without depth");if(D.checkFramebufferStatus(D.FRAMEBUFFER)!==D.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,u=this.colorAttachment.get();if(u&&s.deleteTexture(u),this.depthAttachment){const p=this.depthAttachment.get();p&&s.deleteRenderbuffer(p)}s.deleteFramebuffer(this.framebuffer)}}class Kn{constructor(s,u,p){this.blendFunction=s,this.blendColor=u,this.mask=p}}Kn.Replace=[1,0],Kn.disabled=new Kn(Kn.Replace,y.Color.transparent,[!1,!1,!1,!1]),Kn.unblended=new Kn(Kn.Replace,y.Color.transparent,[!0,!0,!0,!0]),Kn.alphaBlended=new Kn([1,771],y.Color.transparent,[!0,!0,!0,!0]);class _h{constructor(s){var u,p;if(this.gl=s,this.clearColor=new gh(this),this.clearDepth=new Gc(this),this.clearStencil=new zp(this),this.colorMask=new Yr(this),this.depthMask=new bt(this),this.stencilMask=new Xm(this),this.stencilFunc=new Km(this),this.stencilOp=new Ym(this),this.stencilTest=new at(this),this.depthRange=new Qm(this),this.depthTest=new ci(this),this.depthFunc=new pl(this),this.blend=new Yu(this),this.blendFunc=new qc(this),this.blendColor=new Qu(this),this.blendEquation=new Es(this),this.cullFace=new Yl(this),this.cullFaceSide=new Wc(this),this.frontFace=new Zc(this),this.program=new Na(this),this.activeTexture=new Jt(this),this.viewport=new Js(this),this.bindFramebuffer=new Ba(this),this.bindRenderbuffer=new Sr(this),this.bindTexture=new Xc(this),this.bindVertexBuffer=new yn(this),this.bindElementBuffer=new wn(this),this.bindVertexArray=new Jm(this),this.pixelStoreUnpack=new Vp(this),this.pixelStoreUnpackPremultiplyAlpha=new Oe(this),this.pixelStoreUnpackFlipY=new Ju(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),hl(s)){this.HALF_FLOAT=s.HALF_FLOAT;const _=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(u=s.RGBA16F)&&void 0!==u?u:_?.RGBA16F_EXT,this.RGB16F=null!==(p=s.RGB16F)&&void 0!==p?p:_?.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const _=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=_?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u){return new Jo(this,s,u)}createVertexBuffer(s,u,p){return new mh(this,s,u,p)}createRenderbuffer(s,u,p){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,s,u,p),this.bindRenderbuffer.set(null),w}createFramebuffer(s,u,p,_){return new fl(this,s,u,p,_)}clear({color:s,depth:u,stencil:p}){const _=this.gl;let w=0;s&&(w|=_.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(w|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==p&&(w|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(w)}setCullFace(s){!1===s.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){y.deepEqual(s.blendFunction,Kn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return hl(this.gl)?this.gl.createVertexArray():null===(s=this.gl.getExtension("OES_vertex_array_object"))||void 0===s?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var u;return hl(this.gl)?this.gl.deleteVertexArray(s):null===(u=this.gl.getExtension("OES_vertex_array_object"))||void 0===u?void 0:u.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class Wt{constructor(s,u,p){this.func=s,this.mask=u,this.range=p}}Wt.ReadOnly=!1,Wt.ReadWrite=!0,Wt.disabled=new Wt(519,Wt.ReadOnly,[0,1]);class Ln{constructor(s,u,p,_,w,D){this.test=s,this.ref=u,this.mask=p,this.fail=_,this.depthFail=w,this.pass=D}}Ln.disabled=new Ln({func:519,mask:0},0,0,7680,7680,7680);class dn{constructor(s,u,p){this.enable=s,this.mode=u,this.frontFace=p}}let ea;function Jl(m,s,u,p,_,w,D){const M=m.context,I=M.gl,k=m.useProgram("collisionBox"),O=[];let F=0,j=0;for(let J=0;J<p.length;J++){const pe=p[J],ye=s.getTile(pe),De=ye.getBucket(u);if(!De)continue;let Ae=pe.posMatrix;0===_[0]&&0===_[1]||(Ae=m.translatePosMatrix(pe.posMatrix,ye,_,w));const Ne=D?De.textCollisionBox:De.iconCollisionBox,ke=De.collisionCircleArray;if(ke.length>0){const Be=y.create(),ot=Ae;y.mul(Be,De.placementInvProjMatrix,m.transform.glCoordMatrix),y.mul(Be,Be,De.placementViewportMatrix),O.push({circleArray:ke,circleOffset:j,transform:ot,invTransform:Be,coord:pe}),F+=ke.length/4,j=F}Ne&&k.draw(M,I.LINES,Wt.disabled,Ln.disabled,m.colorModeForRenderPass(),dn.disabled,Zu(Ae,m.transform,ye),m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),u.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,null,m.transform.zoom,null,null,Ne.collisionVertexBuffer)}if(!D||!O.length)return;const X=m.useProgram("collisionCircle"),q=new y.CollisionCircleLayoutArray;q.resize(4*F),q._trim();let Z=0;for(const J of O)for(let pe=0;pe<J.circleArray.length/4;pe++){const ye=4*pe,De=J.circleArray[ye+0],Ae=J.circleArray[ye+1],Ne=J.circleArray[ye+2],ke=J.circleArray[ye+3];q.emplace(Z++,De,Ae,Ne,ke,0),q.emplace(Z++,De,Ae,Ne,ke,1),q.emplace(Z++,De,Ae,Ne,ke,2),q.emplace(Z++,De,Ae,Ne,ke,3)}(!ea||ea.length<2*F)&&(ea=function(J){const pe=2*J,ye=new y.QuadTriangleArray;ye.resize(pe),ye._trim();for(let De=0;De<pe;De++){const Ae=6*De;ye.uint16[Ae+0]=4*De+0,ye.uint16[Ae+1]=4*De+1,ye.uint16[Ae+2]=4*De+2,ye.uint16[Ae+3]=4*De+2,ye.uint16[Ae+4]=4*De+3,ye.uint16[Ae+5]=4*De+0}return ye}(F));const te=M.createIndexBuffer(ea,!0),le=M.createVertexBuffer(q,y.collisionCircleLayout.members,!0);for(const J of O){const pe={u_matrix:J.transform,u_inv_matrix:J.invTransform,u_camera_to_center_distance:(fe=m.transform).cameraToCenterDistance,u_viewport_size:[fe.width,fe.height]};X.draw(M,I.TRIANGLES,Wt.disabled,Ln.disabled,m.colorModeForRenderPass(),dn.disabled,pe,m.style.map.terrain&&m.style.map.terrain.getTerrainData(J.coord),u.id,le,te,y.SegmentVector.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,m.transform.zoom,null,null,null)}var fe;le.destroy(),te.destroy()}dn.disabled=new dn(!1,1029,2305),dn.backCCW=new dn(!0,1029,2305);const rd=y.identity(new Float32Array(16));function Up(m,s,u,p,_,w){const{horizontalAlign:D,verticalAlign:M}=y.getAnchorAlignment(m),I=-(D-.5)*s,k=-(M-.5)*u,O=y.evaluateVariableOffset(m,p);return new y.Point((I/_+O[0])*w,(k/_+O[1])*w)}function yh(m,s,u,p,_,w,D,M,I,k,O){const F=m.text.placedSymbolArray,j=m.text.dynamicLayoutVertexArray,X=m.icon.dynamicLayoutVertexArray,q={};j.clear();for(let Z=0;Z<F.length;Z++){const te=F.get(Z),le=te.hidden||!te.crossTileID||m.allowVerticalPlacement&&!te.placedOrientation?null:p[te.crossTileID];if(le){const fe=new y.Point(te.anchorX,te.anchorY),J=gi(fe,u?D:w,O),pe=At(_.cameraToCenterDistance,J.signedDistanceFromCamera);let ye=y.evaluateSizeForFeature(m.textSizeData,I,te)*pe/y.ONE_EM;u&&(ye*=m.tilePixelRatio/M);const{width:De,height:Ae,anchor:Ne,textOffset:ke,textBoxScale:Be}=le,ot=Up(Ne,De,Ae,ke,Be,ye),gt=u?gi(fe.add(ot),w,O).point:J.point.add(s?ot.rotate(-_.angle):ot),He=m.allowVerticalPlacement&&te.placedOrientation===y.WritingMode.vertical?Math.PI/2:0;for(let yt=0;yt<te.numGlyphs;yt++)y.addDynamicAttributes(j,gt,He);k&&te.associatedIconIndex>=0&&(q[te.associatedIconIndex]={shiftedAnchor:gt,angle:He})}else G(te.numGlyphs,j)}if(k){X.clear();const Z=m.icon.placedSymbolArray;for(let te=0;te<Z.length;te++){const le=Z.get(te);if(le.hidden)G(le.numGlyphs,X);else{const fe=q[te];if(fe)for(let J=0;J<le.numGlyphs;J++)y.addDynamicAttributes(X,fe.shiftedAnchor,fe.angle);else G(le.numGlyphs,X)}}m.icon.dynamicLayoutVertexBuffer.updateData(X)}m.text.dynamicLayoutVertexBuffer.updateData(j)}function ec(m,s,u){return u.iconsInText&&s?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Cs(m,s,u,p,_,w,D,M,I,k,O,F){const j=m.context,X=j.gl,q=m.transform,Z="map"===M,te="map"===I,le="viewport"!==M&&"point"!==u.layout.get("symbol-placement"),fe=Z&&!te&&!le,J=!u.layout.get("symbol-sort-key").isConstant();let pe=!1;const ye=m.depthModeForSublayer(0,Wt.ReadOnly),De=u.layout.get("text-variable-anchor"),Ae=[];for(const Ne of p){const ke=s.getTile(Ne),Be=ke.getBucket(u);if(!Be)continue;const ot=_?Be.text:Be.icon;if(!ot||!ot.segments.get().length||!ot.hasVisibleVertices)continue;const gt=ot.programConfigurations.get(u.id),He=_||Be.sdfIcons,yt=_?Be.textSizeData:Be.iconSizeData,Ye=te||0!==q.pitch,tn=m.useProgram(ec(He,_,Be),gt),Jn=y.evaluateSizeForZoom(yt,q.zoom),nn=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Ne);let It,Wn,pr,ii,Mi=[0,0],fr=null;if(_)Wn=ke.glyphAtlasTexture,pr=X.LINEAR,It=ke.glyphAtlasTexture.size,Be.iconsInText&&(Mi=ke.imageAtlasTexture.size,fr=ke.imageAtlasTexture,ii=Ye||m.options.rotating||m.options.zooming||"composite"===yt.kind||"camera"===yt.kind?X.LINEAR:X.NEAREST);else{const Ai=1!==u.layout.get("icon-size").constantOr(0)||Be.iconsNeedLinear;Wn=ke.imageAtlasTexture,pr=He||m.options.rotating||m.options.zooming||Ai||Ye?X.LINEAR:X.NEAREST,It=ke.imageAtlasTexture.size}const Tr=ae(ke,1,m.transform.zoom),mr=Tt(Ne.posMatrix,te,Z,m.transform,Tr),gr=Br(Ne.posMatrix,te,Z,m.transform,Tr),ks=De&&Be.hasTextData(),iu="none"!==u.layout.get("icon-text-fit")&&ks&&Be.hasIconData();if(le){const Ai=m.style.map.terrain?(hd,ua)=>m.style.map.terrain.getElevation(Ne,hd,ua):null,kr="map"===u.layout.get("text-rotation-alignment");ys(Be,Ne.posMatrix,m,_,mr,gr,te,k,kr,Ai)}const Ar=m.translatePosMatrix(Ne.posMatrix,ke,w,D),zi=le||_&&De||iu?rd:mr,un=m.translatePosMatrix(gr,ke,w,D,!0),Vi=He&&0!==u.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1);let Ti;Ti=He?Be.iconsInText?ur(yt.kind,Jn,fe,te,m,Ar,zi,un,It,Mi):Qs(yt.kind,Jn,fe,te,m,Ar,zi,un,_,It,!0):dl(yt.kind,Jn,fe,te,m,Ar,zi,un,_,It);const an={program:tn,buffers:ot,uniformValues:Ti,atlasTexture:Wn,atlasTextureIcon:fr,atlasInterpolation:pr,atlasInterpolationIcon:ii,isSDF:He,hasHalo:Vi};if(J&&Be.canOverlap){pe=!0;const Ai=ot.segments.get();for(const kr of Ai)Ae.push({segments:new y.SegmentVector([kr]),sortKey:kr.sortKey,state:an,terrainData:nn})}else Ae.push({segments:ot.segments,sortKey:0,state:an,terrainData:nn})}pe&&Ae.sort((Ne,ke)=>Ne.sortKey-ke.sortKey);for(const Ne of Ae){const ke=Ne.state;if(j.activeTexture.set(X.TEXTURE0),ke.atlasTexture.bind(ke.atlasInterpolation,X.CLAMP_TO_EDGE),ke.atlasTextureIcon&&(j.activeTexture.set(X.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),ke.isSDF){const Be=ke.uniformValues;ke.hasHalo&&(Be.u_is_halo=1,od(ke.buffers,Ne.segments,u,m,ke.program,ye,O,F,Be,Ne.terrainData)),Be.u_is_halo=0}od(ke.buffers,Ne.segments,u,m,ke.program,ye,O,F,ke.uniformValues,Ne.terrainData)}}function od(m,s,u,p,_,w,D,M,I,k){const O=p.context;_.draw(O,O.gl.TRIANGLES,w,D,M,dn.disabled,I,k,u.id,m.layoutVertexBuffer,m.indexBuffer,s,u.paint,p.transform.zoom,m.programConfigurations.get(u.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function es(m,s,u,p,_){if(!u||!p||!p.imageAtlas)return;const w=p.imageAtlas.patternPositions;let D=w[u.to.toString()],M=w[u.from.toString()];if(!D||!M){const I=_.getPaintProperty(s);D=w[I],M=w[I]}D&&M&&m.setConstantPatternPositions(D,M)}function tc(m,s,u,p,_,w,D){const M=m.context.gl,I="fill-pattern",k=u.paint.get(I),O=k&&k.constantOr(1),F=u.getCrossfadeParameters();let j,X,q,Z,te;D?(X=O&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=M.LINES):(X=O?"fillPattern":"fill",j=M.TRIANGLES);const le=k.constantOr(null);for(const fe of p){const J=s.getTile(fe);if(O&&!J.patternsLoaded())continue;const pe=J.getBucket(u);if(!pe)continue;const ye=pe.programConfigurations.get(u.id),De=m.useProgram(X,ye),Ae=m.style.map.terrain&&m.style.map.terrain.getTerrainData(fe);O&&(m.context.activeTexture.set(M.TEXTURE0),J.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ye.updatePaintBuffers(F)),es(ye,I,le,J,u);const Ne=Ae?fe:null,ke=m.translatePosMatrix(Ne?Ne.posMatrix:fe.posMatrix,J,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(D){Z=pe.indexBuffer2,te=pe.segments2;const Be=[M.drawingBufferWidth,M.drawingBufferHeight];q="fillOutlinePattern"===X&&O?yi(ke,m,F,J,Be):Vc(ke,Be)}else Z=pe.indexBuffer,te=pe.segments,q=O?mn(ke,m,F,J):ph(ke);De.draw(m.context,j,_,m.stencilModeForClipping(fe),w,dn.disabled,q,Ae,u.id,pe.layoutVertexBuffer,Z,te,u.paint,m.transform.zoom,ye)}}function Te(m,s,u,p,_,w,D){const M=m.context,I=M.gl,k="fill-extrusion-pattern",O=u.paint.get(k),F=O.constantOr(1),j=u.getCrossfadeParameters(),X=u.paint.get("fill-extrusion-opacity"),q=O.constantOr(null);for(const Z of p){const te=s.getTile(Z),le=te.getBucket(u);if(!le)continue;const fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Z),J=le.programConfigurations.get(u.id),pe=m.useProgram(F?"fillExtrusionPattern":"fillExtrusion",J);F&&(m.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),J.updatePaintBuffers(j)),es(J,k,q,te,u);const ye=m.translatePosMatrix(Z.posMatrix,te,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),De=u.paint.get("fill-extrusion-vertical-gradient"),Ae=F?zc(ye,m,De,X,Z,j,te):ws(ye,m,De,X);pe.draw(M,M.gl.TRIANGLES,_,w,D,dn.backCCW,Ae,fe,u.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,u.paint,m.transform.zoom,J,m.style.map.terrain&&le.centroidVertexBuffer)}}function vh(m,s,u,p,_,w,D){const M=m.context,I=M.gl,k=u.fbo;if(!k)return;const O=m.useProgram("hillshade"),F=m.style.map.terrain&&m.style.map.terrain.getTerrainData(s);M.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,k.colorAttachment.get()),O.draw(M,I.TRIANGLES,_,w,D,dn.disabled,((j,X,q,Z)=>{const te=q.paint.get("hillshade-shadow-color"),le=q.paint.get("hillshade-highlight-color"),fe=q.paint.get("hillshade-accent-color");let J=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===q.paint.get("hillshade-illumination-anchor")&&(J-=j.transform.angle);const pe=!j.options.moving;return{u_matrix:Z?Z.posMatrix:j.transform.calculatePosMatrix(X.tileID.toUnwrapped(),pe),u_image:0,u_latrange:jc(0,X.tileID),u_light:[q.paint.get("hillshade-exaggeration"),J],u_shadow:te,u_highlight:le,u_accent:fe}})(m,u,p,F?s:null),F,p.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function St(m,s,u,p,_,w){const D=m.context,M=D.gl,I=s.dem;if(I&&I.data){const k=I.dim,O=I.stride,F=I.getPixels();if(D.activeTexture.set(M.TEXTURE1),D.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(O),s.demTexture){const X=s.demTexture;X.update(F,{premultiply:!1}),X.bind(M.NEAREST,M.CLAMP_TO_EDGE)}else s.demTexture=new ut(D,F,M.RGBA,{premultiply:!1}),s.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE);D.activeTexture.set(M.TEXTURE0);let j=s.fbo;if(!j){const X=new ut(D,{width:k,height:k,data:null},M.RGBA);X.bind(M.LINEAR,M.CLAMP_TO_EDGE),j=s.fbo=D.createFramebuffer(k,k,!0,!1),j.colorAttachment.set(X.texture)}D.bindFramebuffer.set(j.framebuffer),D.viewport.set([0,0,k,k]),m.useProgram("hillshadePrepare").draw(D,M.TRIANGLES,p,_,w,dn.disabled,((X,q)=>{const Z=q.stride,te=y.create();return y.ortho(te,0,y.EXTENT,-y.EXTENT,0,0,1),y.translate(te,te,[0,-y.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[Z,Z],u_zoom:X.overscaledZ,u_unpack:q.getUnpackVector()}})(s.tileID,I),null,u.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function qn(m,s,u,p,_,w){const D=p.paint.get("raster-fade-duration");if(!w&&D>0){const M=y.exported.now(),I=(M-m.timeAdded)/D,k=s?(M-s.timeAdded)/D:-1,O=u.getSource(),F=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),j=!s||Math.abs(s.tileID.overscaledZ-F)>Math.abs(m.tileID.overscaledZ-F),X=j&&m.refreshedUponExpiration?1:y.clamp(j?I:1-k,0,1);return m.refreshedUponExpiration&&I>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const Ds=new y.Color(1,0,0,1),dr=new y.Color(0,1,0,1),bh=new y.Color(0,0,1,1),sd=new y.Color(1,0,1,1),xh=new y.Color(0,1,1,1);function Ir(m,s,u,p){Qi(m,0,s+u/2,m.transform.width,u,p)}function ta(m,s,u,p){Qi(m,s-u/2,0,u,m.transform.height,p)}function Qi(m,s,u,p,_,w){const D=m.context,M=D.gl;M.enable(M.SCISSOR_TEST),M.scissor(s*m.pixelRatio,u*m.pixelRatio,p*m.pixelRatio,_*m.pixelRatio),D.clear({color:w}),M.disable(M.SCISSOR_TEST)}function Ro(m,s,u){const p=m.context,_=p.gl,w=u.posMatrix,D=m.useProgram("debug"),M=Wt.disabled,I=Ln.disabled,k=m.colorModeForRenderPass(),O="$debug",F=m.style.map.terrain&&m.style.map.terrain.getTerrainData(u);p.activeTexture.set(_.TEXTURE0);const j=s.getTileByID(u.key).latestRawTileData,X=Math.floor((j&&j.byteLength||0)/1024),q=s.getTile(u).tileSize,Z=512/Math.min(q,512)*(u.overscaledZ/m.transform.zoom)*.5;let te=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(te+=` => ${u.overscaledZ}`),function(le,fe){le.initDebugOverlayCanvas();const J=le.debugOverlayCanvas,pe=le.context.gl,ye=le.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,J.width,J.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(fe,5,5),ye.strokeText(fe,5,5),le.debugOverlayTexture.update(J),le.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(m,`${te} ${X}kB`),D.draw(p,_.TRIANGLES,M,I,Kn.alphaBlended,dn.disabled,xn(w,y.Color.transparent,Z),null,O,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),D.draw(p,_.LINE_STRIP,M,I,k,dn.disabled,xn(w,y.Color.red),F,O,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function on(m,s,u){const p=m.context,_=p.gl,w=m.colorModeForRenderPass(),D=new Wt(_.LEQUAL,Wt.ReadWrite,m.depthRangeFor3D),M=m.useProgram("terrain"),I=s.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,m.width,m.height]);for(const k of u){const O=m.renderToTexture.getTexture(k),F=s.getTerrainData(k.tileID);p.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,O.texture);const j={u_matrix:m.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(m.transform.zoom)};M.draw(p,_.TRIANGLES,D,Ln.disabled,w,dn.backCCW,j,F,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}}const ml={symbol:function(m,s,u,p,_){if("translucent"!==m.renderPass)return;const w=Ln.disabled,D=m.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(M,I,k,O,F,j,X){const q=I.transform,Z="map"===F,te="map"===j;for(const le of M){const fe=O.getTile(le),J=fe.getBucket(k);if(!J||!J.text||!J.text.segments.get().length)continue;const pe=y.evaluateSizeForZoom(J.textSizeData,q.zoom),ye=ae(fe,1,I.transform.zoom),De=Tt(le.posMatrix,te,Z,I.transform,ye),Ae="none"!==k.layout.get("icon-text-fit")&&J.hasIconData();if(pe){const Ne=Math.pow(2,q.zoom-fe.tileID.overscaledZ);yh(J,Z,te,X,q,De,le.posMatrix,Ne,pe,Ae,I.style.map.terrain?(ke,Be)=>I.style.map.terrain.getElevation(le,ke,Be):null)}}}(p,m,u,s,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),_),0!==u.paint.get("icon-opacity").constantOr(1)&&Cs(m,s,u,p,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),w,D),0!==u.paint.get("text-opacity").constantOr(1)&&Cs(m,s,u,p,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),w,D),s.map.showCollisionBoxes&&(Jl(m,s,u,p,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Jl(m,s,u,p,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,u,p){if("translucent"!==m.renderPass)return;const _=u.paint.get("circle-opacity"),w=u.paint.get("circle-stroke-width"),D=u.paint.get("circle-stroke-opacity"),M=!u.layout.get("circle-sort-key").isConstant();if(0===_.constantOr(1)&&(0===w.constantOr(1)||0===D.constantOr(1)))return;const I=m.context,k=I.gl,O=m.depthModeForSublayer(0,Wt.ReadOnly),F=Ln.disabled,j=m.colorModeForRenderPass(),X=[];for(let q=0;q<p.length;q++){const Z=p[q],te=s.getTile(Z),le=te.getBucket(u);if(!le)continue;const fe=le.programConfigurations.get(u.id),J=m.useProgram("circle",fe),pe=le.layoutVertexBuffer,ye=le.indexBuffer,De=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Z),Ae={programConfiguration:fe,program:J,layoutVertexBuffer:pe,indexBuffer:ye,uniformValues:Wu(m,Z,te,u),terrainData:De};if(M){const Ne=le.segments.get();for(const ke of Ne)X.push({segments:new y.SegmentVector([ke]),sortKey:ke.sortKey,state:Ae})}else X.push({segments:le.segments,sortKey:0,state:Ae})}M&&X.sort((q,Z)=>q.sortKey-Z.sortKey);for(const q of X){const{programConfiguration:Z,program:te,layoutVertexBuffer:le,indexBuffer:fe,uniformValues:J,terrainData:pe}=q.state;te.draw(I,k.TRIANGLES,O,F,j,dn.disabled,J,pe,u.id,le,fe,q.segments,u.paint,m.transform.zoom,Z)}},heatmap:function(m,s,u,p){if(0!==u.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const _=m.context,w=_.gl,D=Ln.disabled,M=new Kn([w.ONE,w.ONE],y.Color.transparent,[!0,!0,!0,!0]);(function(I,k,O){const F=I.gl;I.activeTexture.set(F.TEXTURE1),I.viewport.set([0,0,k.width/4,k.height/4]);let j=O.heatmapFbo;if(j)F.bindTexture(F.TEXTURE_2D,j.colorAttachment.get()),I.bindFramebuffer.set(j.framebuffer);else{const X=F.createTexture();F.bindTexture(F.TEXTURE_2D,X),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.LINEAR),j=O.heatmapFbo=I.createFramebuffer(k.width/4,k.height/4,!1,!1),function(q,Z,te,le){var fe,J;const pe=q.gl,ye=null!==(fe=q.HALF_FLOAT)&&void 0!==fe?fe:pe.UNSIGNED_BYTE,De=null!==(J=q.RGBA16F)&&void 0!==J?J:pe.RGBA;pe.texImage2D(pe.TEXTURE_2D,0,De,Z.width/4,Z.height/4,0,pe.RGBA,ye,null),le.colorAttachment.set(te)}(I,k,X,j)}})(_,m,u),_.clear({color:y.Color.transparent});for(let I=0;I<p.length;I++){const k=p[I];if(s.hasRenderableParent(k))continue;const O=s.getTile(k),F=O.getBucket(u);if(!F)continue;const j=F.programConfigurations.get(u.id),X=m.useProgram("heatmap",j),{zoom:q}=m.transform;X.draw(_,w.TRIANGLES,Wt.disabled,D,M,dn.disabled,Uc(k.posMatrix,O,q,u.paint.get("heatmap-intensity")),null,u.id,F.layoutVertexBuffer,F.indexBuffer,F.segments,u.paint,m.transform.zoom,j)}_.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(_,w){const D=_.context,M=D.gl,I=w.heatmapFbo;if(!I)return;D.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,I.colorAttachment.get()),D.activeTexture.set(M.TEXTURE1);let k=w.colorRampTexture;k||(k=w.colorRampTexture=new ut(D,w.colorRamp,M.RGBA)),k.bind(M.LINEAR,M.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(D,M.TRIANGLES,Wt.disabled,Ln.disabled,_.colorModeForRenderPass(),dn.disabled,((O,F,j,X)=>{const q=y.create();y.ortho(q,0,O.width,O.height,0,0,1);const Z=O.context.gl;return{u_matrix:q,u_world:[Z.drawingBufferWidth,Z.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:F.paint.get("heatmap-opacity")}})(_,w),null,w.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,w.paint,_.transform.zoom)}(m,u))},line:function(m,s,u,p){if("translucent"!==m.renderPass)return;const _=u.paint.get("line-opacity"),w=u.paint.get("line-width");if(0===_.constantOr(1)||0===w.constantOr(1))return;const D=m.depthModeForSublayer(0,Wt.ReadOnly),M=m.colorModeForRenderPass(),I=u.paint.get("line-dasharray"),k=u.paint.get("line-pattern"),O=k.constantOr(1),F=u.paint.get("line-gradient"),j=u.getCrossfadeParameters(),X=O?"linePattern":I?"lineSDF":F?"lineGradient":"line",q=m.context,Z=q.gl;let te=!0;for(const le of p){const fe=s.getTile(le);if(O&&!fe.patternsLoaded())continue;const J=fe.getBucket(u);if(!J)continue;const pe=J.programConfigurations.get(u.id),ye=m.context.program.get(),De=m.useProgram(X,pe),Ae=te||De.program!==ye,Ne=m.style.map.terrain&&m.style.map.terrain.getTerrainData(le),ke=k.constantOr(null);if(ke&&fe.imageAtlas){const gt=fe.imageAtlas,He=gt.patternPositions[ke.to.toString()],yt=gt.patternPositions[ke.from.toString()];He&&yt&&pe.setConstantPatternPositions(He,yt)}const Be=Ne?le:null,ot=O?Ee(m,fe,u,j,Be):I?La(m,fe,u,I,j,Be):F?Kl(m,fe,u,J.lineClipsArray.length,Be):Ys(m,fe,u,Be);if(O)q.activeTexture.set(Z.TEXTURE0),fe.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),pe.updatePaintBuffers(j);else if(I&&(Ae||m.lineAtlas.dirty))q.activeTexture.set(Z.TEXTURE0),m.lineAtlas.bind(q);else if(F){const gt=J.gradients[u.id];let He=gt.texture;if(u.gradientVersion!==gt.version){let yt=256;if(u.stepInterpolant){const Ye=s.getSource().maxzoom,tn=le.canonical.z===Ye?Math.ceil(1<<m.transform.maxZoom-le.canonical.z):1;yt=y.clamp(y.nextPowerOfTwo(J.maxLineLength/y.EXTENT*1024*tn),256,q.maxTextureSize)}gt.gradient=y.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:yt,image:gt.gradient||void 0,clips:J.lineClipsArray}),gt.texture?gt.texture.update(gt.gradient):gt.texture=new ut(q,gt.gradient,Z.RGBA),gt.version=u.gradientVersion,He=gt.texture}q.activeTexture.set(Z.TEXTURE0),He.bind(u.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}De.draw(q,Z.TRIANGLES,D,m.stencilModeForClipping(le),M,dn.disabled,ot,Ne,u.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,u.paint,m.transform.zoom,pe,J.layoutVertexBuffer2),te=!1}},fill:function(m,s,u,p){const _=u.paint.get("fill-color"),w=u.paint.get("fill-opacity");if(0===w.constantOr(1))return;const D=m.colorModeForRenderPass(),M=u.paint.get("fill-pattern"),I=m.opaquePassEnabledForLayer()&&!M.constantOr(1)&&1===_.constantOr(y.Color.transparent).a&&1===w.constantOr(0)?"opaque":"translucent";if(m.renderPass===I){const k=m.depthModeForSublayer(1,"opaque"===m.renderPass?Wt.ReadWrite:Wt.ReadOnly);tc(m,s,u,p,k,D,!1)}if("translucent"===m.renderPass&&u.paint.get("fill-antialias")){const k=m.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,Wt.ReadOnly);tc(m,s,u,p,k,D,!0)}},"fill-extrusion":function(m,s,u,p){const _=u.paint.get("fill-extrusion-opacity");if(0!==_&&"translucent"===m.renderPass){const w=new Wt(m.context.gl.LEQUAL,Wt.ReadWrite,m.depthRangeFor3D);if(1!==_||u.paint.get("fill-extrusion-pattern").constantOr(1))Te(m,s,u,p,w,Ln.disabled,Kn.disabled),Te(m,s,u,p,w,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const D=m.colorModeForRenderPass();Te(m,s,u,p,w,Ln.disabled,D)}}},hillshade:function(m,s,u,p){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const _=m.context,w=m.depthModeForSublayer(0,Wt.ReadOnly),D=m.colorModeForRenderPass(),[M,I]="translucent"===m.renderPass?m.stencilConfigForOverlap(p):[{},p];for(const k of I){const O=s.getTile(k);void 0!==O.needsHillshadePrepare&&O.needsHillshadePrepare&&"offscreen"===m.renderPass?St(m,O,u,w,Ln.disabled,D):"translucent"===m.renderPass&&vh(m,k,O,u,w,M[k.overscaledZ],D)}_.viewport.set([0,0,m.width,m.height])},raster:function(m,s,u,p){if("translucent"!==m.renderPass||0===u.paint.get("raster-opacity")||!p.length)return;const _=m.context,w=_.gl,D=s.getSource(),M=m.useProgram("raster"),I=m.colorModeForRenderPass(),[k,O]=D instanceof Nr?[{},p]:m.stencilConfigForOverlap(p),F=O[O.length-1].overscaledZ,j=!m.options.moving;for(const X of O){const q=m.depthModeForSublayer(X.overscaledZ-F,1===u.paint.get("raster-opacity")?Wt.ReadWrite:Wt.ReadOnly,w.LESS),Z=s.getTile(X);Z.registerFadeDuration(u.paint.get("raster-fade-duration"));const te=s.findLoadedParent(X,0),le=qn(Z,te,s,u,m.transform,m.style.map.terrain);let fe,J;const pe="nearest"===u.paint.get("raster-resampling")?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),Z.texture.bind(pe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),te?(te.texture.bind(pe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),fe=Math.pow(2,te.tileID.overscaledZ-Z.tileID.overscaledZ),J=[Z.tileID.canonical.x*fe%1,Z.tileID.canonical.y*fe%1]):Z.texture.bind(pe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);const ye=m.style.map.terrain&&m.style.map.terrain.getTerrainData(X),De=ye?X:null,Ae=De?De.posMatrix:m.transform.calculatePosMatrix(X.toUnwrapped(),j),Ne=Hc(Ae,J||[0,0],fe||1,le,u);D instanceof Nr?M.draw(_,w.TRIANGLES,q,Ln.disabled,I,dn.disabled,Ne,ye,u.id,D.boundsBuffer,m.quadTriangleIndexBuffer,D.boundsSegments):M.draw(_,w.TRIANGLES,q,k[X.overscaledZ],I,dn.disabled,Ne,ye,u.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}},background:function(m,s,u,p){const _=u.paint.get("background-color"),w=u.paint.get("background-opacity");if(0===w)return;const D=m.context,M=D.gl,I=m.transform,k=I.tileSize,O=u.paint.get("background-pattern");if(m.isPatternMissing(O))return;const F=!O&&1===_.a&&1===w&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==F)return;const j=Ln.disabled,X=m.depthModeForSublayer(0,"opaque"===F?Wt.ReadWrite:Wt.ReadOnly),q=m.colorModeForRenderPass(),Z=m.useProgram(O?"backgroundPattern":"background"),te=p||I.coveringTiles({tileSize:k,terrain:m.style.map.terrain});O&&(D.activeTexture.set(M.TEXTURE0),m.imageManager.bind(m.context));const le=u.getCrossfadeParameters();for(const fe of te){const J=p?fe.posMatrix:m.transform.calculatePosMatrix(fe.toUnwrapped()),pe=O?Kr(J,w,m,O,{tileID:fe,tileSize:k},le):po(J,w,_),ye=m.style.map.terrain&&m.style.map.terrain.getTerrainData(fe);Z.draw(D,M.TRIANGLES,X,j,q,dn.disabled,pe,ye,u.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}},debug:function(m,s,u){for(let p=0;p<u.length;p++)Ro(m,s,u[p])},custom:function(m,s,u){const p=m.context,_=u.implementation;if("offscreen"===m.renderPass){const w=_.prerender;w&&(m.setCustomLayerDefaults(),p.setColorMode(m.colorModeForRenderPass()),w.call(_,p.gl,m.transform.customLayerMatrix()),p.setDirty(),m.setBaseState())}else if("translucent"===m.renderPass){m.setCustomLayerDefaults(),p.setColorMode(m.colorModeForRenderPass()),p.setStencilMode(Ln.disabled);const w="3d"===_.renderingMode?new Wt(m.context.gl.LEQUAL,Wt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Wt.ReadOnly);p.setDepthMode(w),_.render(p.gl,m.transform.customLayerMatrix()),p.setDirty(),m.setBaseState(),p.bindFramebuffer.set(null)}}};class Kc{constructor(s,u){this.context=new _h(s),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:y.create(),renderTime:0},this.setup(),this.numSublayers=mi.maxUnderzooming+mi.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bs}resize(s,u,p){if(this.width=s*p,this.height=u*p,this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const s=this.context,u=new y.PosArray;u.emplaceBack(0,0),u.emplaceBack(y.EXTENT,0),u.emplaceBack(0,y.EXTENT),u.emplaceBack(y.EXTENT,y.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(u,qu.members),this.tileExtentSegments=y.SegmentVector.simpleSegment(0,0,4,2);const p=new y.PosArray;p.emplaceBack(0,0),p.emplaceBack(y.EXTENT,0),p.emplaceBack(0,y.EXTENT),p.emplaceBack(y.EXTENT,y.EXTENT),this.debugBuffer=s.createVertexBuffer(p,qu.members),this.debugSegments=y.SegmentVector.simpleSegment(0,0,4,5);const _=new y.RasterBoundsArray;_.emplaceBack(0,0,0,0),_.emplaceBack(y.EXTENT,0,y.EXTENT,0),_.emplaceBack(0,y.EXTENT,0,y.EXTENT),_.emplaceBack(y.EXTENT,y.EXTENT,y.EXTENT,y.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(_,fn.members),this.rasterBoundsSegments=y.SegmentVector.simpleSegment(0,0,4,2);const w=new y.PosArray;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(w,qu.members),this.viewportSegments=y.SegmentVector.simpleSegment(0,0,4,2);const D=new y.LineStripIndexArray;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(D);const M=new y.TriangleIndexArray;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(M);const I=this.context.gl;this.stencilClearMode=new Ln({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)}clearStencil(){const s=this.context,u=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=y.create();y.ortho(p,0,this.width,this.height,0,0,1),y.scale(p,p,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,u.TRIANGLES,Wt.disabled,this.stencilClearMode,Kn.disabled,dn.disabled,Ct(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,u){if(this.currentStencilSource===s.source||!s.isTileClipped()||!u||!u.length)return;this.currentStencilSource=s.source;const p=this.context,_=p.gl;this.nextStencilID+u.length>256&&this.clearStencil(),p.setColorMode(Kn.disabled),p.setDepthMode(Wt.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of u){const M=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D);w.draw(p,_.TRIANGLES,Wt.disabled,new Ln({func:_.ALWAYS,mask:0},M,255,_.KEEP,_.KEEP,_.REPLACE),Kn.disabled,dn.disabled,Ct(D.posMatrix),I,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new Ln({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){const u=this.context.gl;return new Ln({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(s){const u=this.context.gl,p=s.sort((D,M)=>M.overscaledZ-D.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const D={};for(let M=0;M<w;M++)D[M+_]=new Ln({func:u.GEQUAL,mask:255},M+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[D,p]}return[{[_]:Ln.disabled},p]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Kn([s.CONSTANT_COLOR,s.ONE],new y.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Kn.unblended:Kn.alphaBlended}depthModeForSublayer(s,u,p){if(!this.opaquePassEnabledForLayer())return Wt.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Wt(p||this.context.gl.LEQUAL,u,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,u){this.style=s,this.options=u,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(y.exported.now()),this.imageManager.beginFrame();const p=this.style._order,_=this.style.sourceCaches,w={},D={},M={};for(const I in _){const k=_[I];k.used&&k.prepare(this.context),w[I]=k.getVisibleCoordinates(),D[I]=w[I].slice().reverse(),M[I]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<p.length;I++)if(this.style._layers[p[I]].is3D()){this.opaquePassCutoff=I;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const I=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!y.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||I.length)&&(y.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(k,O){const F=k.context,j=F.gl,X=Kn.unblended,q=new Wt(j.LEQUAL,Wt.ReadWrite,[0,1]),Z=O.getTerrainMesh(),te=O.sourceCache.getRenderableTiles(),le=k.useProgram("terrainDepth");F.bindFramebuffer.set(O.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:y.Color.transparent,depth:1});for(const fe of te){const J=O.getTerrainData(fe.tileID),pe={u_matrix:k.transform.calculatePosMatrix(fe.tileID.toUnwrapped()),u_ele_delta:O.getMeshFrameDelta(k.transform.zoom)};le.draw(F,j.TRIANGLES,q,Ln.disabled,X,dn.backCCW,pe,J,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain),function(k,O){const F=k.context,j=F.gl,X=Kn.unblended,q=new Wt(j.LEQUAL,Wt.ReadWrite,[0,1]),Z=O.getTerrainMesh(),te=O.getCoordsTexture(),le=O.sourceCache.getRenderableTiles(),fe=k.useProgram("terrainCoords");F.bindFramebuffer.set(O.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:y.Color.transparent,depth:1}),O.coordsIndex=[];for(const J of le){const pe=O.getTerrainData(J.tileID);F.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,te.texture);const ye={u_matrix:k.transform.calculatePosMatrix(J.tileID.toUnwrapped()),u_terrain_coords_id:(255-O.coordsIndex.length)/255,u_texture:0,u_ele_delta:O.getMeshFrameDelta(k.transform.zoom)};fe.draw(F,j.TRIANGLES,q,Ln.disabled,X,dn.backCCW,ye,pe,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments),O.coordsIndex.push(J.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const I of p){const k=this.style._layers[I];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const O=D[k.source];("custom"===k.type||O.length)&&this.renderLayer(this,_[k.source],k,O)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?y.Color.black:y.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[p[this.currentLayer]],k=_[I.source],O=w[I.source];this._renderTileClippingMasks(I,O),this.renderLayer(this,k,I,O)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const I=this.style._layers[p[this.currentLayer]],k=_[I.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(I))continue;const O=("symbol"===I.type?M:D)[I.source];this._renderTileClippingMasks(I,w[I.source]),this.renderLayer(this,k,I,O)}if(this.options.showTileBoundaries){const I=function(k,O){let F=null;const j=Object.values(k._layers).flatMap(te=>te.source&&!te.isHidden(O)?[k.sourceCaches[te.source]]:[]),X=j.filter(te=>"vector"===te.getSource().type),q=j.filter(te=>"vector"!==te.getSource().type),Z=te=>{(!F||F.getSource().maxzoom<te.getSource().maxzoom)&&(F=te)};return X.forEach(te=>Z(te)),F||q.forEach(te=>Z(te)),F}(this.style,this.transform.zoom);I&&ml.debug(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const k=I.transform.padding;Ir(I,I.transform.height-(k.top||0),3,Ds),Ir(I,k.bottom||0,3,dr),ta(I,k.left||0,3,bh),ta(I,I.transform.width-(k.right||0),3,sd);const O=I.transform.centerPoint;var F,j,X,q;Qi(F=I,(j=O.x)-1,(X=I.transform.height-O.y)-10,2,20,q=xh),Qi(F,j-10,X-1,20,2,q)}(this),this.context.setDefault()}renderLayer(s,u,p,_){p.isHidden(this.transform.zoom)||("background"===p.type||"custom"===p.type||(_||[]).length)&&(this.id=p.id,ml[p.type](s,u,p,_,this.style.placement.variableOffsets))}translatePosMatrix(s,u,p,_,w){if(!p[0]&&!p[1])return s;const D=w?"map"===_?this.transform.angle:0:"viewport"===_?-this.transform.angle:0;if(D){const k=Math.sin(D),O=Math.cos(D);p=[p[0]*O-p[1]*k,p[0]*k+p[1]*O]}const M=[w?p[0]:ae(u,p[0],this.transform.zoom),w?p[1]:ae(u,p[1],this.transform.zoom),0],I=new Float32Array(16);return y.translate(I,s,M),I}saveTileTexture(s){const u=this._tileTextures[s.size[0]];u?u.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const u=this.imageManager.getPattern(s.from.toString()),p=this.imageManager.getPattern(s.to.toString());return!u||!p}useProgram(s,u){this.cache=this.cache||{};const p=s+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new ul(this.context,s,Xr[s],u,fh[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ut(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class gl{constructor(s,u){this.points=s,this.planes=u}static fromInvProjectionMatrix(s,u,p){const _=Math.pow(2,p),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const I=1/(M=y.transformMat4([],M,s))[3]/u*_;return y.mul$1(M,M,[I,I,1/M[3],I])}),D=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const I=function(j,X){var q=X[0],Z=X[1],te=X[2],le=q*q+Z*Z+te*te;return le>0&&(le=1/Math.sqrt(le)),j[0]=X[0]*le,j[1]=X[1]*le,j[2]=X[2]*le,j}([],(j=[],X=ze([],w[M[0]],w[M[1]]),q=ze([],w[M[2]],w[M[1]]),Z=X[0],fe=q[0],j[0]=(te=X[1])*(pe=q[2])-(le=X[2])*(J=q[1]),j[1]=le*fe-Z*pe,j[2]=Z*J-te*fe,j)),k=-((O=I)[0]*(F=w[M[1]])[0]+O[1]*F[1]+O[2]*F[2]);var j,X,q,Z,te,le,fe,J,pe,O,F;return I.concat(k)});return new gl(w,D)}}class Fo{constructor(s,u){var p,_,w;this.min=s,this.max=u,this.center=function(p,_,w){return p[0]=.5*_[0],p[1]=.5*_[1],p[2]=.5*_[2],p}([],((p=[])[0]=(_=this.min)[0]+(w=this.max)[0],p[1]=_[1]+w[1],p[2]=_[2]+w[2],p))}quadrant(s){const u=[s%2==0,s<2],p=Mo(this.min),_=Mo(this.max);for(let w=0;w<u.length;w++)p[w]=u[w]?this.min[w]:this.center[w],_[w]=u[w]?this.center[w]:this.max[w];return _[2]=this.max[2],new Fo(p,_)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let _=0;_<s.planes.length;_++){const w=s.planes[_];let D=0;for(let M=0;M<u.length;M++)y.dot(w,u[M])>=0&&D++;if(0===D)return 0;D!==u.length&&(p=!1)}if(p)return 2;for(let _=0;_<3;_++){let w=Number.MAX_VALUE,D=-Number.MAX_VALUE;for(let M=0;M<s.points.length;M++){const I=s.points[M][_]-this.min[_];w=Math.min(w,I),D=Math.max(D,I)}if(D<0||w>this.max[_]-this.min[_])return 0}return 1}}class fo{constructor(s=0,u=0,p=0,_=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=p,this.right=_}interpolate(s,u,p){return null!=u.top&&null!=s.top&&(this.top=y.interpolate.number(s.top,u.top,p)),null!=u.bottom&&null!=s.bottom&&(this.bottom=y.interpolate.number(s.bottom,u.bottom,p)),null!=u.left&&null!=s.left&&(this.left=y.interpolate.number(s.left,u.left,p)),null!=u.right&&null!=s.right&&(this.right=y.interpolate.number(s.right,u.right,p)),this}getCenter(s,u){const p=y.clamp((this.left+s-this.right)/2,0,s),_=y.clamp((this.top+u-this.bottom)/2,0,u);return new y.Point(p,_)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new fo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class na{constructor(s,u,p,_,w){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===w||!!w,this._minZoom=s||0,this._maxZoom=u||22,this._minPitch=p??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new y.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fo,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const s=new na(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){void 0===s?s=!0:null===s&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new y.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const u=-y.wrap(s,-180,180)*Math.PI/180;var p;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(p=new y.ARRAY_TYPE(4),y.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(p,_,w){var D=_[0],M=_[1],I=_[2],k=_[3],O=Math.sin(w),F=Math.cos(w);p[0]=D*F+I*O,p[1]=M*F+k*O,p[2]=D*-O+I*F,p[3]=M*-O+k*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const u=y.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const u=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,p){this._unmodified=!1,this._edgeInsets.interpolate(s,u,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const u=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(s){const u=[new y.UnwrappedTileID(0,s)];if(this._renderWorldCopies){const p=this.pointCoordinate(new y.Point(0,0)),_=this.pointCoordinate(new y.Point(this.width,0)),w=this.pointCoordinate(new y.Point(this.width,this.height)),D=this.pointCoordinate(new y.Point(0,this.height)),M=Math.floor(Math.min(p.x,_.x,w.x,D.x)),I=Math.floor(Math.max(p.x,_.x,w.x,D.x)),k=1;for(let O=M-k;O<=I+k;O++)0!==O&&u.push(new y.UnwrappedTileID(O,s))}return u}coveringTiles(s){var u,p;let _=this.coveringZoomLevel(s);const w=_;if(void 0!==s.minzoom&&_<s.minzoom)return[];void 0!==s.maxzoom&&_>s.maxzoom&&(_=s.maxzoom);const D=this.pointCoordinate(this.getCameraPoint()),M=y.MercatorCoordinate.fromLngLat(this.center),I=Math.pow(2,_),k=[I*D.x,I*D.y,0],O=[I*M.x,I*M.y,0],F=gl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let j=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(j=_);const X=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,q=J=>({aabb:new Fo([J*I,0,0],[(J+1)*I,I,0]),zoom:0,x:0,y:0,wrap:J,fullyVisible:!1}),Z=[],te=[],le=_,fe=s.reparseOverscaled?w:_;if(this._renderWorldCopies)for(let J=1;J<=3;J++)Z.push(q(-J)),Z.push(q(J));for(Z.push(q(0));Z.length>0;){const J=Z.pop(),pe=J.x,ye=J.y;let De=J.fullyVisible;if(!De){const ot=J.aabb.intersects(F);if(0===ot)continue;De=2===ot}const Ae=s.terrain?k:O,Ne=J.aabb.distanceX(Ae),ke=J.aabb.distanceY(Ae),Be=Math.max(Math.abs(Ne),Math.abs(ke));if(J.zoom===le||Be>X+(1<<le-J.zoom)-2&&J.zoom>=j){const ot=le-J.zoom,gt=k[0]-.5-(pe<<ot),He=k[1]-.5-(ye<<ot);te.push({tileID:new y.OverscaledTileID(J.zoom===le?fe:J.zoom,J.wrap,J.zoom,pe,ye),distanceSq:We([O[0]-.5-pe,O[1]-.5-ye]),tileDistanceToCamera:Math.sqrt(gt*gt+He*He)})}else for(let ot=0;ot<4;ot++){const gt=(pe<<1)+ot%2,He=(ye<<1)+(ot>>1),yt=J.zoom+1;let Ye=J.aabb.quadrant(ot);if(s.terrain){const tn=new y.OverscaledTileID(yt,J.wrap,yt,gt,He),Jn=s.terrain.getMinMaxElevation(tn),nn=null!==(u=Jn.minElevation)&&void 0!==u?u:this.elevation,It=null!==(p=Jn.maxElevation)&&void 0!==p?p:this.elevation;Ye=new Fo([Ye.min[0],Ye.min[1],nn],[Ye.max[0],Ye.max[1],It])}Z.push({aabb:Ye,zoom:yt,x:gt,y:He,wrap:J.wrap,fullyVisible:De})}}return te.sort((J,pe)=>J.distanceSq-pe.distanceSq).map(J=>J.tileID)}resize(s,u){this.width=s,this.height=u,this.pixelsToGLUnits=[2/s,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const u=y.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new y.Point(y.mercatorXfromLng(s.lng)*this.worldSize,y.mercatorYfromLat(u)*this.worldSize)}unproject(s){return new y.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(s){this.freezeElevation||(this.elevation=s?this.getElevation(this._center,s):0)}getElevation(s,u){const p=y.MercatorCoordinate.fromLngLat(s.wrap()),_=(1<<this.tileZoom)*y.EXTENT,w=p.x*_,D=p.y*_,M=Math.floor(w/y.EXTENT),I=Math.floor(D/y.EXTENT),k=new y.OverscaledTileID(this.tileZoom,0,this.tileZoom,M,I);return u.getElevation(k,w%y.EXTENT,D%y.EXTENT,y.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const u=this.pointLocation(this.centerPoint,s),p=this.getElevation(u,s);if(!(this.elevation-p))return;const _=this.getCameraPosition(),w=y.MercatorCoordinate.fromLngLat(_.lngLat,_.altitude),D=y.MercatorCoordinate.fromLngLat(u,p),M=w.x-D.x,I=w.y-D.y,k=w.z-D.z,O=Math.sqrt(M*M+I*I+k*k),F=this.scaleZoom(this.cameraToCenterDistance/O/this.tileSize);this._elevation=p,this._center=u,this.zoom=F}setLocationAtPoint(s,u){const p=this.pointCoordinate(u),_=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(s),D=new y.MercatorCoordinate(w.x-(p.x-_.x),w.y-(p.y-_.y));this.center=this.coordinateLocation(D),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,u){return u?this.coordinatePoint(this.locationCoordinate(s),this.getElevation(s,u),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,u){return this.coordinateLocation(this.pointCoordinate(s,u))}locationCoordinate(s){return y.MercatorCoordinate.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,u){if(u){const j=u.pointCoordinate(s);if(null!=j)return j}const p=[s.x,s.y,0,1],_=[s.x,s.y,1,1];y.transformMat4(p,p,this.pixelMatrixInverse),y.transformMat4(_,_,this.pixelMatrixInverse);const w=p[3],D=_[3],M=p[1]/w,I=_[1]/D,k=p[2]/w,O=_[2]/D,F=k===O?0:(0-k)/(O-k);return new y.MercatorCoordinate(y.interpolate.number(p[0]/w,_[0]/D,F)/this.worldSize,y.interpolate.number(M,I,F)/this.worldSize)}coordinatePoint(s,u=0,p=this.pixelMatrix){const _=[s.x*this.worldSize,s.y*this.worldSize,u,1];return y.transformMat4(_,_,p),new y.Point(_[0]/_[3],_[1]/_[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return(new Ft).extend(this.pointLocation(new y.Point(0,s))).extend(this.pointLocation(new y.Point(this.width,s))).extend(this.pointLocation(new y.Point(this.width,this.height))).extend(this.pointLocation(new y.Point(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Ft([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,u=!1){const p=s.key,_=u?this._alignedPosMatrixCache:this._posMatrixCache;if(_[p])return _[p];const w=s.canonical,D=this.worldSize/this.zoomScale(w.z),M=w.x+Math.pow(2,w.z)*s.wrap,I=y.identity(new Float64Array(16));return y.translate(I,I,[M*D,w.y*D,0]),y.scale(I,I,[D/y.EXTENT,D/y.EXTENT,1]),y.multiply(I,u?this.alignedProjMatrix:this.projMatrix,I),_[p]=new Float32Array(I),_[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s,u,p,_,w=-90,D=90,M=-180,I=180;const k=this.size,O=this._unmodified;if(this.latRange){const X=this.latRange;w=y.mercatorYfromLat(X[1])*this.worldSize,D=y.mercatorYfromLat(X[0])*this.worldSize,s=D-w<k.y?k.y/(D-w):0}if(this.lngRange){const X=this.lngRange;M=y.wrap(y.mercatorXfromLng(X[0])*this.worldSize,0,this.worldSize),I=y.wrap(y.mercatorXfromLng(X[1])*this.worldSize,0,this.worldSize),I<M&&(I+=this.worldSize),u=I-M<k.x?k.x/(I-M):0}const F=this.point,j=Math.max(u||0,s||0);if(j)return this.center=this.unproject(new y.Point(u?(I+M)/2:F.x,s?(D+w)/2:F.y)),this.zoom+=this.scaleZoom(j),this._unmodified=O,void(this._constraining=!1);if(this.latRange){const X=F.y,q=k.y/2;X-q<w&&(_=w+q),X+q>D&&(_=D-q)}if(this.lngRange){const X=(M+I)/2,q=y.wrap(F.x,X-this.worldSize/2,X+this.worldSize/2),Z=k.x/2;q-Z<M&&(p=M+Z),q+Z>I&&(p=I-Z)}void 0===p&&void 0===_||(this.center=this.unproject(new y.Point(void 0!==p?p:F.x,void 0!==_?_:F.y)).wrap()),this._unmodified=O,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,u=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=y.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let _=y.identity(new Float64Array(16));y.scale(_,_,[this.width/2,-this.height/2,1]),y.translate(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=y.identity(new Float64Array(16)),y.scale(_,_,[1,-1,1]),y.translate(_,_,[-1,-1,0]),y.scale(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const w=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,D=Math.PI/2+this._pitch,M=this._fov*(.5+s.y/this.height),I=Math.sin(M)*w/Math.sin(y.clamp(Math.PI-D-M,.01,Math.PI-.01)),k=this.getHorizon(),O=2*Math.atan(k/this.cameraToCenterDistance)*(.5+s.y/(2*k)),F=Math.sin(O)*w/Math.sin(y.clamp(Math.PI-D-O,.01,Math.PI-.01)),j=Math.min(I,F),X=1.01*(Math.cos(Math.PI/2-this._pitch)*j+w),q=this.height/50;_=new Float64Array(16),y.perspective(_,this._fov,this.width/this.height,q,X),_[8]=2*-s.x/this.width,_[9]=2*s.y/this.height,y.scale(_,_,[1,-1,1]),y.translate(_,_,[0,0,-this.cameraToCenterDistance]),y.rotateX(_,_,this._pitch),y.rotateZ(_,_,this.angle),y.translate(_,_,[-u,-p,0]),this.mercatorMatrix=y.scale([],_,[this.worldSize,this.worldSize,this.worldSize]),y.scale(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=y.multiply(new Float64Array(16),this.labelPlaneMatrix,_),y.translate(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=y.invert([],_),this.pixelMatrix3D=y.multiply(new Float64Array(16),this.labelPlaneMatrix,_);const Z=this.width%2/2,te=this.height%2/2,le=Math.cos(this.angle),fe=Math.sin(this.angle),J=u-Math.round(u)+le*Z+fe*te,pe=p-Math.round(p)+le*te+fe*Z,ye=new Float64Array(_);if(y.translate(ye,ye,[J>.5?J-1:J,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=ye,_=y.invert(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new y.Point(0,0)),u=[s.x*this.worldSize,s.y*this.worldSize,0,1];return y.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new y.Point(0,s))}getCameraQueryGeometry(s){const u=this.getCameraPoint();if(1===s.length)return[s[0],u];{let p=u.x,_=u.y,w=u.x,D=u.y;for(const M of s)p=Math.min(p,M.x),_=Math.min(_,M.y),w=Math.max(w,M.x),D=Math.max(D,M.y);return[new y.Point(p,_),new y.Point(w,_),new y.Point(w,D),new y.Point(p,D),new y.Point(p,_)]}}}class ad{constructor(s){this._hashName=s&&encodeURIComponent(s),y.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(u,p){let _=!1,w=null;const D=()=>{w=null,_&&(u(),w=setTimeout(D,300),_=!1)};return()=>(_=!0,w||D(),w)}(this._updateHashUnthrottled.bind(this))}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const u=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),D=Math.round(u.lng*w)/w,M=Math.round(u.lat*w)/w,I=this._map.getBearing(),k=this._map.getPitch();let O="";if(O+=s?`/${D}/${M}/${p}`:`${p}/${M}/${D}`,(I||k)&&(O+="/"+Math.round(10*I)/10),k&&(O+=`/${Math.round(k)}`),this._hashName){const F=this._hashName;let j=!1;const X=window.location.hash.slice(1).split("&").map(q=>{const Z=q.split("=")[0];return Z===F?(j=!0,`${Z}=${O}`):q}).filter(q=>q);return j||X.push(`${F}=${O}`),`#${X.join("&")}`}return`#${O}`}_getCurrentHash(){const s=window.location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(u=p)}),(u&&u[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._getCurrentHash();if(s.length>=3&&!s.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:u,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const s=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,s)}catch{}}}const _l={linearity:.3,easing:y.bezier(0,0,.3,1)},Yc=y.extend({deceleration:2500,maxSpeed:1400},_l),ld=y.extend({deceleration:20,maxSpeed:1400},_l),yl=y.extend({deceleration:1e3,maxSpeed:360},_l),vl=y.extend({deceleration:1e3,maxSpeed:90},_l);class Oo{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:y.exported.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=y.exported.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new y.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(u.pan.mag()){const w=nc(u.pan.mag(),p,y.extend({},Yc,s||{}));_.offset=u.pan.mult(w.amount/u.pan.mag()),_.center=this._map.transform.center,Qr(_,w)}if(u.zoom){const w=nc(u.zoom,p,ld);_.zoom=this._map.transform.zoom+w.amount,Qr(_,w)}if(u.bearing){const w=nc(u.bearing,p,yl);_.bearing=this._map.transform.bearing+y.clamp(w.amount,-179,179),Qr(_,w)}if(u.pitch){const w=nc(u.pitch,p,vl);_.pitch=this._map.transform.pitch+w.amount,Qr(_,w)}if(_.zoom||_.bearing){const w=void 0===u.pinchAround?u.around:u.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),y.extend(_,{noMoveStart:!0})}}function Qr(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function nc(m,s,u){const{maxSpeed:p,linearity:_,deceleration:w}=u,D=y.clamp(m*_/(s/1e3),-p,p),M=Math.abs(D)/(w*_);return{easing:u.easing,duration:1e3*M,amount:D*(M/2)}}class ui extends y.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,p,_={}){const w=be.mousePos(u.getCanvasContainer(),p),D=u.unproject(w);super(s,y.extend({point:w,lngLat:D,originalEvent:p},_)),this._defaultPrevented=!1,this.target=u}}class ia extends y.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,p){const _="touchend"===s?p.changedTouches:p.touches,w=be.touchPos(u.getCanvasContainer(),_),D=w.map(I=>u.unproject(I)),M=w.reduce((I,k,O,F)=>I.add(k.div(F.length)),new y.Point(0,0));super(s,{points:w,point:M,lngLats:D,lngLat:u.unproject(M),originalEvent:p}),this._defaultPrevented=!1}}class jp extends y.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,p){super(s,{originalEvent:p}),this._defaultPrevented=!1}}class Lo{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new jp(s.type,this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new ui(s.type,this._map,s))}mouseup(s){this._map.fire(new ui(s.type,this._map,s))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new ui(s.type,this._map,s))}dblclick(s){return this._firePreventable(new ui(s.type,this._map,s))}mouseover(s){this._map.fire(new ui(s.type,this._map,s))}mouseout(s){this._map.fire(new ui(s.type,this._map,s))}touchstart(s){return this._firePreventable(new ia(s.type,this._map,s))}touchmove(s){this._map.fire(new ia(s.type,this._map,s))}touchend(s){this._map.fire(new ia(s.type,this._map,s))}touchcancel(s){this._map.fire(new ia(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hp{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new ui(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new ui(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class za{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(y.Point.convert(s),this._map.terrain)}}class ic{constructor(s,u){this._map=s,this._tr=new za(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&0===s.button&&(be.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const p=u;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=p,this._box||(this._box=be.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const w=Math.min(_.x,p.x),D=Math.max(_.x,p.x),M=Math.min(_.y,p.y),I=Math.max(_.y,p.y);be.setTransform(this._box,`translate(${w}px,${M}px)`),this._box.style.width=D-w+"px",this._box.style.height=I-M+"px"}mouseupWindow(s,u){if(!this._active||0!==s.button)return;const p=this._startPos,_=u;if(this.reset(),be.suppressClick(),p.x!==_.x||p.y!==_.y)return this._map.fire(new y.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:w=>w.fitScreenCoordinates(p,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&27===s.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(be.remove(this._box),this._box=null),be.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new y.Event(s,{originalEvent:u}))}}function ts(m,s){if(m.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${s.length}`);const u={};for(let p=0;p<m.length;p++)u[m[p].identifier]=s[p];return u}class Je{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,u,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=s.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const w=new y.Point(0,0);for(const D of _)w._add(D);return w.div(_.length)}(u),this.touches=ts(p,u)))}touchmove(s,u,p){if(this.aborted||!this.centroid)return;const _=ts(p,u);for(const w in this.touches){const D=_[w];(!D||D.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(s,u,p){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Qc{constructor(s){this.singleTap=new Je(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,u,p){this.singleTap.touchstart(s,u,p)}touchmove(s,u,p){this.singleTap.touchmove(s,u,p)}touchend(s,u,p){const _=this.singleTap.touchend(s,u,p);if(_){const w=s.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(_)<30;if(w&&D||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class bl{constructor(s){this._tr=new za(s),this._zoomIn=new Qc({numTouches:1,numTaps:2}),this._zoomOut=new Qc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,p){this._zoomIn.touchstart(s,u,p),this._zoomOut.touchstart(s,u,p)}touchmove(s,u,p){this._zoomIn.touchmove(s,u,p),this._zoomOut.touchmove(s,u,p)}touchend(s,u,p){const _=this._zoomIn.touchend(s,u,p),w=this._zoomOut.touchend(s,u,p),D=this._tr;return _?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:D.zoom+1,around:D.unproject(_)},{originalEvent:s})}):w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:D.zoom-1,around:D.unproject(w)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ss{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const u=this._moveFunction(...s);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(s,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,u){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const _=u.length?u[0]:u;return!this._moved&&_.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(p,_))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&be.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const wh={0:1,2:2};class Xe{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const u=be.mouseButton(s);this._eventButton=u}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(u,p){const _=wh[p];return void 0===u.buttons||(u.buttons&_)!==_}(s,this._eventButton)}isValidEndEvent(s){return be.mouseButton(s)===this._eventButton}}class Di{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return 1===s.targetTouches.length}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const cd=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=function(s){s.preventDefault()}},Eh=({enable:m,clickTolerance:s,bearingDegreesPerPixelMoved:u=.8})=>{const p=new Xe({checkCorrectEvent:_=>0===be.mouseButton(_)&&_.ctrlKey||2===be.mouseButton(_)});return new Ss({clickTolerance:s,move:(_,w)=>({bearingDelta:(w.x-_.x)*u}),moveStateManager:p,enable:m,assignEvents:cd})},Jc=({enable:m,clickTolerance:s,pitchDegreesPerPixelMoved:u=-.5})=>{const p=new Xe({checkCorrectEvent:_=>0===be.mouseButton(_)&&_.ctrlKey||2===be.mouseButton(_)});return new Ss({clickTolerance:s,move:(_,w)=>({pitchDelta:(w.y-_.y)*u}),moveStateManager:p,enable:m,assignEvents:cd})};class di{constructor(s,u){this._minTouches=s.cooperativeGestures?2:1,this._clickTolerance=s.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new y.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(s,u,p){return this._calculateTransform(s,u,p)}touchmove(s,u,p){if(this._map._cooperativeGestures&&(2===this._minTouches&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(s,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,u,p)}touchend(s,u,p){this._calculateTransform(s,u,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,p){p.length>0&&(this._active=!0);const _=ts(p,u),w=new y.Point(0,0),D=new y.Point(0,0);let M=0;for(const k in _){const O=_[k],F=this._touches[k];F&&(w._add(O),D._add(O.sub(F)),M++,_[k]=O)}if(this._touches=_,M<this._minTouches||!D.mag())return;const I=D.div(M);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(M),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(s){}_move(s,u,p){return{}}touchstart(s,u,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,p){if(!this._firstTwoTouches)return;s.preventDefault();const[_,w]=this._firstTwoTouches,D=rc(p,u,_),M=rc(p,u,w);if(!D||!M)return;const I=this._aroundCenter?null:D.add(M).div(2);return this._move([D,M],I,s)}touchend(s,u,p){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,D=rc(p,u,_),M=rc(p,u,w);D&&M||(this._active&&be.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&"center"===s.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function rc(m,s,u){for(let p=0;p<m.length;p++)if(m[p].identifier===u)return s[p]}function mt(m,s){return Math.log(m/s)/Math.LN2}class hr extends eu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const p=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(mt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mt(this._distance,p),pinchAround:u}}}function Kt(m,s){return 180*m.angleWith(s)/Math.PI}class Si extends eu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u){const p=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Kt(this._vector,p),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,p=Kt(s,this._startVector);return Math.abs(p)<u}}function Ii(m){return Math.abs(m.y)>Math.abs(m.x)}class Bi extends eu{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,u,p){super.touchstart(s,u,p),this._currentTouchCount=p.length}_start(s){this._lastPoints=s,Ii(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const _=s[0].sub(this._lastPoints[0]),w=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,w,p.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(_.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(s,u,p){if(void 0!==this._valid)return this._valid;const _=s.mag()>=2,w=u.mag()>=2;if(!_&&!w)return;if(!_||!w)return void 0===this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const D=s.y>0==u.y>0;return Ii(s)&&Ii(u)&&D}}const vi={panStep:100,bearingStep:15,pitchStep:10};class ud{constructor(s){this._tr=new za(s);const u=vi;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,p=0,_=0,w=0,D=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?p=-1:(s.preventDefault(),w=-1);break;case 39:s.shiftKey?p=1:(s.preventDefault(),w=1);break;case 38:s.shiftKey?_=1:(s.preventDefault(),D=-1);break;case 40:s.shiftKey?_=-1:(s.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:M=>{const I=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:tu,zoom:u?Math.round(I.zoom)+u*(s.shiftKey?2:1):I.zoom,bearing:I.bearing+p*this._bearingStep,pitch:I.pitch+_*this._pitchStep,offset:[-w*this._panStep,-D*this._panStep],center:I.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tu(m){return m*(2-m)}const Va=4.000244140625;class dd{constructor(s,u){this._map=s,this._tr=new za(s),this._el=s.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,y.bindAll(["_onTimeout"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&"center"===s.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!s[this._map._metaKey])return;s.preventDefault()}let u=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const p=y.exported.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==u&&u%Va==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(_*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=be.mousePos(this._el,s),p=this._tr;this._around=y.LngLat.convert(this._aroundCenter?p.center:p.unproject(u)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(0!==this._delta){const M="wheel"===this._type&&Math.abs(this._delta)>Va?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&0!==I&&(I=1/I);const k="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(k*I))),"wheel"===this._type&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u="number"==typeof this._targetZoom?this._targetZoom:s.zoom,p=this._startZoom,_=this._easing;let w,D=!1;if("wheel"===this._type&&p&&_){const M=Math.min((y.exported.now()-this._lastWheelEventTime)/200,1),I=_(M);w=y.interpolate.number(p,u,I),M<1?this._frameId||(this._frameId=!0):D=!0}else w=u,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=y.ease;if(this._prevEase){const p=this._prevEase,_=(y.exported.now()-p.start)/p.duration,w=p.easing(_+.01)-p.easing(_),D=.27/Math.sqrt(w*w+1e-4)*.01,M=Math.sqrt(.0729-D*D);u=y.bezier(D,M,.25,1)}return this._prevEase={start:y.exported.now(),duration:s,easing:u},u}reset(){this._active=!1}}class Ch{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class cn{constructor(s){this._tr=new za(s),this.reset()}reset(){this._active=!1}dblclick(s,u){return s.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Le{constructor(){this._tap=new Qc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(s,u,p){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=u[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(s,u,p))}touchmove(s,u,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=u[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,s.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(s,u,p)}touchend(s,u,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(s,u,p)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pt{constructor(s,u,p){this._el=s,this._mousePan=u,this._touchPan=p}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nn{constructor(s,u,p){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=u,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class mo{constructor(s,u,p,_){this._el=s,this._touchZoom=u,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Is=m=>m.zoom||m.drag||m.pitch||m.rotate;class Ji extends y.Event{}function ra(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class vn{constructor(s,u){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Oo(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u),y.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,w,D]of this._listeners)be.addEventListener(_,w,_===document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[s,u,p]of this._listeners)be.removeEventListener(s,u,s===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(s){const u=this._map,p=u.getCanvasContainer();this._add("mapEvent",new Lo(u,s));const _=u.boxZoom=new ic(u,s);this._add("boxZoom",_);const w=new bl(u),D=new cn(u);u.doubleClickZoom=new Ch(D,w),this._add("tapZoom",w),this._add("clickZoom",D);const M=new Le;this._add("tapDragZoom",M);const I=u.touchPitch=new Bi(u);this._add("touchPitch",I);const k=Eh(s),O=Jc(s);u.dragRotate=new Nn(s,k,O),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const F=(({enable:le,clickTolerance:fe})=>{const J=new Xe({checkCorrectEvent:pe=>0===be.mouseButton(pe)&&!pe.ctrlKey});return new Ss({clickTolerance:fe,move:(pe,ye)=>({around:ye,panDelta:ye.sub(pe)}),activateOnStart:!0,moveStateManager:J,enable:le,assignEvents:cd})})(s),j=new di(s,u);u.dragPan=new Pt(p,F,j),this._add("mousePan",F),this._add("touchPan",j,["touchZoom","touchRotate"]);const X=new Si,q=new hr;u.touchZoomRotate=new mo(p,q,X,M),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",q,["touchPan","touchRotate"]);const Z=u.scrollZoom=new dd(u,this);this._add("scrollZoom",Z,["mousePan"]);const te=u.keyboard=new ud(u);this._add("keyboard",te),this._add("blockableMapEvent",new Hp(u));for(const le of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[le]&&u[le].enable(s[le])}_add(s,u,p){this._handlers.push({handlerName:s,handler:u,allowed:p}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Is(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,u,p){for(const _ in s)if(_!==p&&(!u||u.indexOf(_)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const u=[];for(const p of s)this._el.contains(p.target)&&u.push(p);return u}handleEvent(s,u){if("blur"===s.type)return void this.stop(!0);this._updatingCamera=!0;const p="renderFrame"===s.type?void 0:s,_={needsRenderFrame:!1},w={},D={},M=s.touches,I=M?this._getMapTouches(M):void 0,k=I?be.touchPos(this._el,I):be.mousePos(this._el,s);for(const{handlerName:j,handler:X,allowed:q}of this._handlers){if(!X.isEnabled())continue;let Z;this._blockedByActive(D,q,j)?X.reset():X[u||s.type]&&(Z=X[u||s.type](s,k,I),this.mergeHandlerResult(_,w,Z,j,p),Z&&Z.needsRenderFrame&&this._triggerRenderFrame()),(Z||X.isActive())&&(D[j]=X)}const O={};for(const j in this._previousActiveHandlers)D[j]||(O[j]=p);this._previousActiveHandlers=D,(Object.keys(O).length||ra(_))&&(this._changes.push([_,w,O]),this._triggerRenderFrame()),(Object.keys(D).length||ra(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:F}=_;F&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],F(this._map))}mergeHandlerResult(s,u,p,_,w){if(!p)return;y.extend(s,p);const D={handlerName:_,originalEvent:p.originalEvent||w};void 0!==p.zoomDelta&&(u.zoom=D),void 0!==p.panDelta&&(u.drag=D),void 0!==p.pitchDelta&&(u.pitch=D),void 0!==p.bearingDelta&&(u.rotate=D)}_applyChanges(){const s={},u={},p={};for(const[_,w,D]of this._changes)_.panDelta&&(s.panDelta=(s.panDelta||new y.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+_.pitchDelta),void 0!==_.around&&(s.around=_.around),void 0!==_.pinchAround&&(s.pinchAround=_.pinchAround),_.noInertia&&(s.noInertia=_.noInertia),y.extend(u,w),y.extend(p,D);this._updateMapTransform(s,u,p),this._changes=[]}_updateMapTransform(s,u,p){const _=this._map,w=_._getTransformForUpdate(),D=_.terrain;if(!(ra(s)||D&&this._terrainMovement))return this._fireEvents(u,p,!0);let{panDelta:M,zoomDelta:I,bearingDelta:k,pitchDelta:O,around:F,pinchAround:j}=s;void 0!==j&&(F=j),_._stop(!0),F=F||_.transform.centerPoint;const X=w.pointLocation(M?F.sub(M):F);k&&(w.bearing+=k),O&&(w.pitch+=O),I&&(w.zoom+=I),D?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?w.center=w.pointLocation(w.centerPoint.sub(M)):w.setLocationAtPoint(X,F):(this._terrainMovement=!0,w.freezeElevation=!0,w.setLocationAtPoint(X,F),this._map.once("moveend",()=>{w.freezeElevation=!1,this._terrainMovement=!1,w.recalculateZoom(_.terrain)})):w.setLocationAtPoint(X,F),_._applyUpdatedTransform(w),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,p,!0)}_fireEvents(s,u,p){const _=Is(this._eventsInProgress),w=Is(s),D={};for(const O in s){const{originalEvent:F}=s[O];this._eventsInProgress[O]||(D[`${O}start`]=F),this._eventsInProgress[O]=s[O]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const O in D)this._fireEvent(O,D[O]);w&&this._fireEvent("move",w.originalEvent);for(const O in s){const{originalEvent:F}=s[O];this._fireEvent(O,F)}const M={};let I;for(const O in this._eventsInProgress){const{handlerName:F,originalEvent:j}=this._eventsInProgress[O];this._handlersById[F].isActive()||(delete this._eventsInProgress[O],I=u[F]||j,M[`${O}end`]=I)}for(const O in M)this._fireEvent(O,M[O]);const k=Is(this._eventsInProgress);if(p&&(_||w)&&!k){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=j=>0!==j&&-this._bearingSnap<j&&j<this._bearingSnap;O?(F(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:I})):(this._map.fire(new y.Event("moveend",{originalEvent:I})),F(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new y.Event(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new Ji("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const No={extend:(m,...s)=>y.extend(m,...s),run(m){m()},logToElement(m,s=!1,u="log"){const p=window.document.getElementById(u);p&&(s&&(p.innerHTML=""),p.innerHTML+=`<br>${m}`)}};class et extends y.Evented{constructor(s,u){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=u.bearingSnap,y.bindAll(["_renderFrameCallback"],this),this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new y.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}panBy(s,u,p){return s=y.Point.convert(s).mult(-1),this.panTo(this.transform.center,y.extend({offset:s},u),p)}panTo(s,u,p){return this.easeTo(y.extend({center:s},u),p)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,p){return this.easeTo(y.extend({zoom:s},u),p)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,p){return this.easeTo(y.extend({bearing:s},u),p)}resetNorth(s,u){return this.rotateTo(0,y.extend({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(y.extend({bearing:0,pitch:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}cameraForBounds(s,u){s=Ft.convert(s);const p=u&&u.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),p,u)}_cameraForBoxAndBearing(s,u,p,_){const w={top:0,bottom:0,right:0,left:0};if("number"==typeof(_=y.extend({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding){const ye=_.padding;_.padding={top:ye,bottom:ye,right:ye,left:ye}}_.padding=y.extend(w,_.padding);const D=this.transform,M=D.padding,I=D.project(y.LngLat.convert(s)),k=D.project(y.LngLat.convert(u)),O=I.rotate(-p*Math.PI/180),F=k.rotate(-p*Math.PI/180),j=new y.Point(Math.max(O.x,F.x),Math.max(O.y,F.y)),X=new y.Point(Math.min(O.x,F.x),Math.min(O.y,F.y)),q=j.sub(X),Z=(D.width-(M.left+M.right+_.padding.left+_.padding.right))/q.x,te=(D.height-(M.top+M.bottom+_.padding.top+_.padding.bottom))/q.y;if(te<0||Z<0)return void y.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const le=Math.min(D.scaleZoom(D.scale*Math.min(Z,te)),_.maxZoom),fe=y.Point.convert(_.offset),J=new y.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(p*Math.PI/180),pe=fe.add(J).mult(D.scale/D.zoomScale(le));return{center:D.unproject(I.add(k).div(2).sub(pe)),zoom:le,bearing:p}}fitBounds(s,u,p){return this._fitInternal(this.cameraForBounds(s,u),u,p)}fitScreenCoordinates(s,u,p,_,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(y.Point.convert(s)),this.transform.pointLocation(y.Point.convert(u)),p,_),_,w)}_fitInternal(s,u,p){return s?(delete(u=y.extend(s,u)).padding,u.linear?this.easeTo(u,p):this.flyTo(u,p)):this}jumpTo(s,u){this.stop();const p=this._getTransformForUpdate();let _=!1,w=!1,D=!1;return"zoom"in s&&p.zoom!==+s.zoom&&(_=!0,p.zoom=+s.zoom),void 0!==s.center&&(p.center=y.LngLat.convert(s.center)),"bearing"in s&&p.bearing!==+s.bearing&&(w=!0,p.bearing=+s.bearing),"pitch"in s&&p.pitch!==+s.pitch&&(D=!0,p.pitch=+s.pitch),null==s.padding||p.isPaddingEqual(s.padding)||(p.padding=s.padding),this._applyUpdatedTransform(p),this.fire(new y.Event("movestart",u)).fire(new y.Event("move",u)),_&&this.fire(new y.Event("zoomstart",u)).fire(new y.Event("zoom",u)).fire(new y.Event("zoomend",u)),w&&this.fire(new y.Event("rotatestart",u)).fire(new y.Event("rotate",u)).fire(new y.Event("rotateend",u)),D&&this.fire(new y.Event("pitchstart",u)).fire(new y.Event("pitch",u)).fire(new y.Event("pitchend",u)),this.fire(new y.Event("moveend",u))}calculateCameraOptionsFromTo(s,u,p,_=0){const w=y.MercatorCoordinate.fromLngLat(s,u),D=y.MercatorCoordinate.fromLngLat(p,_),M=D.x-w.x,I=D.y-w.y,k=D.z-w.z,O=Math.hypot(M,I,k);if(0===O)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(M,I),j=this.transform.scaleZoom(this.transform.cameraToCenterDistance/O/this.transform.tileSize),X=180*Math.atan2(M,-I)/Math.PI;let q=180*Math.acos(F/O)/Math.PI;return q=k<0?90-q:90+q,{center:D.toLngLat(),zoom:j,pitch:q,bearing:X}}easeTo(s,u){this._stop(!1,s.easeId),(!1===(s=y.extend({offset:[0,0],duration:500,easing:y.ease},s)).animate||!s.essential&&y.exported.prefersReducedMotion)&&(s.duration=0);const p=this._getTransformForUpdate(),_=this.getZoom(),w=this.getBearing(),D=this.getPitch(),M=this.getPadding(),I="zoom"in s?+s.zoom:_,k="bearing"in s?this._normalizeBearing(s.bearing,w):w,O="pitch"in s?+s.pitch:D,F="padding"in s?s.padding:p.padding,j=y.Point.convert(s.offset);let X=p.centerPoint.add(j);const q=p.pointLocation(X),Z=y.LngLat.convert(s.center||q);this._normalizeCenter(Z);const te=p.project(q),le=p.project(Z).sub(te),fe=p.zoomScale(I-_);let J,pe;s.around&&(J=y.LngLat.convert(s.around),pe=p.locationPoint(J));const ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||I!==_,this._rotating=this._rotating||w!==k,this._pitching=this._pitching||O!==D,this._padding=!p.isPaddingEqual(F),this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,ye),this.terrain&&this._prepareElevation(Z),this._ease(De=>{if(this._zooming&&(p.zoom=y.interpolate.number(_,I,De)),this._rotating&&(p.bearing=y.interpolate.number(w,k,De)),this._pitching&&(p.pitch=y.interpolate.number(D,O,De)),this._padding&&(p.interpolatePadding(M,F,De),X=p.centerPoint.add(j)),this.terrain&&!s.freezeElevation&&this._updateElevation(De),J)p.setLocationAtPoint(J,pe);else{const Ae=p.zoomScale(p.zoom-_),Ne=I>_?Math.min(2,fe):Math.max(.5,fe),ke=Math.pow(Ne,1-De),Be=p.unproject(te.add(le.mult(De*ke)).mult(Ae));p.setLocationAtPoint(p.renderWorldCopies?Be.wrap():Be,X)}this._applyUpdatedTransform(p),this._fireMoveEvents(u)},De=>{this.terrain&&this._finalizeElevation(),this._afterEase(u,De)},s),this}_prepareEase(s,u,p={}){this._moving=!0,u||p.moving||this.fire(new y.Event("movestart",s)),this._zooming&&!p.zooming&&this.fire(new y.Event("zoomstart",s)),this._rotating&&!p.rotating&&this.fire(new y.Event("rotatestart",s)),this._pitching&&!p.pitching&&this.fire(new y.Event("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(s,this.terrain),this.transform.freezeElevation=!0}_updateElevation(s){const u=this.transform.getElevation(this._elevationCenter,this.terrain);if(s<1&&u!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(p-(u-(p*s+this._elevationStart))/(1-s)),this._elevationTarget=u}this.transform.elevation=y.interpolate.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const u=s.clone(),{center:p,zoom:_,pitch:w,bearing:D,elevation:M}=this.transformCameraUpdate(u);p&&(u.center=p),void 0!==_&&(u.zoom=_),void 0!==w&&(u.pitch=w),void 0!==D&&(u.bearing=D),void 0!==M&&(u.elevation=M),this.transform.apply(u)}_fireMoveEvents(s){this.fire(new y.Event("move",s)),this._zooming&&this.fire(new y.Event("zoom",s)),this._rotating&&this.fire(new y.Event("rotate",s)),this._pitching&&this.fire(new y.Event("pitch",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const p=this._zooming,_=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new y.Event("zoomend",s)),_&&this.fire(new y.Event("rotateend",s)),w&&this.fire(new y.Event("pitchend",s)),this.fire(new y.Event("moveend",s))}flyTo(s,u){if(!s.essential&&y.exported.prefersReducedMotion){const Ye=y.pick(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ye,u)}this.stop(),s=y.extend({offset:[0,0],speed:1.2,curve:1.42,easing:y.ease},s);const p=this._getTransformForUpdate(),_=this.getZoom(),w=this.getBearing(),D=this.getPitch(),M=this.getPadding(),I="zoom"in s?y.clamp(+s.zoom,p.minZoom,p.maxZoom):_,k="bearing"in s?this._normalizeBearing(s.bearing,w):w,O="pitch"in s?+s.pitch:D,F="padding"in s?s.padding:p.padding,j=p.zoomScale(I-_),X=y.Point.convert(s.offset);let q=p.centerPoint.add(X);const Z=p.pointLocation(q),te=y.LngLat.convert(s.center||Z);this._normalizeCenter(te);const le=p.project(Z),fe=p.project(te).sub(le);let J=s.curve;const pe=Math.max(p.width,p.height),ye=pe/j,De=fe.mag();if("minZoom"in s){const Ye=y.clamp(Math.min(s.minZoom,_,I),p.minZoom,p.maxZoom),tn=pe/p.zoomScale(Ye-_);J=Math.sqrt(tn/De*2)}const Ae=J*J;function Ne(Ye){const tn=(ye*ye-pe*pe+(Ye?-1:1)*Ae*Ae*De*De)/(2*(Ye?ye:pe)*Ae*De);return Math.log(Math.sqrt(tn*tn+1)-tn)}function ke(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function Be(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const ot=Ne(0);let gt=function(Ye){return Be(ot)/Be(ot+J*Ye)},He=function(Ye){return pe*((Be(ot)*(ke(tn=ot+J*Ye)/Be(tn))-ke(ot))/Ae)/De;var tn},yt=(Ne(1)-ot)/J;if(Math.abs(De)<1e-6||!isFinite(yt)){if(Math.abs(pe-ye)<1e-6)return this.easeTo(s,u);const Ye=ye<pe?-1:1;yt=Math.abs(Math.log(ye/pe))/J,He=function(){return 0},gt=function(tn){return Math.exp(Ye*J*tn)}}return s.duration="duration"in s?+s.duration:1e3*yt/("screenSpeed"in s?+s.screenSpeed/J:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=w!==k,this._pitching=O!==D,this._padding=!p.isPaddingEqual(F),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(te),this._ease(Ye=>{const tn=Ye*yt,Jn=1/gt(tn);p.zoom=1===Ye?I:_+p.scaleZoom(Jn),this._rotating&&(p.bearing=y.interpolate.number(w,k,Ye)),this._pitching&&(p.pitch=y.interpolate.number(D,O,Ye)),this._padding&&(p.interpolatePadding(M,F,Ye),q=p.centerPoint.add(X)),this.terrain&&!s.freezeElevation&&this._updateElevation(Ye);const nn=1===Ye?te:p.unproject(le.add(fe.mult(He(tn))).mult(Jn));p.setLocationAtPoint(p.renderWorldCopies?nn.wrap():nn,q),this._applyUpdatedTransform(p),this._fireMoveEvents(u)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(u)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,u)}if(!s){const p=this.handlers;p&&p.stop(!1)}return this}_ease(s,u,p){!1===p.animate||0===p.duration?(s(1),u()):(this._easeStart=y.exported.now(),this._easeOptions=p,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((y.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,u){s=y.wrap(s,-180,180);const p=Math.abs(s-u);return Math.abs(s-360-u)<p&&(s-=360),Math.abs(s+360-u)<p&&(s+=360),s}_normalizeCenter(s){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const p=s.lng-u.center.lng;s.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(s){return this.terrain?this.transform.getElevation(y.LngLat.convert(s),this.terrain)-this.transform.elevation:null}}class Fe{constructor(s={}){this.options=s,y.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options&&this.options.compact,this._container=be.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=be.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=be.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){be.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,u){const p=this._map._getUIString(`AttributionControl.${u}`);s.title=p,s.setAttribute("aria-label",p)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(s){!s||"metadata"!==s.sourceDataType&&"visibility"!==s.sourceDataType&&"style"!==s.dataType&&"terrain"!==s.type||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(_=>"string"!=typeof _?"":_)):"string"==typeof this.options.customAttribution&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const u=this._map.style.sourceCaches;for(const _ in u){const w=u[_];if(w.used||w.usedForTerrain){const D=w.getSource();D.attribution&&s.indexOf(D.attribution)<0&&s.push(D.attribution)}}s=s.filter(_=>String(_).trim()),s.sort((_,w)=>_.length-w.length),s=s.filter((_,w)=>{for(let D=w+1;D<s.length;D++)if(s[D].indexOf(_)>=0)return!1;return!0});const p=s.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,s.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class Ms{constructor(s={}){this.options=s,y.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=be.create("div","maplibregl-ctrl");const u=be.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){be.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}}}class nu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,p=u?this._queue.concat(u):this._queue;for(const _ of p)if(_.id===s)return void(_.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const p of u)if(!p.cancelled&&(p.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const oa={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var sn=y.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class xl extends y.Evented{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,u){this.sourceCache.update(s,u),this._renderableTilesKeys=[];const p={};for(const _ of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))p[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),y.ortho(_.posMatrix,0,y.EXTENT,0,y.EXTENT,0,1),this._tiles[_.key]=new sl(_,this.tileSize));for(const _ in this._tiles)p[_]||delete this._tiles[_]}freeRtt(s){for(const u in this._tiles){const p=this._tiles[u];(!s||p.tileID.equals(s)||p.tileID.isChildOf(s)||s.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const u={};for(const p of this._renderableTilesKeys){const _=this._tiles[p].tileID;if(_.canonical.equals(s.canonical)){const w=s.clone();w.posMatrix=new Float64Array(16),y.ortho(w.posMatrix,0,y.EXTENT,0,y.EXTENT,0,1),u[p]=w}else if(_.canonical.isChildOf(s.canonical)){const w=s.clone();w.posMatrix=new Float64Array(16);const D=_.canonical.z-s.canonical.z,M=_.canonical.x-(_.canonical.x>>D<<D),I=_.canonical.y-(_.canonical.y>>D<<D),k=y.EXTENT>>D;y.ortho(w.posMatrix,0,k,0,k,0,1),y.translate(w.posMatrix,w.posMatrix,[-M*k,-I*k,0]),u[p]=w}else if(s.canonical.isChildOf(_.canonical)){const w=s.clone();w.posMatrix=new Float64Array(16);const D=s.canonical.z-_.canonical.z,M=s.canonical.x-(s.canonical.x>>D<<D),I=s.canonical.y-(s.canonical.y>>D<<D),k=y.EXTENT>>D;y.ortho(w.posMatrix,0,y.EXTENT,0,y.EXTENT,0,1),y.translate(w.posMatrix,w.posMatrix,[M*k,I*k,0]),y.scale(w.posMatrix,w.posMatrix,[1/2**D,1/2**D,0]),u[p]=w}}return u}getSourceTile(s,u){const p=this.sourceCache._source;let _=s.overscaledZ-this.deltaZoom;if(_>p.maxzoom&&(_=p.maxzoom),_<p.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(_).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!w||!w.dem)&&u)for(;_>=p.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(s.scaledTo(_--).key);return w}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=s)}}class Mr{constructor(s,u,p){this.painter=s,this.sourceCache=new xl(u),this.options=p,this.exaggeration="number"==typeof p.exaggeration?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,u,p,_=y.EXTENT){if(!(u>=0&&u<_&&p>=0&&p<_))return 0;let w=0;const D=this.getTerrainData(s);if(D.tile&&D.tile.dem){const M=((q=[])[0]=(te=D.u_terrain_matrix)[0]*(le=(Z=[u/_*y.EXTENT,p/_*y.EXTENT])[0])+te[4]*(fe=Z[1])+te[12],q[1]=te[1]*le+te[5]*fe+te[13],q),I=[M[0]*D.tile.dem.dim,M[1]*D.tile.dem.dim],k=[Math.floor(I[0]),Math.floor(I[1])],O=D.tile.dem.get(k[0],k[1]),F=D.tile.dem.get(k[0],k[1]+1),j=D.tile.dem.get(k[0]+1,k[1]),X=D.tile.dem.get(k[0]+1,k[1]+1);w=y.interpolate.number(y.interpolate.number(O,F,I[0]-k[0]),y.interpolate.number(j,X,I[0]-k[0]),I[1]-k[1])}var q,Z,te,le,fe;return w}getElevation(s,u,p,_=y.EXTENT){return this.getDEMElevation(s,u,p,_)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const _=this.painter.context,w=new y.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ut(_,w,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ut(_,new y.RGBAImage({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=y.identity([])}const u=this.sourceCache.getSourceTile(s,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const _=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new ut(_,u.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),u.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const p=u&&u+u.tileID.key+s.key;if(p&&!this._demMatrixCache[p]){const _=this.sourceCache.sourceCache._source.maxzoom;let w=s.canonical.z-u.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=_?w=s.canonical.z-_:y.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const D=s.canonical.x-(s.canonical.x>>w<<w),M=s.canonical.y-(s.canonical.y>>w<<w),I=y.fromScaling(new Float64Array(16),[1/(y.EXTENT<<w),1/(y.EXTENT<<w),0]);y.translate(I,I,[D*y.EXTENT,M*y.EXTENT,0]),this._demMatrixCache[s.key]={matrix:I,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(s){const u=this.painter,p=u.width/devicePixelRatio,_=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ut(u.context,{width:p,height:_,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ut(u.context,{width:p,height:_,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(p,_,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,p,_))),this._fbo.colorAttachment.set("coords"===s?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,D=0;w<this._coordsTextureSize;w++)for(let M=0;M<this._coordsTextureSize;M++,D+=4)u[D+0]=255&M,u[D+1]=255&w,u[D+2]=M>>8<<4|w>>8,u[D+3]=0;const p=new y.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),_=new ut(s,p,s.gl.RGBA,{premultiply:!1});return _.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(s){const u=new Uint8Array(4),p=this.painter.context,_=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null);const w=u[0]+(u[2]>>4<<8),D=u[1]+((15&u[2])<<8),M=this.coordsIndex[255-u[3]],I=M&&this.sourceCache.getTileByID(M);if(!I)return null;const k=this._coordsTextureSize,O=(1<<I.tileID.canonical.z)*k;return new y.MercatorCoordinate((I.tileID.canonical.x*k+w)/O,(I.tileID.canonical.y*k+D)/O,this.getElevation(I.tileID,w,D,k))}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,u=new y.Pos3dArray,p=new y.TriangleIndexArray,_=this.meshSize,w=y.EXTENT/_,D=_*_;for(let F=0;F<=_;F++)for(let j=0;j<=_;j++)u.emplaceBack(j*w,F*w,0);for(let F=0;F<D;F+=_+1)for(let j=0;j<_;j++)p.emplaceBack(j+F,_+j+F+1,_+j+F+2),p.emplaceBack(j+F,_+j+F+2,j+F+1);const M=u.length,I=M+2*(_+1);for(const F of[0,1])for(let j=0;j<=_;j++)for(const X of[0,1])u.emplaceBack(j*w,F*y.EXTENT,X);for(let F=0;F<2*_;F+=2)p.emplaceBack(I+F,I+F+1,I+F+3),p.emplaceBack(I+F,I+F+3,I+F+2),p.emplaceBack(M+F,M+F+3,M+F+1),p.emplaceBack(M+F,M+F+2,M+F+3);const k=u.length,O=k+2*(_+1);for(const F of[0,1])for(let j=0;j<=_;j++)for(const X of[0,1])u.emplaceBack(F*y.EXTENT,j*w,X);for(let F=0;F<2*_;F+=2)p.emplaceBack(k+F,k+F+1,k+F+3),p.emplaceBack(k+F,k+F+3,k+F+2),p.emplaceBack(O+F,O+F+3,O+F+1),p.emplaceBack(O+F,O+F+2,O+F+3);return this._mesh={indexBuffer:s.createIndexBuffer(p),vertexBuffer:s.createVertexBuffer(u,sn.members),segments:y.SegmentVector.simpleSegment(0,0,u.length,p.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*y.earthRadius/Math.pow(2,s)/5}getMinMaxElevation(s){const u=this.getTerrainData(s).tile,p={minElevation:null,maxElevation:null};return u&&u.dem&&(p.minElevation=u.dem.min*this.exaggeration,p.maxElevation=u.dem.max*this.exaggeration),p}}class ns{constructor(s,u,p){this._context=s,this._size=u,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new ut(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(p.texture),{id:s,fbo:u,texture:p,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>s.id!==u),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(s=>!s.inUse)}}const Jr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Yn{constructor(s,u){this.painter=s,this.terrain=u,this.pool=new ns(s.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(p=>!s._layers[p].isHidden(u)),this._coordsDescendingInv={};for(const p in s.sourceCaches){this._coordsDescendingInv[p]={};const _=s.sourceCaches[p].getVisibleCoordinates();for(const w of _){const D=this.terrain.sourceCache.getTerrainCoords(w);for(const M in D)this._coordsDescendingInv[p][M]||(this._coordsDescendingInv[p][M]=[]),this._coordsDescendingInv[p][M].push(D[M])}}this._coordsDescendingInvStr={};for(const p of s._order){const _=s._layers[p],w=_.source;if(Jr[_.type]&&!this._coordsDescendingInvStr[w]){this._coordsDescendingInvStr[w]={};for(const D in this._coordsDescendingInv[w])this._coordsDescendingInvStr[w][D]=this._coordsDescendingInv[w][D].map(M=>M.key).sort().join()}}for(const p of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const w=this._coordsDescendingInvStr[_][p.tileID.key];w&&w!==p.rttCoords[_]&&(p.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const u=s.type,p=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Jr[u]&&(this._prevType&&Jr[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(s.id),!_))return!0;if(Jr[this._prevType]||Jr[u]&&_){this._prevType=u;const w=this._stacks.length-1,D=this._stacks[w]||[];for(const M of this._renderableTiles){if(this.pool.isFull()&&(on(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(M),M.rtt[w]){const k=this.pool.getObjectForId(M.rtt[w].id);if(k.stamp===M.rtt[w].stamp){this.pool.useObject(k);continue}}const I=this.pool.getOrCreateFreeObject();this.pool.useObject(I),this.pool.stampObject(I),M.rtt[w]={id:I.id,stamp:I.stamp},p.context.bindFramebuffer.set(I.fbo.framebuffer),p.context.clear({color:y.Color.transparent,stencil:0}),p.currentStencilSource=void 0;for(let k=0;k<D.length;k++){const O=p.style._layers[D[k]],F=O.source?this._coordsDescendingInv[O.source][M.tileID.key]:[M.tileID];p.context.viewport.set([0,0,I.fbo.width,I.fbo.height]),p._renderTileClippingMasks(O,F),p.renderLayer(p,p.style.sourceCaches[O.source],O,F),O.source&&(M.rttCoords[O.source]=this._coordsDescendingInvStr[O.source][M.tileID.key])}}return on(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Jr[u]}return!1}}const is={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:y.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},rs=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},sa={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gt{constructor(s,u,p=!1){this._clickTolerance=10;const _=s.dragRotate._mouseRotate.getClickTolerance(),w=s.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=Eh({clickTolerance:_,enable:!0}),this.touchRotate=(({enable:D,clickTolerance:M,bearingDegreesPerPixelMoved:I=.8})=>{const k=new Di;return new Ss({clickTolerance:M,move:(O,F)=>({bearingDelta:(F.x-O.x)*I}),moveStateManager:k,enable:D,assignEvents:rs})})({clickTolerance:_,enable:!0}),this.map=s,p&&(this.mousePitch=Jc({clickTolerance:w,enable:!0}),this.touchPitch=(({enable:D,clickTolerance:M,pitchDegreesPerPixelMoved:I=-.5})=>{const k=new Di;return new Ss({clickTolerance:M,move:(O,F)=>({pitchDelta:(F.y-O.y)*I}),moveStateManager:k,enable:D,assignEvents:rs})})({clickTolerance:w,enable:!0})),y.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),be.addEventListener(u,"mousedown",this.mousedown),be.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),be.addEventListener(u,"touchcancel",this.reset)}startMouse(s,u){this.mouseRotate.dragStart(s,u),this.mousePitch&&this.mousePitch.dragStart(s,u),be.disableDrag()}startTouch(s,u){this.touchRotate.dragStart(s,u),this.touchPitch&&this.touchPitch.dragStart(s,u),be.disableDrag()}moveMouse(s,u){const p=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(s,u)||{};if(_&&p.setBearing(p.getBearing()+_),this.mousePitch){const{pitchDelta:w}=this.mousePitch.dragMove(s,u)||{};w&&p.setPitch(p.getPitch()+w)}}moveTouch(s,u){const p=this.map,{bearingDelta:_}=this.touchRotate.dragMove(s,u)||{};if(_&&p.setBearing(p.getBearing()+_),this.touchPitch){const{pitchDelta:w}=this.touchPitch.dragMove(s,u)||{};w&&p.setPitch(p.getPitch()+w)}}off(){const s=this.element;be.removeEventListener(s,"mousedown",this.mousedown),be.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),be.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),be.removeEventListener(window,"touchend",this.touchend),be.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){be.enableDrag(),be.removeEventListener(window,"mousemove",this.mousemove),be.removeEventListener(window,"mouseup",this.mouseup),be.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),be.removeEventListener(window,"touchend",this.touchend)}mousedown(s){this.startMouse(y.extend({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),be.mousePos(this.element,s)),be.addEventListener(window,"mousemove",this.mousemove),be.addEventListener(window,"mouseup",this.mouseup)}mousemove(s){this.moveMouse(s,be.mousePos(this.element,s))}mouseup(s){this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()}touchstart(s){1!==s.targetTouches.length?this.reset():(this._startPos=this._lastPos=be.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),be.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),be.addEventListener(window,"touchend",this.touchend))}touchmove(s){1!==s.targetTouches.length?this.reset():(this._lastPos=be.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))}touchend(s){0===s.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let Ts;function wl(m,s,u){if(m=new y.LngLat(m.lng,m.lat),s){const p=new y.LngLat(m.lng-360,m.lat),_=new y.LngLat(m.lng+360,m.lat),w=u.locationPoint(m).distSqr(s);u.locationPoint(p).distSqr(s)<w?m=p:u.locationPoint(_).distSqr(s)<w&&(m=_)}for(;Math.abs(m.lng-u.center.lng)>180;){const p=u.locationPoint(m);if(p.x>=0&&p.y>=0&&p.x<=u.width&&p.y<=u.height)break;m.lng>u.center.lng?m.lng-=360:m.lng+=360}return m}const aa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function eo(m,s,u){const p=m.classList;for(const _ in aa)p.remove(`maplibregl-${u}-anchor-${_}`);p.add(`maplibregl-${u}-anchor-${s}`)}class la extends y.Evented{constructor(s,u){if(super(),(s instanceof HTMLElement||u)&&(s=y.extend({element:s},u)),y.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&"auto"!==s.pitchAlignment?s.pitchAlignment:this._rotationAlignment,s&&s.element)this._element=s.element,this._offset=y.Point.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=be.create("div"),this._element.setAttribute("aria-label","Map marker");const p=be.createNS("http://www.w3.org/2000/svg","svg"),_=41,w=27;p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height",`${_}px`),p.setAttributeNS(null,"width",`${w}px`),p.setAttributeNS(null,"viewBox",`0 0 ${w} ${_}`);const D=be.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"stroke","none"),D.setAttributeNS(null,"stroke-width","1"),D.setAttributeNS(null,"fill","none"),D.setAttributeNS(null,"fill-rule","evenodd");const M=be.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill-rule","nonzero");const I=be.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of k){const J=be.createNS("http://www.w3.org/2000/svg","ellipse");J.setAttributeNS(null,"opacity","0.04"),J.setAttributeNS(null,"cx","10.5"),J.setAttributeNS(null,"cy","5.80029008"),J.setAttributeNS(null,"rx",fe.rx),J.setAttributeNS(null,"ry",fe.ry),I.appendChild(J)}const O=be.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const F=be.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(F);const j=be.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const X=be.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(X);const q=be.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const Z=be.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=be.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const le=be.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#FFFFFF"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962"),Z.appendChild(te),Z.appendChild(le),M.appendChild(I),M.appendChild(O),M.appendChild(j),M.appendChild(q),M.appendChild(Z),p.appendChild(M),p.setAttributeNS(null,"height",_*this._scale+"px"),p.setAttributeNS(null,"width",w*this._scale+"px"),this._element.appendChild(p),this._offset=y.Point.convert(s&&s.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",p=>{p.preventDefault()}),this._element.addEventListener("mousedown",p=>{p.preventDefault()}),eo(this._element,this._anchor,"marker"),this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),be.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=y.LngLat.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(24.6+_)],"bottom-right":[-_,-1*(24.6+_)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=s,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(s){const u=s.code,p=s.charCode||s.keyCode;"Space"!==u&&"Enter"!==u&&32!==p&&13!==p||this.togglePopup()}_onMapClick(s){const u=s.originalEvent.target,p=this._element;this._popup&&(u===p||p.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():s.addTo(this._map),this):this}_update(s){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=wl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let u="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?u=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(u=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let p="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?p="rotateX(0deg)":"map"===this._pitchAlignment&&(p=`rotateX(${this._map.getPitch()}deg)`),s&&"moveend"!==s.type||(this._pos=this._pos.round()),be.setTransform(this._element,`${aa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${p} ${u}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const _=this._map.unproject(this._pos),w=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=_.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(s){return this._offset=y.Point.convert(s),this._update(),this}_onMove(s){if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new y.Event("dragstart"))),this.fire(new y.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new y.Event("dragend")),this._state="inactive"}_addDragHandler(s){this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&"auto"!==s?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const ca={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let os=0,Qn=!1;const Dh={maxWidth:100,unit:"metric"};function er(m,s,u){const p=u&&u.maxWidth||100,_=m._container.clientHeight/2,w=m.unproject([0,_]),D=m.unproject([p,_]),M=w.distanceTo(D);if(u&&"imperial"===u.unit){const I=3.2808*M;I>5280?hi(s,p,I/5280,m._getUIString("ScaleControl.Miles")):hi(s,p,I,m._getUIString("ScaleControl.Feet"))}else u&&"nautical"===u.unit?hi(s,p,M/1852,m._getUIString("ScaleControl.NauticalMiles")):M>=1e3?hi(s,p,M/1e3,m._getUIString("ScaleControl.Kilometers")):hi(s,p,M,m._getUIString("ScaleControl.Meters"))}function hi(m,s,u,p){const _=function(w){const D=Math.pow(10,`${Math.floor(w)}`.length-1);let M=w/D;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(I){const k=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*k)/k}(M),D*M}(u);m.style.width=s*(_/u)+"px",m.innerHTML=`${_}&nbsp;${p}`}const El={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},As=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ua(m){if(m){if("number"==typeof m){const s=Math.round(Math.sqrt(.5*Math.pow(m,2)));return{center:new y.Point(0,0),top:new y.Point(0,m),"top-left":new y.Point(s,s),"top-right":new y.Point(-s,s),bottom:new y.Point(0,-m),"bottom-left":new y.Point(s,-s),"bottom-right":new y.Point(-s,-s),left:new y.Point(m,0),right:new y.Point(-m,0)}}if(m instanceof y.Point||Array.isArray(m)){const s=y.Point.convert(m);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:y.Point.convert(m.center||[0,0]),top:y.Point.convert(m.top||[0,0]),"top-left":y.Point.convert(m["top-left"]||[0,0]),"top-right":y.Point.convert(m["top-right"]||[0,0]),bottom:y.Point.convert(m.bottom||[0,0]),"bottom-left":y.Point.convert(m["bottom-left"]||[0,0]),"bottom-right":y.Point.convert(m["bottom-right"]||[0,0]),left:y.Point.convert(m.left||[0,0]),right:y.Point.convert(m.right||[0,0])}}return Ua(new y.Point(0,0))}const Cl={setRTLTextPlugin:y.setRTLTextPlugin,getRTLTextPluginStatus:y.getRTLTextPluginStatus,Map:class extends et{constructor(m){var s;if(y.PerformanceUtils.mark(y.PerformanceMarkers.create),null!=(m=y.extend({},is,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new na(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new nu,this._controls=[],this._mapId=y.uniqueId(),this._locale=y.extend({},oa,m.locale),this._clickTolerance=m.clickTolerance,this._pixelRatio=null!==(s=m.pixelRatio)&&void 0!==s?s:devicePixelRatio,this.transformCameraUpdate=m.transformCameraUpdate,this._imageQueueHandle=co.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ci(m.transformRequest),"string"==typeof m.container){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),y.bindAll(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let u=!1;this._resizeObserver=new ResizeObserver(p=>{u?this._trackResize&&this.resize(p)._update():u=!0}),this._resizeObserver.observe(this._container)}this.handlers=new vn(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new ad("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,y.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Fe({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new Ms,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update("style"===u.dataType),this.fire(new y.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new y.Event(`${u.dataType}dataloading`,u))}),this.on("dataabort",u=>{this.fire(new y.Event("sourcedataabort",u))})}_getMapId(){return this._mapId}addControl(m,s){if(void 0===s&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new y.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=m.onAdd(this);this._controls.push(m);const p=this._controlPositions[s];return-1!==s.indexOf("bottom")?p.insertBefore(u,p.firstChild):p.appendChild(u),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new y.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,s,u,p){return null==p&&this.terrain&&(p=this.transform.getElevation(u,this.terrain)),super.calculateCameraOptionsFromTo(m,s,u,p)}resize(m){var s;const u=this._containerDimensions(),p=u[0],_=u[1];this._resizeCanvas(p,_,this.getPixelRatio()),this.transform.resize(p,_),null===(s=this._requestedCameraState)||void 0===s||s.resize(p,_),this.painter.resize(p,_,this.getPixelRatio());const w=!this._moving;return w&&(this.stop(),this.fire(new y.Event("movestart",m)).fire(new y.Event("move",m))),this.fire(new y.Event("resize",m)),w&&this.fire(new y.Event("moveend",m)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(m){const[s,u]=this._containerDimensions();this._pixelRatio=m,this._resizeCanvas(s,u,m),this.painter.resize(s,u,m)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(Ft.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(m){return this.transform.locationPoint(y.LngLat.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(y.Point.convert(m),this.terrain)}isMoving(){var m;return this._moving||(null===(m=this.handlers)||void 0===m?void 0:m.isMoving())}isZooming(){var m;return this._zooming||(null===(m=this.handlers)||void 0===m?void 0:m.isZooming())}isRotating(){var m;return this._rotating||(null===(m=this.handlers)||void 0===m?void 0:m.isRotating())}_createDelegatedListener(m,s,u){if("mouseenter"===m||"mouseover"===m){let p=!1;return{layer:s,listener:u,delegates:{mousemove:w=>{const D=this.getLayer(s)?this.queryRenderedFeatures(w.point,{layers:[s]}):[];D.length?p||(p=!0,u.call(this,new ui(m,this,w.originalEvent,{features:D}))):p=!1},mouseout:()=>{p=!1}}}}if("mouseleave"===m||"mouseout"===m){let p=!1;return{layer:s,listener:u,delegates:{mousemove:D=>{(this.getLayer(s)?this.queryRenderedFeatures(D.point,{layers:[s]}):[]).length?p=!0:p&&(p=!1,u.call(this,new ui(m,this,D.originalEvent)))},mouseout:D=>{p&&(p=!1,u.call(this,new ui(m,this,D.originalEvent)))}}}}{const p=_=>{const w=this.getLayer(s)?this.queryRenderedFeatures(_.point,{layers:[s]}):[];w.length&&(_.features=w,u.call(this,_),delete _.features)};return{layer:s,listener:u,delegates:{[m]:p}}}}on(m,s,u){if(void 0===u)return super.on(m,s);const p=this._createDelegatedListener(m,s,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(m,s,u){if(void 0===u)return super.once(m,s);const p=this._createDelegatedListener(m,s,u);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(m,s,u){return void 0===u?super.off(m,s):(this._delegatedListeners&&this._delegatedListeners[m]&&(p=>{const _=this._delegatedListeners[m];for(let w=0;w<_.length;w++){const D=_[w];if(D.layer===s&&D.listener===u){for(const M in D.delegates)this.off(M,D.delegates[M]);return _.splice(w,1),this}}})(),this)}queryRenderedFeatures(m,s){if(!this.style)return[];let u;const p=m instanceof y.Point||Array.isArray(m),_=p?m:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(p?{}:m)||{},_ instanceof y.Point||"number"==typeof _[0])u=[y.Point.convert(_)];else{const w=y.Point.convert(_[0]),D=y.Point.convert(_[1]);u=[w,new y.Point(D.x,w.y),D,new y.Point(w.x,D.y),w]}return this.style.queryRenderedFeatures(u,s,this.transform)}querySourceFeatures(m,s){return this.style.querySourceFeatures(m,s)}setStyle(m,s){return!1!==(s=y.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(m,s))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const s=this._locale[m];if(null==s)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,s));const u=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Li(this,s||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m,s,u):this.style.loadJSON(m,s,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Li(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,s){if("string"==typeof m){const u=this._requestManager.transformRequest(m,zn.Style);y.getJSON(u,(p,_)=>{p?this.fire(new y.ErrorEvent(p)):_&&this._updateDiff(_,s)})}else"object"==typeof m&&this._updateDiff(m,s)}_updateDiff(m,s){try{this.style.setState(m,s)&&this._update(!0)}catch(u){y.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(m,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():y.warnOnce("There is no style added to the map.")}addSource(m,s){return this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)}isSourceLoaded(m){const s=this.style&&this.style.sourceCaches[m];if(void 0!==s)return s.loaded();this.fire(new y.ErrorEvent(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const s=this.style.sourceCaches[m.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);for(const u in this.style._layers){const p=this.style._layers[u];"hillshade"===p.type&&p.source===m.source&&y.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Mr(this.painter,s,m),this.painter.renderToTexture=new Yn(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=u=>{"style"===u.dataType?this.terrain.sourceCache.freeRtt():"source"===u.dataType&&u.tile&&(u.sourceId===m.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new y.Event("terrain",{terrain:m})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const s in m){const u=m[s]._tiles;for(const p in u){const _=u[p];if("loaded"!==_.state&&"errored"!==_.state)return!1}}return!0}addSourceType(m,s,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,u)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,s,{pixelRatio:u=1,sdf:p=!1,stretchX:_,stretchY:w,content:D}={}){if(this._lazyInitEmptyStyle(),s instanceof HTMLImageElement||y.isImageBitmap(s)){const{width:M,height:I,data:k}=y.exported.getImageData(s);this.style.addImage(m,{data:new y.RGBAImage({width:M,height:I},k),pixelRatio:u,stretchX:_,stretchY:w,content:D,sdf:p,version:0})}else{if(void 0===s.width||void 0===s.height)return this.fire(new y.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:I,data:k}=s,O=s;this.style.addImage(m,{data:new y.RGBAImage({width:M,height:I},new Uint8Array(k)),pixelRatio:u,stretchX:_,stretchY:w,content:D,sdf:p,version:0,userImage:O}),O.onAdd&&O.onAdd(this,m)}}}updateImage(m,s){const u=this.style.getImage(m);if(!u)return this.fire(new y.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=s instanceof HTMLImageElement||y.isImageBitmap(s)?y.exported.getImageData(s):s,{width:_,height:w,data:D}=p;if(void 0===_||void 0===w)return this.fire(new y.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==u.data.width||w!==u.data.height)return this.fire(new y.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(s instanceof HTMLImageElement||y.isImageBitmap(s));u.data.replace(D,M),this.style.updateImage(m,u)}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new y.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,s){co.getImage(this._requestManager.transformRequest(m,zn.Image),s)}listImages(){return this.style.listImages()}addLayer(m,s){return this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)}moveLayer(m,s){return this.style.moveLayer(m,s),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,s,u){return this.style.setLayerZoomRange(m,s,u),this._update(!0)}setFilter(m,s,u={}){return this.style.setFilter(m,s,u),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,s,u,p={}){return this.style.setPaintProperty(m,s,u,p),this._update(!0)}getPaintProperty(m,s){return this.style.getPaintProperty(m,s)}setLayoutProperty(m,s,u,p={}){return this.style.setLayoutProperty(m,s,u,p),this._update(!0)}getLayoutProperty(m,s){return this.style.getLayoutProperty(m,s)}setGlyphs(m,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,s,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,s,u,p=>{p||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,s,u=>{u||this._update(!0)}),this}setLight(m,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,s){return this.style.setFeatureState(m,s),this._update()}removeFeatureState(m,s){return this.style.removeFeatureState(m,s),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,s=0;return this._container&&(m=this._container.clientWidth||400,s=this._container.clientHeight||300),[m,s]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const s=this._canvasContainer=be.create("div","maplibregl-canvas-container",m);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=be.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions();this._resizeCanvas(u[0],u[1],this.getPixelRatio());const p=this._controlContainer=be.create("div","maplibregl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{_[w]=be.create("div",`maplibregl-ctrl-${w} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(m){this._onCooperativeGesture(m,m[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=be.create("div","maplibregl-cooperative-gesture-screen",this._container);let m="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(m="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${m}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){be.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(m,s,u){this._canvas.width=u*m,this._canvas.height=u*s,this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{s={requestedAttributes:m},p&&(s.statusMessage=p.statusMessage,s.type=p.type)},{once:!0});const u=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!u){const p="Failed to initialize WebGL";throw s?(s.message=p,new Error(JSON.stringify(s))):new Error(p)}this.painter=new Kc(u,this.transform),Wi.testSupport(u)}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new y.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new y.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(m,s,u){return!s&&u<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,w=y.exported.now();this.style.zoomHistory.update(_,w);const D=new y.EvaluationParameters(_,{now:w,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=D.crossFadingFactor();1===M&&M===this._crossFadingFactor||(u=!0,this._crossFadingFactor=M),this.style.update(D)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new y.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,y.PerformanceUtils.mark(y.PerformanceMarkers.load),this.fire(new y.Event("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new y.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,y.PerformanceUtils.mark(y.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),co.removeThrottleControl(this._imageQueueHandle),null===(m=this._resizeObserver)||void 0===m||m.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),be.remove(this._canvasContainer),be.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),y.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new y.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=y.exported.frame(m=>{y.PerformanceUtils.frame(m),this._frame=null,this._render(m)}))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return"3.1.0"}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(m){this.options=y.extend({},sa,m),this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(y.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),be.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),be.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(y.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=be.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map.getZoom(),s=m===this._map.getMaxZoom(),u=m===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=m}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gt(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){be.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,s){const u=be.create("button",m,this._container);return u.type="button",u.addEventListener("click",s),u}_setButtonTitle(m,s){const u=this._map._getUIString(`NavigationControl.${s}`);m.title=u,m.setAttribute("aria-label",u)}},GeolocateControl:class extends y.Evented{constructor(m){super(),this.options=y.extend({},ca,m),y.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(m){return this._map=m,this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s,u=!1){void 0===Ts||u?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Ts="denied"!==p.state,s(Ts)}).catch(()=>{Ts=!!window.navigator.geolocation,s(Ts)}):(Ts=!!window.navigator.geolocation,s(Ts)):s(Ts)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),be.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,os=0,Qn=!1}_isOutOfMapMaxBounds(m){const s=this._map.getMaxBounds(),u=m.coords;return s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new y.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new y.Event("geolocate",m)),this._finish()}}_updateCamera(m){const s=new y.LngLat(m.coords.longitude,m.coords.latitude),u=m.coords.accuracy,p=this._map.getBearing(),_=y.extend({bearing:p},this.options.fitBoundsOptions),w=Ft.fromLngLat(s,u);this._map.fitBounds(w,_,{geolocateSource:!0})}_updateMarker(m){if(m){const s=new y.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.getBounds(),s=m.getSouthEast(),u=m.getNorthEast(),p=s.distanceTo(u),_=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&Qn)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new y.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=be.create("button","maplibregl-ctrl-geolocate",this._container),be.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){y.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=be.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new la(this._dotElement),this._circleElement=be.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new la({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||"ACTIVE_LOCK"!==this._watchState||s.originalEvent&&"resize"===s.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new y.Event("trackuserlocationend")))})}}trigger(){if(!this._setup)return y.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new y.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":os--,Qn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new y.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new y.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),os++,os>1?(m={maximumAge:6e5,timeout:0},Qn=!0):(m=this.options.positionOptions,Qn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Fe,LogoControl:Ms,ScaleControl:class{constructor(m){this.options=y.extend({},Dh,m),y.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){er(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){be.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,er(this._map,this._container,this.options)}},FullscreenControl:class extends y.Evented{constructor(m={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:y.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){be.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=be.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);be.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new y.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new y.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(m){this.options=m,y.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(m){return this._map=m,this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=be.create("button","maplibregl-ctrl-terrain",this._container),be.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){be.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends y.Evented{constructor(m){super(),this.options=y.extend(Object.create(El),m),y.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new y.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&be.remove(this._content),this._container&&(be.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new y.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=y.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const s=document.createDocumentFragment(),u=document.createElement("body");let p;for(u.innerHTML=m;p=u.firstChild,p;)s.appendChild(p);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=be.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=be.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(m){this._update(m.point)}_onMouseMove(m){this._update(m.point)}_onDrag(m){this._update(m.point)}_update(m){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=be.create("div","maplibregl-popup",this._map.getContainer()),this._tip=be.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(w=>this._container.classList.add(w)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=wl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!m))return;const s=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat);let u=this.options.anchor;const p=Ua(this.options.offset);if(!u){const w=this._container.offsetWidth,D=this._container.offsetHeight;let M;M=s.y+p.bottom.y<D?["top"]:s.y>this._map.transform.height-D?["bottom"]:[],s.x<w/2?M.push("left"):s.x>this._map.transform.width-w/2&&M.push("right"),u=0===M.length?"bottom":M.join("-")}const _=s.add(p[u]).round();be.setTransform(this._container,`${aa[u]} translate(${_.x}px,${_.y}px)`),eo(this._container,u,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(As);m&&m.focus()}_onClose(){this.remove()}},Marker:la,Style:Li,LngLat:y.LngLat,LngLatBounds:Ft,Point:y.Point,MercatorCoordinate:y.MercatorCoordinate,Evented:y.Evented,AJAXError:y.AJAXError,config:y.config,CanvasSource:xe,GeoJSONSource:ms,ImageSource:Nr,RasterDEMTileSource:Mn,RasterTileSource:Vn,VectorTileSource:Ra,VideoSource:ol,prewarm:function(){ll().acquire(gs)},clearPrewarmedResources:function(){const m=Xi;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(gs),Xi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"3.1.0"},get workerCount(){return je.workerCount},set workerCount(m){je.workerCount=m},get maxParallelImageRequests(){return y.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){y.config.MAX_PARALLEL_IMAGE_REQUESTS=m},get workerUrl(){return y.config.WORKER_URL},set workerUrl(m){y.config.WORKER_URL=m},addProtocol(m,s){y.config.REGISTERED_PROTOCOLS[m]=s},removeProtocol(m){delete y.config.REGISTERED_PROTOCOLS[m]}};return No.extend(Cl,{isSafari:y.isSafari,getPerformanceMetrics:y.PerformanceUtils.getPerformanceMetrics}),Cl}),$t}()}},Pc=>{Pc(Pc.s=780)}]);